(function(){var e={678:function(e,t,a){"use strict";var l=a(7537),s=a.n(l),i=a(3645),o=a.n(i),n=o()(s());n.push([e.id,"@media print{.flex-sche-table{width:100%;background:#fff;border-collapse:collapse;-webkit-print-color-adjust:exact}.flex-sche-table td,.flex-sche-table th{border:1px solid #ddd;padding:8px}.flex-sche-table tr:nth-child(even){background:#f2f2f2}.flex-sche-table tr:hover{background:#ddd}.flex-sche-table thead th{padding:3px 5px 3px 5px;font-weight:normal;text-align:left;background:linear-gradient(to bottom, #fcfcfc 0%, #efefef 49%, #e2e2e2 51%, #d6d6d6 100%)}.flex-sche-table .leave-unit{width:100%;padding:2px 5px;background-color:#e0e0e0}}@media screen{.flex-sche-table{display:none}}","",{version:3,sources:["webpack://./src/components/FlexSchedule/Print/PrintableView.scss"],names:[],mappings:"AAAA,aACI,iBACI,UAAA,CACA,eAAA,CACA,wBAAA,CACA,gCAAA,CAEA,wCACI,qBAAA,CACA,WAAA,CAGJ,oCACI,kBAAA,CAGJ,0BACI,eAAA,CAIA,0BACI,uBAAA,CACA,kBAAA,CACA,eAAA,CACA,yFAAA,CAIR,6BACI,UAAA,CACA,eAAA,CACA,wBAAA,CAAA,CAMZ,cACI,iBACI,YAAA,CAAA",sourcesContent:["@media print {\r\n    .flex-sche-table {\r\n        width: 100%;\r\n        background: white;\r\n        border-collapse: collapse;\r\n        -webkit-print-color-adjust: exact;\r\n\r\n        td, th {\r\n            border: 1px solid #ddd;\r\n            padding: 8px;\r\n        }\r\n\r\n        tr:nth-child(even) {\r\n            background: #f2f2f2;\r\n        }\r\n\r\n        tr:hover {\r\n            background: #ddd;\r\n        }\r\n\r\n        thead {\r\n            th {\r\n                padding: 3px 5px 3px 5px;\r\n                font-weight: normal;\r\n                text-align: left;\r\n                background: linear-gradient(to bottom, #fcfcfc 0%, #efefef 49%, #e2e2e2 51%, #d6d6d6 100%);\r\n            }\r\n        }\r\n\r\n        .leave-unit {\r\n            width: 100%;\r\n            padding: 2px 5px;\r\n            background-color: #E0E0E0\r\n        }\r\n\r\n    }\r\n}\r\n\r\n@media screen {\r\n    .flex-sche-table {\r\n        display: none;\r\n    }\r\n}"],sourceRoot:""}])},6700:function(e,t,a){var l={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":7093,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":7093,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":238,"./ru.js":238,"./sd":950,"./sd.js":950,"./se":7930,"./se.js":7930,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":7198,"./yo.js":7198,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function s(e){var t=i(e);return a(t)}function i(e){if(!a.o(l,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return l[e]}s.keys=function(){return Object.keys(l)},s.resolve=i,e.exports=s,s.id=6700},6584:function(e,t,a){"use strict";a.d(t,{u:function(){return Hw}});var l=a(9963),s=a(6252);const i={class:"v-application"};function o(e,t,a,l,o,n){const r=(0,s.up)("schedules-navigation"),d=(0,s.up)("alert"),c=(0,s.up)("router-view"),h=(0,s.up)("dashboard");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(h,{"enable-by-config":!0,"config-url":"/Config/Dashboard","info-url":"/Auth/GetInfo","logout-url":"/Auth/Logout"},{default:(0,s.w5)((()=>[(0,s._)("div",i,[(0,s.Wm)(r),(0,s.Wm)(d),(0,s.Wm)(c)])])),_:1})])}var n=a(3577);const r=e=>((0,s.dD)("data-v-09187f16"),e=e(),(0,s.Cn)(),e),d={class:"schedules"},c={class:"sch-nav justify-space-between align-center primary body-2"},h={class:"white--text"},u={key:0,class:"d-flex align-center"},m={class:"sch-nav-options mr-1 pa-0"},p=["onClick"],y={href:"/help/index",class:"sch-nav-help align-center mr-2",target:"_blank"},f=r((()=>(0,s._)("span",{class:"icon-help-round white"},null,-1))),g=[f];function D(e,t){const a=(0,s.Q2)("tooltip");return(0,s.wg)(),(0,s.iD)("div",d,[(0,s._)("div",c,[(0,s._)("div",h,"Schedules - "+(0,n.zw)(e.userFullName),1),e.user?((0,s.wg)(),(0,s.iD)("div",u,[(0,s._)("ul",m,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.authorizedMenus,(t=>((0,s.wg)(),(0,s.iD)("li",{class:(0,n.C_)(["nav-box mr-1 py-1 px-2 my-1 caption",{selected:t.selected}]),onClick:a=>e.selectMenu(t)},[(0,s._)("div",null,(0,n.zw)(t.display),1)],10,p)))),256))]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("a",y,g)),[[a,{content:"Help"},void 0,{top:!0}]])])):(0,s.kq)("",!0)])])}a(6699),a(1703);var w=a(9669),v=a.n(w);let S=!1;({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_AXIOSHOST&&(S=!0,v().defaults.baseURL={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_AXIOSHOST),v().defaults.headers.common["X-Requested-With"]="XMLHttpRequest",v().interceptors.response.use((e=>e.request.responseURL.indexOf("aspxerrorpath")>-1?Promise.reject("asp error"):e),(e=>(e&&e.response&&401==e.response.status&&location.reload(),Promise.reject(e))));let b=function(e){return v().post("EmployeeWorkSchedule",e).then((e=>"string"===typeof e.data&&""!==e.data?JSON.parse(e.data):e.data))},k=function(){return v().post("Auth/GetInfo").then((e=>e.data))};function C(e){return v().get("StandardSchedules",{params:{allSchedules:e}}).then((e=>e.data))}async function A(){return v().get("ShiftTypes").then((e=>e.data))}function x(e){return v().get(`ScheduleDetail/${e}`).then((e=>e.data))}function _(e){return v().post("PostSchedule",e).then((e=>e.data))}function T(e){return v().get(`DeleteSchedule/${e}`).then((e=>e.data))}function E(e){return v().post("AllocateSchedule",e).then((e=>{if(e.data.Messages&&e.data.Messages.length>=1)throw new Error(e.data.Messages[0].Message);return e.data}))}function M(e,t){return v().get(`RemoveEmployeeWorkSchedule/${t}/${e}`).then((e=>e.data))}function N(e,t){return v().post(`UpdateEmployeeWorkSchedule/${t}`,e).then((e=>{if(e.data.Messages&&e.data.Messages.length>=1)throw new Error(e.data.Messages[0].Message);return e.data}))}function F(){return v().get("EmployeeOptions").then((e=>e.data))}function P(e){return v().get(`EmployeeWorkSchedules/${e}`).then((e=>e.data))}function O(e){return v().get(`EmployeeWorkScheduleDetail/${e}`).then((e=>e.data))}function H(e){return v().get(`FlexScheduleDetail/${e}`).then((e=>e.data))}function Y(e){return v().get("FlexSchedules",{params:e}).then((e=>e.data))}function I(e){return v().post("CreateFlexSchedule/",e).then((e=>e.data))}function L(e,t){return v().put(`UpdateFlexSchedule/${e}`,t).then((e=>e.data))}function W(e){return v().patch("PatchFlexSchedule",e).then((e=>e.data))}function j(e){return v().get(`GetManagedEmployees/${e}?fields=EmployeeNo,CommonName,StdHoursPerWeek,PositionCode,PositionTitle,Cost1,Cost2`).then((e=>"string"===typeof e.data&&""!==e.data?JSON.parse(e.data):e.data))}function R(e){return v().get(`GetPositions/${e}`).then((e=>e.data))}function $(){return v().get("GetCostElements").then((e=>e.data))}function B(e){return v().get("GetManagedLeaves",{params:e}).then((e=>"string"===typeof e.data?""===e.data?(e.data=[],e.data):JSON.parse(e.data):e.data))}function V(e){return v().post("CopyFlexSchedule",e).then((e=>e.data))}function U(e){return v()["delete"]("DeleteFlexSchedule",{data:e}).then((e=>e.data))}function z(e){return v().post("CreateAvailability",e).then((e=>e.data))}function G(e){return v().get("GetAvailability",{params:{employeeNo:e}}).then((e=>e.data))}function K(e){return v().patch("PatchAvailability",e).then((e=>e.data))}function q(e){return v()["delete"](`DeleteAvailability/${e}`).then((e=>e.data))}function Z(e){return v().get("GetAdditionalDetails",{params:{employeeNo:e}}).then((e=>e.data))}function Q(e){return v().post("PublishFlexSchedule",e).then((e=>e.data))}function J(){return v().get("WorkTypes").then((e=>e.data))}function X(){return v().get("ExcludedWorkTypes").then((e=>e.data))}function ee(e){return v().post("GetCostAnalysis",e).then((e=>e.data))}function te(e){return v().post("GetEmployeesCostCentres",e).then((e=>e.data))}function ae(e){return v().post("CostingAnalytic",e).then((e=>e.data))}function le(e){return v().post("CostingAnalyticSummary",e).then((e=>e.data))}S&&(b=function(e){return v().get("EmployeeWorkSchedule",e).then((e=>"string"===typeof e.data&&""!==e.data?JSON.parse(e.data):e.data),(e=>Promise.reject(e)))},k=function(){return v().get("Auth/GetInfo").then((e=>e.data))});var se={EmployeeWorkSchedule:b,AuthGetInfo:k,StandardSchedules:C,ShiftTypes:A,ScheduleDetail:x,PostSchedule:_,DeleteSchedule:T,AllocateSchedule:E,RemoveEmployeeWorkSchedule:M,UpdateEmpSchedRequest:N,EmployeesList:F,EmpWorkScheds:P,EmpSchedDetailRequest:O,GetFlexScheduleDetail:H,GetFlexSchedules:Y,CreateFlexSchedule:I,UpdateFlexSchedule:L,PatchFlexSchedule:W,GetManagedEmployees:j,GetPosition:R,GetCostelements:$,GetManagedLeaves:B,CopyFlexSchedule:V,DeleteFlexSchedule:U,CreateAvailability:z,GetAvailabilities:G,PatchAvailabilities:K,DeleteAvailabilities:q,GetEmployeeExtraDetail:Z,PublishFlexSchedule:Q,GetWorkTypes:J,GetDefaultWorkTypes:X,GetCostAnalysis:ee,GetEmployeesCostCentres:te,GetCostAnalysisV2:ae,GetCostAnalysisDetailV2:le},ie=(0,s.aZ)({name:"scheduleNavigation",data(){return{user:null,menus:[{text:"Work Schedule",display:"My Schedules",route:"/my-schedules",selected:!1,default:!0},{text:"Availability",display:"My Availability",route:"/Availability",selected:!1,default:!1},{text:"Flex Schedule",display:"Flexi Schedules",route:"/flex-schedule",selected:!1,default:!1},{text:"Schedule Management",display:"Team Schedules",route:"/team-schedules",selected:!1,default:!1},{text:"Employee Allocation",display:"Employee Allocations",route:"/employee-allocations",selected:!1,default:!1},{text:"Cost Report",display:"Cost Reports",route:"/cost-reports",selected:!1,default:!1}],selectedMenu:null}},computed:{userFullName(){let e=this.user;return e?`${e.FirstName} ${e.LastName}`:""},authorizedMenus(){var e=[],t=this.user.AccessibleMenus;let a=this.menus;for(var l=0;l<this.menus.length;l++){var s=a[l];-1!=t.indexOf(s.text)&&e.push(s)}return e}},methods:{selectMenu:function(e){this.$router.push(e.route),this.menus.forEach((e=>{e.selected=!1})),e.selected=!0},isSelected:function(e){return this.selectedMenu&&this.selectedMenu.text==e}},mounted:function(){const e=(0,s.f3)("MANAGE_COMPANY_CONFIG");if(!window.Affinity||window.Affinity&&!window.Affinity.user)console.log("no affinity requesting authInfo"),se.AuthGetInfo().then((t=>{this.user=t;try{window.dispatchEvent(new CustomEvent("GAReady",{bubbles:!0,detail:{companyNumber:this.user.CompanyNo,employeeNumber:this.user.EmployeeNo,appVersion:"V2"}}))}catch(a){console.warn("GA tracking failed. Contact BenK.")}e.setAllowPersonal(t.AccessibleFeatures.includes("Personal Schedule")),e.setAllowSundayFirst(t.AccessibleFeatures.includes("Sunday First"))}));else{console.log("loading user from Affinity lib"),this.user=window.Affinity.user;try{window.dispatchEvent(new CustomEvent("GAReady",{bubbles:!0,detail:{companyNumber:this.user.CompanyNo,employeeNumber:this.user.EmployeeNo,appVersion:"V2"}}))}catch(t){console.warn("GA tracking failed. Contact BenK.")}e.setAllowPersonal(this.user.AccessibleFeatures.includes("Personal Schedule")),e.setAllowSundayFirst(this.user.AccessibleFeatures.includes("Sunday First"));let a=this.menus.find((e=>"/flex-schedule"===e.route?this.$route.path.indexOf(e.route)>-1:e.route===this.$route.path));if(!a){let e=this.menus.find((e=>!0===e.default));this.selectMenu(e)}}}}),oe=a(3744);const ne=(0,oe.Z)(ie,[["render",D],["__scopeId","data-v-09187f16"]]);var re=ne;const de=e=>((0,s.dD)("data-v-ab426914"),e=e(),(0,s.Cn)(),e),ce={class:"promt-box"},he={key:0,class:"mr-2 d-inline"},ue=de((()=>(0,s._)("img",{class:"loader-icon",src:"data:image/gif;base64,R0lGODlhEAAQAPQAADMzM8zMzDs7O3h4eERERKGhoYKCgszMzJaWlra2tmNjY1lZWb+/v21tbcjIyKqqqoyMjAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAAFdyAgAgIJIeWoAkRCCMdBkKtIHIngyMKsErPBYbADpkSCwhDmQCBethRB6Vj4kFCkQPG4IlWDgrNRIwnO4UKBXDufzQvDMaoSDBgFb886MiQadgNABAokfCwzBA8LCg0Egl8jAggGAA1kBIA1BAYzlyILczULC2UhACH5BAkKAAAALAAAAAAQABAAAAV2ICACAmlAZTmOREEIyUEQjLKKxPHADhEvqxlgcGgkGI1DYSVAIAWMx+lwSKkICJ0QsHi9RgKBwnVTiRQQgwF4I4UFDQQEwi6/3YSGWRRmjhEETAJfIgMFCnAKM0KDV4EEEAQLiF18TAYNXDaSe3x6mjidN1s3IQAh+QQJCgAAACwAAAAAEAAQAAAFeCAgAgLZDGU5jgRECEUiCI+yioSDwDJyLKsXoHFQxBSHAoAAFBhqtMJg8DgQBgfrEsJAEAg4YhZIEiwgKtHiMBgtpg3wbUZXGO7kOb1MUKRFMysCChAoggJCIg0GC2aNe4gqQldfL4l/Ag1AXySJgn5LcoE3QXI3IQAh+QQJCgAAACwAAAAAEAAQAAAFdiAgAgLZNGU5joQhCEjxIssqEo8bC9BRjy9Ag7GILQ4QEoE0gBAEBcOpcBA0DoxSK/e8LRIHn+i1cK0IyKdg0VAoljYIg+GgnRrwVS/8IAkICyosBIQpBAMoKy9dImxPhS+GKkFrkX+TigtLlIyKXUF+NjagNiEAIfkECQoAAAAsAAAAABAAEAAABWwgIAICaRhlOY4EIgjH8R7LKhKHGwsMvb4AAy3WODBIBBKCsYA9TjuhDNDKEVSERezQEL0WrhXucRUQGuik7bFlngzqVW9LMl9XWvLdjFaJtDFqZ1cEZUB0dUgvL3dgP4WJZn4jkomWNpSTIyEAIfkECQoAAAAsAAAAABAAEAAABX4gIAICuSxlOY6CIgiD8RrEKgqGOwxwUrMlAoSwIzAGpJpgoSDAGifDY5kopBYDlEpAQBwevxfBtRIUGi8xwWkDNBCIwmC9Vq0aiQQDQuK+VgQPDXV9hCJjBwcFYU5pLwwHXQcMKSmNLQcIAExlbH8JBwttaX0ABAcNbWVbKyEAIfkECQoAAAAsAAAAABAAEAAABXkgIAICSRBlOY7CIghN8zbEKsKoIjdFzZaEgUBHKChMJtRwcWpAWoWnifm6ESAMhO8lQK0EEAV3rFopIBCEcGwDKAqPh4HUrY4ICHH1dSoTFgcHUiZjBhAJB2AHDykpKAwHAwdzf19KkASIPl9cDgcnDkdtNwiMJCshACH5BAkKAAAALAAAAAAQABAAAAV3ICACAkkQZTmOAiosiyAoxCq+KPxCNVsSMRgBsiClWrLTSWFoIQZHl6pleBh6suxKMIhlvzbAwkBWfFWrBQTxNLq2RG2yhSUkDs2b63AYDAoJXAcFRwADeAkJDX0AQCsEfAQMDAIPBz0rCgcxky0JRWE1AmwpKyEAIfkECQoAAAAsAAAAABAAEAAABXkgIAICKZzkqJ4nQZxLqZKv4NqNLKK2/Q4Ek4lFXChsg5ypJjs1II3gEDUSRInEGYAw6B6zM4JhrDAtEosVkLUtHA7RHaHAGJQEjsODcEg0FBAFVgkQJQ1pAwcDDw8KcFtSInwJAowCCA6RIwqZAgkPNgVpWndjdyohACH5BAkKAAAALAAAAAAQABAAAAV5ICACAimc5KieLEuUKvm2xAKLqDCfC2GaO9eL0LABWTiBYmA06W6kHgvCqEJiAIJiu3gcvgUsscHUERm+kaCxyxa+zRPk0SgJEgfIvbAdIAQLCAYlCj4DBw0IBQsMCjIqBAcPAooCBg9pKgsJLwUFOhCZKyQDA3YqIQAh+QQJCgAAACwAAAAAEAAQAAAFdSAgAgIpnOSonmxbqiThCrJKEHFbo8JxDDOZYFFb+A41E4H4OhkOipXwBElYITDAckFEOBgMQ3arkMkUBdxIUGZpEb7kaQBRlASPg0FQQHAbEEMGDSVEAA1QBhAED1E0NgwFAooCDWljaQIQCE5qMHcNhCkjIQAh+QQJCgAAACwAAAAAEAAQAAAFeSAgAgIpnOSoLgxxvqgKLEcCC65KEAByKK8cSpA4DAiHQ/DkKhGKh4ZCtCyZGo6F6iYYPAqFgYy02xkSaLEMV34tELyRYNEsCQyHlvWkGCzsPgMCEAY7Cg04Uk48LAsDhRA8MVQPEF0GAgqYYwSRlycNcWskCkApIyEAOwAAAAAAAAAAAA=="},null,-1))),me=[ue],pe=["innerHTML"],ye={key:0,class:"promptButtons mt-4"},fe={class:"label text-capitalize"},ge=de((()=>(0,s._)("span",{class:""}," ",-1))),De={class:"label text-capitalize"};function we(e,t,a,l,i,o){const r=(0,s.up)("modal");return(0,s.wg)(),(0,s.j4)(r,{ref:"alertModalRef",noBox:!0},{body:(0,s.w5)((()=>[(0,s._)("div",ce,[(0,s._)("div",null,[e.showLoader?((0,s.wg)(),(0,s.iD)("div",he,me)):(0,s.kq)("",!0),(0,s._)("div",{class:"content",innerHTML:e.message},null,8,pe)]),e.showButtons?((0,s.wg)(),(0,s.iD)("div",ye,[(0,s._)("button",{type:"button",class:(0,n.C_)(["orange white--text small",{"mr-4":e.showCancel}]),tabindex:"9999998",onClick:t[0]||(t[0]=(...t)=>e.onOk&&e.onOk(...t))},[(0,s._)("span",fe,(0,n.zw)(e.confirmButtonText),1)],2),ge,e.showCancel?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"grey white--text small",small:"",tabindex:"9999999",onClick:t[1]||(t[1]=(...t)=>e.onCancel&&e.onCancel(...t))},[(0,s._)("span",De,(0,n.zw)(e.cancelButtonText),1)])):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])])),_:1},512)}const ve={class:"modal-wrapper"},Se={class:"modal-header"},be={class:"modal-footer"};function ke(e,t,a,i,o,r){return(0,s.wg)(),(0,s.j4)(l.uT,{name:"modal"},{default:(0,s.w5)((()=>[(0,s._)("div",null,[e.show?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"modal-mask",style:(0,n.j5)([e.modalIndex?{"z-index":e.modalIndex}:""])},[(0,s._)("div",ve,[(0,s._)("div",{class:"modal-backdrop",onClick:t[0]||(t[0]=(...t)=>e.clickWrapper&&e.clickWrapper(...t))}),(0,s._)("div",{class:(0,n.C_)(["modal-box",{"no-modal-box":e.noBox}]),style:(0,n.j5)(e.getCustomPosition())},[(0,s._)("div",Se,[(0,s.WI)(e.$slots,"header",{},void 0,!0)]),(0,s._)("div",{class:(0,n.C_)(["modal-body",{"no-overflow-auto-body":e.noOverflowAutoBody}])},[(0,s.WI)(e.$slots,"body",{},void 0,!0)],2),(0,s._)("div",be,[(0,s.WI)(e.$slots,"footer",{},void 0,!0)])],6)])],4)):(0,s.kq)("",!0)])])),_:3})}var Ce=(0,s.aZ)({name:"modal",props:{customPosition:{type:Boolean,default:!1},top:{type:Number},left:{type:Number},noBox:{type:Boolean},modalIndex:{type:Number},noOverflowAutoBody:{type:Boolean,default:!1}},data(){return{show:!1}},methods:{toggleShow(e){this.show=!0===e||!1===e?e:!this.show},clickWrapper(){this.show=!1,this.$emit("cancel")},getCustomPosition(){if(this.customPosition){let e={position:"absolute",top:`${this.top}px`,left:`${this.left}px`};return window.innerWidth<=800&&(e.left="auto"),e}return""}}});const Ae=(0,oe.Z)(Ce,[["render",ke],["__scopeId","data-v-b9fd33ec"]]);var xe=Ae,_e=(0,s.aZ)({name:"alert",components:{Modal:xe},data(){return{dialog:!1,message:"some message ",showLoader:!1,showButtons:!1,showCancel:!1,confirmButtonText:"Ok",cancelButtonText:"Cancel"}},mounted(){Hw.on("alert",(e=>{console.log("emitter alert"),this.dialog=!0,this.message=e,this.showLoader=!1,this.showButtons=!0})),Hw.on("dialog--loading--request",(e=>{console.log("emitter loading request"),this.dialog=!0,this.message=e,this.showCancel=!1,this.showButtons=!1,this.showLoader=!0})),Hw.on("clearDialog",(()=>{console.log("emitter clear dialog"),this.clearDialog(),this.dialog=!1})),Hw.on("dialog",(e=>{console.log("emitter on dialog"),this.show(),this.dialog=!!e,this.message=e.message,this.showCancel=e.showCancel,this.showButtons=e.showButtons,this.showLoader=e.showLoader,this.confirmButtonText=e.confirmButtonText?e.confirmButtonText:"Ok",this.cancelButtonText=e.cancelButtonText?e.cancelButtonText:"Cancel",e.onOk&&(this.onOk=()=>{e.onOk(),this.dialog=!1,this.toggleShow()}),e.onCancel&&(this.onCancel=()=>{e.onCancel(),this.dialog=!1,this.toggleShow()})}))},methods:{clearDialog(){this.$refs.alertModalRef.toggleShow(!1)},toggleShow(){this.$refs.alertModalRef.toggleShow()},show(){this.$refs.alertModalRef.toggleShow(!0)},onOk(){this.$refs.alertModalRef.toggleShow()},onCancel(){this.$refs.alertModalRef.toggleShow()}}});const Te=(0,oe.Z)(_e,[["render",we],["__scopeId","data-v-ab426914"]]);var Ee=Te;const Me={key:0,class:"UIPromtBoxBG"},Ne=(0,s._)("div",{class:"UIPromtBox loader"},[(0,s._)("span",{class:"img-loader"}),(0,s._)("span",{class:"content aligncenter"},"Please wait")],-1),Fe=[Ne],Pe={key:1,class:"UIPromtBoxBG"},Oe={class:"UIPromtBox error-text"},He=(0,s._)("br",null,null,-1),Ye={key:2,class:"pagewrapper"},Ie={class:"pagecontent"},Le={class:"contentwrapper"};function We(e,t,a,l,i,o){const r=(0,s.up)("dash-header"),d=(0,s.up)("navbar"),c=(0,s.up)("dash-footer");return(0,s.wg)(),(0,s.iD)("div",{class:(0,n.C_)({dashboard:i.enabled,"show-nav":i.showNav,"hide-nav":i.hideNav})},[i.loading?((0,s.wg)(),(0,s.iD)("div",Me,Fe)):i.error?((0,s.wg)(),(0,s.iD)("div",Pe,[(0,s._)("div",Oe,[(0,s._)("span",null,(0,n.zw)(i.error),1),He,(0,s._)("a",{href:"javascript:void(0)",onClick:t[0]||(t[0]=(...e)=>o.reloadPage&&o.reloadPage(...e))},"Please retry")])])):((0,s.wg)(),(0,s.iD)("div",Ye,[(0,s.Wm)(r,{title:o.userFullName,logoUrl:o.logoUrl,onNavtoggle:o.onNavToggle},null,8,["title","logoUrl","onNavtoggle"]),(0,s.Wm)(d,{apps:i.apps,"logout-url":a.logoutUrl,onHide:o.onNavHide},null,8,["apps","logout-url","onHide"]),(0,s._)("div",Ie,[(0,s._)("div",Le,[(0,s.WI)(e.$slots,"default")])]),(0,s.Wm)(c,{version:a.version},null,8,["version"])]))],2)}const je={class:"dash-header"},Re={id:"desktop-nav-toggle",class:"dash-menu-toggle"},$e={class:"dash-header-title displayname"},Be={class:"dash-header-logo"},Ve=["src"];function Ue(e,t,a,i,o,r){return(0,s.wg)(),(0,s.iD)("div",je,[(0,s._)("div",{id:"mobile-nav-toggle",class:"dash-menu-toggle",onMousedown:t[1]||(t[1]=(0,l.iM)((()=>{}),["stop"]))},[(0,s._)("span",{class:"icon-list",onClick:t[0]||(t[0]=t=>e.$emit("navtoggle",!0))})],32),(0,s._)("div",Re,[(0,s._)("span",{class:"icon-list",onClick:t[2]||(t[2]=t=>e.$emit("navtoggle",!1))})]),(0,s._)("div",$e,(0,n.zw)(a.title),1),(0,s._)("div",Be,[(0,s._)("img",{src:a.logoUrl},null,8,Ve)])])}var ze={props:{title:String,logoUrl:String}};const Ge=(0,oe.Z)(ze,[["render",Ue]]);var Ke=Ge;const qe={class:"top"},Ze={class:"bottom"},Qe=(0,s._)("div",{class:"divider"},null,-1),Je=["href"],Xe=(0,s._)("span",{class:"dash-nav-item-inner"},[(0,s._)("span",{class:"icon icon-logout"}),(0,s._)("span",{class:"label"},"Logout")],-1),et=[Xe];function tt(e,t,a,l,i,o){const n=(0,s.up)("nav-item"),r=(0,s.up)("scrollable");return(0,s.wg)(),(0,s.iD)("div",{id:"dash-nav",class:"dash-nav accordion",onMousedown:t[0]||(t[0]=(...e)=>o.onMouseDown&&o.onMouseDown(...e))},[(0,s._)("div",qe,[(0,s.Wm)(r,{"scroll-x":!1},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.enabledApps,((e,t)=>((0,s.wg)(),(0,s.j4)(n,{data:e,key:t},null,8,["data"])))),128))])),_:1})]),(0,s._)("div",Ze,[Qe,(0,s._)("a",{class:"dash-nav-item",href:o.signoutUrl},et,8,Je)])],32)}const at=["href","target"],lt=(0,s._)("span",{class:"sub-nav-icon icon-arrow-line-small-up"},null,-1),st={class:"label"},it={key:0,ref:"menu",class:"sub-nav"};function ot(e,t,a,l,i,o){const r=(0,s.up)("nav-item",!0);return(0,s.wg)(),(0,s.iD)("a",{class:(0,n.C_)(["dash-nav-item",{selected:o.selected,"has-sub-nav":o.hasMenu,expanded:!i.expanding}]),href:o.url,target:o.target},[(0,s._)("div",{class:"dash-nav-item-inner",onClick:t[0]||(t[0]=(...e)=>o.toggleMenu&&o.toggleMenu(...e))},[lt,(0,s._)("span",{class:(0,n.C_)("icon icon-"+a.data.Icon)},null,2),(0,s._)("span",st,(0,n.zw)(a.data.Text||a.data.Name),1)]),o.hasMenu&&i.expanded?((0,s.wg)(),(0,s.iD)("div",it,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.data.Menu,((e,t)=>((0,s.wg)(),(0,s.j4)(r,{data:e,"is-owned":!0,key:t},null,8,["data"])))),128))],512)):(0,s.kq)("",!0)],10,at)}var nt=a(4998),rt=a.n(nt),dt=a(6038),ct={name:"nav-item",props:{data:{type:Object,default(){return{}}},host:String,isOwned:Boolean},data(){return{expanded:!1,expanding:!1}},computed:{target(){return this.data.External?this.data.Name||"_blank":"_self"},selected(){var e=new(rt())(this.url).path().toLowerCase();return!this.isOwned&&Affinity.app==this.data.Name||"/"!==e&&e===window.location.pathname.toLowerCase()||"/cleverforms/inbox"===e&&"/inbox"===window.location.pathname.toLowerCase()||"/cleverforms/template"===e&&"/template"===window.location.pathname.toLowerCase()||"/cleverforms/admin"===e&&"/admin"===window.location.pathname.toLowerCase()},hasMenu(){return this.data.Menu&&this.data.Menu.length>0},url(){return this.hasMenu?"javascript:void(0);":this.data.Url}},methods:{toggleMenu(){this.hasMenu&&(this.expanding=!this.expanded,this.expanding?(this.expanded=!0,(0,s.Y3)((()=>{dt.ZP.from(this.$refs.menu,{duration:.25,height:0})}))):dt.ZP.to(this.$refs.menu,{duration:.25,height:0,onComplete:()=>{this.expanded=!1}}))}},mounted(){this.expanded=this.selected&&this.hasMenu,this.expanding=this.expanded}};const ht=(0,oe.Z)(ct,[["render",ot]]);var ut=ht;const mt={ref:"container",class:"scrollable"};function pt(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("div",mt,[(0,s.WI)(e.$slots,"default")],512)}var yt=a(4772),ft=a(3844),gt=a.n(ft),Dt={props:{scrollX:{type:Boolean,default:!0},scrollY:{type:Boolean,default:!0}},data(){return{ps:null,resizeDetector:gt()({strategy:"scroll"})}},methods:{onResize(){this.ps&&this.ps.update(this.$refs.container)}},mounted(){this.ps=new yt.Z(this.$refs.container,{suppressScrollX:!this.scrollX,suppressScrollY:!this.scrollY}),this.resizeDetector.listenTo(this.$refs.container,this.onResize);for(let e=0;e<this.$slots.default.length;e++){let t=this.$slots.default[e].elm;this.resizeDetector.listenTo(t,this.onResize)}},beforeUnmount(){this.resizeDetector.uninstall(this.$refs.container);for(let e=0;e<this.$slots.default.length;e++){let t=this.$slots.default[e].elm;this.resizeDetector.uninstall(t)}}};const wt=(0,oe.Z)(Dt,[["render",pt]]);var vt=wt,St={props:{apps:Array,logoutUrl:String},data(){return{mousedown:!1}},computed:{enabledApps(){if(this.apps instanceof Array){let e=[];return this.apps.forEach((t=>{t&&t.Enabled&&e.push(t)})),e}return[]},signoutUrl(){if(this.logoutUrl)return this.logoutUrl;let e=this.apps[0].Url;for(let t=1;t<this.apps.length;t++){let a=this.apps[t];if(a&&a.Name==Affinity.app)return e+"/Root/ExternalLogout?redirectUrl="+encodeURI(a.Url)}return"/Auth/SignOut"}},methods:{onMouseDown(){this.mousedown=!0},onBodyMouseDown(e){this.mousedown||this.$emit("hide"),this.mousedown=!1}},created(){document.body.addEventListener("mousedown",this.onBodyMouseDown)},beforeUnmount(){document.body.removeEventListener("mousedown",this.onBodyMouseDown)},components:{NavItem:ut,Scrollable:vt}};const bt=(0,oe.Z)(St,[["render",tt]]);var kt=bt;const Ct={class:"dash-footer"},At={key:0,class:"version"},xt=(0,s._)("a",{href:"http://www.affinityteam.co.nz/",target:"affinity"},"Affinity Employer Services",-1),_t=(0,s._)("a",{href:"http://www.affinityteam.co.nz/",target:"affinity"},[(0,s._)("span",{class:"dash-footer-logo"})],-1);function Tt(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("div",Ct,[a.version?((0,s.wg)(),(0,s.iD)("span",At,"Version "+(0,n.zw)(a.version),1)):(0,s.kq)("",!0),(0,s.Uk)(" © Copyright "+(0,n.zw)(o.year)+" Affinity - ",1),xt,_t])}var Et={props:{version:String},computed:{year(){return(new Date).getFullYear()}}};const Mt=(0,oe.Z)(Et,[["render",Tt]]);var Nt=Mt,Ft={props:{version:String,enableByConfig:Boolean,configUrl:String,infoUrl:String,logoutUrl:String,legacyAuth:Boolean},data(){return{user:null,error:null,apps:[{Enabled:!0,Name:"Dashboard",Url:"",Icon:"gauge"}],loading:!0,enabled:!0,showNav:!1,hideNav:!1}},computed:{userFullName(){return this.user?`${this.user.FirstName} ${this.user.LastName}`:""},logoUrl(){let e=this.apps[0].Url;return e&&this.user?`${e}/Root/Logo?company=${this.user.CompanyNo}&employee=${this.user.EmployeeNo}`:""}},methods:{authorize(e){if(console.log("dashboard authorize"),{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_LOCAL1){let t={FirstName:"Norah",LastName:"Barlow",CompanyNo:5004,EmployeeNo:100603,UseDashboard:!0,AccessibleMenus:["Work Schedule","Schedule Management","Employee Allocation"]},a=Affinity.user=this.legacyAuth?{FirstName:t.Firstname,LastName:t.Lastname,PayPoint:t.PayPoint,CompanyNo:t.CompanyNumber,EmployeeNo:t.EmployeeNumber}:t;this.enabled=!this.enableByConfig||a.UseDashboard,e&&e()}else{let t={method:{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_AXIOSHOST?"get":"post",url:this.legacyAuth?Affinity.authroot+"/GetUser":this.infoUrl};v()(t).then((t=>{let a=Affinity.user=this.legacyAuth?{FirstName:t.data.Firstname,LastName:t.data.Lastname,PayPoint:t.data.PayPoint,CompanyNo:t.data.CompanyNumber,EmployeeNo:t.data.EmployeeNumber}:t.data;this.enabled=!this.enableByConfig||a.UseDashboard,e&&e()})).catch((e=>{console.log("err",e),this.error="Unable to load the page.",this.loading=!1}))}},getConfig(){let e={method:{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_AXIOSHOST?"get":"post",url:this.configUrl};v()(e).then((e=>{let t=e.data;this.user=Affinity.user,this.apps[0].Url=t.Url,t.Apps&&t.Apps.forEach((e=>{this.apps.push(e.Link)})),t.Forms&&this.user.EmployeeNo<=5e6&&t.Forms.forEach((e=>{e.Enabled&&this.apps.push(e)})),this.loading=!1,(0,s.Y3)((()=>{this.$emit("ready",t)}))})).catch((()=>{this.error="Unable to load the page."})).then((()=>{this.loading=!1}))},reloadPage(){window.location.reload()},onNavToggle(e){e?this.showNav=!this.showNav:this.hideNav=!this.hideNav},onNavHide(){this.showNav=!1}},created(){console.log("dashboard created"),this.authorize((()=>{this.enabled?this.getConfig():this.loading=!1}))},components:{"dash-header":Ke,navbar:kt,"dash-footer":Nt}};const Pt=(0,oe.Z)(Ft,[["render",We]]);var Ot=Pt,Ht=Ot,Yt=a(3907),It=a(6486),Lt=a.n(It),Wt=a(381),jt=a.n(Wt);const Rt={date:"",startTime:"",endTime:"",hours:0,breakLength:0,shiftId:"",position:"",costElement1:"",costElement2:"",scheduleType:""};var $t,Bt;(function(e){e["loadTargetSchedule"]="LOAD_TARGET_SCHEDULE",e["loadFlexiSchedules"]="LOAD_FLEXI_SCHEDULES"})($t||($t={})),function(e){e["clearForm"]="CLEAR_FORM",e["setScheduleDay"]="SET_SCHEDULE_DAY",e["saveScheduleDayToWeek"]="SAVE_SCHEDULE_DAY_TO_WEEK",e["saveRemoteData"]="SAVE_REMOTE_DATA",e["updateEditConfig"]="UPDATE_EDIT_CONFIG",e["createNewScheduleDay"]="CREATE_NEW_SCHEDULE_DAY",e["setAnalysisData"]="SET_ANALYSIS_DATA",e["setConfigAllTrue"]="SET_CONFIG_ALL_TRUE"}(Bt||(Bt={}));const Vt={[Bt.clearForm](e){e.flexScheduleDay={...Rt}},[Bt.createNewScheduleDay](e,t){e.flexScheduleDay=Rt,e.flexScheduleDay.scheduleType="",e.selectedFlexDay=t},[Bt.setScheduleDay](e,t){e.selectedFlexDay=t,e.flexScheduleDay.startTime=t.startTime,e.flexScheduleDay.endTime=t.endTime,e.flexScheduleDay.hours=t.hours,e.flexScheduleDay.scheduleType=t.scheduleType;let a=Object.fromEntries(Object.entries(t.scheduleDetail).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])));e.flexScheduleDay=Lt().merge({},e.flexScheduleDay,a)},[Bt.saveScheduleDayToWeek](e){e.selectedFlexDay?(e.selectedFlexDay.startTime=e.flexScheduleDay.startTime,e.selectedFlexDay.endTime=e.flexScheduleDay.endTime,e.selectedFlexDay.scheduleDetail=Lt().merge({},e.selectedFlexDay.scheduleDetail,e.flexScheduleDay)):console.error("missing selected flex day")},[Bt.updateEditConfig](e,t){e.editFlexScheduleDayConfig=Lt().clone(t)},[Bt.setAnalysisData](e,t){e.analysisHoursChartData=t},[Bt.saveRemoteData](e,t){e.flexScheduleRemoteData=t},[Bt.setConfigAllTrue](e,t){e.flexScheduleCellSetting.showHours.value=!0,e.flexScheduleCellSetting.showBreakLength.value=!0,e.flexScheduleCellSetting.showShiftId.value=!0,e.flexScheduleCellSetting.showPosition.value=!0}},Ut={[$t.loadTargetSchedule]({commit:e},t){se.GetFlexScheduleDetail(t).then((e=>{console.log("GetFlexScheduleDetail",e)}))},[$t.loadFlexiSchedules]({commit:e},t){const a={employeeNo:Affinity.user.EmployeeNo,startDate:t.startDate.format("YYYY-MM-DD"),endDate:t.endDate.format("YYYY-MM-DD"),forManagedEmployees:!0};return se.GetFlexSchedules(a).then((t=>{let a=t.FlexSchedules;a.forEach((e=>{e.id=e.Id,e.date=e.Date,e.employeeName=e.EmployeeName,e.employeeNo=e.EmployeeNo,e.startTime=e.StartTime?jt()(e.StartTime).format("HH:mm"):"",e.endTime=e.EndTime?jt()(e.EndTime).format("HH:mm"):"",e.hours=e.Hours,e.scheduleDetail=e.ScheduleData,e.scheduleDetail.breakLength=e.scheduleDetail.BreakLength,e.scheduleDetail.position=e.scheduleDetail.Position,e.scheduleDetail.positionTitle=e.scheduleDetail.PositionTitle,e.scheduleDetail.shiftId=e.scheduleDetail.ShiftId,e.scheduleDetail.costElement1=e.scheduleDetail.CostElement1,e.scheduleDetail.costElement2=e.scheduleDetail.CostElement2,e.scheduleType=e.ScheduleType,e.publishStatus=e.PublishStatus,e.isPaid=e.IsPaid,e.dayInWeek=jt()(e.Date).day()})),e(Bt.saveRemoteData,a);let l=t.Unavailabilities.map((e=>({id:e.EmpAvailability.Id,unavailabilityDate:e.UnavailabilityDate,employeeNo:e.EmpAvailability.EmployeeNo,startTime:e.EmpAvailability.StartTime,endTime:e.EmpAvailability.EndTime,reason:e.EmpAvailability.Reason})));return{flexSchedules:a,unAvailabilities:l}}))}},zt={state:{selectedDate:jt()(),calendarFocusDate:jt()(),selectedFlexDay:null,defaultWorkTypes:null,analysisHoursChartData:null,flexScheduleRemoteData:null,flexScheduleDay:{date:"",startTime:"",endTime:"",hours:0,breakLength:0,shiftId:"",position:"",costElement1:"",costElement2:"",scheduleType:""},editFlexScheduleDayConfig:{startTime:!1,endTime:!1,hours:!1,breakLength:!1,shiftId:!1,position:!1,costElement1:!1,costElement2:!1},scheduleWeek:[],flexScheduleCellSetting:{showHours:{value:!1,name:"Net Hours"},showBreakLength:{value:!1,name:"Break Length"},showShiftId:{value:!1,name:"Shift ID"},showPosition:{value:!1,name:"Position"}},leaveList:[],flexScheduleColumnControl:[{name:"stdHours",value:!0},{name:"netHours",value:!0},{name:"day1",value:!0},{name:"day2",value:!0},{name:"day3",value:!0},{name:"day4",value:!0},{name:"day5",value:!0},{name:"day6",value:!0},{name:"day7",value:!0}]},mutations:Vt,actions:Ut};var Gt=zt;function Kt(e){if(!e)return"";let t="Hmm";e.includes(":")&&(t="H:mm");let a=jt()(e,t);return a.isValid()?a.format("HH:mm"):"Invalid Time"}function qt(){return window.innerWidth<1e3}var Zt={parseTimeColumn:Kt},Qt={name:"App",components:{Dashboard:Ht,schedulesNavigation:re,Alert:Ee},setup(){const e=(0,Yt.oR)();function t(){let t=localStorage.getItem("clientStorageVersion");if("0.11"!==t)localStorage.clear(),localStorage.setItem("clientStorageVersion","0.11"),localStorage.setItem("flexScheduleCellSetting",JSON.stringify(e.state.FlexSchedule.flexScheduleCellSetting)),localStorage.setItem("flexScheduleColumnSetting",JSON.stringify(e.state.FlexSchedule.flexScheduleColumnControl));else{let t=e.state.FlexSchedule.flexScheduleCellSetting,a=JSON.parse(localStorage.getItem("flexScheduleCellSetting"));for(let e of Object.keys(a))t[e]&&(t[e]=a[e]);let l=e.state.FlexSchedule.flexScheduleColumnControl,s=JSON.parse(localStorage.getItem("flexScheduleColumnSetting"));for(let e of Object.keys(s))l[e]&&(l[e]=s[e])}}qt()?e.commit(Bt.setConfigAllTrue):t()},mounted(){console.log("app vue created")}};const Jt=(0,oe.Z)(Qt,[["render",o]]);var Xt=Jt,ea=a(2119);const ta={class:"mt-4 mt-md-10"},aa={class:"my-schedules-search-filter d-flex flex-wrap align-center mb-sm-4"},la={class:"mr-2 mr-sm-6 date-searcher d-flex align-center"},sa=(0,s._)("div",{class:"mr-2 d-inline caption bold date-searcher-label"},"Date From",-1),ia=["value"],oa=(0,s._)("span",{class:"icon-popup white xs-icon"},null,-1),na=[oa],ra=(0,s._)("span",{class:"icon-calendar white xs-icon"},null,-1),da=[ra],ca=(0,s._)("span",{class:"icon-cross white"},null,-1),ha=[ca],ua={class:"date-searcher d-flex align-center ml-lg-4"},ma=(0,s._)("div",{class:"mr-2 d-inline caption bold date-searcher-label"},"Date To",-1),pa=["value"],ya=(0,s._)("span",{class:"icon-popup white","x-small":""},null,-1),fa=[ya],ga=(0,s._)("span",{class:"icon-calendar white","x-small":""},null,-1),Da=[ga],wa=(0,s._)("span",{class:"icon-cross white","x-small":""},null,-1),va=[wa],Sa=(0,s._)("span",{class:"mr-1 icon-printer","x-small":""},null,-1),ba=(0,s._)("span",{class:"text-capitalize"},"Print",-1),ka=[Sa,ba],Ca={style:{"margin-top":"10px"}},Aa={class:"schedules-data-small",style:{overflow:"auto"}},xa={class:"",style:{width:"100%"}},_a={class:"weekInfoDisplay py-2"},Ta={class:"schedules-data-small-head"},Ea={class:"dayScheduleDisplay"},Ma={key:0},Na={key:0},Fa={key:1},Pa={key:2},Oa={id:"workSchedules",class:"schedules-data-medium section",style:{overflow:"auto"}},Ha={class:"my-schedules aff-table"},Ya={key:0},Ia=(0,s._)("th",null,"Week",-1),La=(0,s._)("th",null,"Sun",-1),Wa=(0,s._)("th",null,"Mon",-1),ja=(0,s._)("th",null,"Tue",-1),Ra=(0,s._)("th",null,"Wed",-1),$a=(0,s._)("th",null,"Thu",-1),Ba=(0,s._)("th",null,"Fri",-1),Va=(0,s._)("th",null,"Sat",-1),Ua=[Ia,La,Wa,ja,Ra,$a,Ba,Va],za={key:1},Ga=(0,s._)("th",null,"Week",-1),Ka=(0,s._)("th",null,"Mon",-1),qa=(0,s._)("th",null,"Tue",-1),Za=(0,s._)("th",null,"Wed",-1),Qa=(0,s._)("th",null,"Thu",-1),Ja=(0,s._)("th",null,"Fri",-1),Xa=(0,s._)("th",null,"Sat",-1),el=(0,s._)("th",null,"Sun",-1),tl=[Ga,Ka,qa,Za,Qa,Ja,Xa,el],al={class:"myschedules-tr"},ll={class:"weekInfoRows"},sl={class:"myschedules-td"},il={key:0},ol={class:"bold-text"},nl={key:0},rl={key:1};function dl(e,t){const a=(0,s.up)("date-picker"),l=(0,s.Q2)("tooltip");return(0,s.wg)(),(0,s.iD)("div",ta,[(0,s._)("div",aa,[(0,s._)("div",la,[sa,(0,s._)("input",{value:e.$filters.reformatDate(e.fromDate),class:"d-inline-flex ma-0 pa-0 mr-2 caption",style:{"max-width":"120px"},onChange:t[0]||(t[0]=t=>e.updateDateText(t,e.fromDate,"fromDate")),onClick:t[1]||(t[1]=t=>e.updateDateTime(t,e.fromDate,"fromDate")),"onClick:clear":t[2]||(t[2]=t=>e.fromDate=null)},null,40,ia),(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{class:"light-blue small px-aff-10 ml-2 lh-0",onClick:t[3]||(t[3]=t=>e.updateDateTime(t,e.fromDate,"fromDate"))},na)),[[l,{content:"Open calendar"},void 0,{top:!0}]]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{class:"green small px-aff-10 lh-0",onClick:t[4]||(t[4]=t=>e.selectDateTodayForFromDate())},da)),[[l,{content:"Set to today"},void 0,{top:!0}]]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{class:"orange small px-aff-10 lh-0",onClick:t[5]||(t[5]=t=>e.fromDate=null)},ha)),[[l,{content:"Clear"},void 0,{top:!0}]])]),(0,s._)("div",ua,[ma,(0,s._)("input",{value:e.$filters.reformatDate(e.toDate),outlined:"",dense:"","hide-details":"",class:"d-inline-flex ma-0 pa-0 mr-2 caption",style:{"max-width":"120px"},onChange:t[6]||(t[6]=t=>e.updateDateText(t,e.toDate,"toDate")),onClick:t[7]||(t[7]=t=>e.updateDateTime(t,e.toDate,"toDate")),"onClick:clear":t[8]||(t[8]=t=>e.toDate=null)},null,40,pa),(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{class:"light-blue small px-aff-10 ml-2 lh-0",tile:"",onClick:t[9]||(t[9]=t=>e.updateDateTime(t,e.toDate,"toDate"))},fa)),[[l,{content:"Open calendar"},void 0,{top:!0}]]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{class:"green small px-aff-10 lh-0",tile:"",onClick:t[10]||(t[10]=t=>e.selectDateTodayForToDate())},Da)),[[l,{content:"Set to today"},void 0,{top:!0}]]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{class:"orange small px-aff-10 lh-0",tile:"",onClick:t[11]||(t[11]=t=>e.toDate=null)},va)),[[l,{content:"Clear"},void 0,{top:!0}]])]),(0,s._)("button",{class:"light-blue white--text ml-lg-4 ml-sm-4 mt-sm-0 px-aff-10 small",onClick:t[12]||(t[12]=t=>e.printWorkSchedule())},ka)]),(0,s._)("div",Ca,[(0,s._)("div",Aa,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.schedules,(t=>((0,s.wg)(),(0,s.iD)("div",xa,[(0,s._)("div",_a,[(0,s._)("div",Ta,[(0,s._)("div",null,[(0,s._)("h3",null,(0,n.zw)(t.weekName),1)]),(0,s._)("div",null,(0,n.zw)(t.weekDateRange),1)])]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.detailArr,((a,l)=>((0,s.wg)(),(0,s.iD)("div",Ea,[(0,s._)("div",null,(0,n.zw)(t.weekName)+" - "+(0,n.zw)(e.getWeekDayByIndex(l)),1),e.displayScheduleDetail(a)?((0,s.wg)(),(0,s.iD)("div",Ma,[(0,s._)("div",null,(0,n.zw)(a.shiftDescription),1),a.startTime?((0,s.wg)(),(0,s.iD)("div",Na,"Start Time:"+(0,n.zw)(a.startTime),1)):(0,s.kq)("",!0),a.finishTime?((0,s.wg)(),(0,s.iD)("div",Fa,"Finish Time:"+(0,n.zw)(a.finishTime),1)):(0,s.kq)("",!0),a.hours?((0,s.wg)(),(0,s.iD)("div",Pa,"Hours:"+(0,n.zw)(a.hours),1)):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])))),256))])))),256))]),(0,s._)("div",Oa,[(0,s._)("div",Ha,[(0,s._)("table",null,[(0,s._)("thead",null,[e.sundayFirst?((0,s.wg)(),(0,s.iD)("tr",Ya,Ua)):((0,s.wg)(),(0,s.iD)("tr",za,tl))]),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.schedules,(t=>((0,s.wg)(),(0,s.iD)("tr",al,[(0,s._)("td",ll,[(0,s._)("div",null,(0,n.zw)(t.weekName),1),(0,s._)("div",null,(0,n.zw)(t.weekDateRange),1)]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.detailArr,(t=>((0,s.wg)(),(0,s.iD)("td",sl,[e.displayScheduleDetail(t)?((0,s.wg)(),(0,s.iD)("div",il,[(0,s._)("div",null,(0,n.zw)(t.date),1),(0,s._)("div",ol,(0,n.zw)(t.shiftDescription),1),t.hours?((0,s.wg)(),(0,s.iD)("div",nl,"Hours:"+(0,n.zw)(t.hours),1)):(0,s.kq)("",!0),t.startTime?((0,s.wg)(),(0,s.iD)("div",rl,(0,n.zw)(t.startTime)+" - "+(0,n.zw)(t.finishTime),1)):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])))),256))])))),256))])])])])]),(0,s.Wm)(a,{ref:"DatePickerRef",top:e.dateModalTop,leftInput:e.dateModalLeft,"max-date":e.datePickerMax,"min-date":e.datePickerMin,date:e.datePickerTargetDay},null,8,["top","leftInput","max-date","min-date","date"])])}function cl(){Hw.emit("dialog",{message:"here is a test dialog",showButtons:!0,showCancel:!0,okColor:"orange"})}function hl(e){Hw.emit("dialog",{dialog:!0,message:e.message,showCancel:!0,showButtons:!0,showLoader:!1,confirmButtonText:e.confirmButtonText?e.confirmButtonText:"Yes",cancelButtonText:e.cancelButtonText?e.cancelButtonText:"No",onOk:()=>{e.onOk()},onCancel:()=>{e.onCancel&&e.onCancel()}})}function ul(e){return new Promise(((t,a)=>{Hw.emit("dialog",{dialog:!0,message:e.message,showCancel:!0,showButtons:!0,showLoader:!1,confirmButtonText:e.confirmButtonText?e.confirmButtonText:"Yes",cancelButtonText:e.cancelButtonText?e.cancelButtonText:"No",onOk:()=>{t("ok")},onCancel:()=>{a("cancel")}})}))}function ml(e){Hw.emit("dialog",{dialog:!0,message:e,showLoader:!1,showButtons:!0,onOk:()=>{},onCancel:()=>{}})}function pl(e){Hw.emit("dialog",{dialog:!0,message:e||"Loading",showCancel:!1,showButtons:!1,showLoader:!0})}function yl(){Hw.emit("clearDialog")}var fl={testDialog:cl,loading:pl,clear:yl,checkChange:hl,alert:ml,confirmOrCancel:ul};const gl={class:"v3-calendar"},Dl={class:"dp-heading"},wl={class:"db-content"},vl={class:"dp-week-of-day"},Sl={class:"dp-week-days"},bl={class:"date-wrapper"},kl=["onClick"];function Cl(e,t){const a=(0,s.up)("Modal");return(0,s.wg)(),(0,s.j4)(a,{ref:"ModalRef",top:e.top,left:e.calculateLeft(e.left),customPosition:!(!e.top&&!e.left),onCancel:e.cancelPickDate},{body:(0,s.w5)((()=>[(0,s._)("div",gl,[(0,s._)("section",Dl,[(0,s._)("span",{class:"cursor-pointer icon-arrow-left px-4",onClick:t[0]||(t[0]=(...t)=>e.previousMonth&&e.previousMonth(...t))}),(0,s._)("div",null,(0,n.zw)(e.selectedDate.format("YYYY MMM")),1),(0,s._)("span",{class:"cursor-pointer icon-arrow-right px-4",onClick:t[1]||(t[1]=(...t)=>e.nextMonth&&e.nextMonth(...t))})]),(0,s._)("section",wl,[(0,s._)("div",vl,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.weekOfDays,(e=>((0,s.wg)(),(0,s.iD)("span",null,(0,n.zw)(e.shortName),1)))),256))]),(0,s._)("div",Sl,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.calendarArr,(t=>((0,s.wg)(),(0,s.iD)("span",bl,[(0,s._)("span",{class:(0,n.C_)(["date-number-cell",{"today-target":e.colorToday(t),"not-valid":!t.isValid,"last-month-day":t.lastMonth,"next-month-day":t.nextMonth,selected:t.selected}]),onClick:a=>e.selectDate(t)},(0,n.zw)(t.dateNumber),11,kl)])))),256))])])])])),_:1},8,["top","left","customPosition","onCancel"])}var Al=a(2262),xl=(0,s.aZ)({name:"DatePicker",components:{Modal:xe},props:{top:{type:Number},leftInput:{type:Number},date:{type:Object},maxDate:{type:Object},minDate:{type:Object}},data(){return{left:0,currentYear:2021,datePickerPromise:null,resolve:null,reject:null,selectedDate:jt()(),weekOfDays:[{fullName:"Sunday",shortName:"Sun",dayNumber:0},{fullName:"Monday",shortName:"Mon",dayNumber:1},{fullName:"Tuesday",shortName:"Tue",dayNumber:2},{fullName:"Wednesday",shortName:"Wed",dayNumber:3},{fullName:"Thursday",shortName:"Thu",dayNumber:4},{fullName:"Friday",shortName:"Fri",dayNumber:5},{fullName:"Saturday",shortName:"Sat",dayNumber:6}]}},setup(){const e=(0,Al.iH)([]),t=(0,Al.iH)();return t.value=jt()().month(),{currentMonth:t,calendarArr:e}},mounted(){this.calculateMonth(),this.datePickerPromise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))},watch:{maxDate(){this.selectedDate?this.calculateBaseOnInput(this.selectedDate):this.calculateBaseOnInput()},minDate(){this.selectedDate?this.calculateBaseOnInput(this.selectedDate):this.calculateBaseOnInput()}},methods:{cancelPickDate(){this.reject()},calculateLeft(){return this.leftInput?(window.innerWidth<this.leftInput+370?this.left=window.innerWidth-400:this.left=this.leftInput,this.left):0},nextMonth(){this.currentMonth=this.currentMonth+1,this.calculateMonth()},previousMonth(){this.currentMonth=this.currentMonth-1,this.calculateMonth()},colorToday(e){const t=jt()();return t.year()===e.year&&t.month()+1===e.month&&t.date()===e.dateNumber},selectDateOnly(e){for(let t of this.calendarArr)t.year===e.year()&&t.month===e.month()+1&&t.dateNumber===e.date()?t.selected=!0:t.selected=!1},selectDate(e){this.selectedDate=this.selectedDate.date(e.dateNumber);for(let t of this.calendarArr)t.selected=!1;e.selected=!0,this.$refs.ModalRef.toggleShow(),this.resolve(this.selectedDate.clone())},calculateMonth(e){e||(e=jt()(),this.currentYear&&e.year(this.currentYear));let t=e.clone().month(this.currentMonth),a=t.startOf("month").day(),l=t.clone().endOf("month").day();t.startOf("day");let s=[],i=t.clone().date(0).date(),o=i-(a-1);for(o;o<=i;o++)s.push({year:t.clone().date(0).year(),month:t.clone().date(0).month()+1,dateNumber:o,selected:!1,lastMonth:!0});let n=1,r=t.clone().endOf("month").date();for(n;n<=r;n++)s.push({year:t.year(),month:t.month()+1,isValid:this.validDateRange(this.maxDate,this.minDate,t.clone().startOf("month").date(n)),dateNumber:n,selected:!1});let d=1,c=7-l-1;for(d;d<=c;d++)s.push({year:t.clone().add(1,"month").year(),month:t.clone().add(1,"month").month()+1,dateNumber:d,selected:!1,nextMonth:!0});this.calendarArr=s,t.clone().endOf("month").date()===this.selectedDate.date()?this.selectedDate=t.clone().endOf("month").startOf("day").clone():this.selectedDate=t.date(this.selectedDate.date())},validDateRange(e,t,a){return e&&t?a.diff(e,"day")<0&&a.diff(t,"day")>0:e?a.diff(e,"day")<0:!t||a.diff(t,"day")>0},calculateBaseOnInput(e){e?(this.currentMonth=e.month(),this.selectedDate=e.clone(),this.calculateMonth(e),this.currentYear=e.year(),this.selectDateOnly(e)):(e=jt()(),this.currentMonth=e.month(),this.selectedDate=e.clone(),this.calculateMonth(e),this.currentYear=e.year())},toggleShow(e){return e?this.calculateBaseOnInput(e):this.calculateBaseOnInput(),this.$refs.ModalRef.toggleShow(),this.datePickerPromise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),this.waitPickDate()},async waitPickDate(){return this.datePickerPromise}}});const _l=(0,oe.Z)(xl,[["render",Cl],["__scopeId","data-v-c5ce8e34"]]);var Tl,El=_l;(function(e){e["fromDate"]="fromDate",e["toDate"]="toDate"})(Tl||(Tl={}));var Ml=(0,s.aZ)({name:"mySchedules",components:{DatePicker:El},inject:{manageCompanyConfig:"MANAGE_COMPANY_CONFIG"},data(){return{title:"Work Schedule",schedules:[],user:null,datePickerFormat:"dd/MM/yyyy",sundayFirst:!1,menu1:!1,menu2:!1,fromDate:null,toDate:null,dateModal:!1,dateModalTop:0,dateModalLeft:0,datePickerTargetDay:jt()(),selectedDateType:Tl.fromDate,datePickerMax:null,datePickerMin:null}},mounted(){this.sundayFirst=!!this.manageCompanyConfig.getAllowSundayFirst(),[this.fromDate,this.toDate]=this.convertDateRange(jt()(),jt()()),this.loadSchedules(this.fromDate,this.toDate)},methods:{updateDateText(e,t,a){"toDate"===a?this.toDate=jt()(e.target.value,"DD/MM/YYYY"):this.fromDate=jt()(e.target.value,"DD/MM/YYYY"),this.dateModal=!1},updateDateTime(e,t,a){let l=e.target.getClientRects()[0];this.dateModalTop=l.bottom,this.dateModalLeft=l.left,this.selectedDateType=a,"toDate"===a?(this.fromDate&&(this.datePickerMin=this.fromDate,this.datePickerMax=null),this.datePickerTargetDay=this.toDate?this.toDate:jt()()):(this.toDate&&(this.datePickerMin=null,this.datePickerMax=this.toDate),this.datePickerTargetDay=this.fromDate?this.fromDate:jt()()),this.dateModal=!0,this.openDatePicker()},printWorkSchedule:function(){var e="left=5,top=5,resizable=yes,height=600,width=700,scrollbars=yes,status=1",t=document.getElementById("workSchedules").innerHTML,a=window.open("","Print",e);a.document.write("<html>"),a.document.write("<head>"),a.document.write('<style type="text/css">table {border-collapse: collapse;}</style>'),a.document.write('<style type="text/css">table, th, td {border: 1px solid #cbcbcb;text-align: center;}</style>'),a.document.write("</head>"),a.document.write("<body>"),a.document.write(t),a.document.write("</body></html>"),a.document.close(),a.focus(),a.print(),a.close()},loadSchedules:function(e,t){if(null!==e&&e.startOf("day"),null!==t&&""!==t&&t.startOf("day"),this.schedules=[],null===t&&null===e)return;null!==t&&null===e&&(e=t),null===t&&null!==e&&(t=e);let[a,l]=this.convertDateRange(this.fromDate,this.toDate);var s={employeeNo:null,fromDate:null,toDate:null};if(null!==a&&null!==l){var i=a.format("DD/MM/YYYY"),o=l.format("DD/MM/YYYY");s={employeeNo:window.Affinity.user.EmployeeNo,fromDate:i,toDate:o}}fl.loading(),se.EmployeeWorkSchedule(s).then((e=>{let t=e;for(const[a,l]of t.entries()){this.sundayFirst?l.weekDateRange=`${l.sundayScheduleDetail.date} - ${l.saturdayScheduleDetail.date}`:l.weekDateRange=`${l.mondayScheduleDetail.date} - ${l.sundayScheduleDetail.date}`,l.weekName=`Week ${a+1}`,this.manageCompanyConfig.getAllowSundayFirst()?(l.detailArr=[],l.detailArr.push(l.sundayScheduleDetail),l.detailArr.push(l.mondayScheduleDetail),l.detailArr.push(l.tuesdayScheduleDetail),l.detailArr.push(l.wednesdayScheduleDetail),l.detailArr.push(l.thursdayScheduleDetail),l.detailArr.push(l.fridayScheduleDetail),l.detailArr.push(l.saturdayScheduleDetail)):(l.detailArr=[],l.detailArr.push(l.mondayScheduleDetail),l.detailArr.push(l.tuesdayScheduleDetail),l.detailArr.push(l.wednesdayScheduleDetail),l.detailArr.push(l.thursdayScheduleDetail),l.detailArr.push(l.fridayScheduleDetail),l.detailArr.push(l.saturdayScheduleDetail),l.detailArr.push(l.sundayScheduleDetail));for(let e of l.detailArr)this.clearZeroHour(e)}this.schedules=t,fl.clear()}),(e=>{console.log("err",e),fl.clear()})).finally((()=>{fl.clear()}))},clearZeroHour(e){e&&(("12:00 am"===e.finishTime&&"12:00 am"===e.startTime||"12:00 AM"===e.finishTime&&"12:00 AM"===e.startTime)&&(e.finishTime="",e.startTime=""),"0"===e.hours&&(e.hours="",e.shiftDescription=""))},convertDateRange(e,t){let a=e.clone(),l=t.clone();return this.manageCompanyConfig.getAllowSundayFirst()?(e.day()>a.startOf("week").day()&&(a=a.startOf("week")),t.day()<l.endOf("week").day()&&(l=l.endOf("week"))):(e.day()>1?a=a.subtract(e.day()-1,"day"):0===e.day()&&(a=a.subtract(6,"day")),t.day()>0&&(l=l.add(7-t.day(),"day"))),[a,l]},displayScheduleDetail(e){return 0!==e.hours&&null!==e.hours&&""!==e.hours},selectDateTodayForFromDate:function(){this.fromDate=jt()().startOf("day"),this.toDate=null,this.loadSchedules(this.fromDate,this.toDate)},selectDateTodayForToDate:function(){this.toDate=jt()(),this.toDate.hour(11),this.toDate.minute(59),this.toDate<this.fromDate&&(this.fromDate=null),this.loadSchedules(this.fromDate,this.toDate)},getWeekDayByIndex:function(e){let t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return t[e]},async openDatePicker(){let e=await this.$refs.DatePickerRef.toggleShow(this.datePickerTargetDay);return this.selectedDateType===Tl.toDate?this.toDate=e:this.selectedDateType===Tl.fromDate&&(this.fromDate=e),this.loadSchedules(this.fromDate,this.toDate),e}}});const Nl=(0,oe.Z)(Ml,[["render",dl]]);var Fl=Nl;const Pl=e=>((0,s.dD)("data-v-dc59e724"),e=e(),(0,s.Cn)(),e),Ol={class:"vue-sched-management"},Hl={class:"sched-card-default mr-4 mr-xs-0"},Yl=Pl((()=>(0,s._)("div",null,[(0,s._)("h3",{class:"mt-2"},"Schedules")],-1))),Il={key:0,class:"sched-card-default sched-detail-card sche-detail-mt"},Ll={key:0},Wl=Pl((()=>(0,s._)("h3",null,"Create New Schedule",-1))),jl=[Wl],Rl={key:1,class:"d-flex justify-space-between"},$l=Pl((()=>(0,s._)("h3",null,"Schedule Details",-1))),Bl={key:3,class:"sched-man-allocations mt-4"},Vl=Pl((()=>(0,s._)("div",{class:"caption font-weight-bold text-start"},"Employee Allocations",-1))),Ul={class:"aff-table allowcated-employee-table mt-4"},zl=Pl((()=>(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Employee Name"),(0,s._)("th",{class:"text-center"},"Date From"),(0,s._)("th",{class:"text-center"},"Date To")])],-1))),Gl={class:"text-center"},Kl={class:"text-center"},ql={class:"d-flex justify-end mt-2"};function Zl(e,t){const a=(0,s.up)("search-schedule"),i=(0,s.up)("schedule-detail");return(0,s.wg)(),(0,s.iD)("div",Ol,[(0,s.wy)((0,s._)("div",Hl,[Yl,(0,s.Wm)(a,{ref:"searchScheduleRef",onCreateNewSchedule:e.createNewSchedule,onSelectSchedFromSearch:e.selectSchedulesDetail},null,8,["onCreateNewSchedule","onSelectSchedFromSearch"])],512),[[l.F8,!e.createNew]]),e.schedDetail?((0,s.wg)(),(0,s.iD)("div",Il,[e.createNew?((0,s.wg)(),(0,s.iD)("div",Ll,jl)):((0,s.wg)(),(0,s.iD)("div",Rl,[$l,(0,s._)("span",{class:"icon-cross vp-icon",onClick:t[0]||(t[0]=t=>e.closeScheduleDetail(!0))})])),e.schedDetail?((0,s.wg)(),(0,s.j4)(i,{key:2,ref:"detail",shiftTypeList:e.shiftTypeList,detail:e.schedDetail,"read-only":0,onCancel:e.cancelScheduleDetail,onReload:e.reloadSchedulesDetail,onScheduleSaved:e.scheduleSaved,onScheduleDeleted:e.scheduleDeleted},null,8,["shiftTypeList","detail","onCancel","onReload","onScheduleSaved","onScheduleDeleted"])):(0,s.kq)("",!0),e.schedDetail&&e.schedDetail.EmpAllocations&&e.schedDetail.EmpAllocations.length>0?((0,s.wg)(),(0,s.iD)("div",Bl,[Vl,(0,s._)("div",Ul,[(0,s._)("table",null,[zl,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.schedDetail.EmpAllocations,(t=>((0,s.wg)(),(0,s.iD)("tr",{class:(0,n.C_)({"hide-none-active-detail":!t.isActive&&e.showActiveSchedule})},[(0,s._)("td",null,(0,n.zw)(t.EmployeeName),1),(0,s._)("td",Gl,(0,n.zw)(e.$filters.reformatDateString(t.DateFrom,null)),1),(0,s._)("td",Kl,(0,n.zw)(e.$filters.reformatDateString(t.DateTo,null)),1)],2)))),256))])])]),(0,s._)("div",ql,[(0,s._)("button",{class:"grey white--text text-capitalize small",onClick:t[1]||(t[1]=(...t)=>e.toggleShowActiveSchedule&&e.toggleShowActiveSchedule(...t))},[(0,s.wy)((0,s._)("span",null,"Show Active",512),[[l.F8,!e.showActiveSchedule]]),(0,s.wy)((0,s._)("span",null,"Show All",512),[[l.F8,e.showActiveSchedule]])])])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])}const Ql=e=>((0,s.dD)("data-v-6a12e3e6"),e=e(),(0,s.Cn)(),e),Jl={class:"default-form sched-detail-form mt-4"},Xl={key:0,class:"caption d-flex"},es={class:"d-flex align-center"},ts=Ql((()=>(0,s._)("label",{for:"personal",class:"ml-2 cursor-pointer"},"Create Personal Schedule",-1))),as={class:"d-flex align-center ml-6"},ls=Ql((()=>(0,s._)("label",{for:"team",class:"ml-2 cursor-pointer"},"Create Team Schedule",-1))),ss={class:"caption d-flex justify-space-between mt-4"},is={class:"full-width d-flex align-center"},os=Ql((()=>(0,s._)("div",{class:"form-label"},"Name",-1))),ns={key:1},rs={key:2,class:"label-detail"},ds={key:0,class:"red--text"},cs={key:1,class:"caption mt-4"},hs=Ql((()=>(0,s._)("div",{class:"form-label"},[(0,s._)("span",null,"Employee No")],-1))),us={key:0,class:"employeeNo-autoComplete"},ms={key:1,class:"label-detail"},ps={class:"caption d-flex mt-4"},ys=Ql((()=>(0,s._)("div",{class:"form-label"},"Description",-1))),fs={class:"caption mt-4"},gs=Ql((()=>(0,s._)("div",{class:"form-label"},"Effective Date",-1))),Ds={class:"inline-block"},ws=["value"],vs=Ql((()=>(0,s._)("span",{class:"input-icon icon-calendar xs-icon"},null,-1))),Ss={class:"caption mt-4 ml-4 d-inline number-of-weeks"},bs=Ql((()=>(0,s._)("div",{class:"d-inline mr-4 bold-text"},"Number of Weeks",-1))),ks=Ql((()=>(0,s._)("label",{for:"now"},null,-1))),Cs={class:"mobile-arrow"},As=Ql((()=>(0,s._)("span",{class:"icon-arrowhead-up arrow-icon"},null,-1))),xs=[As],_s=Ql((()=>(0,s._)("span",{class:"mt-1 icon-arrowhead-down arrow-icon"},null,-1))),Ts=[_s],Es={class:"section-table ui-gridbox-scrollable-titles mt-4"},Ms={class:"aff-table sched-detail-table"},Ns=(0,s.uE)('<div class="head-cell" data-v-6a12e3e6>Week</div><div class="head-cell" data-v-6a12e3e6>Day</div><div class="head-cell" data-v-6a12e3e6>Hours</div><div class="head-cell" data-v-6a12e3e6>Start</div><div class="head-cell" data-v-6a12e3e6>Finish</div><div class="head-cell break-column-width" data-v-6a12e3e6>Unpaid Break</div>',6),Fs={class:"head-cell"},Ps={class:"aff-table-body"},Os={class:"aff-table-body-cell"},Hs={class:"table-date-counter aff-table-body-cell"},Ys={class:"mr-2"},Is={class:"aff-table-body-cell"},Ls=["onUpdate:modelValue","error","onChange","data-test"],Ws={class:"aff-table-body-cell"},js=["value","onChange"],Rs={class:"aff-table-body-cell"},$s=["value","onChange"],Bs={class:"unpaid-break hide-arrow aff-table-body-cell"},Vs=["onUpdate:modelValue","onChange"],Us=Ql((()=>(0,s._)("span",null,":",-1))),zs=["onUpdate:modelValue","onChange"],Gs={key:0,class:"shift-select-td aff-table-body-cell"},Ks={class:"schedules-buttons form-row d-flex flex-wrap justify-end mt-2"},qs={key:0},Zs={key:1},Qs=["disabled"],Js=Ql((()=>(0,s._)("span",{class:"icon-trash mr-1"},null,-1))),Xs=Ql((()=>(0,s._)("span",null,"Delete",-1))),ei=[Js,Xs],ti=["disabled"],ai=Ql((()=>(0,s._)("span",{class:"icon-briefcase mr-1"},null,-1))),li=Ql((()=>(0,s._)("span",null,"Archive",-1))),si=[ai,li],ii=["disabled"],oi=Ql((()=>(0,s._)("span",{class:"icon-cancel mr-1"},null,-1))),ni=Ql((()=>(0,s._)("span",null,"Cancel",-1))),ri=[oi,ni],di=["disabled"],ci=Ql((()=>(0,s._)("span",{class:"icon-save mr-1"},null,-1))),hi=Ql((()=>(0,s._)("span",null,"Save",-1))),ui=[ci,hi];function mi(e,t){const a=(0,s.up)("auto-complete"),i=(0,s.up)("custom-select"),o=(0,s.up)("date-picker"),r=(0,s.Q2)("tooltip");return(0,s.wg)(),(0,s.iD)("div",Jl,[(0,s._)("form",{onChange:t[22]||(t[22]=(...t)=>e.formUpdated&&e.formUpdated(...t)),onSubmit:t[23]||(t[23]=(0,l.iM)((t=>e.formSubmited(t)),["prevent"]))},[e.isNewSchedule&&e.$CompanyConfig.isAllowPersonal?((0,s.wg)(),(0,s.iD)("div",Xl,[(0,s._)("div",es,[(0,s.wy)((0,s._)("input",{type:"radio",id:"personal",value:"personal",class:"cursor-pointer","onUpdate:modelValue":t[0]||(t[0]=t=>e.createType=t)},null,512),[[l.G2,e.createType]]),ts]),(0,s._)("div",as,[(0,s.wy)((0,s._)("input",{type:"radio",id:"team",value:"team",class:"cursor-pointer","onUpdate:modelValue":t[1]||(t[1]=t=>e.createType=t)},null,512),[[l.G2,e.createType]]),ls])])):(0,s.kq)("",!0),(0,s._)("div",ss,[(0,s._)("div",is,[os,e.isNewSchedule&&"team"===e.createType?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:0,class:"caption underline-input full-width",name:"name",onKeyup:t[2]||(t[2]=t=>e.hasChanges=!0),counter:"49","onUpdate:modelValue":t[3]||(t[3]=t=>e.detail.Name=t)},null,544)),[[l.nr,e.detail.Name]]):e.isNewSchedule&&"personal"===e.createType&&e.detail.EmployeeNo?((0,s.wg)(),(0,s.iD)("div",ns,(0,n.zw)("Personal_"+e.detail.EmployeeNo),1)):(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",rs,[(0,s.Uk)((0,n.zw)(e.detail.Name),1)])),[[r,{content:e.detail.Name,delay:{show:3e3,hide:100}},void 0,{top:!0}]])]),e.detail.Archive?((0,s.wg)(),(0,s.iD)("div",ds,"Archived")):(0,s.kq)("",!0)]),"personal"===e.createType&&e.$CompanyConfig.isAllowPersonal?((0,s.wg)(),(0,s.iD)("div",cs,[hs,e.isNewSchedule&&e.employees&&e.employees.length>0?((0,s.wg)(),(0,s.iD)("span",us,[(0,s.Wm)(a,{inputList:e.employees,optionName:"joinedName",onSelected:e.selectedEmployee},null,8,["inputList","onSelected"])])):(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",ms,[(0,s.Uk)((0,n.zw)(e.detail.EmployeeNo),1)])),[[r,{content:e.detail.EmployeeNo,delay:{show:3e3,hide:100}},void 0,{top:!0}]])])):(0,s.kq)("",!0),(0,s._)("div",ps,[ys,(0,s.wy)((0,s._)("textarea",{class:"caption description-area","hide-details":"",rows:"2",onKeyup:t[4]||(t[4]=t=>e.hasChanges=!0),outlined:"",dense:"","onUpdate:modelValue":t[5]||(t[5]=t=>e.detail.Description=t)}," ",544),[[l.nr,e.detail.Description]])]),(0,s._)("div",fs,[gs,(0,s._)("div",Ds,[(0,s._)("input",{class:"date-input",value:e.$filters.reformatDate(e.detail.StartDate),onClick:t[6]||(t[6]=(...t)=>e.openDatePicker&&e.openDatePicker(...t))},null,8,ws),vs]),(0,s._)("div",Ss,[bs,ks,(0,s.wy)((0,s._)("input",{class:"number-input",max:"12",min:"1",step:"1",id:"now",name:"now",type:"number","onUpdate:modelValue":t[7]||(t[7]=t=>e.detail.NoOfWeeks=t),onChange:t[8]||(t[8]=(...t)=>e.updateNoOfWeeks&&e.updateNoOfWeeks(...t)),onKeydown:t[9]||(t[9]=(...t)=>e.numLimitKeyDown&&e.numLimitKeyDown(...t)),style:{width:"60px"}},null,544),[[l.nr,e.detail.NoOfWeeks]]),(0,s._)("div",Cs,[e.detail.NoOfWeeks<12?((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",class:"icon",color:"grey",onClick:t[10]||(t[10]=(...t)=>e.increaseNumber&&e.increaseNumber(...t))},xs)):(0,s.kq)("",!0),e.detail.NoOfWeeks>1?((0,s.wg)(),(0,s.iD)("button",{key:1,type:"button",class:"ml-2 icon",small:"",color:"grey",onClick:t[11]||(t[11]=(...t)=>e.reduceNumber&&e.reduceNumber(...t))},Ts)):(0,s.kq)("",!0)])])]),(0,s._)("div",Es,[(0,s._)("div",Ms,[(0,s._)("div",{class:(0,n.C_)(["sched-detail-days",{"shift-min-width":e.showMore}])},[(0,s._)("div",{class:(0,n.C_)(["aff-table-head",{"show-shift-column":e.showMore}])},[Ns,(0,s.wy)((0,s._)("div",Fs,"Shift",512),[[l.F8,e.showMore]])],2),(0,s._)("div",Ps,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.detail.Days,(a=>((0,s.wg)(),(0,s.iD)("div",{key:a.DayNumber,class:(0,n.C_)(["aff-table-body-row",{"show-shift-column":e.showMore}])},[(0,s._)("div",Os,[(0,s.wy)((0,s._)("span",null,(0,n.zw)(a.Week),513),[[l.F8,e.isFirstDayOfWeek(a.DayOfWeek)]])]),(0,s._)("div",Hs,[(0,s._)("span",Ys,(0,n.zw)(a.DayNumber+1),1),(0,s._)("span",null,(0,n.zw)(e.getDayOfWeek(a.DayOfWeek)),1)]),(0,s._)("div",Is,[(0,s.wy)((0,s._)("input",{type:"number",step:"any",min:"0",max:"24","onUpdate:modelValue":e=>a.Hours=e,class:"caption sched-detail-table-input",center:"",name:"Sche Hour",autocomplete:"off","data-lpignore":"true",error:a.error,onKeydown:t[12]||(t[12]=t=>e.numLimitKeyDown(t,!0,!1)),onChange:t=>e.checkHour(a),"data-test":a.Hours},null,40,Ls),[[l.nr,a.Hours,void 0,{number:!0}]])]),(0,s._)("div",Ws,[(0,s._)("input",{value:e.$filters.reformatTime(a.StartTime),autocomplete:"off","data-lpignore":"true",class:"d-inline-flex ma-0 pa-0 caption sched-detail-table-input",onChange:t=>e.timeTextChanged(t,a,"StartTime"),onKeydown:t[13]||(t[13]=t=>e.numLimitKeyDown(t,!1,!0)),"onClick:clear":t[14]||(t[14]=t=>e.fromDate=null)},null,40,js)]),(0,s._)("div",Rs,[(0,s._)("input",{value:e.$filters.reformatTime(a.FinishTime),autocomplete:"off","data-lpignore":"true",class:"d-inline-flex ma-0 pa-0 caption sched-detail-table-input",onChange:t=>e.timeTextChanged(t,a,"FinishTime"),onKeydown:t[15]||(t[15]=t=>e.numLimitKeyDown(t,!1,!0)),"onClick:clear":t[16]||(t[16]=t=>e.fromDate=null)},null,40,$s)]),(0,s._)("div",Bs,[(0,s.wy)((0,s._)("input",{class:"sched-detail-table-input",type:"number",max:"100","onUpdate:modelValue":e=>a.breakH=e,onChange:t=>e.calcBreakHour(a)},null,40,Vs),[[l.nr,a.breakH,void 0,{lazy:!0}]]),Us,(0,s.wy)((0,s._)("input",{class:"sched-detail-table-input","onUpdate:modelValue":e=>a.breakM=e,onChange:t=>e.calcBreakHour(a)},null,40,zs),[[l.nr,a.breakM,void 0,{lazy:!0}]])]),e.showMore?((0,s.wg)(),(0,s.iD)("div",Gs,[(0,s.Wm)(i,{class:"caption",options:e.shifts,selected:a.ShiftId,onSelectOption:t=>e.selectedShift(t,a)},null,8,["options","selected","onSelectOption"])])):(0,s.kq)("",!0)],2)))),128))])],2)])]),(0,s._)("div",Ks,[(0,s._)("button",{type:"button",class:"white--text grey caption text-capitalize mr-2 mt-2 small",onClick:t[17]||(t[17]=(...t)=>e.toggleShift&&e.toggleShift(...t))},[e.showMore?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("span",qs,"Show Shift")),e.showMore?((0,s.wg)(),(0,s.iD)("span",Zs,"Hide Shift")):(0,s.kq)("",!0)]),!e.isNewSchedule&&e.detail.EmpAllocations&&0===e.detail.EmpAllocations.length?((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",class:"white--text red text-capitalize mr-2 mt-2 small",disabled:e.hasChanges,onClick:t[18]||(t[18]=t=>e.deleteSchedule())},ei,8,Qs)):(0,s.kq)("",!0),e.detail.Archive||e.isNewSchedule||"team"!==e.createType?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:1,type:"button",class:"white--text red text-capitalize mr-2 mt-2 small",disabled:e.hasChanges,onClick:t[19]||(t[19]=t=>e.archiveSchedule())},si,8,ti)),(0,s._)("button",{type:"button",class:"white--text grey text-capitalize mr-2 mt-2 small",disabled:!e.hasChanges&&!e.isNewSchedule,onClick:t[20]||(t[20]=t=>e.cancelChanges())},ri,8,ii),(0,s._)("button",{type:"button",class:"white--text text-capitalize mr-1 mt-2 green small",disabled:!e.hasChanges,onClick:t[21]||(t[21]=t=>e.updateDetail())},ui,8,di)])],32),(0,s.Wm)(o,{ref:"DatePickerRef",top:e.dateModalTop,leftInput:e.dateModalLeft,date:e.detail.StartDate},null,8,["top","leftInput","date"])])}var pi,yi,fi;(function(e){e["getEmployees"]="GET_EMPLOYEES",e["getFilteredEmployees"]="GET_FILTERED_EMPLOYEES"})(pi||(pi={})),function(e){e["setEmployees"]="SET_EMPLOYEES"}(yi||(yi={})),function(e){e["getEmployees"]="GET_EMPLOYEES"}(fi||(fi={}));const gi={[pi.getEmployees](e){return e.employees},[pi.getFilteredEmployees](e){return e.filteredEmployees}},Di={[yi.setEmployees](e,t){e.employees=t,e.filteredEmployees=t.slice()}},wi={[fi.getEmployees]({commit:e,state:t},a){return t.employees.length>0?t.employees:se.GetManagedEmployees(a).then((t=>{let a=t.map((e=>(e.employeeName=e.CommonName,Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t]))))));return e(yi.setEmployees,a),a}))}},vi={state:{employees:[],employeesWithPeronsalSche:[],filteredEmployees:[]},getters:gi,mutations:Di,actions:wi};var Si=vi;const bi={class:"custom-select",tabindex:"1",ref:"selectRef"},ki={class:"custom-select-selected"},Ci={class:"custom-select-items"},Ai=["tabindex","onClick"],xi={class:"cell-config"};function _i(e,t){return(0,s.wg)(),(0,s.iD)("div",bi,[(0,s._)("div",ki,[(0,s.wy)((0,s._)("input",{class:"custom-select-input",ref:"selectInputRef","onUpdate:modelValue":t[0]||(t[0]=t=>e.selectSearchInput=t),onKeyup:t[1]||(t[1]=(...t)=>e.updateSearchList&&e.updateSearchList(...t))},null,544),[[l.nr,e.selectSearchInput]])]),(0,s._)("div",Ci,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.dropDownList,((t,a)=>((0,s.wg)(),(0,s.iD)("div",{class:(0,n.C_)(["custom-select-item",{targeting:t.targeting}]),ref_for:!0,ref:"selectDropdownRef",key:a,tabindex:a+99,onClick:a=>e.chooseOption(a,t)},[(0,s._)("div",xi,(0,n.zw)(t.name),1)],10,Ai)))),128))])],512)}var Ti=(0,s.aZ)({name:"AutoComplete",props:{inputList:{type:Array},optionName:{type:String}},data(){return{editing:!1,targetingIndex:null}},setup(e){e.optionName||console.error("need object, optionName is missing");const t=(0,Al.iH)(e.inputList.map(((t,a)=>({targeting:!1,name:t[e.optionName],index:a})))),a=(0,Al.iH)(t.value.slice()),l=(0,Al.iH)("");return{originList:t,dropDownList:a,selectSearchInput:l}},methods:{updateSearchList(e){"ArrowDown"!==e.key?"ArrowUp"!==e.key?"Enter"===e.key&&this.targetingIndex?this.selectFromTarget():this.dropDownList=this.originList.filter((e=>(e.targeting=!1,e.name.toLowerCase().indexOf(this.selectSearchInput.toLowerCase())>-1))):this.moveTargetUp():this.moveTargetDown()},moveTargetDown(){null!==this.targetingIndex?(this.dropDownList[this.targetingIndex].targeting=!1,this.targetingIndex+1<this.dropDownList.length?(this.targetingIndex++,this.dropDownList[this.targetingIndex].targeting=!0):(this.targetingIndex,this.dropDownList.length,this.targetingIndex=0,this.dropDownList[this.targetingIndex].targeting=!0)):(this.targetingIndex=0,this.dropDownList[this.targetingIndex].targeting=!0)},moveTargetUp(){null!==this.targetingIndex?(this.dropDownList[this.targetingIndex].targeting=!1,this.targetingIndex-1>=0?(this.targetingIndex--,this.dropDownList[this.targetingIndex].targeting=!0):this.targetingIndex-1<0?(this.targetingIndex=this.dropDownList.length-1,this.dropDownList[this.targetingIndex].targeting=!0):(this.targetingIndex=0,this.dropDownList[this.targetingIndex].targeting=!0)):(this.targetingIndex=0,this.dropDownList[this.targetingIndex].targeting=!0)},selectFromTarget(){this.selectSearchInput=this.dropDownList[this.targetingIndex].name,this.$emit("selected",this.inputList[this.targetingIndex])},chooseOption(e,t){this.selectSearchInput=t.name,this.$emit("selected",this.inputList[t.index]),e.target.blur()}}});const Ei=(0,oe.Z)(Ti,[["render",_i],["__scopeId","data-v-309b7c5e"]]);var Mi=Ei;const Ni=e=>((0,s.dD)("data-v-0c2a3a8e"),e=e(),(0,s.Cn)(),e),Fi={class:"custom-select",tabindex:"1",ref:"selectRef"},Pi={key:0,class:"custom-select-selected"},Oi={key:0},Hi={key:1},Yi={key:2,class:"custom-select-empty-selected"},Ii={key:1,class:"custom-select-selected"},Li={key:0},Wi={key:1},ji={key:2,class:"custom-select-empty-selected"},Ri=["onClick"],$i={class:"cell-config"},Bi={key:0},Vi={key:1},Ui=Ni((()=>(0,s._)("label",null,null,-1)));function zi(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("span",null,[(0,s._)("div",Fi,[e.modelValue?((0,s.wg)(),(0,s.iD)("div",Pi,[e.modelValue&&"object"===typeof e.modelValue&&e.displayKey?((0,s.wg)(),(0,s.iD)("span",Oi,(0,n.zw)(e.modelValue[e.displayKey]),1)):e.modelValue?((0,s.wg)(),(0,s.iD)("span",Hi,(0,n.zw)(e.modelValue),1)):((0,s.wg)(),(0,s.iD)("span",Yi))])):((0,s.wg)(),(0,s.iD)("div",Ii,[e.selected&&"object"===typeof e.selected?((0,s.wg)(),(0,s.iD)("span",Li,(0,n.zw)(e.selected[e.displayKey]),1)):e.selected?((0,s.wg)(),(0,s.iD)("span",Wi,(0,n.zw)(e.selected),1)):((0,s.wg)(),(0,s.iD)("span",ji))])),(0,s._)("div",{class:"custom-select-items",style:(0,n.j5)({left:e.left+"px",top:e.getTop()+"px"})},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.options,((t,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"custom-select-item",key:a,onClick:a=>{e.selectOption(a,t)}},[(0,s._)("div",$i,[e.displayKey?((0,s.wg)(),(0,s.iD)("label",Bi,(0,n.zw)(t[e.displayKey]),1)):((0,s.wg)(),(0,s.iD)("label",Vi,(0,n.zw)(t),1)),Ui])],8,Ri)))),128))],4)],512)])])}var Gi=(0,s.aZ)({name:"CustomSelect",props:{options:{type:Array,default:[]},displayKey:{type:String,default:""},modelValue:{type:[String,Number]},selected:{}},data(){return{left:0,top:0}},mounted(){const e=this.$refs.selectRef.getClientRects()[0];this.left=e.left,this.top=e.top+e.height},methods:{getTop(){if(!this.$refs.selectRef)return 0;const e=this.$refs.selectRef.getClientRects()[0];return e.top+e.height},selectOption(e,t){e.target.blur();let a=this.$refs.selectRef;a.blur(),this.modelValue?this.$emit("update:modelValue",t):this.$emit("selectOption",t)}}});const Ki=(0,oe.Z)(Gi,[["render",zi],["__scopeId","data-v-0c2a3a8e"]]);var qi=Ki,Zi=(0,s.aZ)({name:"schedule-detail",components:{AutoComplete:Mi,DatePicker:El,CustomSelect:qi},props:["detail","shiftTypeList","readOnly"],data:function(){return{createType:"team",employees:[],week:1,tablePadding:"0 0;",hasChanges:!1,isDateToCleared:!1,shifts:[],showMore:!0,initialEmpSched:null,startDateMenu:!1,dateModalTop:0,dateModalLeft:0,timePickerTargetDay:null,selectedTimeType:"Start"}},computed:{isNewSchedule(){let e=this.detail;return e.Id<=0}},mounted:function(){this.shifts=this.shiftTypeList,this.hasChanges=-1==this.detail.Id,this.$emit("dataChanged",this.hasChanges);let e=this.$store.getters[pi.getEmployees];e=e.filter((e=>!this.$store.state.EmployeeModule.employeesWithPeronsalSche.includes(e.employeeNo))),this.employees=e.map((e=>(e.joinedName=e.commonName+" "+e.employeeNo,e))),this.remapDays(),console.log("schedule type",this.detail.ScheduleType),this.createType=0===this.detail.ScheduleType||void 0===this.detail.ScheduleType?"team":"personal"},watch:{["detail"](e,t){this.remapDays(),this.createType=0===this.detail.ScheduleType||void 0===this.detail.ScheduleType?"team":"personal",e!=t&&-1==e.Id&&(this.detail.Days=[],this.createNewDays(1,1))}},methods:{selectedShift(e,t){t.ShiftId=e,this.hasChanges=!0},formSubmited(e){return e.preventDefault(),e.stopPropagation(),!1},increaseNumber(){this.detail.NoOfWeeks++,this.updateNoOfWeeks()},reduceNumber(){this.detail.NoOfWeeks--,this.updateNoOfWeeks()},toggleShift(){this.showMore=!this.showMore},remapDays(){for(var e=0,t=jt()(this.detail.StartDate),a=7*this.detail.NoOfWeeks,l=new Array(a),s=0;s<a;s++)s%7==0&&e++,l[s]={DayNumber:s,DayOfWeek:t.day(),Week:e,Date:jt()(t),Hours:0,StartTime:null,FinishTime:null,ShiftId:null,BreakHours:null},t.add(1,"day");this.showMore=!1,this.detail.Days.map((e=>{e.StartTime&&(l[e.DayNumber].StartTime=jt()(e.StartTime)),e.FinishTime&&(l[e.DayNumber].FinishTime=jt()(e.FinishTime)),l[e.DayNumber].Hours=e.Hours,l[e.DayNumber].ShiftId=e.ShiftId,l[e.DayNumber].BreakHours=e.BreakHours;let t=e.BreakHours,a=Math.floor(t),s=t-a;0!==a&&(l[e.DayNumber].breakH=a),s>0&&(l[e.DayNumber].breakM=Math.round(60*s))})),this.detail.Days=l,this.detail.StartDate=jt()(this.detail.StartDate),this.hasChanges=!1},timeTextChanged(e,t,a){let l;if(l=e.target.value.includes(":")?jt()(e.target.value,"HH:mm"):jt()(e.target.value,"Hmm"),"FinishTime"===a){if(!l.isValid())return e.target.value="InValid Time",void(t.FinishTime=null);if(t.FinishTime&&l.hour()===t.FinishTime.hour()&&l.minute()===t.FinishTime.minute())return;if(""===e)return void(t.FinishTime=null);t.FinishTime=l}else{if(t.StartTime&&l.hour()===t.StartTime.hour()&&l.minute()===t.StartTime.minute())return;if(!l.isValid())return e.target.value="InValid Time",void(t.StartTime=null);if(""===e)return void(t.StartTime=null);t.StartTime=l}this.timePickerTargetDay=t,this.autoCalcTime(a),this.hasChanges=!0},autoCalcTime(e){let t=this.timePickerTargetDay;if(console.log("calc time"),!t.FinishTime||"00:00"===t.FinishTime.format("HH:mm")||!t.StartTime||"00:00"===t.StartTime.format("HH:mm")||t.Hours&&0!==t.Hours)if(!t.FinishTime||!t.Hours||t.StartTime&&"00:00"!==t.StartTime.format("HH:mm"))if(!t.StartTime||!t.Hours||t.FinishTime&&"00:00"!==t.FinishTime.format("HH:mm")){if(t.FinishTime&&"00:00"!==t.FinishTime.format("HH:mm")&&t.StartTime&&"00:00"!==t.StartTime.format("HH:mm")&&(t.Hours||0!==t.Hours)){const a=t.BreakHours?t.Hours+t.BreakHours:t.Hours;"StartTime"===e?t.FinishTime=t.StartTime.clone().add(a,"hours"):"FinishTime"===e&&(t.StartTime=t.FinishTime.clone().subtract(a,"hours"))}}else{const e=t.BreakHours?t.Hours+t.BreakHours:t.Hours;t.FinishTime=t.StartTime.clone().add(e,"hours")}else{const e=t.BreakHours?t.Hours+t.BreakHours:t.Hours;t.StartTime=t.FinishTime.clone().subtract(e,"hours")}else{t.FinishTime.year(t.StartTime.year()),t.FinishTime.month(t.StartTime.month()),t.FinishTime.day(t.StartTime.day());let e=t.FinishTime.startOf("minute").diff(t.StartTime.startOf("minute"),"hours",!0);t.BreakHours&&(e-=t.BreakHours),t.Hours=Math.round(100*e)/100}},updateDateText(e,t){this.startDateMenu=!1,t.set(jt()(e,"DD/MM/YYYY").toObject()),this.remapDays()},startDateDatePickerHandler(e){"string"===typeof e&&(e=jt()(e)),this.detail.StartDate=e,this.remapDays()},isFirstDayOfWeek:function(e){var t=jt()(this.detail.StartDate);return e==t.day()},calcBreakHour(e){e.breakH&&e.breakM?e.BreakHours=Number(e.breakH)+Math.round(Number(e.breakM)/60*1e3)/1e3:e.breakH?e.BreakHours=Number(e.breakH):e.breakM?e.BreakHours=Math.round(Number(e.breakM)/60*1e3)/1e3:(0===e.breakHours&&e.breakM,e.BreakHours=0),e.StartTime&&"00:00"!==e.StartTime.format("HH:mm")&&e.FinishTime&&"00:00"!==e.FinishTime.format("HH:mm")&&(e.Hours=e.FinishTime.startOf("minute").diff(e.StartTime.startOf("minute"),"hours",!0)-e.BreakHours)},getDayOfWeek:function(e){if(e<0||e>6)return console.error("day No not correct"),"unknown";var t=["Sun","Mon","Tue","Wed","Thur","Fri","Sat"];return t[e]},checkHour(e){if(this.hasChanges=!0,e.Hours>24)return fl.alert("You can only enter up to 24 hours."),void(e.Hours=24);const t=e.BreakHours?e.Hours+e.BreakHours:e.Hours;e.StartTime&&e.Hours&&e.FinishTime||e.StartTime&&e.Hours?e.FinishTime=e.StartTime.clone().add(t,"hours"):e.Hours&&e.FinishTime&&(e.StartTime=e.FinishTime.clone().add(t,"hours"))},updateNoOfWeeks(e){let t=this.detail.Days.length,a=Math.floor(t/7);if(this.detail.NoOfWeeks>a)this.createNewDays(a+1,this.detail.NoOfWeeks);else{let e=7*this.detail.NoOfWeeks;this.detail.Days.splice(e)}},numLimitKeyDown:function(e,t,a){let l=[8,9,13,46,16,17];l.push(65,67,86,88),t&&l.push(190,110),a&&l.push(186),e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105||l.indexOf(e.keyCode)>-1||(e.preventDefault(),e.stopPropagation())},cancelChanges(){if(!this.hasChanges)return void this.$emit("cancel");let e="You haven't saved your changes.  <br /> Are you sure you want to cancel?";fl.checkChange({message:e,confirmButtonText:"Yes",cancelButtonText:"No",onOk:()=>{this.hasChanges=!1,this.$emit("cancel")}})},reloadDetail:function(){this.hasChanges&&this.$emit("reload")},createNewDays:function(e,t){if(!(e>t)){var a=e,l=this.detail.Days.length;while(a<=t){var s=jt()(this.detail.StartDate);s.add(l,"day"),this.detail.Days.push({DayNumber:l,DayOfWeek:s.day(),Week:a,Date:s,Hours:0,StartTime:null,FinishTime:null,ShiftId:null,startDateModal:!1,endDateModal:!1}),l++,a=Math.floor(l/7)+1}}},archiveSchedule:function(){this.hasChanges||(this.detail.Archive?fl.alert("Unable to archive schedule, it's already archived."):fl.confirmOrCancel({message:"Are you sure you want to archive this work schedule?"}).then((()=>{this.detail.Archive=!0,this.doUpdateDetail()})))},deleteSchedule:function(){this.hasChanges||(this.detail.EmpAllocations.length>0?fl.alert("Unable to delete schedule, it's currently allocated to employees"):Hw.emit("dialog",{message:"Are you sure you want to permanently delete this work schedule?",showButtons:!0,showCancel:!0,okColor:"red",onOk:()=>{this.doDeleteSchedule()},onCancel:()=>{}}))},doDeleteSchedule:function(){fl.loading(),se.DeleteSchedule(this.detail.Id).then((e=>{this.$emit("schedule-deleted"),fl.clear()}))},updateDetail:function(){this.hasChanges&&this.doUpdateValidation()&&this.doUpdateDetail()},doUpdateValidation:function(){if("team"===this.createType){if(!this.detail.Name&&!this.detail.Description||""===this.detail.Name&&""===this.detail.Description)return fl.alert("Schedule name cannot be blank. <br /> Schedule description cannot be blank."),!1;if(!this.detail.Name||""===this.detail.Name)return fl.alert("Schedule name cannot be blank."),!1}return this.detail.Description&&""!==this.detail.Description?void 0!==this.detail.Name&&null!==this.detail.Name&&this.detail.Name.length>50?(fl.alert("Schedule names must be 50 characters or fewer (including spaces)."),!1):!(void 0!==this.detail.Description&&null!==this.detail.Description&&this.detail.Description.length>50)||(fl.alert("Schedule descriptions must be 50 characters or fewer (including spaces)."),!1):(fl.alert("Schedule description cannot be blank."),!1)},doUpdateDetail:function(){var e={Id:this.detail.Id,NoOfWeeks:this.detail.NoOfWeeks,StartDate:jt()(this.detail.StartDate).format("DD/MMM/YYYY"),Name:"team"===this.createType?this.detail.Name:"Personal_ "+this.detail.EmployeeNo,EmployeeNo:this.detail.EmployeeNo?this.detail.EmployeeNo:null,ScheduleType:this.detail.EmployeeNo?1:0,IsPersonal:!!this.detail.EmployeeNo,Description:this.detail.Description,Archive:this.detail.Archive,Days:[]};this.detail.Days.map((function(t){(t.Hours>0||null!==t.ShiftId&&""!==t.ShiftId)&&(""===t.ShiftId&&(t.ShiftId=null),e.Days.push({DayNumber:t.DayNumber,StartTime:t.StartTime?t.StartTime.format("HH:mm"):null,FinishTime:t.FinishTime?t.FinishTime.format("HH:mm"):null,Hours:t.Hours>24?24:t.Hours,ShiftId:t.ShiftId,BreakHours:t.BreakHours?Number(t.BreakHours):null}))})),fl.loading(),se.PostSchedule(e).then((e=>{this.$emit("schedule-saved",e.Data),void 0!==this&&void 0!==this.hasChanges&&(this.hasChanges=!1)})).finally((()=>{fl.clear()}))},formUpdated(){this.hasChanges=!0},async openDatePicker(e){let t=e.target.getClientRects()[0];this.dateModalTop=t.bottom,this.dateModalLeft=t.left;try{this.detail.StartDate=await this.$refs.DatePickerRef.toggleShow(this.detail.StartDate)}catch(a){return void(a&&console.error(a))}this.remapDays(),this.hasChanges=!0},selectedEmployee(e){this.detail.EmployeeNo=e.employeeNo,this.detail.Description=`${e.commonName} ${e.employeeNo} Personal Schedule`}}});const Qi=(0,oe.Z)(Zi,[["render",mi],["__scopeId","data-v-6a12e3e6"]]);var Ji=Qi;const Xi=e=>((0,s.dD)("data-v-6ae049cf"),e=e(),(0,s.Cn)(),e),eo={id:"sched-man-list ",class:"sched-man-list mt-4"},to={class:"d-flex align-center flex-wrap"},ao={class:"filter-dropdown"},lo={class:"custom-select",tabindex:"1",ref:"selectRef"},so={class:"custom-select-selected"},io={class:"custom-select-items"},oo=["tabindex","onClick"],no={class:"cell-config"},ro=Xi((()=>(0,s._)("span",{class:"icon-plus btn-icon white"},null,-1))),co=Xi((()=>(0,s._)("span",{class:"font-weight-regular text-capitalize white"}," Create",-1))),ho=[ro,co],uo={class:"d-flex justify-start mt-2"},mo={class:"d-flex align-center"},po=Xi((()=>(0,s._)("label",{class:"ml-1"},"My Employees Only",-1))),yo={class:"d-flex align-center ml-2"},fo=Xi((()=>(0,s._)("label",{class:"ml-1"},"All Employees",-1))),go={class:"aff-table sche-search-table mt-4"},Do={class:"ui-grid"},wo={class:"table-head"},vo=(0,s.Uk)(" Name "),So=(0,s.Uk)(" Description "),bo=(0,s.Uk)(" Weeks "),ko=(0,s.Uk)(" H/W "),Co=(0,s.Uk)(" Allocated "),Ao={class:"table-body-box"},xo=["onClick"],_o={class:"table-body-cell table-body-cell-first"},To={class:"table-body-cell"},Eo={class:"sched-search-desc"},Mo={class:"table-body-cell text-center"},No={class:"table-body-cell text-center"},Fo={class:"table-body-cell text-center"};function Po(e,t){const a=(0,s.Q2)("tooltip");return(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",eo,[(0,s._)("div",null,[(0,s._)("div",to,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.filters.searchTerm=t),type:"text",placeholder:"Search for schedules","hide-details":"",class:"sched-search-box body-2 underline-input"},null,512),[[l.nr,e.filters.searchTerm]]),(0,s._)("div",ao,[(0,s._)("div",lo,[(0,s._)("div",so,(0,n.zw)(e.filters.selected),1),(0,s._)("div",io,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.filters.options,((t,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"custom-select-item",key:a,tabindex:a+99,onClick:a=>e.choseFilter(a,t)},[(0,s._)("div",no,(0,n.zw)(t),1)],8,oo)))),128))])],512)]),(0,s._)("button",{class:"blue ml-2 small",onClick:t[1]||(t[1]=t=>e.createNewSchedule())},ho)]),(0,s._)("div",uo,[(0,s._)("div",mo,[(0,s.wy)((0,s._)("input",{class:"ma-0",type:"radio",id:"myEmployee",value:"MyEmployee","onUpdate:modelValue":t[2]||(t[2]=t=>e.myEmployeeToggle=t),onChange:t[3]||(t[3]=(...t)=>e.getSchedulesList&&e.getSchedulesList(...t))},null,544),[[l.G2,e.myEmployeeToggle]]),po]),(0,s._)("div",yo,[(0,s.wy)((0,s._)("input",{class:"my-0",type:"radio",id:"allEmployee",value:"AllEmployee","onUpdate:modelValue":t[4]||(t[4]=t=>e.myEmployeeToggle=t),onChange:t[5]||(t[5]=(...t)=>e.getSchedulesList&&e.getSchedulesList(...t))},null,544),[[l.G2,e.myEmployeeToggle]]),fo])])]),(0,s._)("div",go,[(0,s._)("div",Do,[(0,s._)("div",wo,[(0,s._)("div",{class:"table-head-cell table-head-cell-first",onClick:t[6]||(t[6]=t=>e.updateSort(0))},[vo,(0,s._)("span",{class:(0,n.C_)({"icon-arrow-line-small-down":"Asc"===e.filters.orderByArrow[0],"icon-arrow-line-small-up":"Desc"===e.filters.orderByArrow[0]})},null,2)]),(0,s._)("div",{class:"table-head-cell",onClick:t[7]||(t[7]=t=>e.updateSort(1))},[So,(0,s._)("span",{class:(0,n.C_)({"icon-arrow-line-small-down":"Asc"===e.filters.orderByArrow[1],"icon-arrow-line-small-up":"Desc"===e.filters.orderByArrow[1]})},null,2)]),(0,s._)("div",{class:"table-head-cell text-center",onClick:t[8]||(t[8]=t=>e.updateSort(2))},[bo,(0,s._)("span",{class:(0,n.C_)({"icon-arrow-line-small-down":"Asc"===e.filters.orderByArrow[2],"icon-arrow-line-small-up":"Desc"===e.filters.orderByArrow[2]})},null,2)]),(0,s._)("div",{class:"table-head-cell text-center",onClick:t[9]||(t[9]=t=>e.updateSort(3))},[ko,(0,s._)("span",{class:(0,n.C_)({"icon-arrow-line-small-down":"Asc"===e.filters.orderByArrow[3],"icon-arrow-line-small-up":"Desc"===e.filters.orderByArrow[3]})},null,2)]),(0,s._)("div",{class:"table-head-cell text-center",onClick:t[10]||(t[10]=t=>e.updateSort(4))},[Co,(0,s._)("span",{class:(0,n.C_)({"icon-arrow-line-small-down":"Asc"===e.filters.orderByArrow[4],"icon-arrow-line-small-up":"Desc"===e.filters.orderByArrow[4]})},null,2)])]),(0,s._)("div",Ao,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.schedList,(t=>((0,s.wg)(),(0,s.iD)("div",{onClick:a=>e.selectSchedulesDetail(t),class:(0,n.C_)([t.classObject,"table-body"])},[(0,s._)("div",_o,[(0,s._)("div",null,(0,n.zw)(t.Name),1)]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",To,[(0,s._)("div",Eo,(0,n.zw)(t.Description),1)])),[[a,{content:t.Description,delay:{show:3e3,hide:100}},void 0,{right:!0}]]),(0,s._)("div",Mo,[(0,s._)("div",null,(0,n.zw)(t.NoOfWeeks),1)]),(0,s._)("div",No,[(0,s._)("div",null,(0,n.zw)(t.HoursPerWeek),1)]),(0,s._)("div",Fo,[(0,s._)("div",null,(0,n.zw)(t.Count),1)])],10,xo)))),256))])])])],512)),[[l.F8,!e.createNew]])}var Oo;(function(e){e["myEmployee"]="MyEmployee",e["allEmployee"]="AllEmployee"})(Oo||(Oo={}));var Ho=(0,s.aZ)({name:"SearchSchedule",inject:{manageCompanyConfig:"MANAGE_COMPANY_CONFIG"},data(){return{selectedSched:null,schedList:[],shiftTypeList:[],schedDetail:null,createNew:!1,empListHeight:"",showFilters:!0,myEmployeeToggle:Oo.myEmployee,filters:{searchTerm:"",sort:"Name",sortOptions:["Name","Description","NoOfWeeks","HoursPerWeek","Count"],orderBy:"Asc",orderByArrow:["Asc","Asc","Asc","Asc","Asc"],partTimeSche:!1,fullTimeSche:!0,activeSche:!0,inActiveSche:!1,archivedSche:!1,options:[],selected:"Show Active",all:!1},searchTermFocus:!1}},mounted:function(){this.showFilters=!0,this.getSchedulesList(),this.manageCompanyConfig.getAllowPersonal()?this.filters.options=["Show All","Show Active","Show Inactive","Show Archived","Show Personal"]:this.filters.options=["Show All","Show Active","Show Inactive","Show Archived"],this.$watch("filters",this.refreshFilters,{deep:!0})},methods:{choseFilter(e,t){e.target.blur(),this.filters.selected=t;e.target.blur();let a=this.$refs.selectRef;a.blur()},createNewSchedule(){this.$emit("createNewSchedule")},selectSchedulesDetail(e){this.schedList.map((e=>{e.classObject.selected=!1})),e.classObject.selected=!0,this.selectedSched=e,this.$emit("selectSchedFromSearch",this.selectedSched)},deselectScheDetail(){this.schedList.forEach((e=>{e.classObject.selected=!1})),this.selectedSched=null},toggleFilters:function(){this.showFilters=!this.showFilters},refreshFilters:function(){var e=this;this.schedList.sort((function(t,a){var l,s,i=1;return"Desc"===e.filters.orderBy&&(i=-1),"string"===typeof t[e.filters.sort]?(l=t[e.filters.sort].toLowerCase(),s=a[e.filters.sort].toLowerCase()):(l=t[e.filters.sort],s=a[e.filters.sort]),l<s?-1*i:l>s?1*i:0}));var t=this.filters.searchTerm.toLowerCase().trim();this.schedList.forEach((a=>{a.classObject.selected=!!e.selectedSched&&e.selectedSched.Id==a.Id,a.classObject.visible=!0,this.filters.all?a.classObject.visible=!0:(a.classObject.visible=this.getDropDownFilterResult(a),a.classObject.visible&&0!=t.length&&(a.classObject.visible=(-1!==a.Name.toLowerCase().indexOf(t)||-1!==a.Description.toLowerCase().indexOf(t))&&a.classObject.visible)),a.classObject.hidden=!a.classObject.visible}))},getDropDownFilterResult(e){switch(this.filters.selected){case"Show All":return!0;case"Show Active":return!0===e.isActive&&!1===e.Archive&&0===e.ScheduleType;case"Show Inactive":return!1===e.isActive&&!1===e.Archive&&0===e.ScheduleType;case"Show Archived":return!0===e.Archive&&0===e.ScheduleType;case"Show Personal":return 1===e.ScheduleType}},getSchedulesList:function(){fl.loading(),se.StandardSchedules(this.myEmployeeToggle===Oo.allEmployee).then((e=>{var t=[];let a=[],l=e.Data;this.manageCompanyConfig.getAllowPersonal()||(l=e.Data.filter((e=>0===e.ScheduleType))),l.map((e=>{if(e.Name.includes("Personal")){var l=e.Name.replace(/^\D+/g,"");a.push(Number(l))}e.classObject={selected:!1,visible:!0,hidden:!1},this.selectedSched&&this.selectedSched.Id===e.Id&&(this.selectedSched=e,e.classObject.selected=!0),t.push(e.NoOfWeeks)})),t.unshift("All"),this.schedList=l,this.$store.state.EmployeeModule.employeesWithPeronsalSche=a,this.refreshFilters(),fl.clear()}))},updateSort:function(e){this.filters.orderBy=this.filters.orderByArrow[e]="Asc"===this.filters.orderByArrow[e]?"Desc":"Asc",this.filters.sort=this.filters.sortOptions[e],this.filters.orderByArrow.forEach(((t,a)=>{a!==e&&"Asc"}))}}});const Yo=(0,oe.Z)(Ho,[["render",Po],["__scopeId","data-v-6ae049cf"]]);var Io=Yo,Lo=(0,s.aZ)({name:"schedulesManagement",components:{SearchSchedule:Io,"schedule-detail":Ji},data(){return{selectedSched:null,shiftTypeList:[],schedDetail:null,createNew:!1,empListHeight:"",showActiveSchedule:!0,employees:[]}},async mounted(){fl.loading(),await Promise.all([this.getShiftTypeList(),this.getEmployees()]),fl.clear()},methods:{async getShiftTypeList(){try{let e=await se.ShiftTypes();this.shiftTypeList=e.map((e=>e.ShiftType))}catch(e){console.error(e)}},async getEmployees(){try{this.employees=await this.$store.dispatch(fi.getEmployees,Affinity.user.EmployeeNo)}catch(e){console.error(e)}},toggleShowActiveSchedule(){this.showActiveSchedule=!this.showActiveSchedule},selectSchedulesDetail(e){this.$refs.detail&&this.$refs.detail.hasChanges?fl.checkChange({message:"There are currently Schedule Detail changes <br /> Do you want to discard your changes?",onOk:()=>{this.loadScheduleDetail(e)}}):this.loadScheduleDetail(e)},loadScheduleDetail(e){fl.loading(),se.ScheduleDetail(e.Id).then((t=>{this.schedDetail=t.Data,this.checkEmpAllocationActive(),fl.clear(),this.selectedSched=e}),(e=>{fl.clear(),"Network Error"===e.message?fl.alert("Lost Internet connection. Please try again after reconnect."):fl.alert("Something went wrong")}))},checkEmpAllocationActive(){this.schedDetail.EmpAllocations.forEach((e=>{if(!e.DateTo)return void(e.isActive=!0);let t=jt()(e.DateFrom),a=jt()(e.DateTo);e.isActive=a.diff(jt()(),"day")>=0&&t.diff(jt()(),"day")<=0}))},createNewSchedule:function(){this.createNew=!0;let e=jt()();e.hour(0),e.minute(0),e.second(0),this.schedDetail={Id:-1,Name:"",Description:"",NoOfWeeks:1,StartDate:e,Days:[]},this.$refs.detail&&(this.$refs.detail.hasChanges=!0)},cancelScheduleDetail(){this.createNew&&(this.createNew=!1),this.schedDetail=null},reloadSchedulesDetail:function(){this.selectedSched?this.selectSchedulesDetail(this.selectedSched):this.schedDetail=null,this.createNew=!1},closeScheduleDetail(e){if(!e||!this.$refs.detail.hasChanges)return this.schedDetail=null,this.createNew=!1,this.selectedSched=null,void this.$refs.searchScheduleRef.deselectScheDetail();fl.checkChange({message:"There are currently Schedule Detail changes <br /> Do you want to discard your changes?",onOk:()=>{this.closeScheduleDetail(!1)}})},scheduleSaved:function(e){this.selectedSched?(this.schedDetail=e,this.selectedSched={Id:e.Id}):this.schedDetail=null,this.$refs.searchScheduleRef.getSchedulesList(),this.createNew=!1},scheduleDeleted:function(){this.selectedSched=null,this.schedDetail=null,this.$refs.searchScheduleRef.getSchedulesList()}}});const Wo=(0,oe.Z)(Lo,[["render",Zl],["__scopeId","data-v-dc59e724"]]);var jo=Wo;const Ro=e=>((0,s.dD)("data-v-5d3c1829"),e=e(),(0,s.Cn)(),e),$o={class:"outter-h-scroll"},Bo={class:"fix-content-width"},Vo={key:0,class:"emp-detail pa-4 mr-4 ml-4 mr-xs-0"},Uo={class:"section"},zo=Ro((()=>(0,s._)("div",{class:"d-flex justify-space-between"},[(0,s._)("h3",null,"Selected Employees")],-1))),Go={class:"emp-selection-list mt-4 caption"},Ko={class:"list-text"},qo=["onClick"],Zo=Ro((()=>(0,s._)("span",{class:"icon-calendar white lh-0"},null,-1))),Qo=[Zo],Jo=["onClick"],Xo=Ro((()=>(0,s._)("span",{class:"icon-minus white lh-0"},null,-1))),en=[Xo],tn=["onClick"],an=Ro((()=>(0,s._)("span",{class:"icon-minus white lh-0"},null,-1))),ln=[an],sn=["onClick"],on=Ro((()=>(0,s._)("span",{class:"icon-calendar white lh-0"},null,-1))),nn=[on],rn={class:"schedules-buttons mt-2 d-flex justify-end"},dn=Ro((()=>(0,s._)("span",{class:"icon-cancel mr-2 vert-mid white lh-0"},null,-1))),cn=Ro((()=>(0,s._)("span",{class:"text-capitalize white"},"Clear",-1))),hn=[dn,cn],un=Ro((()=>(0,s._)("span",{class:"icon-cancel vert-mid white lh-0"},null,-1))),mn=Ro((()=>(0,s._)("span",{class:"text-capitalize white"},"Clear",-1))),pn=[un,mn],yn={class:"section mt-4",style:{height:"100%"}},fn=Ro((()=>(0,s._)("h3",{class:"bold-text"},"Allocate Schedule",-1))),gn={class:"mt-4 allocate-sche-form"},Dn={class:"custom-select",tabindex:"1",ref:"selectRef"},wn={class:"custom-select-selected"},vn={class:"custom-select-items"},Sn=["tabindex","onClick"],bn={class:"cell-config"},kn={key:0,class:"mt-4"},Cn=Ro((()=>(0,s._)("div",{class:"bold-text"},"Description",-1))),An={class:"caption"},xn={class:"bold-text mt-4"},_n=(0,s.Uk)("No. of Weeks: "),Tn={class:"ml-4"},En={class:"d-flex justify-space-between"},Mn={class:"mt-4 date-input-warpper"},Nn=Ro((()=>(0,s._)("div",{class:"bold-text"},"Date From",-1))),Fn=["value"],Pn=Ro((()=>(0,s._)("span",{class:"input-icon icon-calendar xs-icon"},null,-1))),On={class:"mt-4 date-input-warpper"},Hn=Ro((()=>(0,s._)("div",{class:"bold-text"},"Date To",-1))),Yn=["value"],In=Ro((()=>(0,s._)("span",{class:"input-icon icon-calendar xs-icon"},null,-1))),Ln={class:"mt-4"},Wn=Ro((()=>(0,s._)("div",{class:"bold-text"},"Notes",-1))),jn={key:1,class:"form-row mt-4"},Rn={class:"label-width"},$n={class:"schedules-buttons mt-4 d-flex justify-end"},Bn=Ro((()=>(0,s._)("span",{class:"icon-cancel vert-mid lh-0 white--text mr-1"},null,-1))),Vn=Ro((()=>(0,s._)("span",{class:"text-capitalize white--text"},"Cancel",-1))),Un=[Bn,Vn],zn=Ro((()=>(0,s._)("span",{class:"icon-paperplane vert-mid lh-0 white--text mr-1"},null,-1))),Gn=Ro((()=>(0,s._)("span",{class:"text-capitalize white--text"},"Allocate",-1))),Kn=[zn,Gn];function qn(e,t){const a=(0,s.up)("search-employee"),i=(0,s.up)("employee-schedule"),o=(0,s.up)("date-picker"),r=(0,s.Q2)("tooltip");return(0,s.wg)(),(0,s.iD)("div",$o,[(0,s._)("div",Bo,[(0,s.Wm)(a,{class:"mr-4 mr-xs-0",ref:"SearchEmployeeRef",onUpdateSelectedEmpList:e.updateEmpList},null,8,["onUpdateSelectedEmpList"]),e.bulkEmpList.length>0?((0,s.wg)(),(0,s.iD)("div",Vo,[(0,s._)("div",Uo,[zo,(0,s._)("div",Go,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.bulkEmpList,((t,a)=>((0,s.wg)(),(0,s.iD)("div",{class:(0,n.C_)(["d-flex justify-space-between align-center py-1 px-2",{"emp-select-item-odd":a%2}])},[(0,s._)("div",null,[(0,s.wy)(((0,s.wg)(),(0,s.iD)("span",Ko,[(0,s.Uk)((0,n.zw)(t.EmployeeName)+" ("+(0,n.zw)(t.EmployeeNo)+")",1)])),[[r,{content:"Remove from Employee Selection List"},void 0,{right:!0}]])]),(0,s._)("div",null,[e.isMobileView?(0,s.kq)("",!0):(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{key:0,class:"blue small",style:{"margin-right":"3px"},onClick:a=>e.showScheduleDetail(t)},Qo,8,qo)),[[r,{content:"View Schedule Allocations"},void 0,{right:!0}]]),e.isMobileView?(0,s.kq)("",!0):(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{key:1,class:"orange small",onClick:a=>e.removeEmployee(t)},en,8,Jo)),[[r,{content:"Remove from Employee Selection List"},void 0,{right:!0}]]),e.isMobileView?((0,s.wg)(),(0,s.iD)("button",{key:2,class:"orange small",onClick:a=>e.removeEmployee(t)},ln,8,tn)):(0,s.kq)("",!0),e.isMobileView?((0,s.wg)(),(0,s.iD)("button",{key:3,class:"blue ml-1 small",style:{"margin-right":"3px"},onClick:a=>e.showScheduleDetail(t)},nn,8,sn)):(0,s.kq)("",!0)])],2)))),256))]),(0,s._)("div",rn,[e.isMobileView?(0,s.kq)("",!0):(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{key:0,class:"button grey small",onClick:t[0]||(t[0]=t=>e.clearSelectedEmployee())},hn)),[[r,{content:"Clear Employee Selection List"},void 0,{right:!0}]]),e.isMobileView?((0,s.wg)(),(0,s.iD)("button",{key:1,class:"button grey small",onClick:t[1]||(t[1]=t=>e.clearSelectedEmployee())},pn)):(0,s.kq)("",!0)])]),(0,s._)("div",{onSubmit:t[16]||(t[16]=(0,l.iM)(((...t)=>e.submitForm&&e.submitForm(...t)),["prevent"]))},[(0,s._)("div",yn,[fn,(0,s._)("div",gn,[(0,s._)("form",null,[(0,s._)("div",Dn,[(0,s._)("div",wn,[(0,s.wy)((0,s._)("input",{class:"custom-select-input",ref:"selectInputRef","onUpdate:modelValue":t[2]||(t[2]=t=>e.selectSearchInput=t),onKeyup:t[3]||(t[3]=(...t)=>e.updateSearchList&&e.updateSearchList(...t))},null,544),[[l.nr,e.selectSearchInput]])]),(0,s._)("div",vn,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.cloneSchedList,((a,i)=>((0,s.wg)(),(0,s.iD)("div",{class:"custom-select-item",ref_for:!0,ref:"selectDropdownRef",key:i,tabindex:i+99,onKeyup:t[4]||(t[4]=(0,l.D2)(((...t)=>e.navDownList&&e.navDownList(...t)),["down"])),onClick:t=>e.chooseSchedule(t,a)},[(0,s._)("div",bn,(0,n.zw)(a.Name),1)],40,Sn)))),128))])],512),e.selectedSchedule&&e.selectedSchedule.Name?((0,s.wg)(),(0,s.iD)("div",kn,[Cn,(0,s._)("div",An,(0,n.zw)(e.selectedSchedule.Description),1),(0,s._)("div",xn,[_n,(0,s._)("span",Tn,(0,n.zw)(e.selectedSchedule.NoOfWeeks),1)])])):(0,s.kq)("",!0),(0,s._)("div",En,[(0,s._)("div",Mn,[Nn,(0,s._)("input",{value:e.$filters.reformatDate(e.schedAllocation.DateFrom),class:"d-inline-flex ma-0 pa-0 mr-2 caption date-input-width date-input",onChange:t[5]||(t[5]=t=>e.updateDateText(t,e.schedAllocation.DateFrom,"DateFrom")),onClick:t[6]||(t[6]=t=>e.updateDateTime(t,e.schedAllocation.DateFrom,"DateFrom")),"onClick:clear":t[7]||(t[7]=t=>e.fromDate=!1)},null,40,Fn),Pn]),(0,s._)("div",On,[Hn,(0,s._)("input",{value:e.$filters.reformatDate(e.schedAllocation.DateTo),class:"d-inline-flex ma-0 pa-0 caption date-input-width date-input",onChange:t[8]||(t[8]=t=>e.updateDateText(t,e.schedAllocation.DateTo,"DateTo")),onClick:t[9]||(t[9]=t=>e.updateDateTime(t,e.schedAllocation.DateTo,"DateTo")),"onClick:clear":t[10]||(t[10]=t=>e.toDateMenu=!1)},null,40,Yn),In])]),(0,s._)("div",Ln,[Wn,(0,s.wy)((0,s._)("textarea",{rows:"3",class:"caption",onKeyup:t[11]||(t[11]=t=>e.hasChanges=!0),"onUpdate:modelValue":t[12]||(t[12]=t=>e.schedAllocation.Comment=t)}," ",544),[[l.nr,e.schedAllocation.Comment]])]),e.schedAllocation.DateFrom?((0,s.wg)(),(0,s.iD)("div",jn,[(0,s._)("label",Rn,"End existing schedules on "+(0,n.zw)(e.capDate),1),(0,s.wy)((0,s._)("input",{type:"checkbox",value:"1","onUpdate:modelValue":t[13]||(t[13]=t=>e.schedAllocation.EndExistingScheds=t)},null,512),[[l.e8,e.schedAllocation.EndExistingScheds]])])):(0,s.kq)("",!0),(0,s._)("div",$n,[(0,s._)("button",{class:"grey vert-mid small",onClick:t[14]||(t[14]=t=>e.closeSchedAllocation())},Un),(0,s._)("button",{class:"green ml-4 small",onClick:t[15]||(t[15]=t=>e.allocateEmployees())},Kn)])])])])],32)])):(0,s.kq)("",!0),e.selectedEmpForDetail?((0,s.wg)(),(0,s.j4)(i,{key:1,ref:"EmployeeScheduleRef",employee:e.selectedEmpForDetail,onClose:e.resetSelectedEmpForDetail},null,8,["employee","onClose"])):(0,s.kq)("",!0),(0,s.Wm)(o,{ref:"DatePickerRef",top:e.dateModalTop,left:e.dateModalLeft},null,8,["top","left"])])])}const Zn=e=>((0,s.dD)("data-v-3708ba95"),e=e(),(0,s.Cn)(),e),Qn={class:"emp-workSched-card pa-4"},Jn={class:"d-flex justify-space-between"},Xn={class:"d-flex justify-end align-center mt-4 caption"},er=Zn((()=>(0,s._)("label",{class:"default-line-height"},"Active Only",-1))),tr={key:0,class:"section-table aff-table mt-2"},ar=Zn((()=>(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Schedule Name"),(0,s._)("th",{class:"text-center"},"Date From"),(0,s._)("th",{class:"text-center"},"Date To")])],-1))),lr=["onClick"],sr={class:"text-center"},ir={class:"text-center"},or={key:1};function nr(e,t){const a=(0,s.up)("emp-schedule-detail");return(0,s.wg)(),(0,s.iD)("div",Qn,[(0,s._)("div",Jn,[(0,s._)("h3",null,(0,n.zw)(e.selectedEmp.EmployeeName)+" ("+(0,n.zw)(e.selectedEmp.EmployeeNo)+")",1),(0,s._)("span",{class:"icon-cross vp-icon",onClick:t[0]||(t[0]=t=>e.closeEmployeeSchedule(!0))})]),(0,s._)("div",Xn,[(0,s.wy)((0,s._)("input",{class:"override-width mr-2",type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=t=>e.activeOnly=t),onChange:t[2]||(t[2]=(...t)=>e.updateActiveOnly&&e.updateActiveOnly(...t)),"true-value":1,"false-value":0},null,544),[[l.e8,e.activeOnly]]),er]),e.empSchedList.length>0?((0,s.wg)(),(0,s.iD)("div",tr,[(0,s._)("table",null,[ar,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.empSchedList,(t=>((0,s.wg)(),(0,s.iD)("tr",{class:(0,n.C_)(t.classObject),onClick:a=>e.selectEmpSchedCheck(t)},[(0,s._)("td",null,(0,n.zw)(t.WorkSchedName),1),(0,s._)("td",sr,(0,n.zw)(e.$filters.reformatDate(t.DateFrom)),1),(0,s._)("td",ir,(0,n.zw)(e.$filters.reformatDate(t.DateTo)),1)],10,lr)))),256))])])])):((0,s.wg)(),(0,s.iD)("div",or," Work schedule empty.")),e.selectedEmpSched?((0,s.wg)(),(0,s.j4)(a,{key:2,ref:"empScheDetailRef",empSched:e.selectedEmpSched,onDeleted:e.deleteSelection,onUpdated:e.updatedEmpSchedule},null,8,["empSched","onDeleted","onUpdated"])):(0,s.kq)("",!0)])}const rr=e=>((0,s.dD)("data-v-44eed558"),e=e(),(0,s.Cn)(),e),dr={key:0,class:"section default-form sched-empSched-form mt-4"},cr=rr((()=>(0,s._)("h3",null,"Schedule Details",-1))),hr={class:"caption mt-2"},ur=rr((()=>(0,s._)("div",{class:"form-label"},"Name",-1))),mr={class:"label-empSched"},pr={class:"caption d-flex mt-4"},yr=rr((()=>(0,s._)("div",{class:"form-label"},"Number of Weeks",-1))),fr={class:"label-empSched"},gr={class:"d-flex justify-space-between"},Dr={class:"caption mt-4"},wr=rr((()=>(0,s._)("div",{class:"date-label"},"Date From",-1))),vr=["value"],Sr={class:"caption mt-4"},br=rr((()=>(0,s._)("div",{class:"date-label"},"Date To",-1))),kr=["value"],Cr={class:"caption mt-4"},Ar=rr((()=>(0,s._)("div",{class:"date-label"},"Notes",-1))),xr={class:"section-table ui-gridbox-scrollable-titles mt-4"},_r={class:"aff-table sched-empSched-table"},Tr=(0,s.uE)('<div class="head-cell" data-v-44eed558>Week</div><div class="head-cell" data-v-44eed558>Day</div><div class="head-cell" data-v-44eed558>Hours</div><div class="head-cell" data-v-44eed558>Start</div><div class="head-cell" data-v-44eed558>Finish</div><div class="head-cell break-column-width" data-v-44eed558>Unpaid Break</div><div class="head-cell" data-v-44eed558>Shift</div>',7),Er=[Tr],Mr={class:"aff-table-body"},Nr={class:"aff-table-body-row"},Fr={class:"aff-table-body-cell"},Pr={class:"aff-table-body-cell"},Or={class:"mr-2 days-width"},Hr={class:"aff-table-body-cell"},Yr={class:"aff-table-body-cell"},Ir={class:"aff-table-body-cell"},Lr={class:"aff-table-body-cell"},Wr={class:"aff-table-body-cell"},jr={class:"schedules-buttons form-row d-flex justify-end mt-4"},Rr=rr((()=>(0,s._)("span",{class:"icon-briefcase mr-1"},null,-1))),$r=rr((()=>(0,s._)("span",null,"Remove",-1))),Br=[Rr,$r],Vr=["disabled"],Ur=rr((()=>(0,s._)("span",{class:"icon-cancel mr-1"},null,-1))),zr=rr((()=>(0,s._)("span",null,"Cancel",-1))),Gr=[Ur,zr],Kr=["disabled"],qr=rr((()=>(0,s._)("span",{class:"icon-save mr-1"},null,-1))),Zr=rr((()=>(0,s._)("span",null,"Update",-1))),Qr=[qr,Zr];function Jr(e,t){const a=(0,s.up)("date-picker");return e.empSchedDetail&&e.empSchedDetail.Detail?((0,s.wg)(),(0,s.iD)("div",dr,[cr,(0,s._)("form",{onSubmit:t[11]||(t[11]=(0,l.iM)(((...t)=>e.submitForm&&e.submitForm(...t)),["prevent"]))},[(0,s._)("div",hr,[ur,(0,s._)("div",mr,(0,n.zw)(e.empSchedDetail.Detail.Name),1)]),(0,s._)("div",pr,[yr,(0,s._)("div",fr,(0,n.zw)(e.empSchedDetail.Detail.NoOfWeeks),1)]),(0,s._)("div",gr,[(0,s._)("div",Dr,[wr,(0,s._)("input",(0,s.dG)({value:e.$filters.reformatDate(e.empSchedDetail.DateFrom)},e.attrs,(0,s.mx)(e.on),{outlined:"",dense:"","hide-details":"",autocomplete:"off",class:"d-inline-flex ma-0 pa-0 mr-2 caption date-input-width date-input","append-icon":"icon-calendar",onChange:t[0]||(t[0]=t=>e.updateDateText(t,e.empSchedDetail.DateFrom)),onClick:t[1]||(t[1]=t=>e.updateDateTime(t,e.empSchedDetail.DateFrom,"DateFrom")),"onClick:clear":t[2]||(t[2]=t=>e.fromDate=!1)}),null,16,vr)]),(0,s._)("div",Sr,[br,(0,s._)("input",(0,s.dG)({value:e.$filters.reformatDate(e.empSchedDetail.DateTo)},e.attrs,(0,s.mx)(e.on),{autocomplete:"off",outlined:"",dense:"","hide-details":"",class:"d-inline-flex ma-0 pa-0 caption date-input-width date-input","append-icon":"icon-calendar",onChange:t[3]||(t[3]=t=>e.updateDateText(t,e.empSchedDetail.DateTo)),onClick:t[4]||(t[4]=t=>e.updateDateTime(t,e.empSchedDetail.DateTo,"DateTo")),"onClick:clear":t[5]||(t[5]=t=>e.toDateMenu=!1)}),null,16,kr)])]),(0,s._)("div",Cr,[Ar,(0,s.wy)((0,s._)("textarea",{class:"caption schedule-textarea",onKeyup:t[6]||(t[6]=t=>e.hasChanges=!0),"hide-details":"",rows:"2",outlined:"",dense:"","onUpdate:modelValue":t[7]||(t[7]=t=>e.empSchedDetail.Comment=t)},"\r\n                ",544),[[l.nr,e.empSchedDetail.Comment]])]),(0,s._)("div",xr,[(0,s._)("div",_r,[(0,s._)("div",{class:(0,n.C_)(["sched-detail-days",{"shift-min-width":e.showMore}])},[(0,s._)("div",{class:(0,n.C_)(["aff-table-head",{"show-shift-column":e.showMore}])},Er,2),(0,s._)("div",Mr,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.empSchedDetail.Detail.Days,(t=>((0,s.wg)(),(0,s.iD)("div",Nr,[(0,s._)("div",Fr,[(0,s.wy)((0,s._)("span",null,(0,n.zw)(t.Week),513),[[l.F8,e.isFirstDayOfWeek(t.DayOfWeek)]])]),(0,s._)("div",Pr,[(0,s._)("span",Or,(0,n.zw)(t.DayNumber+1),1),(0,s._)("span",null,(0,n.zw)(e.getDayOfWeek(t.DayOfWeek)),1)]),(0,s._)("div",Hr,(0,n.zw)(t.Hours),1),(0,s._)("div",Yr,[(0,s._)("span",null,(0,n.zw)(e.$filters.reformatTime(t.StartTime)),1)]),(0,s._)("div",Ir,[(0,s._)("span",null,(0,n.zw)(e.$filters.reformatTime(t.FinishTime)),1)]),(0,s._)("div",Lr,[(0,s._)("span",null,(0,n.zw)(e.$filters.reformatBreakHours(t.BreakHours)),1)]),(0,s._)("div",Wr,[(0,s._)("span",null,(0,n.zw)(t.ShiftId),1)])])))),256))])],2)])]),(0,s._)("div",jr,[(0,s._)("button",{type:"button",class:"white--text small red text-capitalize mr-2",onClick:t[8]||(t[8]=t=>e.RemoveSchedule())},Br),(0,s._)("button",{type:"button",class:"white--text small grey text-capitalize mr-2",disabled:!e.hasChanges,onClick:t[9]||(t[9]=t=>e.cancelChanges())},Gr,8,Vr),(0,s._)("button",{type:"button",class:"white--text small green text-capitalize mr-1",disabled:!e.hasChanges,onClick:t[10]||(t[10]=t=>e.updateEmpSched())},Qr,8,Kr)])],32),(0,s.Wm)(a,{ref:"DatePickerRef",top:e.dateModalTop,left:e.dateModalLeft},null,8,["top","left"])])):(0,s.kq)("",!0)}var Xr=(0,s.aZ)({name:"emp-schedule-detail",props:["empSched"],components:{DatePicker:El},data:function(){return{dateModalTop:null,dateModalLeft:null,datePickerTargetDay:null,dateType:"",empSchedDetail:null,hasChanges:!1,fromDateMenu:!1,toDateMenu:!1,fromDatePickerValue:"",toDatePickerValue:""}},computed:{},mounted:function(){this.$emit("dataChanged",this.hasChanges),this.getEmpSchedDetail()},watch:{["empSched"](e,t){e!=t&&(this.empSchedDetail=null,this.hasChanges=null,this.fromDateMenu=!1,this.toDateMenu=!1,this.getEmpSchedDetail())}},methods:{getEmpSchedDetail(){fl.loading(),se.EmpSchedDetailRequest(this.empSched.EmployeeNo+"/"+this.empSched.Id).then((e=>{if(this.empSchedDetail=e.Data,this.empSchedDetail.Detail){for(var t=0,a=jt()(this.empSchedDetail.Detail.StartDate),l=7*this.empSchedDetail.Detail.NoOfWeeks,s=new Array(l),i=0;i<l;i++)i%7==0&&t++,s[i]={DayNumber:i,DayOfWeek:a.day(),Week:t,Date:jt()(a),Hours:0,BreakHours:null,StartTime:null,FinishTime:null,ShiftId:null},a.add(1,"day");this.empSchedDetail.Detail.Days.map((function(e){e.StartTime&&(s[e.DayNumber].StartTime=jt()(e.StartTime)),e.FinishTime&&(s[e.DayNumber].FinishTime=jt()(e.FinishTime)),s[e.DayNumber].Hours=e.Hours,s[e.DayNumber].ShiftId=e.ShiftId,s[e.DayNumber].BreakHours=e.BreakHours})),this.empSchedDetail.Detail.Days=s,this.empSchedDetail.Detail.StartDate=jt()(this.empSchedDetail.Detail.StartDate),e.Data.DateFrom&&(this.empSchedDetail.DateFrom=jt()(e.Data.DateFrom,"YYYY-MM-DD")),e.Data.DateTo&&(this.empSchedDetail.DateTo=jt()(e.Data.DateTo,"YYYY-MM-DD")),this.datePickerFormattedFromDate(),this.datePickerFormattedToDate()}})).finally((()=>fl.clear()))},submitForm(){return!1},updateDateText(e,t){this.toDateMenu=!1,t.set(jt()(e,"DD/MM/YYYY").toObject()),this.datePickerFormattedFromDate(),this.datePickerFormattedToDate()},datePickerFormattedFromDate(){this.fromDatePickerValue=this.empSchedDetail.DateFrom?jt()(this.empSchedDetail.DateFrom).format("YYYY-MM-DD"):void 0},datePickerFormattedToDate(){this.toDatePickerValue=this.empSchedDetail.DateTo?jt()(this.empSchedDetail.DateTo).format("YYYY-MM-DD"):void 0},fromDateDatePickerHandler(e){"string"===typeof e&&(e=jt()(e)),this.empSchedDetail.DateFrom=e,this.hasChanges=!0,this.datePickerFormattedFromDate()},toDateDatePickerHandler(e){"string"===typeof e&&(e=jt()(e)),this.empSchedDetail.DateTo=e,this.hasChanges=!0,this.datePickerFormattedToDate()},isFirstDayOfWeek:function(e){var t=jt()(this.empSchedDetail.Detail.StartDate);return e==t.day()},getDayOfWeek:function(e){if(e<0||e>6)return"unknown";var t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return t[e]},RemoveSchedule(){fl.checkChange({message:"Are you sure?",onOk:()=>{fl.loading(),se.RemoveEmployeeWorkSchedule(this.empSchedDetail.Id,this.empSched.EmployeeNo).then((e=>{this.$emit("deleted")})).finally((()=>fl.clear()))}})},cancelChanges(){if(!this.hasChanges)return void this.getEmpSchedDetail();let e="There is currently unsaved schedule changes <br /> Do you want to discard your changes?";Hw.emit("dialog",{message:e,showButtons:!0,showCancel:!0,okColor:"orange",onOk:()=>{this.getEmpSchedDetail(),this.hasChanges=!1},onCancel:()=>{}})},updateEmpSched(){var e=jt()(this.empSchedDetail.DateFrom),t=jt()(this.empSchedDetail.DateTo);if(e&&t&&e>t)fl.alert("<br />Date From cannot be before Date To.");else{Hw.emit("dialog",{message:"Updating Employee Schedule",showButtons:!1,showLoader:!0,noClose:!1}),fl.loading();var a={Id:this.empSchedDetail.Id,DateFrom:e?e.format("DD/MMM/YYYY"):null,DateTo:t?t.format("DD/MMM/YYYY"):null,Comment:this.empSchedDetail.Comment};se.UpdateEmpSchedRequest(a,this.empSched.EmployeeNo).then((e=>{fl.clear(),this.$emit("updated")})).catch((e=>{fl.alert(e.message),console.error("err",e)}))}},updateDateTime(e,t,a){let l=e.target.getClientRects()[0];this.dateModalTop=l.bottom,this.dateModalLeft=l.left,this.datePickerTargetDay=t,this.dateType=a,this.openDatePicker()},async openDatePicker(){let e=await this.$refs.DatePickerRef.toggleShow(this.datePickerTargetDay);"DateTo"===this.dateType?this.empSchedDetail.DateTo=e:"DateFrom"===this.dateType&&(this.empSchedDetail.DateFrom=e),this.hasChanges=!0}}});const ed=(0,oe.Z)(Xr,[["render",Jr],["__scopeId","data-v-44eed558"]]);var td=ed,ad=(0,s.aZ)({name:"employeeSchedule",components:{EmpScheduleDetail:td},props:["employee"],data:function(){return{selectedEmp:null,empSchedList:[],activeOnly:!1,selectedEmpSched:null}},setup(e){const t=(0,Al.iH)(e.employee);return{selectedEmp:t}},mounted(){this.selectedEmp=this.employee,this.selectedEmp&&this.selectedEmp.EmployeeNo?this.getEmpWorkScheds():console.error("employee or employee number missing")},watch:{employee(){this.selectedEmp=this.employee,this.selectedEmp&&this.selectedEmp.EmployeeNo?this.getEmpWorkScheds():console.error("employee or employee number missing")}},methods:{selectEmpSchedCheck(e){this.$refs.empScheDetailRef&&this.$refs.empScheDetailRef.hasChanges?fl.checkChange({message:"There are currently Schedule changes <br /> Do you want to discard your changes?",onOk:()=>{this.selectEmpSched(e)}}):this.selectEmpSched(e)},selectEmpSched(e){this.empSchedList.forEach((e=>{e.classObject.selected=!1})),e.classObject.selected=!0,this.selectedEmpSched=e},getEmpWorkScheds(){fl.loading(),se.EmpWorkScheds(this.selectedEmp.EmployeeNo+(this.activeOnly?"?activeOnly=true":"?activeOnly=false")).then((e=>{e.Data.map(((e,t)=>{e.classObject={selected:!1,odd:t%2},e.DateFrom=new Date(Date.parse(e.DateFrom)),e.DateTo&&(e.DateTo=new Date(Date.parse(e.DateTo)))})),this.empSchedList=e.Data,fl.clear()}))},updateActiveOnly(){this.getEmpWorkScheds()},closeEmployeeSchedule(e){e&&this.$refs.empScheDetailRef&&(!this.$refs.empScheDetailRef||this.$refs.empScheDetailRef.hasChanges)?fl.checkChange({message:"There are currently Schedule changes <br /> Do you want to discard your changes?",onOk:()=>{this.closeEmployeeSchedule(!1)}}):this.$emit("close")},deleteSelection(){this.selectedEmpSched=null,this.getEmpWorkScheds()},updatedEmpSchedule(){this.selectedEmpSched=null,this.getEmpWorkScheds()}}});const ld=(0,oe.Z)(ad,[["render",nr],["__scopeId","data-v-3708ba95"]]);var sd=ld;const id=e=>((0,s.dD)("data-v-d14d6750"),e=e(),(0,s.Cn)(),e),od={class:"section shadow sched-card-default pa-4"},nd=id((()=>(0,s._)("h3",null,"Select Employees",-1))),rd={class:"aff-table mt-4"},dd={class:"ui-grid"},cd=["onClick"],hd={class:"name-text-width"},ud={class:"current-schedules-width"},md={class:"schedule-name"},pd={class:"schedule-name"},yd=["onClick"],fd=id((()=>(0,s._)("span",{class:"icon-add-to-list"},null,-1))),gd=[fd],Dd=["onClick"],wd=id((()=>(0,s._)("span",{class:"icon-add-to-list"},null,-1))),vd=[wd],Sd=["onClick"],bd=id((()=>(0,s._)("span",{class:"icon-minus white--text small"},null,-1))),kd=[bd];function Cd(e,t){const a=(0,s.Q2)("tooltip");return(0,s.wg)(),(0,s.iD)("div",od,[nd,(0,s.wy)((0,s._)("input",{class:"mt-2 caption text-field-input","onUpdate:modelValue":t[0]||(t[0]=t=>e.searchTerm=t),"hide-details":"",dense:"",outlined:"",type:"text",placeholder:"Search for employees "},null,512),[[l.nr,e.searchTerm]]),(0,s._)("div",rd,[(0,s._)("table",dd,[(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.empList,(t=>((0,s.wg)(),(0,s.iD)("tr",{class:(0,n.C_)(t.classObject),onClick:a=>e.toggleEmployeeSelect(t)},[(0,s._)("td",null,[(0,s._)("span",hd,(0,n.zw)(t.EmployeeName)+" ("+(0,n.zw)(t.EmployeeNo)+")",1),(0,s._)("span",ud,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.WorkschedNames,(e=>((0,s.wg)(),(0,s.iD)("div",md,(0,n.zw)(e),1)))),256)),(0,s._)("div",pd,(0,n.zw)(t.PersonalSchedule),1)])]),(0,s._)("td",null,[e.isMobileView||t.classObject.selected?(0,s.kq)("",!0):(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{key:0,class:"green white--text fsmall",onClick:(0,l.iM)((a=>e.addEmployee(t)),["stop"])},gd,8,yd)),[[a,{content:"Add to Employee Selection List"},void 0,{right:!0}]]),e.isMobileView&&!t.classObject.selected?((0,s.wg)(),(0,s.iD)("button",{key:1,class:"green white--text fsmall",onClick:(0,l.iM)((a=>e.addEmployee(t)),["stop"])},vd,8,Dd)):(0,s.kq)("",!0),t.classObject.selected?(0,s.wy)(((0,s.wg)(),(0,s.iD)("button",{key:2,class:"grey fsmall",onClick:(0,l.iM)((a=>e.removeEmployee(t)),["stop"])},kd,8,Sd)),[[a,{content:"Remove Employee From Selection List"},void 0,{right:!0}]]):(0,s.kq)("",!0)])],10,cd)))),256))])])])])}var Ad=(0,s.aZ)({name:"SearchEmployee",data:function(){return{searchTerm:"",empList:[],selectedEmpList:[],selectedEmp:null,isMobileView:!1}},mounted(){navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?(console.log("is mobile view true"),this.isMobileView=!0):this.isMobileView=!1,this.getEmployeesList()},watch:{searchTerm:function(e,t){if(t!=e)if(0==e.trim().length)this.empList.forEach((function(e){e.classObject.visible=!0,e.classObject.hidden=!1}));else{var a=e.toLowerCase().trim();this.empList.forEach((e=>{e.classObject.visible=e.EmployeeName&&e.EmployeeName.toLowerCase().indexOf(a)>-1||e.EmployeeNo&&e.EmployeeNo.toString().indexOf(a)>-1,e.classObject.hidden=!e.classObject.visible}))}}},methods:{getEmployeesList(){fl.loading(),se.EmployeesList().then((e=>{e.Data.map(((e,t)=>{e.classObject={visible:!0,hidden:!1,selected:!1,odd:t%2}})),this.empList=e.Data})).finally((()=>{fl.clear()}))},toggleEmployeeSelect:function(e){e.classObject.selected?this.removeEmployee(e):this.addEmployee(e)},removeEmployee:function(e){e.classObject.selected=!1,this.selectedEmpList.splice(this.selectedEmpList.indexOf(e),1),this.$emit("updateSelectedEmpList",this.selectedEmpList)},addEmployee:function(e){e.classObject.selected=!0,this.selectedEmpList.push(e),this.$emit("updateSelectedEmpList",this.selectedEmpList)},clearSelectedEmployeeList:function(){this.selectedEmpList.forEach((e=>{e.classObject.selected=!1})),this.selectedEmpList=[],this.$emit("updateSelectedEmpList",this.selectedEmpList)}}});const xd=(0,oe.Z)(Ad,[["render",Cd],["__scopeId","data-v-d14d6750"]]);var _d=xd,Td=(0,s.aZ)({name:"employeeAllocation",components:{SearchEmployee:_d,EmployeeSchedule:sd,DatePicker:El},data:function(){return{bulkEmpList:[],schedList:[],hasChanges:!1,cloneSchedList:[],selectSearchInput:"",schedAllocation:{WorkschedId:-1,DateFrom:jt()(),DateTo:null,Comment:"",EndExistingScheds:!0},selectedSchedule:{},selectedEmpForDetail:null,startDateMenu:!1,toDateMenu:!1,startDatePickerValue:"",toDatePickerValue:"",datePickerTargetDay:null,dateType:"",isMobileView:!1,dateModalTop:null,dateModalLeft:null}},mounted:function(){this.isMobileView=this.checkIsMobileView(),se.StandardSchedules().then((e=>{this.schedList=e.Data.filter((e=>!1===e.Archive&&0===e.ScheduleType)),this.cloneSchedList=this.schedList.slice()})),this.$watch("schedAllocation",((e,t)=>{e===t&&(this.hasChanges=!0)}),{deep:!0})},computed:{selectedSched(){if(-1===this.schedAllocation.WorkschedId)return!1;let e=this.schedList;return e.find((e=>e.Id===this.schedAllocation.WorkschedId))},capDate:function(){if(!this.schedAllocation.DateFrom)return;let e=this.schedAllocation,t=jt()(e.DateFrom),a=t.subtract(1,"day");return a.format("DD/MM/YYYY")}},methods:{navDownList(){},updateSearchList(e){"ArrowDown"===e.key&&this.$refs.selectDropdownRef.focus(),this.cloneSchedList=this.schedList.filter((e=>e.Name.toLowerCase().indexOf(this.selectSearchInput.toLowerCase())>-1))},updateDateText(e,t,a){this.startDateMenu=!1,this.toDateMenu=!1,t?t.set(jt()(e?.target?.value,"DD/MM/YYYY").toObject()):"DateTo"===a?this.schedAllocation.DateTo=jt()(e?.target?.value,"DD/MM/YYYY"):"DateFrom"===a&&(this.schedAllocation.DateFrom=jt()(e?.target?.value,"DD/MM/YYYY")),this.datePickerFormattedFromDate(),this.datePickerFormattedToDate()},datePickerFormattedFromDate(){this.startDatePickerValue=this.schedAllocation.DateFrom?jt()(this.schedAllocation.DateFrom).format("YYYY-MM-DD"):void 0},datePickerFormattedToDate(){this.toDatePickerValue=this.schedAllocation.DateTo?jt()(this.schedAllocation.DateTo).format("YYYY-MM-DD"):void 0},updateEmpList(e){this.bulkEmpList=e},startDateDatePickerHandler(e){"string"===typeof e&&(e=jt()(e)),this.schedAllocation.DateFrom=e,this.datePickerFormattedFromDate()},toDateDatePickerHandler(e){"string"===typeof e&&(e=jt()(e)),this.schedAllocation.DateTo=e,this.datePickerFormattedToDate()},removeEmployee:function(e){this.$refs.SearchEmployeeRef.removeEmployee(e)},clearSelectedEmployee:function(){this.hasChanges?fl.checkChange({message:"There are currently Schedule Allocation changes <br /> Do you want to discard your changes?",onOk:()=>{this.$refs.SearchEmployeeRef.clearSelectedEmployeeList(),this.resetSchedAllocation()}}):this.$refs.SearchEmployeeRef.clearSelectedEmployeeList()},allocateEmployees:function(){var e="";if((this.selectedSchedule.Id<1||!this.selectedSchedule.Id)&&(e+="<br />Select a schedule that you want to allocate."),this.schedAllocation.DateFrom&&this.schedAllocation.DateTo&&this.schedAllocation.DateFrom.diff(this.schedAllocation.DateTo)>0&&(e+="<br />Date To cannot be before Date From."),""==e){var t={WorkschedId:this.selectedSchedule.Id,EmployeeList:[],DateFrom:jt()(this.schedAllocation.DateFrom)?jt()(this.schedAllocation.DateFrom).format("DD/MMM/YYYY"):null,DateTo:jt()(this.schedAllocation.DateTo)?jt()(this.schedAllocation.DateTo).format("DD/MMM/YYYY"):null,Comment:this.schedAllocation.Comment,EndExistingScheds:this.schedAllocation.EndExistingScheds};this.bulkEmpList.length>0&&this.bulkEmpList.forEach((e=>{t.EmployeeList.push(e.EmployeeNo)})),fl.loading(),se.AllocateSchedule(t).then((e=>{this.hasChanges=!1,this.resetSchedAllocation(),fl.clear(),this.$refs.EmployeeScheduleRef&&this.$refs.EmployeeScheduleRef.getEmpWorkScheds()})).catch((e=>{fl.alert(e.message),console.error("err",e)}))}else fl.alert(e)},closeSchedAllocation:function(){this.hasChanges?fl.checkChange({message:"You have unsaved changes. Are you sure to discard the changes?",onOk:()=>{this.resetSchedAllocation(),this.hasChanges=!1,this.$refs.SearchEmployeeRef.clearSelectedEmployeeList()}}):this.$refs.SearchEmployeeRef.clearSelectedEmployeeList()},showScheduleDetail:function(e){this.selectedEmpForDetail=e},resetSelectedEmpForDetail(){this.selectedEmpForDetail=null},resetSchedAllocation:function(){this.hasChanges=!1,this.schedAllocation={WorkschedId:-1,DateFrom:jt()(),DateTo:null,Comment:"",EndExistingScheds:!0}},checkIsMobileView:function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},chooseSchedule(e,t){e.target.blur(),this.selectedSchedule=t,this.selectSearchInput=this.selectedSchedule.Name;e.target.blur();let a=this.$refs.selectRef;a.blur();let l=this.$refs.selectInputRef;l.blur()},updateDateTime(e,t,a){let l=e.target.getClientRects()[0];this.dateModalTop=l.bottom,this.dateModalLeft=l.left,this.datePickerTargetDay=t,this.dateType=a,this.openDatePicker()},async openDatePicker(){let e=await this.$refs.DatePickerRef.toggleShow(this.datePickerTargetDay);"DateTo"===this.dateType?this.schedAllocation.DateTo=e:"DateFrom"===this.dateType&&(this.schedAllocation.DateFrom=e)},submitForm(){}}});const Ed=(0,oe.Z)(Td,[["render",qn],["__scopeId","data-v-5d3c1829"]]);var Md=Ed;const Nd=e=>((0,s.dD)("data-v-2f764bfc"),e=e(),(0,s.Cn)(),e),Fd={class:"d-flex mt-4 justify-space-between"},Pd=(0,s.uE)('<div class="left-box ml-2" data-v-2f764bfc><div class="background-legend" data-v-2f764bfc><div data-v-2f764bfc><div class="flexi-legend" data-v-2f764bfc></div><div class="legend-label" data-v-2f764bfc>Flexi Schedule</div></div><div class="ml-4" data-v-2f764bfc><div class="team-legend" data-v-2f764bfc></div><div class="legend-label" data-v-2f764bfc>Team Schedule</div></div><div class="ml-4" data-v-2f764bfc><div class="personal-legend" data-v-2f764bfc></div><div class="legend-label" data-v-2f764bfc>Personal Schedule</div></div></div></div>',1),Od={class:"weekDetail d-flex align-center"},Hd={class:"status-section right-box"},Yd={class:"copy2 ml-2 text-capitalize"},Id={class:"d-flex mt-4 justify-space-between align-center"},Ld={class:"d-flex align-center"},Wd={class:"costCenter-wrapper"},jd={key:0},Rd={class:"custom-select",tabindex:"1",ref:"selectRef"},$d=Nd((()=>(0,s._)("span",{class:"inline-block-middle"},"Actions",-1))),Bd={class:"inline-block-middle ml-1",style:{height:"15px"}},Vd={class:"custom-select-items"},Ud={class:"action-buttons"},zd={key:1},Gd={key:0},Kd={class:"custom-select",tabindex:"1",ref:"selectRef"},qd=Nd((()=>(0,s._)("span",{class:"inline-block-middle"},"Actions",-1))),Zd={class:"inline-block-middle ml-1",style:{height:"15px"}},Qd={class:"custom-select-items"},Jd={class:"action-buttons"},Xd={class:"schedules-data-medium mt-4",style:{overflow:"auto"}},ec={class:"flex-sche-table"},tc={class:"table-head"},ac=Nd((()=>(0,s._)("div",{class:"table-cell"},null,-1))),lc=["onClick"],sc={class:"table-body"},ic=["onClick"],oc={key:0,class:"published-icon"},nc=Nd((()=>(0,s._)("span",null,"P",-1))),rc=[nc],dc={class:"content-cell"},cc={class:"content-cell"},hc={class:"schedules-data-medium mt-4"};function uc(e,t){const a=(0,s.up)("Icon"),l=(0,s.up)("flex-schedule-cell-control"),i=(0,s.up)("flex-schedule-column-control"),o=(0,s.up)("flex-schedule-cost-center"),r=(0,s.up)("day-cell"),d=(0,s.up)("perfect-scrollbar"),c=(0,s.up)("printable-view"),h=(0,s.up)("edit-flex-schedule"),u=(0,s.up)("date-picker"),m=(0,s.up)("draft-creation-dialog"),p=(0,s.up)("extra-emp-detail"),y=(0,s.up)("analysis-chart"),f=(0,s.up)("publish-dialog"),g=(0,s.up)("cost-analysis-dialog"),D=(0,s.Q2)("tooltip");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",Fd,[Pd,(0,s._)("div",Od,[(0,s._)("span",{class:"arrow-height mr-4",onClick:t[0]||(t[0]=(...t)=>e.getLastWeek&&e.getLastWeek(...t))},[(0,s.Wm)(a,{icon:e.$icons.chevronLeft,height:"30",style:{color:"#0000008a"}},null,8,["icon"])]),(0,s._)("span",{onClick:t[1]||(t[1]=(...t)=>e.chooseCalendarDate&&e.chooseCalendarDate(...t))},(0,n.zw)(e.$filters.ordinalSuffix(e.dayFocus.week()))+" Week, "+(0,n.zw)(e.dayFocus.format("DD/MM/YYYY")),1),(0,s._)("span",{class:"arrow-height ml-4",onClick:t[2]||(t[2]=(...t)=>e.getNextWeek&&e.getNextWeek(...t))},[(0,s.Wm)(a,{icon:e.$icons.chevronRight,height:"30",style:{color:"#0000008a"}},null,8,["icon"])])]),(0,s._)("div",Hd,[(0,s._)("span",Yd," Status: "+(0,n.zw)(e.getCurrentWeekStatus()),1)])]),(0,s._)("div",Id,[(0,s._)("div",Ld,[(0,s.Wm)(l,{class:"inline-block"}),(0,s.Wm)(i,{class:"inline-block ml-2",onCheckOptions:e.loadColumnWithSetting},null,8,["onCheckOptions"]),(0,s._)("div",Wd,[(0,s.Wm)(o,{class:"ml-2",costCenterOptions:e.costCenterOptions,onSelectOption:e.selectCostCenter},null,8,["costCenterOptions","onSelectOption"])])]),"published"===e.weekStatus?((0,s.wg)(),(0,s.iD)("div",jd,[(0,s._)("div",Rd,[(0,s._)("div",null,[(0,s._)("button",{class:"grey small copy2 white--text action-button-width",onClick:t[3]||(t[3]=(...t)=>e.changeDisplayControl&&e.changeDisplayControl(...t))},[$d,(0,s._)("span",Bd,[(0,s.Wm)(a,{icon:e.$icons.chevronDown,height:"15",style:{color:"#FFFF"}},null,8,["icon"])])])]),(0,s._)("div",Vd,[(0,s._)("div",Ud,[(0,s._)("button",{class:"blue small copy2 mt-2 white--text",onClick:t[4]||(t[4]=(...t)=>e.openAnalysisChart&&e.openAnalysisChart(...t))},"Coverage"),(0,s._)("button",{class:"blue small copy2 mt-2 white--text",onClick:t[5]||(t[5]=(...t)=>e.openCostAnalysis&&e.openCostAnalysis(...t))},"Cost"),(0,s._)("button",{class:"blue small copy2 mt-2 white--text",onClick:t[6]||(t[6]=(...t)=>e.printFlexSchedule&&e.printFlexSchedule(...t))},"Print")])])],512)])):((0,s.wg)(),(0,s.iD)("div",zd,[e.isAdmin?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Gd,[(0,s._)("span",null,[(0,s._)("div",Kd,[(0,s._)("div",null,[(0,s._)("button",{class:"grey small copy2 white--text action-button-width",onClick:t[7]||(t[7]=(...t)=>e.changeDisplayControl&&e.changeDisplayControl(...t))},[qd,(0,s._)("span",Zd,[(0,s.Wm)(a,{icon:e.$icons.chevronDown,height:"15",style:{color:"#FFFF"}},null,8,["icon"])])])]),(0,s._)("div",Qd,[(0,s._)("div",Jd,[e.showCopy()?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"blue small copy2 white--text",onClick:t[8]||(t[8]=(...t)=>e.openDraftDialog&&e.openDraftDialog(...t))},"Copy")):(0,s.kq)("",!0),"draft"===e.weekStatus||"partial"===e.weekStatus?((0,s.wg)(),(0,s.iD)("button",{key:1,class:"blue small copy2 mt-2 white--text",onClick:t[9]||(t[9]=(...t)=>e.selectEmployeeAndPublish&&e.selectEmployeeAndPublish(...t))},"Publish")):(0,s.kq)("",!0),(0,s._)("button",{class:"blue small copy2 mt-2 white--text",onClick:t[10]||(t[10]=(...t)=>e.openAnalysisChart&&e.openAnalysisChart(...t))},"Coverage"),(0,s._)("button",{class:"blue small copy2 mt-2 white--text",onClick:t[11]||(t[11]=(...t)=>e.openCostAnalysis&&e.openCostAnalysis(...t))},"Cost"),(0,s._)("button",{class:"blue small copy2 mt-2 white--text",onClick:t[12]||(t[12]=(...t)=>e.printFlexSchedule&&e.printFlexSchedule(...t))},"Print")])])],512)])]))]))]),(0,s._)("div",Xd,[(0,s._)("div",ec,[(0,s._)("div",tc,[(0,s._)("div",{class:"schedule-head-grid",style:(0,n.j5)(e.getGridTemplateColumnStyle())},[ac,(0,s._)("div",{class:"table-cell",onClick:t[13]||(t[13]=t=>e.hideColumn(1))},"Std Hours"),(0,s._)("div",{class:"table-cell",onClick:t[14]||(t[14]=t=>e.hideColumn(2))},"Net Hours"),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.weekDays,((t,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"table-cell",onClick:t=>e.hideColumn(a+3)},(0,n.zw)(t.day),9,lc)))),256))],4)]),(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s._)("div",sc,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.scheduleWeekMap.keys(),(t=>((0,s.wg)(),(0,s.iD)(s.HY,null,[e.scheduleWeekMap.get(t)&&e.scheduleWeekMap.get(t).show?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"schedules-arr",style:(0,n.j5)(e.getGridTemplateColumnStyle())},[(0,s._)("div",{class:"content-cell content-employee-name",onClick:a=>e.openEmployeeDetail(t)},[(0,s._)("span",null,(0,n.zw)(e.scheduleWeekMap.get(t).employeeName),1),"published"===e.scheduleWeekMap.get(t).empSchePublishState?(0,s.wy)(((0,s.wg)(),(0,s.iD)("span",oc,rc)),[[D,{content:"Schedule for the week is published. "},void 0,{top:!0}]]):(0,s.kq)("",!0)],8,ic),(0,s._)("div",dc,(0,n.zw)(e.scheduleWeekMap.get(t).stdHoursPerWeek?.toFixed(2)),1),(0,s._)("div",cc,(0,n.zw)(e.getTotalHour(e.scheduleWeekMap.get(t).sche)),1),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.scheduleWeekMap.get(t).sche,(a=>((0,s.wg)(),(0,s.iD)("div",{class:"content-cell",style:(0,n.j5)(a.column)},[(0,s.Wm)(r,{scheDay:a,employeeNo:t,employeeName:e.scheduleWeekMap.get(t).employeeName,onOpenEditDialog:e.openEditDialog},null,8,["scheDay","employeeNo","employeeName","onOpenEditDialog"])],4)))),256))],4)):(0,s.kq)("",!0)],64)))),256))])])),_:1})])]),(0,s._)("div",hc,[(0,s.Wm)(c,{scheduleWeek:e.scheduleWeekMap,weekDays:e.weekDays,ref:"PrintableViewRef"},null,8,["scheduleWeek","weekDays"])]),(0,s._)("div",null,[(0,s.Wm)(h,{ref:"EditModalRef",isEdit:e.isEditingDialog,weekStatus:e.weekStatus,modalIndex:1999,onReload:e.reloadAfterEdit},null,8,["isEdit","weekStatus","onReload"]),(0,s.Wm)(u,{ref:"DatePickerRef",top:e.datePickerTop,left:e.datePickerLeft},null,8,["top","left"]),(0,s.Wm)(m,{ref:"DraftCreationDialogRef",modalIndex:1999,onReload:e.reloadAfterEdit},null,8,["onReload"]),(0,s.Wm)(p,{ref:"ExtraEmpDetailRef",externalDetail:e.externalDetail},null,8,["externalDetail"]),(0,s.Wm)(y,{ref:"AnalysisChartRef",modalIndex:1999},null,512),(0,s.Wm)(f,{ref:"PublishDialogRef",onPublish:e.publishCurrentWeek},null,8,["onPublish"]),(0,s.Wm)(g,{ref:"CostAnalysisDialogRef",dayFocus:e.dayFocus},null,8,["dayFocus"])])],64)}const mc=e=>((0,s.dD)("data-v-6b47c0fe"),e=e(),(0,s.Cn)(),e),pc={class:"bold"},yc={key:0},fc={key:1},gc={key:0},Dc={key:1},wc={key:0,class:"mt-2"},vc={key:1,class:"error-area red"},Sc={key:2,class:"error-area red"},bc={class:"edit-form mt-4 copy2"},kc=mc((()=>(0,s._)("label",null,"Date",-1))),Cc=(0,s.Uk)(),Ac=mc((()=>(0,s._)("label",null,"Employee Name",-1))),xc=(0,s.Uk)(),_c=mc((()=>(0,s._)("label",null,"Employee No",-1))),Tc=(0,s.Uk)(),Ec=mc((()=>(0,s._)("label",null,"Position",-1))),Mc={key:0},Nc=mc((()=>(0,s._)("div",{class:"mt-4"},null,-1))),Fc=(0,s.Uk)(),Pc=mc((()=>(0,s._)("div",null,null,-1))),Oc=mc((()=>(0,s._)("label",null,"Start Time",-1))),Hc=mc((()=>(0,s._)("label",null,"Finish Time",-1))),Yc={key:0,class:"two-column orange"},Ic=mc((()=>(0,s._)("div",{class:"mt-4"},null,-1))),Lc=mc((()=>(0,s._)("div",null,null,-1))),Wc=mc((()=>(0,s._)("label",null,"Unpaid Break",-1))),jc={class:"break-parts"},Rc=mc((()=>(0,s._)("span",{class:"font-small"},"Hours",-1))),$c=mc((()=>(0,s._)("div",{class:"break-parts mobile-column ml-2 mr-2"},[(0,s._)("span",null,":")],-1))),Bc={class:"break-parts"},Vc=mc((()=>(0,s._)("span",{class:"font-small"},"Minutes",-1))),Uc=mc((()=>(0,s._)("label",null,"Net Hours",-1))),zc=mc((()=>(0,s._)("label",null,"Shift ID",-1))),Gc={class:"mt-4 full-width d-flex justify-space-between"},Kc=mc((()=>(0,s._)("div",null,null,-1))),qc=mc((()=>(0,s._)("span",{class:"white"},"Save",-1))),Zc=[qc],Qc=mc((()=>(0,s._)("span",{class:"white"},"Delete",-1))),Jc=[Qc],Xc=mc((()=>(0,s._)("span",{class:"white"},"Create",-1))),eh=[Xc],th=mc((()=>(0,s._)("span",{class:"white"},"Cancel",-1))),ah=[th];function lh(e,t){const a=(0,s.up)("custom-select"),i=(0,s.up)("Modal");return(0,s.wg)(),(0,s.j4)(i,{ref:"ModalRef"},{header:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s._)("h2",pc,[e.isEdit?((0,s.wg)(),(0,s.iD)("span",yc,"Edit Schedule")):((0,s.wg)(),(0,s.iD)("span",fc,["published"===e.weekStatus?((0,s.wg)(),(0,s.iD)("span",gc,"Create Schedule")):((0,s.wg)(),(0,s.iD)("span",Dc,"Create Schedule"))]))])])])),body:(0,s.w5)((()=>[(0,s._)("div",null,["Team"===e.day.scheduleType?((0,s.wg)(),(0,s.iD)("div",wc," This schedule is generated from team schedule. ")):(0,s.kq)("",!0),e.showTimeHourError?((0,s.wg)(),(0,s.iD)("div",vc,"The value for Hours Unpaid Break field must be a whole number. Use Minutes field for breaks that last partial hours.")):(0,s.kq)("",!0),e.showTimeMinuteError?((0,s.wg)(),(0,s.iD)("div",Sc,"The value for Minutes Unpaid Break field must be a whole number.")):(0,s.kq)("",!0),(0,s._)("div",bc,[kc,Cc,(0,s._)("span",null,(0,n.zw)(e.dialogDate),1),Ac,xc,(0,s._)("span",null,(0,n.zw)(e.employeeDetail.employeeName),1),_c,Tc,(0,s._)("span",null,(0,n.zw)(e.employeeDetail.employeeNo),1),Ec,(0,s._)("div",null,[e.positionOptions&&1===e.positionOptions.length?((0,s.wg)(),(0,s.iD)("span",Mc,(0,n.zw)(e.positionOptions[0].positionTitle),1)):e.positionOptions&&e.positionOptions.length>1?((0,s.wg)(),(0,s.j4)(a,{key:1,options:e.positionOptions,displayKey:"positionTitle",selected:e.selectedPosition,onSelectOption:e.selectPositionCustom},null,8,["options","selected","onSelectOption"])):(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:2,"onUpdate:modelValue":t[0]||(t[0]=t=>e.day.position=t)},null,512)),[[l.nr,e.day.position]])]),Nc,Fc,Pc,Oc,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.day.startTime=t),onChange:t[2]||(t[2]=t=>e.updateStartTime(e.day))},null,544),[[l.nr,e.day.startTime]]),Hc,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.day.endTime=t),onChange:t[4]||(t[4]=t=>e.updateEndTime(e.day))},null,544),[[l.nr,e.day.endTime]]),e.showUnAvaError?((0,s.wg)(),(0,s.iD)("span",Yc,"Note: This schedule's time overlaps with this person's unavailability time.")):(0,s.kq)("",!0),Ic,Lc,Wc,(0,s._)("div",null,[(0,s._)("div",jc,[(0,s.wy)((0,s._)("input",{type:"number",step:"any","onUpdate:modelValue":t[5]||(t[5]=t=>e.breakHours=t),onChange:t[6]||(t[6]=(...t)=>e.calcBreakHour&&e.calcBreakHour(...t)),onKeydown:t[7]||(t[7]=t=>e.breakValidation(t))},null,544),[[l.nr,e.breakHours,void 0,{lazy:!0}]]),Rc]),$c,(0,s._)("div",Bc,[(0,s.wy)((0,s._)("input",{type:"number",step:"any","onUpdate:modelValue":t[8]||(t[8]=t=>e.breakMinutes=t),onChange:t[9]||(t[9]=(...t)=>e.calcBreakHour&&e.calcBreakHour(...t)),onKeydown:t[10]||(t[10]=t=>e.breakValidation(t))},null,544),[[l.nr,e.breakMinutes,void 0,{lazy:!0}]]),Vc])]),Uc,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[11]||(t[11]=t=>e.fixedHours=t)},null,512),[[l.nr,e.fixedHours,void 0,{lazy:!0}]]),zc,(0,s._)("div",null,[e.shiftOptions&&e.shiftOptions.length>0?((0,s.wg)(),(0,s.j4)(a,{key:0,options:e.shiftOptions,displayKey:"description",selected:e.selectedShift,onSelectOption:e.selectShift},null,8,["options","selected","onSelectOption"])):(0,s.kq)("",!0)])])])])),footer:(0,s.w5)((()=>[(0,s._)("div",Gc,[Kc,(0,s._)("div",null,[e.isEdit?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"blue normal copy2",onClick:t[12]||(t[12]=t=>e.updateSche())},Zc)):(0,s.kq)("",!0),e.isEdit&&e.allowDelete()?((0,s.wg)(),(0,s.iD)("button",{key:1,class:"grey normal copy2 ml-2",onClick:t[13]||(t[13]=t=>e.confirmIfDeleteSche())},Jc)):(0,s.kq)("",!0),e.isEdit?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:2,class:"blue normal copy2",onClick:t[14]||(t[14]=t=>e.createSche())},eh)),(0,s._)("button",{class:"ml-2 normal orange copy2",onClick:t[15]||(t[15]=t=>e.cancel())},ah)])])])),_:1},512)}function sh(e,t){return window.innerWidth<1010?e.format("DD/MM/YYYY"):e.day(t).format("DD/MM/YYYY")}function ih(e,t){return window.innerWidth<1010?e.format("MM/DD/YYYY"):e.day(t).format("MM/DD/YYYY")}var oh=(0,s.aZ)({name:"EditFlexSchedule",components:{Modal:xe,CustomSelect:qi},props:{isEdit:{type:Boolean},weekStatus:{type:String}},data(){return{day:{},unAvailability:null,selectedPosition:{},selectedShift:{},selectedCostElement1:{},selectedCostElement2:{},employeeDetail:{},dialogDate:"",showUnAvaError:!1,showTimeHourError:!1,showTimeMinuteError:!1,breakHours:null,breakMinutes:null}},setup(){const e=(0,Yt.oR)();return{shiftOptions:(0,s.Fl)((()=>{let t={shiftType:"",description:"",isDefault:null,archive:"F"},a=e.state.LookUp.shifts.slice();return a.unshift(t),a})),costElementOptions:(0,s.Fl)((()=>e.state.LookUp.costElements))}},computed:{positionOptions(){let e=this.$store.state.LookUp.positions;return 1===e.length&&(this.selectedPosition=e[0]),e},fixedHours:{get(){return this.day.hours?this.day.hours.toFixed(2):""},set(e){this.day.hours=Number(e)}},fixedBreakLength:{get(){return this.day.breakLength?this.day.breakLength.toFixed(2):""},set(e){this.day.breakLength=Number(e)}}},mounted(){this.$store;this.day=this.$store.state.FlexSchedule.flexScheduleDay},methods:{selectCostElement1(e){this.selectedCostElement1=e},selectCostElement2(e){this.selectedCostElement2=e},selectShift(e){this.selectedShift=e},selectPositionCustom(e){this.selectedPosition=e},selectPosition(e,t){this.selectedPosition=t,e.target.blur();let a=this.$refs.selectRef;a.blur()},updateStartTime(e){if(!e.startTime)return;let t;t=e.startTime.includes(":")?jt()(e.startTime,"HH:mm"):jt()(e.startTime,"Hmm"),t.isValid()?(e.startTime=t.format("HH:mm"),this.calcNetHour()):e.startTime="Invalid Time"},updateEndTime(e){if(!e.endTime)return;let t;t=e.endTime.includes(":")?jt()(e.endTime,"HH:mm"):jt()(e.endTime,"Hmm"),t.isValid()?(e.endTime=t.format("HH:mm"),this.calcNetHour()):e.endTime="Invalid Time"},breakValidation(e){e.key.match(/[-]/)&&e.preventDefault()},checkBreakHours(){if(this.day.breakLength){let e=this.day.breakLength,t=Math.floor(e),a=e-t;0!==t&&(this.breakHours=t),a>0&&(this.breakMinutes=Math.round(60*a))}},calcBreakHour(){this.breakHours&&this.breakMinutes?this.day.breakLength=Number(this.breakHours)+Math.round(Number(this.breakMinutes)/60*1e3)/1e3:this.breakHours?this.day.breakLength=Number(this.breakHours):this.breakMinutes?this.day.breakLength=Math.round(Number(this.breakMinutes)/60*1e3)/1e3:(0===this.breakHours&&this.breakMinutes,this.day.breakLength=0),this.calcNetHour()},calcNetHour(){if("Invalid Time"===this.day.startTime||"Invalid Time"===this.day.endTime)return;if(!this.day.startTime||!this.day.endTime)return;let e=jt()(this.day.startTime,"H:mm"),t=jt()(this.day.endTime,"H:mm"),a=t.diff(e,"hours",!0);a<=0&&(a=t.add(1,"day").diff(e,"hours",!0));let l=Math.round(100*a)/100;this.day.breakLength?this.day.hours=l-this.day.breakLength:this.day.hours=l,this.checkUnavailability()},checkUnavailability(){if(this.showUnAvaError=!1,!this.day.startTime||!this.day.endTime)return;if(!this.unAvailability||!this.unAvailability.endTime||!this.unAvailability.startTime)return;const e=jt()(this.day.startTime,"HH:mm"),t=jt()(this.day.endTime,"HH:mm"),a=jt()(this.unAvailability.startTime,"HH:mm"),l=jt()(this.unAvailability.endTime,"HH:mm");e<=l&&t>=a&&(console.log("show error"),this.showUnAvaError=!0)},clearForm(){this.$store.commit(Bt.clearForm),this.showUnAvaError=!1,this.showTimeHourError=!1,this.showTimeMinuteError=!1},cancel(){this.$store.commit(Bt.clearForm),this.showUnAvaError=!1,this.showTimeHourError=!1,this.showTimeMinuteError=!1,this.toggleShow()},getPublishStateBaseOnEmp(){if(qt())return"draft";const e=this.$store.state.FlexSchedule.selectedFlexDay.employeeNo,t=this.$store.state.FlexSchedule.scheduleWeek.get(e).empSchePublishState;return"published"===t?"published":"draft"},validateForm(){return this.showTimeHourError=!1,this.showTimeMinuteError=!1,this.breakHours&&this.breakHours.toString().indexOf(".")>-1?(this.showTimeHourError=!0,!1):!(this.breakMinutes&&this.breakMinutes.toString().indexOf(".")>-1)||(this.showTimeMinuteError=!0,!1)},updateSche(){if(!this.validateForm())return;const e=this.$store.state.FlexSchedule.calendarFocusDate.day(this.$store.state.FlexSchedule.selectedFlexDay.dayInWeek).format("MM/DD/YYYY"),[t,a]=this.getStartAndEndTimeWithDate(e,this.day.startTime,this.day.endTime);fl.loading();let l={Id:this.$store.state.FlexSchedule.selectedFlexDay.id,EmployeeNo:this.$store.state.FlexSchedule.selectedFlexDay.employeeNo,Date:e,StartTime:t,EndTime:a,Hours:this.day.hours,PublishStatus:this.$store.state.FlexSchedule.selectedFlexDay.publishStatus?this.$store.state.FlexSchedule.selectedFlexDay.publishStatus:this.getPublishStateBaseOnEmp(),ScheduleType:"Flex",ScheduleData:{ShiftId:this.selectedShift.shiftType,BreakLength:this.day.breakLength,Position:this.selectedPosition.positionCode,CostElement1:this.selectedCostElement1?this.selectedCostElement1.id:void 0,CostElement2:this.selectedCostElement1?this.selectedCostElement2.id:void 0}};se.PatchFlexSchedule([l]).then((e=>{this.$emit("reload"),fl.clear()}),(()=>{fl.clear(),fl.alert("Something went wrong. Update Schedule failed")})),this.$store.commit(Bt.saveScheduleDayToWeek),this.toggleShow()},createSche(){if(!this.validateForm())return;const e=ih(this.$store.state.FlexSchedule.calendarFocusDate,this.$store.state.FlexSchedule.selectedFlexDay.dayInWeek),[t,a]=this.getStartAndEndTimeWithDate(e,this.day.startTime,this.day.endTime);fl.loading();let l=[{EmployeeNo:this.$store.state.FlexSchedule.selectedFlexDay.employeeNo,Date:e,StartTime:t,EndTime:a,Hours:this.day.hours,PublishStatus:this.$store.state.FlexSchedule.selectedFlexDay.publishStatus?this.$store.state.FlexSchedule.selectedFlexDay.publishStatus:this.getPublishStateBaseOnEmp(),ScheduleType:"Flex",ScheduleData:{ShiftId:this.selectedShift.shiftType?this.selectedShift.shiftType:"",BreakLength:this.day.breakLength,Position:this.selectedPosition.positionCode,CostElement1:this.selectedCostElement1?this.selectedCostElement1.id:"",CostElement2:this.selectedCostElement2?this.selectedCostElement2.id:""}}];se.CreateFlexSchedule(l).then((e=>{if(e.Error)throw e;this.$store.commit(Bt.saveScheduleDayToWeek),fl.clear(),this.toggleShow(),this.$emit("reload")})).catch((e=>{fl.clear(),e.Error?fl.alert(e.Error):fl.alert("Something went wrong. Create Schedule failed")}))},allowDelete(){return 0!==this.$store.state.FlexSchedule.selectedFlexDay.id},confirmIfDeleteSche(){this.$store.state.FlexSchedule.selectedFlexDay.id?fl.confirmOrCancel({message:"Are you sure you want to delete this schedule?"}).then((()=>{this.deleteSche(this.$store.state.FlexSchedule.selectedFlexDay.id)})):fl.alert("This record cannot be deleted yet, as it is too far away from today's date.")},deleteSche(e){fl.loading();const t=ih(this.$store.state.FlexSchedule.calendarFocusDate,this.$store.state.FlexSchedule.selectedFlexDay.dayInWeek),[a,l]=this.getStartAndEndTimeWithDate(t,this.day.startTime,this.day.endTime);let s={Id:this.$store.state.FlexSchedule.selectedFlexDay.id,EmployeeNo:this.$store.state.FlexSchedule.selectedFlexDay.employeeNo,Date:t,StartTime:a,EndTime:l,Hours:this.day.hours,PublishStatus:this.$store.state.FlexSchedule.selectedFlexDay.publishStatus?this.$store.state.FlexSchedule.selectedFlexDay.publishStatus:"draft",ScheduleData:{ShiftId:this.selectedShift.shiftType,BreakLength:this.day.breakLength,Position:this.selectedPosition.positionCode,CostElement1:this.selectedCostElement1?this.selectedCostElement1.id:void 0,CostElement2:this.selectedCostElement1?this.selectedCostElement2.id:void 0}};se.DeleteFlexSchedule(s).then((e=>{this.$emit("reload"),this.toggleShow()}),(e=>{fl.alert("Something went wrong. Delete Schedule failed")})).finally((()=>{}))},getStartAndEndTimeWithDate(e,t,a){if(!t&&a){const t=jt()(e),l=jt()(a,"HH:mm"),s=t.clone().hours(l.hour()).minutes(l.minutes());return[null,s]}if(t&&!a){const a=jt()(e),l=jt()(t,"HH:mm"),s=a.clone().hours(l.hour()).minutes(l.minutes());return[s,null]}if(t||a){const l=jt()(e),s=jt()(t,"HH:mm"),i=jt()(a,"HH:mm"),o=l.clone().hours(s.hour()).minutes(s.minutes()),n=l.clone().hours(i.hour()).minutes(i.minutes());let r=n.diff(o,"hours",!0);return r<=0&&n.add(1,"day"),[o.format("YYYY-MM-DDTHH:mm:ss"),n.format("YYYY-MM-DDTHH:mm:ss")]}return[null,null]},openEdit(){let e;this.breakMinutes=null,this.breakHours=null,this.$store.state.FlexSchedule.selectedFlexDay.ScheduleData&&(e=this.shiftOptions.find((e=>e.shiftType===this.$store.state.FlexSchedule.selectedFlexDay.ScheduleData.ShiftId))),e&&(this.selectedShift=e),this.$store.state.FlexSchedule.selectedFlexDay.ScheduleData&&(this.selectedCostElement1=this.costElementOptions.find((e=>e.id===this.$store.state.FlexSchedule.selectedFlexDay.ScheduleData.CostElement1)),this.selectedCostElement2=this.costElementOptions.find((e=>e.id===this.$store.state.FlexSchedule.selectedFlexDay.ScheduleData.CostElement2))),this.employeeDetail={employeeName:this.$store.state.FlexSchedule.selectedFlexDay.employeeName,employeeNo:this.$store.state.FlexSchedule.selectedFlexDay.employeeNo},this.dialogDate=sh(this.$store.state.FlexSchedule.calendarFocusDate,this.$store.state.FlexSchedule.selectedFlexDay.dayInWeek),this.day=this.$store.state.FlexSchedule.flexScheduleDay,this.unAvailability=this.$store.state.FlexSchedule.selectedFlexDay?.unAvailability,this.checkUnavailability(),this.checkBreakHours(),this.$refs.ModalRef.toggleShow()},toggleShow(){this.$refs.ModalRef.toggleShow()}}});const nh=(0,oe.Z)(oh,[["render",lh],["__scopeId","data-v-6b47c0fe"]]);var rh=nh;const dh=e=>((0,s.dD)("data-v-38c36867"),e=e(),(0,s.Cn)(),e),ch={class:"day-info"},hh=dh((()=>(0,s._)("span",{class:"white"},"Create",-1))),uh=[hh],mh={key:1},ph={class:"full-width"},yh={key:0},fh={key:1},gh={key:2},Dh={key:3},wh={key:4},vh=dh((()=>(0,s._)("div",null,"Position:",-1))),Sh=dh((()=>(0,s._)("span",{class:"white caption"},"Edit",-1))),bh=[Sh],kh={key:2,class:"leave-unit mt-2"},Ch={key:0},Ah={key:1},xh={key:3,class:"leave-unit mt-2"},_h=dh((()=>(0,s._)("div",null,"Unavailable",-1)));function Th(e,t,a,i,o,r){return(0,s.wg)(),(0,s.iD)("div",ch,[(0,s._)("div",{class:(0,n.C_)(["display-day",{"team-color-bg":"Team"===e.scheDay.scheduleType,"flexi-color-bg":"Flex"===e.scheDay.scheduleType,"personal-color-bg":"Personal"===e.scheDay.scheduleType}]),onClick:t[2]||(t[2]=(0,l.iM)(((...t)=>e.clickDayCell&&e.clickDayCell(...t)),["prevent"]))},[e.scheDay.startTime||e.scheDay.endTime||e.scheDay.hours||!e.scheDay.allowCreateOrEdit||!e.checkMobileShowCreate()?e.scheDay.startTime||e.scheDay.endTime||e.scheDay.hours?((0,s.wg)(),(0,s.iD)("div",mh,[(0,s._)("div",ph,[e.scheDay.startTime||e.scheDay.endTime?((0,s.wg)(),(0,s.iD)("div",yh,[(0,s._)("div",null,(0,n.zw)(e.scheDay.startTime)+" - "+(0,n.zw)(e.scheDay.endTime),1)])):(0,s.kq)("",!0),e.shouldDisplayHours(e.scheDay)?((0,s.wg)(),(0,s.iD)("div",fh,[(0,s._)("div",null,"Net Hours: "+(0,n.zw)(Math.round(100*e.scheDay.hours)/100),1)])):(0,s.kq)("",!0),e.cellSettings.showBreakLength.value&&e.scheDay.breakLength?((0,s.wg)(),(0,s.iD)("div",gh,[(0,s._)("div",null,"Break Length: "+(0,n.zw)(Math.round(100*e.scheDay.breakLength)/100),1)])):(0,s.kq)("",!0),e.cellSettings.showShiftId.value&&e.scheDay.shiftId?((0,s.wg)(),(0,s.iD)("div",Dh,[(0,s._)("div",null,"Shift ID: "+(0,n.zw)(e.scheDay.shiftId),1)])):(0,s.kq)("",!0),e.cellSettings.showPosition.value&&e.scheDay.positionTitle?((0,s.wg)(),(0,s.iD)("div",wh,[vh,(0,s._)("div",null,(0,n.zw)(e.scheDay.positionTitle),1)])):(0,s.kq)("",!0)]),e.scheDay.allowCreateOrEdit&&!e.scheDay.isPaid&&e.checkMobileShowEdit()?((0,s.wg)(),(0,s.iD)("button",{key:0,class:(0,n.C_)(["detail-button blue small mt-2",{"detail-button-auto-hide":!e.isMobileG()}]),onClick:t[1]||(t[1]=t=>e.moreDetail(e.scheDay))},bh,2)):(0,s.kq)("",!0)])):(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",{key:0,class:(0,n.C_)(["create-day",{"create-day-show":!e.isMobileG()}])},[(0,s._)("button",{class:"blue small",onClick:t[0]||(t[0]=t=>e.createSche(e.scheDay))},uh)],2)),e.scheDay.leaveUnit?((0,s.wg)(),(0,s.iD)("div",kh,["D"===e.scheDay.leaveUnit.calcUnit?((0,s.wg)(),(0,s.iD)("span",Ch,"Leave: "+(0,n.zw)(e.scheDay.leaveUnit.daysAppliedFor)+" day",1)):((0,s.wg)(),(0,s.iD)("span",Ah,"Leave: "+(0,n.zw)(e.scheDay.leaveUnit.hoursAppliedFor)+" hours",1))])):(0,s.kq)("",!0),e.scheDay.unAvailability?((0,s.wg)(),(0,s.iD)("div",xh,[_h,(0,s._)("span",null,(0,n.zw)(e.scheDay.unAvailability.startTime)+" - "+(0,n.zw)(e.scheDay.unAvailability.endTime),1),(0,s._)("div",null,(0,n.zw)(e.scheDay.unAvailability.reason),1)])):(0,s.kq)("",!0)],2)])}var Eh,Mh;(function(e){e["setShifts"]="SET_SHIFTS",e["setPosition"]="SET_POSITION",e["setCostElements"]="SET_COST_ELEMENTS",e["setWorkTypes"]="SET_WORK_TYPES",e["setCostCenters"]="SET_COST_CENTER"})(Eh||(Eh={})),function(e){e["getPositions"]="GET_POSITIONS",e["getShifts"]="GET_SHIFTS",e["getCostElement"]="GET_COST_ELEMENT",e["getWorkTypes"]="GET_WORK_TYPES",e["getCostCenters"]="GET_COST_CENTER"}(Mh||(Mh={}));const Nh={[Eh.setShifts](e,t){e.shifts=t},[Eh.setPosition](e,t){e.positions=t},[Eh.setCostElements](e,t){e.costElements=t},[Eh.setWorkTypes](e,t){e.workTypes=t},[Eh.setCostCenters](e,t){e.costCenters=t}},Fh={[Mh.getPositions]({commit:e},t){se.GetPosition(t).then((t=>{let a=t.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));e(Eh.setPosition,a)}))},[Mh.getShifts]({commit:e}){se.ShiftTypes().then((t=>{let a=t.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));e(Eh.setShifts,a)}))},[Mh.getCostElement]({commit:e}){se.GetCostelements().then((t=>{let a=t.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));e(Eh.setCostElements,a)}))},[Mh.getWorkTypes]({commit:e}){se.GetWorkTypes().then((t=>{let a=t.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));a.map((e=>{e.isSelected=!1})),e(Eh.setWorkTypes,a)}))},[Mh.getCostCenters]({commit:e},t){return se.GetEmployeesCostCentres(t).then((t=>{let a=t.data.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));return e(Eh.setCostCenters,a),a}))}},Ph={state:{shifts:[],positions:[],costElements:[],workTypes:[],costCenters:[]},mutations:Nh,actions:Fh};var Oh=Ph,Hh=(0,s.aZ)({name:"DayCell",props:{scheDay:{type:Object},employeeNo:{type:Number},employeeName:{type:String}},data(){return{mobileShowCreate:!1,mobileShowEdit:!1}},setup(){const e=(0,Yt.oR)(),t=e.state.FlexSchedule.flexScheduleCellSetting,a=(0,s.Fl)((()=>e.state.LookUp.shifts)),l=(0,s.Fl)((()=>e.state.LookUp.positions));return{cellSettings:t,shiftOptions:a,positionOptions:l,selectedShift:(0,s.Fl)((e=>a.value.find((t=>t.shiftType===e))))}},methods:{moreDetail(e){this.$store.dispatch(Mh.getPositions,this.employeeNo);const t=this.$store.state.FlexSchedule.flexScheduleRemoteData.find((t=>t.date===e.date&&t.employeeNo===this.employeeNo));t?(this.$store.commit(Bt.setScheduleDay,t),this.$emit("openEditDialog",!0)):console.error("can not find selected schedule")},createSche(e){this.$store.dispatch(Mh.getPositions,this.employeeNo);let t=Lt().clone(e);t.employeeNo=this.employeeNo,t.employeeName=this.employeeName,this.$store.commit(Bt.createNewScheduleDay,t),this.$emit("openEditDialog",!1)},shouldDisplayHours(e){return!!this.cellSettings.showHours.value&&(!(!e.startTime&&!e.endTime||0!==e.hours)||!!e.hours)},isMobileG(){return qt()},clickDayCell(){this.mobileShowCreate=!this.mobileShowCreate,this.mobileShowEdit=!this.mobileShowEdit},checkMobileShowEdit(){return!qt()||this.mobileShowEdit},checkMobileShowCreate(){return!qt()||this.mobileShowCreate}}});const Yh=(0,oe.Z)(Hh,[["render",Th],["__scopeId","data-v-38c36867"]]);var Ih=Yh;const Lh=e=>((0,s.dD)("data-v-4c3c35d4"),e=e(),(0,s.Cn)(),e),Wh={class:"cell-config-list"},jh={class:"custom-select",tabindex:"1"},Rh=Lh((()=>(0,s._)("div",{class:"custom-select-selected"}," Show/Hide Details ",-1))),$h={class:"custom-select-items"},Bh=["onClick"],Vh={class:"cell-config"},Uh=["onUpdate:modelValue"];function zh(e,t,a,i,o,r){return(0,s.wg)(),(0,s.iD)("div",Wh,[(0,s._)("div",jh,[Rh,(0,s._)("div",$h,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.cellSettings,((a,i)=>((0,s.wg)(),(0,s.iD)("div",{class:"custom-select-item",key:i,onClick:t=>{e.checkOptions(a)}},[(0,s._)("div",Vh,[(0,s._)("label",null,(0,n.zw)(a.name),1),(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":e=>a.value=e,onChange:t[0]||(t[0]=(...t)=>e.optionChanged&&e.optionChanged(...t))},null,40,Uh),[[l.e8,a.value]])])],8,Bh)))),128))])])])}var Gh=(0,s.aZ)({name:"FlexScheduleCellControl",setup(){const e=(0,Yt.oR)(),t=(0,Al.iH)(!1),a=(0,Al.iH)([]),l=e.state.FlexSchedule.flexScheduleCellSetting;return{open:t,cellSettings:l,optionSelected:a}},methods:{optionChanged(){localStorage.setItem("flexScheduleCellSetting",JSON.stringify(this.cellSettings))},checkOptions(e){}}});const Kh=(0,oe.Z)(Gh,[["render",zh],["__scopeId","data-v-4c3c35d4"]]);var qh=Kh;const Zh=(0,s._)("div",{class:"heading"},null,-1),Qh={class:"content"},Jh={class:"clock-frame"},Xh={ref:"clockRef",width:"200",height:"200",style:{"background-color":"white"}},eu=(0,s._)("div",{class:"controls"},null,-1);function tu(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("div",null,[Zh,(0,s._)("div",Qh,[(0,s._)("div",Jh,[(0,s._)("canvas",Xh,null,512)]),eu])])}var au=(0,s.aZ)({name:"TimePicker",setup(){const e=(0,Al.iH)([]),t=(0,Al.iH)([]),a=(0,Al.iH)(null);for(let l=0;l<12;l++)e.value.push(l);for(let l=0;l<=55;l+=5)t.value.push(l);return(0,s.bv)((()=>{let e=a.value,t=e.getContext("2d"),l=e.height/2;function s(){t.arc(0,0,l,0,2*Math.PI),t.fillStyle="lightGrey",t.fill(),i(t,l),o(t,l),n(t,l)}function i(e,t){e.beginPath(),e.arc(0,0,5,0,2*Math.PI),e.fillStyle="#333",e.fill()}function o(e,t){let a;e.font="18px arial",e.textBaseline="middle",e.textAlign="center";for(let l=1;l<13;l++)a=l*Math.PI/6,e.rotate(a),e.translate(0,.85*-t),e.rotate(-a),e.fillText(l.toString(),0,0),e.rotate(a),e.translate(0,.85*t),e.rotate(-a)}function n(e,t){new Date;var a=5,l=15;a%=12,a=a*Math.PI/6,r(e,a,.5*t,5),l=l*Math.PI/30,r(e,l,.7*t,3)}function r(e,t,a,l){e.beginPath(),e.lineWidth=l,e.lineCap="round",e.moveTo(0,0),e.rotate(t),e.lineTo(0,-a),e.stroke(),e.rotate(-t)}t.translate(l,l),l*=.9,s()})),{clockHours:e,clockMinutes:t,clockRef:a}}});const lu=(0,oe.Z)(au,[["render",tu]]);var su=lu,iu=a(6860);const ou=e=>((0,s.dD)("data-v-42d9f14e"),e=e(),(0,s.Cn)(),e),nu=ou((()=>(0,s._)("div",null,[(0,s._)("h2",null,[(0,s._)("b",null,"Create Draft Schedule")])],-1))),ru=ou((()=>(0,s._)("div",{class:"line-break my-4"},null,-1))),du={class:"d-flex align-center"},cu=(0,s.Uk)("Copy from Flexi Schedules"),hu=[cu],uu={class:"mt-2 draft-option pa-2"},mu={key:0,class:"grey-wrapper"},pu={class:"input-label"},yu=(0,s.Uk)("From Date"),fu=[yu],gu={class:"mt-2"},Du={class:"input-label"},wu=(0,s.Uk)("Number of Days"),vu=[wu],Su={key:0,class:"mt-1"},bu=ou((()=>(0,s._)("span",{class:"red"},"Number of days cannot be greater than 14",-1))),ku=[bu],Cu={class:"mt-2"},Au={class:"input-label"},xu=(0,s.Uk)("Start On"),_u=[xu],Tu=ou((()=>(0,s._)("div",{class:"line-break my-4"},null,-1))),Eu={class:"d-flex"},Mu={class:"container-half"},Nu=ou((()=>(0,s._)("div",null," Paste Options ",-1))),Fu={class:"px-2 mt-4"},Pu={class:"d-flex align-center"},Ou=(0,s.Uk)("Replace All"),Hu=[Ou],Yu={class:"d-flex align-center mt-2"},Iu=(0,s.Uk)("Merge"),Lu=[Iu],Wu={class:"container-half"},ju=ou((()=>(0,s._)("label",null,"Exclude Worker Type",-1))),Ru=ou((()=>(0,s._)("div",{class:"line-break my-4"},null,-1))),$u={class:"d-flex"},Bu=(0,s.Uk)("Override Team and Personal Schedules"),Vu=[Bu],Uu={class:"d-flex justify-end full-width mt-4"};function zu(e,t){const a=(0,s.up)("multi-select"),i=(0,s.up)("date-picker"),o=(0,s.up)("Modal"),n=(0,s.Q2)("tooltip");return(0,s.wg)(),(0,s.j4)(o,{ref:"ModalRef"},{header:(0,s.w5)((()=>[nu])),body:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s._)("form",null,[ru,(0,s._)("div",null,[(0,s._)("div",du,[(0,s.wy)(((0,s.wg)(),(0,s.iD)("span",null,hu)),[[n,{content:"Copies information from a previous flexi schedule and pastes it into a current or future flexi schedule.",classes:"tool-tip-width"},void 0,{top:!0}]])]),(0,s._)("div",uu,["copy"!==e.sourceMode?((0,s.wg)(),(0,s.iD)("div",mu)):(0,s.kq)("",!0),(0,s._)("div",null,[(0,s.wy)(((0,s.wg)(),(0,s.iD)("span",pu,fu)),[[n,{content:"The date to copy from."},void 0,{top:!0}]]),(0,s.wy)((0,s._)("input",{class:"input-box",type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.copyFromDateText=t),onClick:t[1]||(t[1]=t=>e.updateDateTime(t,"copyFromDate"))},null,512),[[l.nr,e.copyFromDateText]])]),(0,s._)("div",gu,[(0,s.wy)(((0,s.wg)(),(0,s.iD)("span",Du,vu)),[[n,{content:"The number of days to copy."},void 0,{top:!0}]]),(0,s.wy)((0,s._)("input",{class:"input-box",type:"number",max:"14","onUpdate:modelValue":t[2]||(t[2]=t=>e.copyToDateDuration=t),onChange:t[3]||(t[3]=(...t)=>e.validNoDays&&e.validNoDays(...t))},null,544),[[l.nr,e.copyToDateDuration,void 0,{number:!0}]]),e.showNoDaysError?((0,s.wg)(),(0,s.iD)("div",Su,ku)):(0,s.kq)("",!0)]),(0,s._)("div",Cu,[(0,s.wy)(((0,s.wg)(),(0,s.iD)("span",Au,_u)),[[n,{content:"The date in the flexi schedule when copied information will start. </br> For example, if you copy a 5-day block from 1 April and start it on 11 July, it will run from 11- 15 July."},void 0,{top:!0}]]),(0,s.wy)((0,s._)("input",{class:"input-box",type:"text","onUpdate:modelValue":t[4]||(t[4]=t=>e.targetDateText=t),onClick:t[5]||(t[5]=t=>e.updateDateTime(t,"targetDate"))},null,512),[[l.nr,e.targetDateText]])])])])]),Tu,(0,s._)("div",Eu,[(0,s._)("div",Mu,[Nu,(0,s._)("div",Fu,[(0,s._)("div",Pu,[(0,s.wy)((0,s._)("input",{type:"radio",name:"copyOption",value:"replace",class:"mt-0 ml-0","onUpdate:modelValue":t[6]||(t[6]=t=>e.copyOption=t)},null,512),[[l.G2,e.copyOption]]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("span",null,Hu)),[[n,{content:"When copied information is pasted in, it will replace all information on the days specified.",classes:"tool-tip-width"},void 0,{top:!0}]])]),(0,s._)("div",Yu,[(0,s.wy)((0,s._)("input",{type:"radio",name:"copyOption",value:"merge",class:"mt-0 ml-0","onUpdate:modelValue":t[7]||(t[7]=t=>e.copyOption=t)},null,512),[[l.G2,e.copyOption]]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("span",null,Lu)),[[n,{content:"When copied information is pasted in, <br/> it will replace information on the days specified only if there is a conflict."},void 0,{top:!0}]])])])]),(0,s._)("div",Wu,[ju,(0,s.Wm)(a,{class:"mt-4",selectOptionInput:e.workTypeOptions,targetString:"description","fixed-left":!0},null,8,["selectOptionInput"])])]),Ru,(0,s._)("div",$u,[(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=t=>e.overrideTeam=t)},null,512),[[l.e8,e.overrideTeam]]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("span",null,Vu)),[[n,{content:"Selecting this option will copy Flexi Schedules for all non-published employees</br> as well as those employees who are already on a Team or a Personal Schedule."},void 0,{top:!0}]])])]),(0,s.Wm)(i,{ref:"DatePickerRef",top:e.datePickerTop,left:e.datePickerLeft,"min-date":e.datePickerMin,"max-date":e.datePickerMax},null,8,["top","left","min-date","max-date"])])])),footer:(0,s.w5)((()=>[(0,s._)("div",Uu,[(0,s._)("button",{class:"blue xsmall white--text mr-2",onClick:t[9]||(t[9]=(...t)=>e.actionByMode&&e.actionByMode(...t))},"Create"),(0,s._)("button",{class:"orange xsmall white--text",onClick:t[10]||(t[10]=(...t)=>e.cancel&&e.cancel(...t))},"Cancel")])])),_:1},512)}const Gu={class:"custom-select",tabindex:"1",ref:"selectRef"},Ku={class:"custom-select-selected"},qu=["onClick"],Zu={class:"cell-config"},Qu=["onUpdate:modelValue"],Ju={class:"ml-2 vert-mid"};function Xu(e,t){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("span",null,[(0,s._)("div",Gu,[(0,s._)("div",Ku,[(0,s._)("span",null,(0,n.zw)(e.getSelectedOptions()),1)]),(0,s._)("div",{class:"custom-select-items",style:(0,n.j5)(e.getLeft())},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.options,((t,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"custom-select-item",key:a,onClick:a=>e.selectOptionAction(t)},[(0,s._)("div",Zu,[(0,s.wy)((0,s._)("input",{type:"checkbox",class:"ma-0 vert-mid","onUpdate:modelValue":e=>t.isSelected=e},null,8,Qu),[[l.e8,t.isSelected]]),(0,s._)("label",Ju,(0,n.zw)(t[e.targetString]),1)])],8,qu)))),128))],4)],512)])])}var em=(0,s.aZ)({name:"CustomSelect",props:{selectOptionInput:{type:Array},targetString:{type:String},allowAll:{type:Boolean},fixedLeft:{type:Boolean}},data(){return{options:[],left:0,selected:[]}},mounted(){this.left=this.$refs.selectRef.getClientRects()[0].left,this.options=this.selectOptionInput;let e=!1;if(this.options.find((e=>e.isSelected))&&(e=!0),this.allowAll){const t={commonName:"All",isAll:!0,isSelected:!e};this.options.unshift(t)}},methods:{getSelectedOptions(){let e=this.options.filter((e=>e.isSelected)),t="";return e.map(((e,a)=>{t=a>0?t+", "+e[this.targetString]:e[this.targetString]})),t},getLeft(){return this.fixedLeft?{left:this.left+"px"}:{position:"absolute"}},selectOptionAction(e){e.isAll&&0==e.isSelected?this.options.forEach(((e,t)=>{t>0&&(e.isSelected=!1)})):!e.isAll&&this.options[0].isAll&&(this.options[0].isSelected=!1),e.isSelected=!e.isSelected}}});const tm=(0,oe.Z)(em,[["render",Xu],["__scopeId","data-v-45e6dd59"]]);var am,lm=tm;(function(e){e["copy"]="replace",e["merge"]="merge"})(am||(am={}));var sm=(0,s.aZ)({name:"DraftCreationDialog",components:{Modal:xe,DatePicker:El,MultiSelect:lm},data(){return{datePickerTop:0,datePickerLeft:0,sourceMode:"copy",copyOption:"replace",overrideTeam:!1,scheduleStartDateText:"",copyFromDateText:"",targetDateText:"",scheduleStartDate:jt()(),copyFromDate:jt()(),copyToDateDuration:0,targetDate:jt()(),datePickerMax:null,datePickerMin:null,dateTarget:"",copyPersonalDuration:0,workTypeOptions:[],selected:{},options:[],left:0,showNoDaysError:!1}},mounted(){},methods:{selectOption(){},resetData(){this.datePickerTop=0,this.datePickerLeft=0,this.sourceMode="copy",this.copyOption="replace",this.scheduleStartDateText="",this.copyFromDateText="",this.targetDateText="",this.scheduleStartDate=jt()(),this.copyFromDate=jt()(),this.copyToDateDuration=0,this.targetDate=jt()(),this.dateTarget="",this.copyPersonalDuration=0,this.datePickerMax=null,this.datePickerMin=null,this.showNoDaysError=!1,this.workTypeOptions=this.$store.state.LookUp.workTypes},toggleShow(){this.resetData(),this.$refs.ModalRef.toggleShow()},actionByMode(){"copy"===this.sourceMode?this.createDraft():this.importFromPersonal()},importFromPersonal(){fl.loading();let e=[];for(const a of this.$store.state.FlexSchedule.scheduleWeek.values())this.$store.state.EmployeeModule.filteredEmployees.find((e=>e.employeeNo===a.employeeNo))&&e.push(a.employeeNo);let t={CopyFromPersonalSchedule:!0,EmployeeNumbers:e,PersonalSchedCopyDurationInDays:this.copyPersonalDuration,TargetDate:this.scheduleStartDate.format("DD/MMM/YYYY"),CopyOption:this.copyOption,ExcludedworkTypes:this.getExcludedWorkTypes()};se.CopyFlexSchedule(t).then((e=>{this.$refs.ModalRef.toggleShow(),this.$emit("reload")})).finally((()=>{}))},validForm(){return this.validNoDays()},validNoDays(){return this.copyToDateDuration>14?(this.showNoDaysError=!0,!1):(this.showNoDaysError=!1,!0)},createDraft(){if(!this.validForm())return;fl.loading();let e=[];if(this.overrideTeam)for(const a of this.$store.state.FlexSchedule.scheduleWeek.values())(a.includeTeamOrPersonal||"published"!==a.empSchePublishState)&&e.push(a.employeeNo);else for(const a of this.$store.state.FlexSchedule.scheduleWeek.values())"published"!==a.empSchePublishState&&e.push(a.employeeNo);e=e.filter((e=>!!this.$store.state.EmployeeModule.filteredEmployees.find((t=>t.employeeNo===e))));let t={CopyFromPersonalSchedule:!1,EmployeeNumbers:e,CopyFromDate:this.copyFromDate.format("DD/MMM/YYYY"),CopyToDate:this.copyFromDate.add(this.copyToDateDuration-1,"days").format("DD/MMM/YYYY"),TargetDate:this.targetDate.format("DD/MMM/YYYY"),CopyOption:this.copyOption,ExcludedworkTypes:this.getExcludedWorkTypes(),OverrideTeam:this.overrideTeam};se.CopyFlexSchedule(t).then((e=>{fl.clear(),this.$refs.ModalRef.toggleShow(),fl.alert("Your schedules are being copied. This process can take a few minutes. You will need to refresh your screen to see the updated schedules.")})).finally((()=>{}))},getExcludedWorkTypes(){let e=this.workTypeOptions.filter((e=>e.isSelected));return e.length<1&&(e=this.$store.state.FlexSchedule.defaultWorkTypes),e.map((e=>e.code))},async updateDateTime(e,t){let a=e.target.getClientRects()[0];this.datePickerTop=a.bottom,this.datePickerLeft=a.left;try{switch(t){case"ScheduleStartDate":return this.scheduleStartDate=await this.$refs.DatePickerRef.toggleShow(this.scheduleStartDate),void(this.scheduleStartDateText=this.scheduleStartDate.format("DD/MM/YYYY"));case"copyFromDate":return this.datePickerMax=null,this.datePickerMin=null,this.copyFromDate=await this.$refs.DatePickerRef.toggleShow(this.copyFromDate),void(this.copyFromDateText=this.copyFromDate.format("DD/MM/YYYY"));case"targetDate":return this.datePickerMax=null,this.datePickerMin=jt()().add(-2,"day"),this.targetDate=await this.$refs.DatePickerRef.toggleShow(this.targetDate),void(this.targetDateText=this.targetDate.format("DD/MM/YYYY"))}}catch(l){return}},cancel(){this.toggleShow()}}});const im=(0,oe.Z)(sm,[["render",zu],["__scopeId","data-v-42d9f14e"]]);var om=im;const nm=e=>((0,s.dD)("data-v-3e8387ea"),e=e(),(0,s.Cn)(),e),rm=nm((()=>(0,s._)("h2",{class:"bold"},"Employee Details",-1))),dm={class:"mt-4"},cm={class:"mt-4"};function hm(e,t,a,l,i,o){const n=(0,s.up)("cf-widget"),r=(0,s.up)("Modal");return(0,s.wg)(),(0,s.j4)(r,{ref:"ModalRef"},{header:(0,s.w5)((()=>[rm])),body:(0,s.w5)((()=>[(0,s._)("div",dm,[(0,s.Wm)(n,{title:e.title,icon:"",class:"my-pay-widget",data:e.externalDetail,loading:e.loading,error:e.error},null,8,["title","data","loading","error"])])])),footer:(0,s.w5)((()=>[(0,s._)("div",cm,[(0,s._)("button",{class:"grey small white--text",onClick:t[0]||(t[0]=(...t)=>e.toggleShow&&e.toggleShow(...t))},"Close")])])),_:1},512)}const um={class:"cf-widget"};function mm(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("div",um,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.items,((e,t)=>((0,s.wg)(),(0,s.j4)((0,s.LL)(e.Type),{data:e,class:"item",key:t},null,8,["data"])))),128))])}const pm={class:"field-display"},ym={class:"label"},fm=["href"],gm=["href"],Dm={key:2,class:"value"};function wm(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("div",pm,[(0,s._)("div",ym,(0,n.zw)(a.data.Label),1),o.email?((0,s.wg)(),(0,s.iD)("a",{key:0,href:o.email,class:"value"},(0,n.zw)(a.data.Value),9,fm)):(0,s.kq)("",!0),!o.email&&o.tel?((0,s.wg)(),(0,s.iD)("a",{key:1,href:o.tel,class:"value"},(0,n.zw)(a.data.Value),9,gm)):(0,s.kq)("",!0),o.email||o.tel?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Dm,(0,n.zw)(a.data.Value),1))])}var vm={props:["data"],computed:{tel(){return"string"==typeof this.data.Key&&(this.data.Key.includes("Phone")||this.data.Key.includes("Mobile"))?`tel:${this.data.Value}`:null},email(){return"string"==typeof this.data.Value&&this.data.Value.includes("@")?`mailto:${this.data.Value}`:null}}};const Sm=(0,oe.Z)(vm,[["render",wm]]);var bm=Sm;const km={class:"separator"};function Cm(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("div",km)}var Am={};const xm=(0,oe.Z)(Am,[["render",Cm]]);var _m=xm;const Tm={class:"youtube-input"},Em=["src"];function Mm(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("div",Tm,[(0,s._)("iframe",{class:"video-frame",src:"//www.youtube.com/embed/"+a.data.Value+"?autoplay=0&controls=1&rel=0&showinfo=0&theme=light&modestbranding=1"},null,8,Em)])}var Nm={props:["data"]};const Fm=(0,oe.Z)(Nm,[["render",Mm]]);var Pm=Fm;function Om(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("p",null,(0,n.zw)(a.data.Label),1)}var Hm={props:["data"]};const Ym=(0,oe.Z)(Hm,[["render",Om]]);var Im=Ym;const Lm={class:"explanation"};function Wm(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("p",Lm,(0,n.zw)(a.data.Label),1)}var jm={props:["data"]};const Rm=(0,oe.Z)(jm,[["render",Wm]]);var $m=Rm;const Bm={class:"attachment"},Vm={class:"label"},Um={class:"value"},zm={href:"#"};function Gm(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("div",Bm,[(0,s._)("div",Vm,(0,n.zw)(a.data.Label),1),(0,s._)("div",Um,[(0,s._)("a",zm,(0,n.zw)(a.data.Value.Display),1)])])}var Km={props:["data"]};const qm=(0,oe.Z)(Km,[["render",Gm]]);var Zm=qm;const Qm={class:"subheading"},Jm={class:"label"};function Xm(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("div",Qm,[(0,s._)("div",Jm,(0,n.zw)(a.data.Label),1)])}var ep={props:["data"]};const tp=(0,oe.Z)(ep,[["render",Xm]]);var ap=tp;const lp=["href"];function sp(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("a",{href:a.data.Value},(0,n.zw)(a.data.Label),9,lp)}var ip={props:["data"]};const op=(0,oe.Z)(ip,[["render",sp]]);var np=op,rp={props:["title","icon","data","loading","error"],components:{FieldDisplay:bm,Separator:_m,YoutubeInput:Pm,Paragraph:Im,Explanation:$m,AttachFile:Zm,Subheading:ap,Link:np},computed:{items(){if(this.data)return this.data.filter((e=>"Separator"===e.Type||"Subheading"===e.Type||"Explanation"===e.Type||"Paragraph"===e.Type||"YoutubeInput"===e.Type||"Link"===e.Type||e.Value))}}};const dp=(0,oe.Z)(rp,[["render",mm]]);var cp=dp,hp=(0,s.aZ)({name:"TestEmployeeList",components:{Modal:xe,CfWidget:cp},props:{externalDetail:{type:Array}},data(){return{title:"data title",loading:!1,error:null}},mounted(){},methods:{toggleShow(){this.$refs.ModalRef.toggleShow()}}});const up=(0,oe.Z)(hp,[["render",hm],["__scopeId","data-v-3e8387ea"]]);var mp=up;const pp=e=>((0,s.dD)("data-v-19c59d50"),e=e(),(0,s.Cn)(),e),yp={class:"flex-sche-table print-only",id:"FlexSchedules"},fp={class:"table-head"},gp=pp((()=>(0,s._)("th",{class:"table-cell"},null,-1))),Dp=pp((()=>(0,s._)("th",{class:"table-cell"},"Std Hours",-1))),wp=pp((()=>(0,s._)("th",{class:"table-cell"},"Net Hours",-1))),vp={class:"table-cell"},Sp={class:"table-body"},bp={key:0,class:"schedules-arr"},kp=["onClick"],Cp={class:"content-cell"},Ap={class:"content-cell"},xp={key:0,class:"leave-unit mt-2"},_p={key:0},Tp={key:1};function Ep(e,t,a,l,i,o){return(0,s.wg)(),(0,s.iD)("table",yp,[(0,s._)("thead",null,[(0,s._)("tr",fp,[gp,Dp,wp,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.weekDays,(e=>((0,s.wg)(),(0,s.iD)("th",vp,(0,n.zw)(e.day),1)))),256))])]),(0,s._)("tbody",Sp,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.scheduleWeek.keys(),(t=>((0,s.wg)(),(0,s.iD)(s.HY,null,[e.scheduleWeek.get(t)&&e.scheduleWeek.get(t).show?((0,s.wg)(),(0,s.iD)("tr",bp,[(0,s._)("td",{class:"content-cell content-employee-name",onClick:a=>e.openEmployeeDetail(t)},(0,n.zw)(e.scheduleWeek.get(t).employeeName),9,kp),(0,s._)("td",Cp,(0,n.zw)(e.scheduleWeek.get(t).stdHoursPerWeek.toFixed(2)),1),(0,s._)("td",Ap,(0,n.zw)(e.getTotalHour(e.scheduleWeek.get(t).sche)),1),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.scheduleWeek.get(t).sche,(e=>((0,s.wg)(),(0,s.iD)("td",{class:"content-cell",style:(0,n.j5)(e.column)},[(0,s._)("div",null,(0,n.zw)(e.startTime)+" - "+(0,n.zw)(e.endTime),1),e.leaveUnit?((0,s.wg)(),(0,s.iD)("div",xp,["D"===e.leaveUnit.calcUnit?((0,s.wg)(),(0,s.iD)("span",_p,"Leave: "+(0,n.zw)(e.leaveUnit.daysAppliedFor)+" day",1)):((0,s.wg)(),(0,s.iD)("span",Tp,"Leave: "+(0,n.zw)(e.leaveUnit.hoursAppliedFor)+" hours",1))])):(0,s.kq)("",!0)],4)))),256))])):(0,s.kq)("",!0)],64)))),256))])])}var Mp=(0,s.aZ)({name:"PrintableView",props:{scheduleWeek:{type:Object},weekDays:{type:Array}},methods:{getTotalHour(e){let t=0;for(let a of e)a.hours&&(t+=a.hours);return t.toFixed(2)},printFlexSchedule(){var e="left=5,top=5,resizable=yes,height=600,width=700,scrollbars=yes,status=1",t=document.getElementById("FlexSchedules").outerHTML,l=window.open("","Print",e);const s=a(678).toString();l.document.write("<html>"),l.document.write("<head>"),l.document.write('<style type="text/css">table {border-collapse: collapse;}</style>'),l.document.write('<style type="text/css">table, th, td {border: 1px solid #cbcbcb;text-align: center;}</style>'),l.document.write(`<style type="text/css">${s}</style>`),l.document.write("</head>"),l.document.write("<body>"),l.document.write(t),l.document.write("</body></html>"),l.document.close(),l.focus(),l.print(),l.close()}}});const Np=(0,oe.Z)(Mp,[["render",Ep],["__scopeId","data-v-19c59d50"]]);var Fp=Np;const Pp=e=>((0,s.dD)("data-v-05223cb4"),e=e(),(0,s.Cn)(),e),Op=Pp((()=>(0,s._)("div",{class:"d-flex justify-center"},[(0,s._)("h3",null,"Shift Coverage")],-1))),Hp={class:"mt-4 full-width"},Yp=Pp((()=>(0,s._)("label",null,"Choose Date:",-1))),Ip=["value"],Lp={key:0,class:"d-flex justify-center mt-4"},Wp={key:0,class:"choose-date-info"},jp={key:1,class:"choose-date-info"},Rp={class:"analysisChart"},$p={class:"axis-canvas",id:"myChartHeader",height:"39",ref:"myChartHeaderRef"},Bp={class:"main-canvas-wrapper"},Vp={class:"main-canvas",ref:"myChartRef",id:"myChart",colours:"[ { fillColor: '#ffff00' }, { fillColor: '#0066ff' } ]"};function Up(e,t){const a=(0,s.up)("Modal"),i=(0,s.up)("date-picker");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(a,{ref:"ModalRef",onCancel:e.cancelModal,modalIndex:e.modalIndex},{header:(0,s.w5)((()=>[Op])),body:(0,s.w5)((()=>[(0,s._)("div",Hp,[(0,s._)("div",null,[Yp,(0,s._)("input",{value:e.$filters.reformatDate(e.selectedDate),class:"d-inline-flex ma-0 pa-0 mr-2 ml-2 caption analysis-date-input",style:{"max-width":"120px"},onChange:t[0]||(t[0]=t=>e.updateDateText(t,e.selectedDate)),onClick:t[1]||(t[1]=t=>e.updateDateTime(t,e.selectedDate)),"onClick:clear":t[2]||(t[2]=t=>e.toDate=null)},null,40,Ip)]),0===e.chartDatasets.length?((0,s.wg)(),(0,s.iD)("div",Lp,[null===e.selectedDate?((0,s.wg)(),(0,s.iD)("h3",Wp,"Choose a day above to view the shift coverage")):0===e.chartDatasets.length?((0,s.wg)(),(0,s.iD)("h3",jp,"There's no one scheduled on this day. Please choose another day.")):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s.wy)((0,s._)("div",Rp,[(0,s._)("canvas",$p,null,512),(0,s._)("div",Bp,[(0,s._)("div",{class:"myChart-wrapper",style:(0,n.j5)({height:e.canvasHeight+"px"})},[(0,s._)("canvas",Vp,null,512)],4)])],512),[[l.F8,e.chartDatasets.length>0]])])])),_:1},8,["onCancel","modalIndex"]),(0,s.Wm)(i,{ref:"DatePickerRef",top:e.dateModalTop,leftInput:e.dateModalLeft,date:e.datePickerTargetDay},null,8,["top","leftInput","date"])],64)}var zp=a(1877);a(6961);let Gp=null;var Kp=(0,s.aZ)({name:"AnalysisChart",components:{Modal:xe,DatePicker:El},props:{modalIndex:{type:Number}},data(){return{selectedDate:null,dateModal:!1,dateModalTop:0,dateModalLeft:0,datePickerTargetDay:jt()(),chartLabels:[],chartDatasets:[],min:0,max:100,canvasHeight:1,myChartHeader:null}},setup(){const e=(0,Al.iH)(),t=(0,Al.iH)();return{myChartRef:e,myChartHeaderRef:t}},methods:{toggleShow(){this.$refs.ModalRef.toggleShow()},updateDateText(e,t){this.selectedDate=jt()(e.target.value,"DD/MM/YYYY"),this.dateModal=!1},updateDateTime(e,t){let a=e.target.getClientRects()[0];this.dateModalTop=a.bottom,this.dateModalLeft=a.left,this.datePickerTargetDay=this.selectedDate,this.dateModal=!0,this.openDatePicker().then((e=>{this.prepareChartData()})).catch((e=>{console.log("err",e)}))},async openDatePicker(){let e=await this.$refs.DatePickerRef.toggleShow(this.datePickerTargetDay);return this.selectedDate=e,e},getData(e){return this.getDateData(e,e)},async getDateData(e,t){let a={};return e&&t&&(a={employeeNo:Affinity.user.EmployeeNo,startDate:e.format("YYYY-MM-DD"),endDate:t.format("YYYY-MM-DD"),forManagedEmployees:!0}),se.GetFlexSchedules(a).then((e=>e.FlexSchedules.filter((e=>!!this.$store.state.EmployeeModule.filteredEmployees.find((t=>t.employeeNo===e.EmployeeNo))))))},staticWorkersPerHour(e){let t=e.map((e=>[jt()(e[0]),jt()(e[1])])),a=Array(24).fill(0);for(let l of t){let e=l[0],t=l[1],s=e.hour(),i=t.diff(e,"hour");for(let l=0;l<s+i;l++)l>=s&&(a[l]=a[l]+1)}return a},prepareChartData(){let e=jt()(this.selectedDate);fl.loading(),this.getData(e).then((t=>{fl.clear();let a=t,l=new Map;for(const d of a)if(d&&d.StartTime&&d.EndTime){let t=d.EmployeeName,a=jt()(d.StartTime),s=jt()(d.EndTime),i=e.clone();i.hour(a.hour()),i.minutes(a.minutes());let o=e.clone();o.hour(s.hours()),o.minutes(s.minutes());let n=[i.toISOString(),o.toISOString()];l.set(t,n)}let s=[...l.keys()],i=[...l.values()];this.chartDatasets=i;let o=this.staticWorkersPerHour(i),n=jt()(e).startOf("day").valueOf(),r=jt()(e).endOf("day").valueOf();if(this.canvasHeight=30*s.length+100,Gp)if(s.length<=0){let e=this.myChartHeaderRef.getContext("2d");e.clearRect(0,0,this.myChartHeaderRef.width,this.myChartHeaderRef.height),console.info("destroy chart"),Gp.destroy(),Gp=null}else console.info("update chart"),Gp.options.scales.x.min=n,Gp.options.scales.x.max=r,Gp.options.scales.x1.ticks={callback:(e,t,a)=>o[t]},Gp.data.labels=s,Gp.data.datasets[0].data=i,s.length<=0&&(Gp.data.labels=[],Gp.data.datasets=[],Gp.options.scales.x.min=0,Gp.options.scales.x.max=1),Gp.update();else if(s.length<=0);else{console.info("create new chart");let e=document.getElementById("myChart").getContext("2d"),t=this,a={type:"bar",data:{labels:s,datasets:[{label:"Work Hours",data:i,backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)"],borderWidth:2,borderSkipped:!1}]},grouped:!1,options:{responsive:!0,maintainAspectRatio:!1,devicePixelRatio:window.devicePixelRatio,indexAxis:"y",scales:{y:{stacked:!1},x:{id:"xAxis2",backgroundColor:"#ffffff",position:"top",type:"time",time:{unit:"hour",displayFormats:{hour:"HH:mm"}},title:{display:!0,text:"Time"},min:n,max:r,ticks:{stepSize:5e5}},x1:{id:"xAxis1",type:"time",position:"bottom",gridLines:{drawOnChartArea:!1},time:{unit:"hour",displayFormats:{hour:"HH:mm:ss"}},min:n,max:r,title:{display:!0,text:"Working Employees / Hour"},ticks:{callback:(e,t,a)=>o[t]}}},plugins:{title:{display:!1},legend:{display:!1},tooltip:{usePointStyle:!0,callbacks:{label:function(e){let t=e.raw;return` ${jt()(t[0]).format("HH:mm")} - ${jt()(t[1]).format("HH:mm")}`},labelPointStyle:function(e){return{pointStyle:"triangle",rotation:0}}}}},animation:{onComplete:function(e){let a=this.ctx.canvas,l=window.devicePixelRatio,s=this.canvas.width,i=this.scales.x.height*l,o=t.myChartHeaderRef.getContext("2d"),n=document.getElementById("myChartHeader");n.style.width=this.canvas.width/l+"px",n.style.height=i/l+"px",n.width=Math.floor(this.canvas.width),n.height=Math.floor(i),o.scale(l,l),o.drawImage(a,0,0,s,i,0,0,s/l,i/l)}}}};Gp=new zp.Z(e,a)}})).catch((()=>{fl.clear(),fl.alert("Something Wrong. Please try again later")}))},cancelModal(){Gp&&(Gp.destroy(),Gp=null,this.selectedDate=null,this.canvasHeight=1,this.chartDatasets=[])}},beforeUnmount(){Gp&&(Gp.destroy(),Gp=null,this.selectedDate=null,this.canvasHeight=1,this.chartDatasets=[])}});const qp=(0,oe.Z)(Kp,[["render",Up],["__scopeId","data-v-05223cb4"]]);var Zp=qp;function Qp(e){return{id:e.id,startTime:e.startTime,endTime:e.endTime,hours:e.hours,date:e.date,isPaid:e.isPaid,scheduleType:e.scheduleType,dayInWeek:e.dayInWeek,publishStatus:e.publishStatus,breakLength:e.scheduleDetail.breakLength,position:e.scheduleDetail.position,positionTitle:e.scheduleDetail.positionTitle,shiftId:e.scheduleDetail.shiftId}}function Jp(e,t,a,l){let s=a.flexSchedules;const i=new Map;for(let o of t){const e={...o};e.show=!0,i.set(o.employeeNo,e)}for(let o of s){const e=i.get(o.EmployeeNo);if(e&&!e.sche)e.sche=[Qp(o)];else if(e){const t=Qp(o);e.sche.push(t)}}return i}function Xp(e,t,a,l){let s=a.flexSchedules;const i=new Map;for(let o of t){const e={...o};e.show=!0,i.set(o.employeeNo,e)}for(let o of s){const e=i.get(o.EmployeeNo);e&&(e.sche=Qp(o))}for(let o of i.values())o.sche||(o.sche={},o.sche.dayInWeek=0,o.sche.employeeName=o.employeeName,o.sche.employeeNo=o.employeeNo),o.sche.allowCreateOrEdit=!0,o.sche.editing=!1;return i}function ey(e,t,a){for(let l of t)if(l.leaveUnits)for(let t of l.leaveUnits){let s=jt()(t.leaveDate).diff(e,"days");s<0||(t.calcUnit=l.calcUnit,t.leaveCode=l.leaveCode,t.leaveName=l.leaveName,a.get(l.employeeNo)?.sche[s]&&(a.get(l.employeeNo).sche[s].leaveUnit=t))}}function ty(e,t){for(let a of e)if(a.leaveUnits)for(let e of a.leaveUnits)e.calcUnit=a.calcUnit,e.leaveCode=a.leaveCode,e.leaveName=a.leaveName,t.get(a.employeeNo)?.sche&&(t.get(a.employeeNo).sche.leaveUnit=e)}function ay(e,t){for(let a of e.unAvailabilities){let e=jt()(a.unavailabilityDate).day();t.get(a.employeeNo)&&t.get(a.employeeNo).sche&&t.get(a.employeeNo).sche[e]&&(t.get(a.employeeNo).sche[e].unAvailability=a)}}function ly(e,t){for(let a of e.unAvailabilities)t.get(a.employeeNo)&&t.get(a.employeeNo).sche&&(t.get(a.employeeNo).sche.unAvailability=a)}function sy(e,t){jt()();for(let a of t.values()){let e=a.EmployeeName,t=a.EmployeeNo;for(let l=0;l<=6;l++){let s;a.sche?s=a.sche.find((e=>e.dayInWeek===l)):a.sche=[],s||(0!==l||a.sche[0]&&null!==a.sche[0].dayInWeek&&void 0!==a.sche[0].dayInWeek?a.sche.push({dayInWeek:l,employeeName:e,employeeNo:t}):(a.sche[0]={},a.sche[0].dayInWeek=0,a.sche[0].employeeName=e,a.sche[0].employeeNo=t))}a.sche.sort(((e,t)=>e.dayInWeek-t.dayInWeek));for(let[l,s]of a.sche.entries())s.column=`grid-column-start: ${s.dayInWeek+4}`,s.allowCreateOrEdit=!0,s.editing=!1}}var iy={prepareGridData:Jp,prepareGridDataMobile:Xp,scheDaysToColumn:sy,addLeaveToGrid:ey,addUnAvaToGrid:ay,addUnAvaToGridMobile:ly,addLeaveToGridMobile:ty};const oy=e=>((0,s.dD)("data-v-bdeb7434"),e=e(),(0,s.Cn)(),e),ny=oy((()=>(0,s._)("div",null,[(0,s._)("h2",null,[(0,s._)("b",null,"Publish Flexi Schedule")])],-1))),ry={class:"full-width mt-4"},dy={key:0},cy=oy((()=>(0,s._)("br",null,null,-1))),hy=(0,s.Uk)(" This will publish the schedule for all employees."),uy={key:1},my={key:0},py=oy((()=>(0,s._)("span",null,"Publish by individual employee(s)",-1))),yy=[py],fy={key:1},gy={class:"container-half mt-4"},Dy=oy((()=>(0,s._)("label",null,"Select Employees",-1))),wy=oy((()=>(0,s._)("div",{class:"line-break mt-4"},null,-1))),vy={class:"d-flex justify-end full-width mt-4"};function Sy(e,t){const a=(0,s.up)("multi-select"),l=(0,s.up)("Modal");return(0,s.wg)(),(0,s.j4)(l,{ref:"ModalRef","no-overflow-auto-body":!0},{header:(0,s.w5)((()=>[ny])),body:(0,s.w5)((()=>[(0,s._)("div",ry,[(0,s._)("div",null,[!1===e.showPublishByEmployee?((0,s.wg)(),(0,s.iD)("span",dy,[(0,s.Uk)("Are you sure you want to publish the schedule for week "+(0,n.zw)(e.selectedDate)+"? ",1),cy,hy])):(0,s.kq)("",!0),!0===e.showPublishByEmployee?((0,s.wg)(),(0,s.iD)("span",uy,"Are you sure you want to publish the schedule for week "+(0,n.zw)(e.selectedDate)+"?",1)):(0,s.kq)("",!0)]),!1===e.showPublishByEmployee?((0,s.wg)(),(0,s.iD)("div",my,[(0,s._)("button",{class:"text-button mt-4",onClick:t[0]||(t[0]=t=>e.showPublishByEmployee=!0)},yy)])):(0,s.kq)("",!0),!0===e.showPublishByEmployee?((0,s.wg)(),(0,s.iD)("div",fy,[(0,s._)("div",gy,[Dy,(0,s.Wm)(a,{class:"mt-2",targetString:"commonName",allowAll:!0,selectOptionInput:e.selectOptions},null,8,["selectOptionInput"])])])):(0,s.kq)("",!0),wy])])),footer:(0,s.w5)((()=>[(0,s._)("div",vy,[(0,s._)("button",{class:"blue xsmall white--text mr-2",onClick:t[1]||(t[1]=(...t)=>e.publish&&e.publish(...t))},"Publish"),(0,s._)("button",{class:"orange xsmall white--text",onClick:t[2]||(t[2]=(...t)=>e.cancel&&e.cancel(...t))},"Cancel")])])),_:1},512)}var by=(0,s.aZ)({name:"PublishDialog",components:{Modal:xe,MultiSelect:lm},data(){return{selectOptions:[],selectedDate:"",showPublishByEmployee:!1}},mounted(){this.showPublishByEmployee=!1,this.selectOptions=this.$store.getters[pi.getFilteredEmployees].slice()},methods:{selectOption(){},resetData(){this.showPublishByEmployee=!1},publish(){if(!this.showPublishByEmployee){const e=this.selectOptions.map((e=>e.employeeNo));return this.$emit("publish",e),void this.$refs.ModalRef.toggleShow()}if(this.selectOptions[0].isAll&&this.selectOptions[0].isSelected)return void this.publishAllEmployee();let e=this.selectOptions.filter((e=>e.isSelected)).map((e=>e.employeeNo));this.$emit("publish",e),this.$refs.ModalRef.toggleShow()},publishAllEmployee(){let e=this.selectOptions.slice();e.shift();const t=e.map((e=>e.employeeNo));this.$emit("publish",t),this.$refs.ModalRef.toggleShow()},cancel(){this.toggleShow()},setSelectedDate(e){this.selectedDate=e},toggleShow(){this.resetData(),this.selectOptions=this.$store.getters[pi.getFilteredEmployees].slice(),this.$refs.ModalRef.toggleShow()}}});const ky=(0,oe.Z)(by,[["render",Sy],["__scopeId","data-v-bdeb7434"]]);var Cy=ky;const Ay=e=>((0,s.dD)("data-v-9d3a1320"),e=e(),(0,s.Cn)(),e),xy=Ay((()=>(0,s._)("div",{class:"d-flex justify-center"},[(0,s._)("h2",null,[(0,s._)("b",null,"Cost Analysis")])],-1))),_y={class:"d-flex justify-center mt-2"},Ty={key:0,class:"mt-4"},Ey=Ay((()=>(0,s._)("h3",null,"No Cost Analysis Data",-1))),My=[Ey],Ny={key:1,class:"mt-4 full-width costAnalaysisBody"},Fy={class:"display-option"},Py={class:"cost-grid mt-4"},Oy=Ay((()=>(0,s._)("div",{class:"table-cell"},null,-1))),Hy={class:"table-cell"},Yy={key:0,class:"table-cell"},Iy={key:0},Ly={key:1},Wy=Ay((()=>(0,s._)("div",{class:"table-cell bold"}," Total ",-1))),jy={key:0},Ry={key:1},$y={class:"mt-4"};function By(e,t){const a=(0,s.up)("multi-select"),l=(0,s.up)("Modal");return(0,s.wg)(),(0,s.j4)(l,{ref:"ModalRef",onCancel:e.cancelModal,modalIndex:e.modalIndex},{header:(0,s.w5)((()=>[xy,(0,s._)("div",_y,[(0,s._)("h3",null,(0,n.zw)(e.weekStart)+" - "+(0,n.zw)(e.weekEnd),1)])])),body:(0,s.w5)((()=>[e.data[0]?((0,s.wg)(),(0,s.iD)("div",Ny,[(0,s._)("div",Fy,[(0,s.Wm)(a,{class:"mt-4",selectOptionInput:e.displayOptions,targetString:"description","fixed-left":!1},null,8,["selectOptionInput"])]),(0,s._)("div",Py,[(0,s._)("div",{class:"day-arr cost-grid-heading",style:(0,n.j5)(e.getGridTemplateStyle())},[Oy,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.displayList,(e=>((0,s.wg)(),(0,s.iD)("div",Hy,(0,n.zw)(e.heading),1)))),256))],4),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.data,((t,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"day-arr",style:(0,n.j5)(e.getGridTemplateStyle())},[t.day?((0,s.wg)(),(0,s.iD)("div",Yy,(0,n.zw)(t.day),1)):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Object.entries(e.displayList),(([l,i])=>((0,s.wg)(),(0,s.iD)("div",{class:(0,n.C_)(["table-cell",e.getDataStyle(e.calculatedData[a],l,i)])},[i.isCalculated?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("span",Iy,"$")),(0,s._)("span",null,(0,n.zw)(t[l]),1),i.isCalculated?((0,s.wg)(),(0,s.iD)("span",Ly,"%")):(0,s.kq)("",!0)],2)))),256))],4)))),256)),(0,s._)("div",{class:"day-arr",style:(0,n.j5)(e.getGridTemplateStyle())},[Wy,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Object.entries(e.displayList),(([t,a])=>((0,s.wg)(),(0,s.iD)("div",{class:(0,n.C_)(["table-cell bold",e.getDataStyle(e.totalInNumber,t,a)])},[a.isCalculated?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("span",jy,"$")),(0,s._)("span",null,(0,n.zw)(e.total[t]),1),a.isCalculated?((0,s.wg)(),(0,s.iD)("span",Ry,"%")):(0,s.kq)("",!0)],2)))),256))],4)])])):((0,s.wg)(),(0,s.iD)("div",Ty,My))])),footer:(0,s.w5)((()=>[(0,s._)("div",$y,[(0,s._)("button",{class:"orange small white--text",onClick:t[0]||(t[0]=(...t)=>e.toggleShow&&e.toggleShow(...t))},"Close")])])),_:1},8,["onCancel","modalIndex"])}var Vy=a(6740),Uy=a.n(Vy),zy=(0,s.aZ)({name:"CostAnalysisDialog",components:{Modal:xe,MultiSelect:lm},props:{dayFocus:{type:Object},modalIndex:{type:Number}},data(){return{selectedDate:null,data:[],calculatedData:[],total:{},totalInNumber:{},displayN:6,displayList:{},sourceDisplayList:{scheduled:{heading:"Scheduled",isDisplay:!0,isCalculated:!1},actual:{heading:"Actuals",isDisplay:!1,isCalculated:!1},budgeted:{heading:"Budgeted",isDisplay:!1,isCalculated:!1},sales:{heading:"Sales",isDisplay:!1,isCalculated:!1},scheduledVSBudgeted:{heading:"Scheduled vs Budgeted",isDisplay:!1,isCalculated:!0},actualsVSBudgeted:{heading:"Actuals vs Budgeted",isDisplay:!1,isCalculated:!0},actualsVSScheduled:{heading:"Actuals vs Scheduled",isDisplay:!1,isCalculated:!0},scheduledVSSales:{heading:"Scheduled vs Sales",isDisplay:!1,isCalculated:!0},actualsVSSales:{heading:"Actuals vs Sales",isDisplay:!1,isCalculated:!0}},weekStart:"",weekEnd:"",displayOptions:[{key:"scheduled",description:"Scheduled",isSelected:!0},{key:"actual",description:"Actuals",isSelected:!1},{key:"budgeted",description:"Budgeted",isSelected:!0},{key:"sales",description:"Sales",isSelected:!0},{key:"scheduledVSBudgeted",description:"Scheduled vs Budgeted",isSelected:!1},{key:"actualsVSBudgeted",description:"Actuals vs Budgeted",isSelected:!1},{key:"actualsVSScheduled",description:"Actuals vs Scheduled",isSelected:!1},{key:"scheduledVSSales",description:"Scheduled vs Sales",isSelected:!1},{key:"actualsVSSales",description:"Actuals vs Sales",isSelected:!1}]}},setup(){},computed:{comparedValue(){let e=[];for(let[t,a]of Object.entries(this.displayList))a.isDisplay&&e.push(a);return e}},mounted(){const e=JSON.parse(localStorage.getItem("costAnalysisSetting_v1.2"));e&&(this.displayOptions=e)},watch:{displayOptions:{handler(e,t){this.displayList={};for(const[a,l]of Object.entries(this.sourceDisplayList)){const t=e.find((e=>e.key===a));t&&t.isSelected?(this.displayList[a]=l,this.displayList[a].isDisplay=t.isSelected):console.error("key not found",a)}localStorage.setItem("costAnalysisSetting_v1.2",JSON.stringify(e))},deep:!0}},methods:{getDataStyle(e,t,a){if(a.isCalculated)return"scheduledVSBudgeted"===t||"actualsVSBudgeted"===t?e[t]>0?"positive-cell":"negative-cell":void 0},getGridTemplateStyle(){return this.calculateDisplayRow(),this.displayN>1?`grid-template-columns: 100px repeat( ${this.displayN} , 100px)`:`grid-template-columns: 100px repeat( ${this.displayN} , auto)`},open(){Object.keys(this.displayList).forEach((e=>{this.displayList[e].isDisplay=!1}));let e=this.dayFocus.clone().startOf("week").format("DD/MMM/YYYY");this.weekStart=e;let t=this.dayFocus.clone().endOf("week").format("DD/MMM/YYYY");this.weekEnd=t;let a=this.$store.getters[pi.getFilteredEmployees].map((e=>e.employeeNo)),l={employeeNumbers:a,dateFrom:e,dateTo:t};fl.loading();for(const[s,i]of Object.entries(this.sourceDisplayList)){const e=this.displayOptions.find((e=>e.key===s));e&&!0===e.isSelected?(this.displayList[s]=i,this.displayList[s].isDisplay=e.isSelected):console.error("key not found",s)}se.GetCostAnalysis(l).then((e=>{if(!e[0])return this.data=[],this.total=[],this.$refs.ModalRef.toggleShow(),void fl.clear();let t=e.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));this.calculatedData=[],this.data=t.map((e=>{let t={...e},a={};t.weekDay=jt()(e.date).format("dddd"),this.sourceDisplayList.scheduledVSBudgeted&&(t.scheduledVSBudgeted=this.calculateRatioPercentage(e.scheduled,e.budgeted)),this.sourceDisplayList.actualsVSBudgeted&&(t.actualsVSBudgeted=this.calculateRatioPercentage(e.actual,e.budgeted)),this.sourceDisplayList.actualsVSScheduled&&(t.actualsVSScheduled=this.calculateDiffPercentage(e.actual,e.scheduled)),this.sourceDisplayList.actualsVSSales&&(t.actualsVSSales=this.calculateRatioPercentage(e.actual,e.sales)),this.sourceDisplayList.scheduledVSSales&&(t.scheduledVSSales=this.calculateRatioPercentage(e.scheduled,e.sales));for(let[l,s]of Object.entries(t))Number.isNaN(s)&&(t[l]=0),a[l]="day"===l||"dayNumber"===l?s:Uy()(t[l]).format({symbol:""});return this.calculatedData.push(t),a})),this.calculateTotal(),fl.clear(),this.$refs.ModalRef.toggleShow()})).catch((e=>{this.data=[],this.total=[]}))},calculateTotal(){const e=[];this.totalInNumber={};for(const[t,a]of Object.entries(this.sourceDisplayList))e.push(t);if(1!==e.length){for(let t of e){this.totalInNumber[t]=0;for(let e of this.calculatedData)e[t]||(e[t]=0),this.totalInNumber[t]=this.totalInNumber[t]+e[t]}this.sourceDisplayList.scheduledVSBudgeted&&(this.totalInNumber.scheduledVSBudgeted=this.calculateRatioPercentage(this.totalInNumber.scheduled,this.totalInNumber.budgeted)),this.sourceDisplayList.actualsVSBudgeted&&(this.totalInNumber.actualsVSBudgeted=this.calculateRatioPercentage(this.totalInNumber.actual,this.totalInNumber.budgeted)),this.sourceDisplayList.actualsVSScheduled&&(this.totalInNumber.actualsVSScheduled=this.calculateDiffPercentage(this.totalInNumber.actual,this.totalInNumber.scheduled)),this.sourceDisplayList.actualsVSSales&&(this.totalInNumber.actualsVSSales=this.calculateRatioPercentage(this.totalInNumber.actual,this.totalInNumber.sales)),this.sourceDisplayList.scheduledVSSales&&(this.totalInNumber.scheduledVSSales=this.calculateRatioPercentage(this.totalInNumber.scheduled,this.totalInNumber.sales));for(let[e,t]of Object.entries(this.totalInNumber))Number.isNaN(t)&&(this.totalInNumber[e]=0),this.total[e]=Uy()(this.totalInNumber[e]).format({symbol:""})}else this.totalInNumber[e[0]]=Math.round(100*this.calculatedData[0][e[0]])/100},calculateDiffPercentage(e,t){return t?(e-t)/t*100:0},calculateRatioPercentage(e,t){return t?e/t*100:0},calculateDisplayRow(){this.displayN=this.displayOptions.filter((e=>e.isSelected)).length},toggleShow(){this.data=[],this.total=[],this.calculatedData=[],this.$refs.ModalRef.toggleShow()},cancelModal(){this.data=[],this.total=[],this.calculatedData=[]}}});const Gy=(0,oe.Z)(zy,[["render",By],["__scopeId","data-v-9d3a1320"]]);var Ky=Gy;const qy=e=>((0,s.dD)("data-v-eb233cc0"),e=e(),(0,s.Cn)(),e),Zy={class:"cell-config-list"},Qy={class:"custom-select",tabindex:"1"},Jy=qy((()=>(0,s._)("div",{class:"custom-select-selected"}," Select Cost Center ",-1))),Xy={class:"custom-select-items"},ef=["onClick"],tf={class:"cell-config"},af=["onUpdate:modelValue"];function lf(e,t,a,i,o,r){const d=(0,s.Q2)("tooltip");return(0,s.wg)(),(0,s.iD)("div",Zy,[(0,s._)("div",null,[(0,s._)("div",Qy,[Jy,(0,s._)("div",Xy,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.costCenterOptions,((t,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"custom-select-item",key:a,onClick:a=>{e.checkOptions(t)}},[(0,s._)("div",tf,[(0,s.wy)(((0,s.wg)(),(0,s.iD)("label",null,[(0,s.Uk)((0,n.zw)(t.description),1)])),[[d,{content:t.description},void 0,{top:!0}]]),(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":e=>t.selected=e},null,8,af),[[l.e8,t.selected]])])],8,ef)))),128))])])])])}var sf=(0,s.aZ)({name:"FlexScheduleCostCenter",props:{costCenterOptions:{type:Array}},setup(){const e=(0,Yt.oR)(),t=(0,Al.iH)(!1),a=(0,Al.iH)([]),l=e.state.LookUp.costCenters;return{open:t,costCenters:l,optionSelected:a}},methods:{checkOptions(e){if(e.selected=!e.selected,-1===e.costCentreId&&this.costCenterOptions){for(const e of this.costCenterOptions)e.selected=!1;this.costCenterOptions[0].selected=!0}else this.costCenterOptions[0].selected=!1;this.$emit("selectOption",this.costCenterOptions)}}});const of=(0,oe.Z)(sf,[["render",lf],["__scopeId","data-v-eb233cc0"]]);var nf=of;const rf=e=>((0,s.dD)("data-v-280cce78"),e=e(),(0,s.Cn)(),e),df={class:"cell-config-list"},cf={class:"custom-select",tabindex:"2"},hf=rf((()=>(0,s._)("div",{class:"custom-select-selected"}," Show/Hide Columns ",-1))),uf={class:"custom-select-items"},mf=["onClick"],pf={class:"cell-config"},yf=["onUpdate:modelValue"];function ff(e,t,a,i,o,r){return(0,s.wg)(),(0,s.iD)("div",df,[(0,s._)("div",cf,[hf,(0,s._)("div",uf,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.columnSettings,((a,i)=>((0,s.wg)(),(0,s.iD)("div",{class:"custom-select-item",key:i,onClick:t=>{e.checkOptions(a)}},[(0,s._)("div",pf,[(0,s._)("label",null,(0,n.zw)(a.name),1),(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":e=>a.value=e,onChange:t[0]||(t[0]=(...t)=>e.optionChanged&&e.optionChanged(...t))},null,40,yf),[[l.e8,a.value]])])],8,mf)))),128))])])])}var gf=(0,s.aZ)({name:"FlexScheduleColumnControl",setup(){const e=(0,Yt.oR)(),t=(0,Al.iH)(!1),a=(0,Al.iH)([]),l=e.state.FlexSchedule.flexScheduleColumnControl;return console.log("flexScheduleColumnControl",l),{open:t,optionSelected:a,columnSettings:l}},methods:{optionChanged(){localStorage.setItem("flexScheduleColumnSetting",JSON.stringify(this.columnSettings)),this.$emit("checkOptions")},checkOptions(e){}}});const Df=(0,oe.Z)(gf,[["render",ff],["__scopeId","data-v-280cce78"]]);var wf,vf=Df;(function(e){e["empty"]="",e["draft"]="draft",e["published"]="published",e["partial"]="partial"})(wf||(wf={}));var Sf=(0,s.aZ)({name:"FlexSchedule",components:{FlexScheduleColumnControl:vf,FlexScheduleCostCenter:nf,CostAnalysisDialog:Ky,AnalysisChart:Zp,PrintableView:Fp,DraftCreationDialog:om,DatePicker:El,TimePicker:su,EditFlexSchedule:rh,DayCell:Ih,FlexScheduleCellControl:qh,Icon:iu.JO,AutoComplete:Mi,ExtraEmpDetail:mp,PublishDialog:Cy,CustomSelect:qi},data(){return{dayFocus:jt()(),weekDays:[],datePickerTop:0,datePickerLeft:0,employeeList:[],scheduleWeekMap:new Map,weekStatus:wf.empty,showControl:!1,extraEmpDetail:[],isAdmin:!1,hasFuturePaidDate:!1,costCenterOptions:[],displayColumnArray:[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],gridTemplateColumns:"8% 90px 90px repeat(7, 1fr);"}},setup(){const e=(0,ea.tv)();window.innerWidth<1010&&e.push({name:"FlexScheduleMobile"});const t=(0,Al.iH)(),a=(0,Al.iH)(),l=(0,Al.iH)(),s=(0,Al.iH)(),i=(0,Al.iH)(),o=(0,Al.iH)(),n=(0,Al.iH)(),r=(0,Al.iH)(!1),d=(0,Al.iH)([]);function c(){n.value.open()}function h(){t.value.toggleShow()}function u(){i.value.toggleShow()}function m(){o.value.toggleShow()}function p(e){r.value=e,a.value.openEdit()}function y(e){fl.loading(),se.GetEmployeeExtraDetail(e).then((e=>{d.value=e.map((e=>("DateTime"===e.InputType?(e.remoteKeyValue=e.KeyValue,e.remoteValue=e.Value,e.KeyValue=jt()(e.KeyValue).format("ddd DD MMM YYYY"),e.Value=jt()(e.Value).format("ddd DD MMM YYYY")):"Double"===e.InputType&&(e.remoteKeyValue=e.KeyValue,e.remoteValue=e.Value,e.KeyValue=Math.round(100*e.KeyValue)/100,e.Value=Math.round(100*e.Value)/100),e))),fl.clear(),l.value.toggleShow()}),(e=>{fl.clear(),fl.alert("Something went wrong")}))}function f(){s.value.printFlexSchedule()}return{openDraftDialog:h,openEditDialog:p,openEmployeeDetail:y,openAnalysisChart:u,printFlexSchedule:f,openPublishDialog:m,openCostAnalysis:c,DraftCreationDialogRef:t,EditModalRef:a,ExtraEmpDetailRef:l,PrintableViewRef:s,AnalysisChartRef:i,PublishDialogRef:o,CostAnalysisDialogRef:n,isEditingDialog:r,externalDetail:d}},async mounted(){this.$store.dispatch(Mh.getPositions,Affinity.user.EmployeeNo),this.$store.dispatch(Mh.getShifts),this.$store.dispatch(Mh.getCostElement),this.$store.dispatch(Mh.getWorkTypes);let e=this.dayFocus.clone().startOf("week"),t=this.dayFocus.clone().endOf("week");this.loadDate(e,t),se.GetDefaultWorkTypes().then((e=>{this.$store.state.FlexSchedule.defaultWorkTypes=e})),Affinity.user.EmployeeNo>=5e6&&(this.isAdmin=!0),this.loadColumnWithSetting()},methods:{showCopy(){return!this.hasFuturePaidDate&&jt()().diff(this.dayFocus.endOf("week"),"day")<=0},reloadAfterEdit(){let e=this.dayFocus.clone().startOf("week"),t=this.dayFocus.clone().endOf("week");this.refreshScheduleData(e,t)},getGridTemplateColumnStyle(){return{"grid-template-columns":this.gridTemplateColumns}},calGridColumn(){const e=["8%","90px","90px","1fr","1fr","1fr","1fr","1fr","1fr","1fr"];let t=e.slice();t=t.map(((e,t)=>0===t||this.displayColumnArray[t-1]?e:"0px"));const a=t.filter(((e,t)=>"0px"===e));a.length>=7&&(t=e.slice(),this.resetColumns()),this.gridTemplateColumns=t.join(" ")},resetColumns(){this.displayColumnArray.forEach(((e,t)=>{this.displayColumnArray[t]=!0})),this.$store.state.FlexSchedule.flexScheduleColumnControl.forEach((e=>{e.value=!0}));const e=this.$store.state.FlexSchedule.flexScheduleColumnControl;localStorage.setItem("flexScheduleColumnSetting",JSON.stringify(e))},hideColumn(e){const t=this.$store.state.FlexSchedule.flexScheduleColumnControl;t[e-1].value=!1,this.displayColumnArray[e-1]=!this.displayColumnArray[e-1],this.calGridColumn(),localStorage.setItem("flexScheduleColumnSetting",JSON.stringify(t))},loadColumnWithSetting(){const e=this.$store.state.FlexSchedule.flexScheduleColumnControl;this.displayColumnArray=e.map((e=>e.value)),this.calGridColumn()},getCurrentWeekStatus(){return this.weekStatus===wf.empty||this.weekStatus===wf.draft?"Draft":this.weekStatus===wf.partial?"Partially Published":this.weekStatus===wf.published?"Published":this.weekStatus},async loadDate(e,t){this.weekStatus=wf.empty,this.showControl=!1,this.hasFuturePaidDate=!1;let a={managerEmployeeNo:Affinity.user.EmployeeNo,dateFrom:e.format("YYYY-MM-DD"),dateTo:t.format("YYYY-MM-DD")};fl.loading();let[l,s,i]=await Promise.all([this.$store.dispatch($t.loadFlexiSchedules,{startDate:e,endDate:t}),se.GetManagedLeaves(a),this.$store.dispatch(fi.getEmployees,Affinity.user.EmployeeNo)]).finally((()=>{fl.clear()}));fl.clear(),this.setupGridData(l,s,i,e),this.$store.state.FlexSchedule.leaveList=s,this.setupDate(e),this.checkStatus(this.scheduleWeekMap),this.setupCostCenterList(i)},async refreshScheduleData(e,t){this.weekStatus=wf.empty,this.showControl=!1,this.hasFuturePaidDate=!1,fl.loading();const a=await this.$store.dispatch($t.loadFlexiSchedules,{startDate:e,endDate:t});fl.clear(),this.setupGridData(a,this.$store.state.FlexSchedule.leaveList,this.$store.getters[pi.getEmployees],e),this.checkStatus(this.scheduleWeekMap);for(const[l,s]of this.scheduleWeekMap.entries())s.show=!1;for(const l of this.$store.state.EmployeeModule.filteredEmployees){const e=this.scheduleWeekMap.get(l.employeeNo);e.show=!0}},setupGridData(e,t,a,l){let s=iy.prepareGridData(l,a,e,t);iy.scheDaysToColumn(l,s),iy.addLeaveToGrid(l,t,s),iy.addUnAvaToGrid(e,s),this.scheduleWeekMap=this.$store.state.FlexSchedule.scheduleWeek=s},setupDate(e){this.$store.state.FlexSchedule.calendarFocusDate=this.dayFocus,this.weekDays=this.getSelectedWeek(e)},setupCostCenterList(e){const t=e.map((e=>e.cost1)),a=[...new Set(t)];this.$store.dispatch(Mh.getCostCenters,a).then((()=>{this.costCenterOptions=this.$store.state.LookUp.costCenters,this.costCenterOptions=this.costCenterOptions.map((e=>(e.selected=!1,e))),this.costCenterOptions.unshift({costCentreId:-1,description:"All",selected:!0})}))},selectCostCenter(e){this.costCenterOptions.filter((e=>e.selected));const t=e.map((e=>!!e.selected&&e.costCentreId));if(t.find((e=>-1===e))){for(const[e,t]of this.scheduleWeekMap.entries())t.show=!0;return void(this.$store.state.EmployeeModule.filteredEmployees=this.$store.state.EmployeeModule.employees)}let a=this.$store.state.EmployeeModule.employees.filter((e=>!!t.find((t=>t===e.cost1))));this.$store.state.EmployeeModule.filteredEmployees=a;for(const[l,s]of this.scheduleWeekMap.entries())s.show=!1;for(const l of a){const e=this.scheduleWeekMap.get(l.employeeNo);e.show=!0}},checkStatus(e){let t=new Set;for(const a of e.values()){a.empSchePublishState="";for(const t of a.sche)t.publishStatus&&(t.publishStatus===wf.draft?a.empSchePublishState=wf.draft:t.publishStatus===wf.published&&(a.empSchePublishState=wf.published)),!this.hasFuturePaidDate&&t.isPaid&&jt()(0,"HH").diff(jt()(t.date),"days")<=-1&&(this.hasFuturePaidDate=!0);""===a.empSchePublishState?t.add(wf.empty):t.add(a.empSchePublishState);let e=a.sche.find((e=>"Personal"===e.scheduleType||"Team"===e.scheduleType));e&&(a.includeTeamOrPersonal=!0)}t.has(wf.published)?t.has(wf.draft)&&t.has(wf.published)||t.has(wf.empty)&&t.has(wf.published)?this.weekStatus=wf.partial:this.weekStatus=wf.published:this.weekStatus=wf.draft},async chooseCalendarDate(e){let t,a=e.target.getClientRects()[0];this.datePickerTop=a.bottom,this.datePickerLeft=a.left;try{t=await this.$refs.DatePickerRef.toggleShow(this.dayFocus)}catch(l){return}await this.selectDate(t)},async selectDate(e){this.dayFocus=e,this.$store.state.FlexSchedule.calendarFocusDate=e;let t=e.clone().startOf("week"),a=e.clone().endOf("week");await this.loadDate(t,a)},getSelectedWeek(e){var t=e.clone().startOf("week");e.clone().endOf("week");let a=[];for(let l=0;l<=6;l++){let e=jt()(t).add(l,"days");a.push({momentDay:e,day:e.format("ddd, MMM Do")})}return a},getLastWeek(){this.dayFocus.subtract(7,"days");let e=this.dayFocus.clone().startOf("week"),t=this.dayFocus.clone().endOf("week");this.loadDate(e,t)},getNextWeek(){this.dayFocus.add(7,"days");let e=this.dayFocus.clone().startOf("week"),t=this.dayFocus.clone().endOf("week");this.loadDate(e,t)},moreDetail(e){this.$store.commit(Bt.setScheduleDay,e)},getTotalHour(e){let t=0;for(let a of e)a.hours&&(t+=a.hours);return t.toFixed(2)},confirmEdit(e){e.editing=!1},cancelEdit(e){},editScheDay(e){e.editing=!0},selectEmployeeAndPublish(){this.PublishDialogRef.setSelectedDate(this.dayFocus.week().toString()),this.openPublishDialog()},publishCurrentWeek(e){let t=this.dayFocus.clone().startOf("week"),a=this.dayFocus.clone().endOf("week"),l={EmployeeNumbers:e,DateFrom:t.format("YYYY-MM-DD"),DateTo:a.format("YYYY-MM-DD")};fl.loading(),se.PublishFlexSchedule(l).then((()=>{fl.clear(),this.reloadAfterEdit()}),(e=>{408!=e.response.status?(console.error(e),fl.alert("Something went wrong.")):fl.alert("Your schedules are being published. This process can take a few minutes. You will need to refresh your screen to see the published schedules.")}))},changeDisplayControl(){this.showControl=!this.showControl}}});const bf=(0,oe.Z)(Sf,[["render",uc],["__scopeId","data-v-2f764bfc"]]);var kf=bf;const Cf=e=>((0,s.dD)("data-v-b4550fd6"),e=e(),(0,s.Cn)(),e),Af={class:"mt-4"},xf=(0,s.uE)('<div class="left-box ml-2" data-v-b4550fd6><div class="background-legend" data-v-b4550fd6><div data-v-b4550fd6><div class="flexi-legend" data-v-b4550fd6></div><div class="legend-label" data-v-b4550fd6>Flexi Schedule</div></div><div class="ml-4" data-v-b4550fd6><div class="team-legend" data-v-b4550fd6></div><div class="legend-label" data-v-b4550fd6>Team Schedule</div></div><div class="ml-4" data-v-b4550fd6><div class="personal-legend" data-v-b4550fd6></div><div class="legend-label" data-v-b4550fd6>Personal Schedule</div></div></div></div>',1),_f={class:"weekDetail d-flex align-center justify-center"},Tf={class:"mt-4",style:{overflow:"auto"}},Ef={class:"flex-sche-table"},Mf=Cf((()=>(0,s._)("div",{class:"table-head"},[(0,s._)("div",{class:"schedule-head-grid"},[(0,s._)("div",{class:"table-cell"},"Employee"),(0,s._)("div",{class:"table-cell"},"Schedule")])],-1))),Nf={class:"table-body"},Ff={class:"schedules-arr"},Pf=["onClick"],Of={key:0,class:"published-icon"},Hf=Cf((()=>(0,s._)("span",null,"P",-1))),Yf=[Hf],If={class:"content-cell"};function Lf(e,t){const a=(0,s.up)("Icon"),l=(0,s.up)("day-cell"),i=(0,s.up)("perfect-scrollbar"),o=(0,s.up)("edit-flex-schedule"),r=(0,s.up)("date-picker"),d=(0,s.up)("extra-emp-detail");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",Af,[xf,(0,s._)("div",_f,[(0,s._)("span",{class:"arrow-height mr-4",onClick:t[0]||(t[0]=t=>e.getLastDate())},[(0,s.Wm)(a,{icon:e.$icons.chevronLeft,height:"30",style:{color:"#0000008a"}},null,8,["icon"])]),(0,s._)("span",{onClick:t[1]||(t[1]=(...t)=>e.chooseCalendarDate&&e.chooseCalendarDate(...t))},(0,n.zw)(e.$filters.ordinalSuffix(e.dayFocus.week()))+" Week, "+(0,n.zw)(e.dayFocus.format("DD/MM/YYYY")),1),(0,s._)("span",{class:"arrow-height ml-4",onClick:t[2]||(t[2]=t=>e.getNextDate())},[(0,s.Wm)(a,{icon:e.$icons.chevronRight,height:"30",style:{color:"#0000008a"}},null,8,["icon"])])])]),(0,s._)("div",Tf,[(0,s._)("div",Ef,[Mf,(0,s.Wm)(i,null,{default:(0,s.w5)((()=>[(0,s._)("div",Nf,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.scheduleWeekMap.keys(),(t=>((0,s.wg)(),(0,s.iD)("div",Ff,[(0,s._)("div",{class:"content-cell content-employee-name",onClick:a=>e.openEmployeeDetail(t)},[(0,s._)("span",null,(0,n.zw)(e.scheduleWeekMap.get(t).employeeName),1),"published"===e.scheduleWeekMap.get(t).empSchePublishState?((0,s.wg)(),(0,s.iD)("span",Of,Yf)):(0,s.kq)("",!0)],8,Pf),(0,s._)("div",If,[(0,s.Wm)(l,{scheDay:e.scheduleWeekMap.get(t).sche,employeeNo:e.scheduleWeekMap.get(t).employeeNo,employeeName:e.scheduleWeekMap.get(t).employeeName,onOpenEditDialog:e.openEditDialog},null,8,["scheDay","employeeNo","employeeName","onOpenEditDialog"])])])))),256))])])),_:1})])]),(0,s._)("div",null,[(0,s.Wm)(o,{ref:"EditModalRef",isEdit:e.isEditingDialog,weekStatus:e.weekStatus,modalIndex:1999,onReload:e.reloadAfterEdit},null,8,["isEdit","weekStatus","onReload"]),(0,s.Wm)(r,{ref:"DatePickerRef",top:e.datePickerTop,left:e.datePickerLeft},null,8,["top","left"]),(0,s.Wm)(d,{ref:"ExtraEmpDetailRef",externalDetail:e.externalDetail},null,8,["externalDetail"])])],64)}var Wf;(function(e){e["empty"]="",e["draft"]="draft",e["published"]="published",e["partial"]="partial"})(Wf||(Wf={}));var jf=(0,s.aZ)({name:"FlexScheduleM",components:{CostAnalysisDialog:Ky,AnalysisChart:Zp,PrintableView:Fp,DraftCreationDialog:om,DatePicker:El,TimePicker:su,EditFlexSchedule:rh,DayCell:Ih,FlexScheduleCellControl:qh,Icon:iu.JO,AutoComplete:Mi,ExtraEmpDetail:mp,PublishDialog:Cy},data(){return{dayFocus:jt()(),weekDays:[],datePickerTop:0,datePickerLeft:0,employeeList:[],scheduleWeekMap:new Map,weekStatus:Wf.empty,showControl:!1,extraEmpDetail:[],isAdmin:!1,hasFuturePaidDate:!1}},setup(){const e=(0,Al.iH)(),t=(0,Al.iH)(),a=(0,Al.iH)(!1),l=(0,Al.iH)([]),s=(0,ea.tv)();function i(t){a.value=t,e.value.openEdit()}function o(e){fl.loading(),se.GetEmployeeExtraDetail(e).then((e=>{l.value=e.map((e=>("DateTime"===e.InputType?(e.remoteKeyValue=e.KeyValue,e.remoteValue=e.Value,e.KeyValue=jt()(e.KeyValue).format("ddd DD MMM YYYY"),e.Value=jt()(e.Value).format("ddd DD MMM YYYY")):"Double"===e.InputType&&(e.remoteKeyValue=e.KeyValue,e.remoteValue=e.Value,e.KeyValue=Math.round(100*e.KeyValue)/100,e.Value=Math.round(100*e.Value)/100),e))),fl.clear(),t.value.toggleShow()}),(e=>{fl.clear(),fl.alert("Something went wrong")}))}return window.innerWidth>=1010&&s.push({name:"Flex Schedule"}),{openEditDialog:i,openEmployeeDetail:o,EditModalRef:e,ExtraEmpDetailRef:t,isEditingDialog:a,externalDetail:l}},async mounted(){this.$store.dispatch(Mh.getPositions,Affinity.user.EmployeeNo),this.$store.dispatch(Mh.getShifts),this.$store.dispatch(Mh.getCostElement),this.$store.dispatch(Mh.getWorkTypes),this.loadDate(),se.GetDefaultWorkTypes().then((e=>{this.$store.state.FlexSchedule.defaultWorkTypes=e})),Affinity.user.EmployeeNo>=5e6&&(this.isAdmin=!0)},methods:{showCopy(){return!this.hasFuturePaidDate&&jt()().diff(this.dayFocus.endOf("week"),"day")<=0},reloadAfterEdit(){this.loadDate()},getCurrentWeekStatus(){return this.weekStatus===Wf.empty||this.weekStatus===Wf.draft?"Draft":this.weekStatus===Wf.partial?"Partially Published":this.weekStatus===Wf.published?"Published":this.weekStatus},async loadDate(){this.weekStatus=Wf.empty,this.showControl=!1,this.hasFuturePaidDate=!1;let e={managerEmployeeNo:Affinity.user.EmployeeNo,dateFrom:this.dayFocus.format("YYYY-MM-DD"),dateTo:this.dayFocus.format("YYYY-MM-DD")};fl.loading();let[t,a,l]=await Promise.all([this.$store.dispatch($t.loadFlexiSchedules,{startDate:this.dayFocus,endDate:this.dayFocus}),se.GetManagedLeaves(e),this.$store.dispatch(fi.getEmployees,Affinity.user.EmployeeNo).then((e=>e.map((e=>({employeeName:e.commonName,employeeNo:e.employeeNo,stdHoursPerWeek:e.stdHoursPerWeek,positionCode:e.positionCode})))))]).finally((()=>{fl.clear()}));fl.clear();let s=iy.prepareGridDataMobile(this.dayFocus,l,t,a);this.scheduleWeekMap=s,iy.addUnAvaToGridMobile(t,s),iy.addLeaveToGridMobile(a,s)},checkStatus(e){let t=new Set;for(const a of e.values()){a.empSchePublishState="";for(const e of a.sche)e.publishStatus&&(e.publishStatus===Wf.draft?a.empSchePublishState=Wf.draft:e.publishStatus===Wf.published&&(a.empSchePublishState=Wf.published)),!this.hasFuturePaidDate&&e.isPaid&&jt()(0,"HH").diff(jt()(e.date),"days")<=-1&&(this.hasFuturePaidDate=!0);""===a.empSchePublishState?t.add(Wf.empty):t.add(a.empSchePublishState)}t.has(Wf.published)?t.has(Wf.draft)&&t.has(Wf.published)||t.has(Wf.empty)&&t.has(Wf.published)?this.weekStatus=Wf.partial:this.weekStatus=Wf.published:this.weekStatus=Wf.draft},async chooseCalendarDate(e){let t,a=e.target.getClientRects()[0];this.datePickerTop=a.bottom,this.datePickerLeft=a.left;try{t=await this.$refs.DatePickerRef.toggleShow(this.dayFocus)}catch(l){return}await this.selectDate(t)},async selectDate(e){this.dayFocus=e,this.$store.state.FlexSchedule.calendarFocusDate=e,await this.loadDate()},getSelectedWeek(e){var t=e.clone().startOf("week");e.clone().endOf("week");let a=[];for(let l=0;l<=6;l++){let e=jt()(t).add(l,"days");a.push({momentDay:e,day:e.format("ddd, MMM Do")})}return a},getLastDate(){this.dayFocus=this.dayFocus.clone().subtract(1,"days"),this.$store.state.FlexSchedule.calendarFocusDate=this.dayFocus,this.loadDate()},getNextDate(){this.dayFocus=this.dayFocus.clone().add(1,"days"),this.$store.state.FlexSchedule.calendarFocusDate=this.dayFocus,this.loadDate()},moreDetail(e){this.$store.commit(Bt.setScheduleDay,e)},getTotalHour(e){let t=0;for(let a of e)a.hours&&(t+=a.hours);return t.toFixed(2)},confirmEdit(e){e.editing=!1},cancelEdit(e){},editScheDay(e){e.editing=!0},publishCurrentWeek(e){let t=this.dayFocus.clone().startOf("week"),a=this.dayFocus.clone().endOf("week"),l={EmployeeNumbers:e,DateFrom:t.format("YYYY-MM-DD"),DateTo:a.format("YYYY-MM-DD")};fl.loading(),se.PublishFlexSchedule(l).then((()=>{this.reloadAfterEdit(),fl.clear()}),(e=>{console.error(e),fl.alert("Something went wrong.")}))},changeDisplayControl(){this.showControl=!this.showControl}}});const Rf=(0,oe.Z)(jf,[["render",Lf],["__scopeId","data-v-b4550fd6"]]);var $f=Rf;const Bf=e=>((0,s.dD)("data-v-69f9b2fb"),e=e(),(0,s.Cn)(),e),Vf=Bf((()=>(0,s._)("p",{class:"mt-4"},[(0,s.Uk)("I am "),(0,s._)("b",null,"unavailable"),(0,s.Uk)(" during these times:")],-1))),Uf={class:"available-table mt-4"},zf={class:"service-grid"},Gf=(0,s.uE)('<div class="grid-heading" data-v-69f9b2fb>Day of Week</div><div class="grid-heading" data-v-69f9b2fb>Start Time</div><div class="grid-heading" data-v-69f9b2fb>End Time</div><div class="grid-heading" data-v-69f9b2fb>Repeat</div><div class="grid-heading" data-v-69f9b2fb>Starts On</div><div class="grid-heading" data-v-69f9b2fb>Ends On</div><div class="grid-heading" data-v-69f9b2fb>Actions</div><div class="grid-heading" data-v-69f9b2fb>Reason</div>',8),Kf={class:"grid-item"},qf={class:"grid-item"},Zf={class:"grid-item"},Qf={class:"grid-item"},Jf={class:"grid-item"},Xf={class:"grid-item"},eg={class:"grid-item"},tg=["onClick"],ag=["onClick"],lg={class:"grid-item"},sg={class:"d-flex justify-end mt-4"};function ig(e,t,a,l,i,o){const r=(0,s.up)("edit-availability");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",null,[Vf,(0,s._)("div",Uf,[(0,s._)("div",zf,[Gf,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.girdData,(t=>((0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",Kf,(0,n.zw)(t.dayOfWeek),1),(0,s._)("div",qf,(0,n.zw)(t.startTime),1),(0,s._)("div",Zf,(0,n.zw)(t.endTime),1),(0,s._)("div",Qf,(0,n.zw)(t.frequencyType),1),(0,s._)("div",Jf,(0,n.zw)(t.startDate),1),(0,s._)("div",Xf,(0,n.zw)(t.endDate),1),(0,s._)("div",eg,[(0,s._)("button",{class:"green white--text xsmall",onClick:a=>e.openEditDialog(!0,t)},"Edit",8,tg),(0,s._)("button",{class:"grey white--text xsmall ml-2",onClick:a=>e.confirmDelete(t)},"Delete",8,ag)]),(0,s._)("div",lg,(0,n.zw)(t.reason),1)],64)))),256))])]),(0,s._)("div",sg,[(0,s._)("button",{class:"green small white--text",onClick:t[0]||(t[0]=t=>e.openEditDialog(!1))},"Create")])]),(0,s.Wm)(r,{ref:"EditAvailabilityRef",isEdit:e.isEditingDialog,onReload:e.loadAvailability,modalIndex:1999},null,8,["isEdit","onReload"])],64)}const og=e=>((0,s.dD)("data-v-a3a9af32"),e=e(),(0,s.Cn)(),e),ng={class:"bold"},rg={key:0},dg={key:1},cg={class:"edit-form mt-4 copy2"},hg=og((()=>(0,s._)("label",{class:"form-label"},"Start Time ",-1))),ug={class:"mt-2"},mg=og((()=>(0,s._)("label",{class:"form-label"},"End Time ",-1))),pg={class:"mt-4"},yg=og((()=>(0,s._)("label",{class:"form-label"},"Day of Week",-1))),fg={class:"select-day-of-week"},gg={class:"mt-2"},Dg=og((()=>(0,s._)("label",{class:"form-label"},"Repeat",-1))),wg={class:"select-repeat"},vg={class:"mt-4"},Sg=og((()=>(0,s._)("label",{class:"form-label"},"Start On",-1))),bg={class:"mt-2 endDateWidth"},kg={key:0},Cg=og((()=>(0,s._)("label",{class:"form-label"},"End On",-1))),Ag={class:"ml-2"},xg=og((()=>(0,s._)("label",{class:"checkbox-label"},"No End Date",-1))),_g={class:"mt-2"},Tg=og((()=>(0,s._)("label",{class:"form-label"},"Reason",-1))),Eg={class:"mt-4 full-width d-flex justify-end"},Mg=og((()=>(0,s._)("span",{class:"white"},"Save",-1))),Ng=[Mg],Fg=og((()=>(0,s._)("span",{class:"white"},"Delete",-1))),Pg=[Fg],Og=og((()=>(0,s._)("span",{class:"white"},"Create",-1))),Hg=[Og],Yg=og((()=>(0,s._)("span",{class:"white"},"Cancel",-1))),Ig=[Yg];function Lg(e,t){const a=(0,s.up)("custom-select"),i=(0,s.up)("date-picker"),o=(0,s.up)("Modal");return(0,s.wg)(),(0,s.j4)(o,{ref:"ModalRef"},{header:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s._)("h2",ng,[e.isEdit?((0,s.wg)(),(0,s.iD)("span",rg,"Edit Unavailability")):((0,s.wg)(),(0,s.iD)("span",dg,"Create Unavailability"))])])])),body:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s._)("div",cg,[(0,s._)("div",null,[hg,(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.startTime=t),onChange:t[1]||(t[1]=(...t)=>e.updateStartTime&&e.updateStartTime(...t))},null,544),[[l.nr,e.startTime]])]),(0,s._)("div",ug,[mg,(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.endTime=t),onChange:t[3]||(t[3]=(...t)=>e.updateEndTime&&e.updateEndTime(...t))},null,544),[[l.nr,e.endTime]])]),(0,s._)("div",pg,[yg,(0,s._)("div",fg,[(0,s.Wm)(a,{options:e.dayOfWeekOption,modelValue:e.selectedDayOfWeek,"onUpdate:modelValue":t[4]||(t[4]=t=>e.selectedDayOfWeek=t),modelModifiers:{modelValue:!0}},null,8,["options","modelValue"])])]),(0,s._)("div",gg,[Dg,(0,s._)("div",wg,[(0,s.Wm)(a,{options:e.repeatOption,modelValue:e.selectedRepeat,"onUpdate:modelValue":[t[5]||(t[5]=t=>e.selectedRepeat=t),e.updateRepeat],modelModifiers:{modelValue:!0}},null,8,["options","modelValue","onUpdate:modelValue"])])]),(0,s._)("div",vg,[Sg,(0,s.wy)((0,s._)("input",{class:"input-box",type:"text","onUpdate:modelValue":t[6]||(t[6]=t=>e.startDateText=t),onChange:t[7]||(t[7]=t=>e.updateDateTimeText("startDate")),onClick:t[8]||(t[8]=t=>e.updateDateTime(t,"startDate"))},null,544),[[l.nr,e.startDateText]])]),(0,s._)("div",bg,[e.endDateDisable?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",kg,[Cg,(0,s.wy)((0,s._)("input",{class:"input-box",type:"text","onUpdate:modelValue":t[9]||(t[9]=t=>e.endDateText=t),onChange:t[10]||(t[10]=t=>e.updateDateTimeText("endDate")),onClick:t[11]||(t[11]=t=>e.updateDateTime(t,"endDate"))},null,544),[[l.nr,e.endDateText]]),(0,s._)("span",Ag,[(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=t=>e.noEndDate=t),onChange:t[13]||(t[13]=(...t)=>e.clickedNoEndDate&&e.clickedNoEndDate(...t))},null,544),[[l.e8,e.noEndDate]]),xg])]))]),(0,s._)("div",_g,[Tg,(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":t[14]||(t[14]=t=>e.reason=t)},null,512),[[l.nr,e.reason]])])]),(0,s.Wm)(i,{ref:"DatePickerRef",top:e.datePickerTop,left:e.datePickerLeft},null,8,["top","left"])])])),footer:(0,s.w5)((()=>[(0,s._)("div",Eg,[e.isEdit?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"blue normal copy2",onClick:t[15]||(t[15]=t=>e.updateAvailability())},Ng)):(0,s.kq)("",!0),e.isEdit?((0,s.wg)(),(0,s.iD)("button",{key:1,class:"grey normal copy2 ml-2",onClick:t[16]||(t[16]=t=>e.confirmDelete())},Pg)):(0,s.kq)("",!0),e.isEdit?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:2,class:"blue normal copy2",onClick:t[17]||(t[17]=t=>e.createAvailability())},Hg)),(0,s._)("button",{class:"ml-2 normal orange copy2",onClick:t[18]||(t[18]=t=>e.cancel())},Ig)])])),_:1},512)}const Wg=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],jg=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Rg=["Once","Weekly","Fortnightly"];function $g(e){return jg[Wg.indexOf(e)]}function Bg(e){return Wg[jg.indexOf(e)]}const Vg={shortWeekDays:Wg,fullWeekDays:jg,frequencyCycle:Rg,findFullDaysByShort:$g,findShortDayByFull:Bg};var Ug=Vg,zg=(0,s.aZ)({name:"EditAvailability",components:{Modal:xe,CustomSelect:qi,DatePicker:El},props:{isEdit:{type:Boolean},weekStatus:{type:String}},data(){return{ava:null,employeeNo:0,startTime:"",endTime:"",dayOfWeekOption:Ug.fullWeekDays,selectedDayOfWeek:"Monday",repeatOption:Ug.frequencyCycle,selectedRepeat:"Weekly",datePickerTop:0,datePickerLeft:0,startDate:jt()(),startDateText:"",endDate:jt()(),endDateText:"",reason:"",noEndDate:!0,endDateDisable:!1}},setup(){return{}},watch:{selectedDayOfWeek(e,t){}},methods:{reset(){this.ava=null,this.employeeNo=0,this.startTime="",this.endTime="",this.startDate=jt()(),this.startDateText="",this.endDate=jt()(),this.endDateText="",this.reason="",this.selectedRepeat="Weekly",this.noEndDate=!0,this.endDateDisable=!1},updateStartTime(){this.startTime=Zt.parseTimeColumn(this.startTime)},updateEndTime(){this.endTime=Zt.parseTimeColumn(this.endTime)},updateRepeat(){"Once"===this.selectedRepeat?this.endDateDisable=!0:this.endDateDisable=!1},clickedNoEndDate(){this.noEndDate&&(this.endDateText="",this.endDate=null)},createAvailability(){fl.loading();let e=this.endDateText?this.endDate.format("DD/MMM/YYYY"):null;e=this.noEndDate||this.endDateDisable?null:e;let t=[{employeeNo:Affinity.user.EmployeeNo,startTime:this.startTime,endTime:this.endTime,dayOfWeek:Ug.findShortDayByFull(this.selectedDayOfWeek),dayOfMonth:null,frequencyType:this.selectedRepeat,startDate:this.startDate.format("DD/MMM/YYYY"),endDate:e,reason:this.reason,hasNoEndDate:this.noEndDate}];se.CreateAvailability(t).then((e=>{fl.clear(),this.$emit("reload"),this.$refs.ModalRef.toggleShow()}))},updateDateTimeText(e){if("endDate"===e)if(""===this.endDateText)this.endDate=null;else{this.noEndDate=!1;const e=jt()(this.endDateText,"DD/MM/YYYY");e.isValid()&&(this.endDate=e)}else if("startDate"===e)if(""===this.startDateText)this.startDate=null;else{this.noEndDate=!1;const e=jt()(this.startDateText,"DD/MM/YYYY");e.isValid()&&(this.startDate=e)}},confirmDelete(){fl.confirmOrCancel({message:"Are you sure you want to delete this period of unavailability?"}).then((()=>{se.DeleteAvailabilities(this.ava.id).then((e=>{this.$emit("reload"),this.$refs.ModalRef.toggleShow()}),(e=>{fl.alert("Something went wrong. Delete Availability failed")}))}))},updateAvailability(){let e=this.endDateText?this.endDate.format("DD/MMM/YYYY"):null;e=this.noEndDate||this.endDateDisable?null:e,fl.loading();let t=[{Id:this.ava.id,StartTime:this.startTime,EndTime:this.endTime,DayOfWeek:Ug.findShortDayByFull(this.selectedDayOfWeek),DayOfMonth:null,FrequencyType:this.selectedRepeat,StartDate:this.startDate.format("DD/MMM/YYYY"),EndDate:e,Reason:this.reason,HasNoEndDate:this.noEndDate}];se.PatchAvailabilities(t).then((e=>{fl.clear(),this.$emit("reload"),this.$refs.ModalRef.toggleShow()}))},async updateDateTime(e,t){let a=e.target.getClientRects()[0];this.datePickerTop=a.bottom,this.datePickerLeft=a.left;try{switch(t){case"startDate":return this.startDate=await this.$refs.DatePickerRef.toggleShow(this.startDate),void(this.startDateText=this.startDate.format("DD/MM/YYYY"));case"endDate":return this.endDate&&this.endDate.isValid()||(this.endDate=jt()()),this.endDate=await this.$refs.DatePickerRef.toggleShow(this.endDate),this.endDateText=this.endDate.format("DD/MM/YYYY"),void(this.noEndDate=!1)}}catch(l){return}},openEditDialog(e){e?(this.ava=e,this.employeeNo=Affinity.user.EmployeeNo,this.startTime=e.startTime,this.endTime=e.endTime,this.selectedDayOfWeek=e.dayOfWeek,this.selectedRepeat=e.frequencyType,this.startDateText=e.startDate,this.startDate=jt()(this.startDateText,"DD/MM/YYYY"),this.endDateText=e.endDate?e.endDate:"",this.endDate=jt()(this.endDateText,"DD/MM/YYYY"),this.reason=e.reason,this.noEndDate=e.hasNoEndDate):this.reset(),this.$refs.ModalRef.toggleShow()},cancel(){this.toggleShow()},toggleShow(){this.$refs.ModalRef.toggleShow()}}});const Gg=(0,oe.Z)(zg,[["render",Lg],["__scopeId","data-v-a3a9af32"]]);var Kg=Gg,qg=(0,s.aZ)({components:{EditAvailability:Kg},data(){return{}},setup(){const e=(0,Al.iH)(!1),t=(0,Al.iH)(),a=(0,Al.iH)([]),l=(0,Al.iH)();function i(a,l){e.value=a,t.value.openEditDialog(l)}function o(){se.GetAvailabilities(Affinity.user.EmployeeNo).then((e=>{let t=e.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));a.value=t.map((e=>(e.startDate=jt()(e.startDate).format("DD/MM/YYYY"),e.endDate&&(e.endDate=jt()(e.endDate).format("DD/MM/YYYY")),e.dayOfWeek=Ug.findFullDaysByShort(e.dayOfWeek),e)))}))}return(0,s.bv)((()=>{o()})),{girdData:a,openEditDialog:i,selectedAva:l,loadAvailability:o,isEditingDialog:e,EditAvailabilityRef:t}},mounted(){},methods:{confirmDelete(e){fl.confirmOrCancel({message:"Are you sure you want to delete this period of unavailability?"}).then((()=>{this.deleteAva(e.id)}))},deleteAva(e){se.DeleteAvailabilities(e).then((e=>{this.loadAvailability()}),(e=>{fl.alert("Something went wrong. Delete Availability failed")}))}}});const Zg=(0,oe.Z)(qg,[["render",ig],["__scopeId","data-v-69f9b2fb"]]);var Qg=Zg;const Jg=(0,s._)("link",{href:"https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css",rel:"stylesheet",integrity:"sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1",crossorigin:"anonymous"},null,-1),Xg={class:"col-sm-4"},eD=(0,s._)("p",null,"Login form style 3",-1),tD={class:"card"},aD={class:"card-body"},lD=(0,s._)("h4",{class:"card-title text-center mb-4 mt-1"},"Sign in",-1),sD=(0,s._)("hr",null,null,-1),iD=(0,s._)("p",{class:"text-success text-center"},"Some message goes here",-1),oD={class:"form-group"},nD={class:"input-group"},rD={class:"form-group mt-2"},dD={class:"input-group"},cD=(0,s._)("div",{class:"form-group mt-4"},[(0,s._)("button",{type:"submit",class:"btn btn-primary btn-block"}," Login ")],-1);function hD(e,t,a,i,o,n){return(0,s.wg)(),(0,s.iD)(s.HY,null,[Jg,(0,s._)("aside",Xg,[eD,(0,s._)("div",tD,[(0,s._)("article",aD,[lD,sD,iD,(0,s._)("form",{onSubmit:t[2]||(t[2]=(0,l.iM)(((...e)=>n.login&&n.login(...e)),["prevent"]))},[(0,s._)("div",oD,[(0,s._)("div",nD,[(0,s.wy)((0,s._)("input",{name:"",class:"form-control",placeholder:"Email or login","onUpdate:modelValue":t[0]||(t[0]=e=>o.username=e)},null,512),[[l.nr,o.username]])])]),(0,s._)("div",rD,[(0,s._)("div",dD,[(0,s.wy)((0,s._)("input",{class:"form-control",placeholder:"******",type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>o.password=e)},null,512),[[l.nr,o.password]])])]),cD],32)])])])],64)}var uD={name:"Login",data(){return{username:"",password:""}},methods:{login(){console.log("login"),console.log(this.username),console.log(this.password),v().post("http://localhost:11140/api/Authentication/post",{username:this.username,password:this.password}).then((e=>{console.log("res",e)}))}}};const mD=(0,oe.Z)(uD,[["render",hD]]);var pD=mD;const yD=e=>((0,s.dD)("data-v-ca59bc9e"),e=e(),(0,s.Cn)(),e),fD={class:"d-flex justify-space-between align-center"},gD={class:"mt-2 ml-2 analytic-date-picker pa-2"},DD=yD((()=>(0,s._)("label",null,"Select View",-1))),wD={class:"ml-4"},vD=yD((()=>(0,s._)("span",{class:"input-label"},"From Date",-1))),SD={class:"ml-4"},bD=yD((()=>(0,s._)("span",{class:"input-label"},"End Date",-1))),kD={class:"ml-4"};function CD(e,t){const a=(0,s.up)("custom-select"),i=(0,s.up)("CostDetailAnalysisV2"),o=(0,s.up)("CostAnalysisV2"),n=(0,s.up)("date-picker");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",fD,[(0,s._)("div",gD,[DD,(0,s.Wm)(a,{class:"ml-2",options:e.options,selected:e.selectedView,onSelectOption:e.selectGridData},null,8,["options","selected","onSelectOption"]),(0,s._)("div",wD,[vD,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.fromDateText=t),class:"input-box ml-2",type:"text",onClick:t[1]||(t[1]=t=>e.updateFromDateTime(t,e.fromDate))},null,512),[[l.nr,e.fromDateText]])]),(0,s._)("div",SD,[bD,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.toDateText=t),class:"input-box ml-2",type:"text",onClick:t[3]||(t[3]=t=>e.updateToDateTime(t,e.toDate))},null,512),[[l.nr,e.toDateText]])]),(0,s._)("div",kD,[(0,s._)("button",{class:"light-blue small action-button white",onClick:t[4]||(t[4]=t=>e.loadGridDataBySelection())},"Show")])]),(0,s._)("div",null,[(0,s._)("button",{class:"light-blue small action-button white",onClick:t[5]||(t[5]=(...t)=>e.exportCSVByView&&e.exportCSVByView(...t))},"Export CSV")])]),(0,s.wy)((0,s._)("div",null,[(0,s.Wm)(i,{ref:"CostDetailAnalysisRef",fromDate:e.fromDate,toDate:e.toDate,"employee-list":e.employeeList},null,8,["fromDate","toDate","employee-list"])],512),[[l.F8,"Detailed Cost Report"===e.selectedView&&e.employeeList.length>0]]),(0,s.wy)((0,s._)("div",null,[(0,s.Wm)(o,{ref:"CostAnalysisRef",fromDate:e.fromDate,toDate:e.toDate,"employee-list":e.employeeList},null,8,["fromDate","toDate","employee-list"])],512),[[l.F8,"Start/End Time"===e.selectedView&&e.employeeList.length>0]]),(0,s.Wm)(n,{ref:"DatePickerRef",top:e.dateModalTop,leftInput:e.dateModalLeft,"max-date":e.datePickerMax,"min-date":e.datePickerMin,date:e.datePickerTargetDay},null,8,["top","leftInput","max-date","min-date","date"])])}const AD=e=>((0,s.dD)("data-v-a76815b2"),e=e(),(0,s.Cn)(),e),xD={key:0,class:"d-flex justify-center mt-4"},_D=AD((()=>(0,s._)("h3",null,"No Data has been found",-1))),TD=[_D],ED={key:1,class:"mt-4 full-width grid-section"},MD={class:"heading-cell"},ND={class:"grid-body"},FD={class:"grid-body-cell"},PD={class:"d-flex justify-space-between align-center"},OD={key:0,class:"ml-4"};function HD(e,t){const a=(0,s.up)("perfect-scrollbar"),l=(0,s.up)("paginator");return(0,s.wg)(),(0,s.iD)("div",null,[e.noDataError?((0,s.wg)(),(0,s.iD)("div",xD,TD)):((0,s.wg)(),(0,s.iD)("div",ED,[(0,s.Wm)(a,null,{default:(0,s.w5)((()=>[e.dataHeadings.length>0?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"grid-extra-width",style:(0,n.j5)(e.girdWidthStyle)},[(0,s._)("div",{class:"grid-heading",style:(0,n.j5)(e.headingStyle)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.dataHeadings,(e=>((0,s.wg)(),(0,s.iD)("div",MD,(0,n.zw)(e),1)))),256))],4),(0,s._)("div",ND,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.dataAnalysis,(t=>((0,s.wg)(),(0,s.iD)("div",{class:"grid-body-row",style:(0,n.j5)(e.headingStyle)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Object.entries(t),(([e,t])=>((0,s.wg)(),(0,s.iD)("div",FD,(0,n.zw)(t),1)))),256))],4)))),256))])],4)):(0,s.kq)("",!0)])),_:1}),(0,s._)("div",PD,[(0,s.Wm)(l,{ref:"PaginatorRef",totalPage:e.totalPage,currentPage:e.pageNumber,onSelectPage:e.selectPage},null,8,["totalPage","currentPage","onSelectPage"]),e.recordCount>0?((0,s.wg)(),(0,s.iD)("div",OD,"No. of Records: "+(0,n.zw)(e.recordCount),1)):(0,s.kq)("",!0)])]))])}const YD={key:0,class:"d-flex justify-space-between align-center"},ID={class:"pagination"},LD={class:"total-page-small"},WD=["onClick"],jD={key:2,class:"ml-2"},RD={key:0,class:"ml-4"};function $D(e,t){return e.pageList.length>0?((0,s.wg)(),(0,s.iD)("div",YD,[(0,s._)("div",ID,[(0,s._)("div",LD,[e.totalPage>1&&e.currentPage>1?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"previous-button page-button",onClick:t[0]||(t[0]=t=>e.selectNextPage(-1))}," <")):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.pageList,(t=>((0,s.wg)(),(0,s.iD)("div",{class:(0,n.C_)(["page-button",{selected:e.currentPage===t}]),onClick:a=>e.selectPage(t)},(0,n.zw)(t),11,WD)))),256)),e.totalPage>1&&e.currentPage<e.totalPage?((0,s.wg)(),(0,s.iD)("div",{key:1,class:"next-button page-button",onClick:t[1]||(t[1]=t=>e.selectNextPage(1))}," >")):(0,s.kq)("",!0),e.totalPage>5?((0,s.wg)(),(0,s.iD)("div",jD,"Total Pages: "+(0,n.zw)(e.totalPage),1)):(0,s.kq)("",!0)])]),e.recordCount>0?((0,s.wg)(),(0,s.iD)("div",RD,"No. of Records: "+(0,n.zw)(e.recordCount),1)):(0,s.kq)("",!0)])):(0,s.kq)("",!0)}var BD=(0,s.aZ)({name:"Paginator",props:{totalPage:{type:Number,default:1},currentPage:{type:Number,default:1}},setup(e,{emit:t}){const a=(0,Al.iH)(20),l=(0,Al.iH)([]),s=(0,Al.iH)(0);function i(e,t){l.value=t<=5?Array.from(Array(t).keys()).map((e=>e+1)):e<=3?Array.from(Array(5).keys()).map((e=>e+1)):t>e+2?Array.from(Array(5).keys()).map((t=>t+e-2)):Array.from(Array(5).keys()).map((e=>e+t-4))}async function o(e){t("selectPage",e)}async function n(a=1){let l=e.currentPage+a;t("selectPage",l)}return{pageSize:a,pageList:l,recordCount:s,selectPage:o,selectNextPage:n,calculatePageList:i}}});const VD=(0,oe.Z)(BD,[["render",$D],["__scopeId","data-v-bcb192ec"]]);var UD=VD,zD=(0,s.aZ)({name:"CostDetailAnalysisV2",components:{Paginator:UD},props:{fromDate:{type:Object},toDate:{type:Object},employeeList:{type:Array}},setup(e){const t=(0,Al.iH)([]),a=(0,Al.iH)(0),l=(0,Al.iH)(1),i=(0,Al.iH)(20),o=(0,Al.iH)(5),n=(0,Al.iH)(0),r=(0,Al.iH)(),d=(0,Al.iH)([]),c=(0,Al.iH)(),h=(0,Al.iH)(2e3),u=(0,Al.iH)({width:"2000px"}),m=(0,Al.iH)([]),p=(0,Al.iH)(["Start/End Time","Detailed Cost Report"]),y=(0,Al.iH)(!1);async function f(){C(),fl.loading(),await g(),fl.clear()}async function g(){y.value=!1;let t=e.fromDate,s=e.toDate,c=e.employeeList;t&&s||(t=jt()().startOf("month"),s=jt()().endOf("month"));const h={sortBy:"CommonName",sortingType:"asc",pagingEnabled:!0,pageNumber:l.value,pageSize:i.value,employeeNumbers:c,transDateFrom:t?t.format("YYYY-MM-DD"):null,transDateTo:s?s.format("YYYY-MM-DD"):null};await se.GetCostAnalysisDetailV2(h).then((e=>{if(e.response&&0===e.response.length||!e.response)return void(y.value=!0);const t=e.response.slice();t.forEach((e=>{e.TransDate=jt()(e.TransDate).format("YYYY-MM-DD"),e.TotalCost=Math.round(100*e.TotalCost)/100;for(const[t,a]of Object.entries(e))"number"===typeof a&&(e[t]=Math.round(100*a)/100)}));const s=t.map((e=>{const t=Object.values(e);return t[0]=e.CommonName,t[1]=e.EmployeeNo,t}));let i=-1;const c=e.response[0];for(const a of Object.keys(c))a.indexOf("Cost")>-1&&i++;a.value=i,d.value=D(a.value),w(),v(),l.value=e.currentPageNumber,n.value=e.recordCount,o.value=e.totalPages,r.value.calculatePageList(e.currentPageNumber,e.totalPages),m.value=s}))}function D(e){const t=["Employee Name","Employee Number","Functional Area","Date","Pay Rate","Total Hours","Total Cost"],a=["Description","Hours","Cost"];let l=t.slice(),s=0;while(s<e){const e=a.map((e=>e+(s+1)));l.push(...e),s++}return l}function w(){let e="";Array.from(Array(a.value)).map(((t,a)=>{e+=" 150px 100px 100px"})),c.value={"grid-template-columns":`150px 150px 150px 100px 100px 100px 100px${e}`}}function v(){return h.value=850+350*a.value+3*a.value+6,console.log("gridWidth.value",h.value),u.value={width:`${h.value}px`},h.value}async function S(e){l.value=e,fl.loading(),await g(),fl.clear()}async function b(){if(y.value)return void fl.alert("No data to export");fl.loading();const e=await k();fl.clear();let t="data:text/csv;charset=utf-8,";t+=d.value.join(",")+"\r\n",e.map((e=>{t+=Object.values(e).join(",")+"\r\n"}));var a=encodeURI(t),l=document.createElement("a");l.setAttribute("href",a),l.setAttribute("download","Analytic.csv"),l.setAttribute("Content-Type","application/octet-stream"),document.body.appendChild(l),l.click()}async function k(){const t={pageNumber:1,pageSize:1e4,pagingEnabled:!1,sortBy:"CommonName",sortingType:"asc",employeeNumbers:e.employeeList,transDateFrom:e.fromDate?e.fromDate.format("YYYY-MM-DD"):null,transDateTo:e.toDate?e.toDate.format("YYYY-MM-DD"):null};return await se.GetCostAnalysisDetailV2(t).then((e=>{const t=e.response.map((e=>{e.TransDate=jt()(e.TransDate).format("YYYY-MM-DD"),e.TotalCost=Math.round(100*e.TotalCost)/100;for(const[a,l]of Object.entries(e))"number"===typeof l&&(e[a]=Math.round(100*l)/100);const t=Object.values(e);return t[0]=e.CommonName,t[1]=e.EmployeeNo,t}));let l=-1;const s=e.response[0];for(const a of Object.keys(s))a.indexOf("Cost")>-1&&l++;a.value=l,d.value=D(a.value);const i=Object.values(e.resultSummary).map((e=>"number"===typeof e?Math.round(100*e)/100:e));let o=Array(7).fill(null).concat(i);return t.push(o),t}))}function C(){y.value=!1,l.value=1,o.value=5}return(0,s.bv)((()=>{m.value=[],l.value=1,o.value=5,y.value=!1})),{data:t,dataHeadings:d,dataAnalysis:m,options:p,headingStyle:c,girdWidthStyle:u,pageNumber:l,pageSize:i,totalPage:o,noDataError:y,recordCount:n,PaginatorRef:r,selectPage:S,exportCSV:b,loadGridData:g,loadGridDataFromParent:f}}});const GD=(0,oe.Z)(zD,[["render",HD],["__scopeId","data-v-a76815b2"]]);var KD=GD;const qD=e=>((0,s.dD)("data-v-d0e48bb2"),e=e(),(0,s.Cn)(),e),ZD={class:"mt-4 full-width grid-section"},QD={key:0,class:"d-flex justify-center mt-4"},JD=qD((()=>(0,s._)("h3",null,"No Data has been found",-1))),XD=[JD],ew={key:1},tw={class:"grid-extra-width"},aw={class:"grid-heading"},lw={class:"heading-cell"},sw={class:"grid-body"},iw={class:"grid-body-row"},ow={class:"grid-body-cell"},nw={class:"d-flex justify-space-between align-center"},rw={key:0,class:"ml-4"};function dw(e,t){const a=(0,s.up)("perfect-scrollbar"),l=(0,s.up)("paginator");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",ZD,[e.noDataError?((0,s.wg)(),(0,s.iD)("div",QD,XD)):((0,s.wg)(),(0,s.iD)("div",ew,[(0,s.Wm)(a,null,{default:(0,s.w5)((()=>[(0,s._)("div",tw,[(0,s._)("div",aw,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.dataHeadings,(e=>((0,s.wg)(),(0,s.iD)("div",lw,(0,n.zw)(e),1)))),256))]),(0,s._)("div",sw,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.dataAnalysis,(e=>((0,s.wg)(),(0,s.iD)("div",iw,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Object.entries(e),(([e,t])=>((0,s.wg)(),(0,s.iD)("div",ow,(0,n.zw)(t),1)))),256))])))),256))])])])),_:1}),(0,s._)("div",nw,[(0,s.Wm)(l,{ref:"PaginatorRef",totalPage:e.totalPages,currentPage:e.pageNumber,onSelectPage:e.selectPage},null,8,["totalPage","currentPage","onSelectPage"]),e.recordCount>0?((0,s.wg)(),(0,s.iD)("div",rw,"No. of Records: "+(0,n.zw)(e.recordCount),1)):(0,s.kq)("",!0)])]))])])}var cw=(0,s.aZ)({name:"CostAnalysisV2",components:{Paginator:UD},props:{fromDate:{type:Object},toDate:{type:Object},employeeList:{type:Array}},setup(e){const t=(0,Al.iH)([]),a=(0,Al.iH)(1),l=(0,Al.iH)(20),i=(0,Al.iH)(5),o=(0,Al.iH)(0),n=(0,Al.iH)(!1),r=(0,Al.iH)(),d=(0,Al.iH)(["Employee Name","Employee Number","Functional Area","Date","Award","Scheduled Hours","Actual Hours","Hours Variance","Scheduled Cost","Actual Cost","Cost Variance","Actual Start Time","Actual End Time","Adjusted Start Time","Adjusted End Time"]),c=(0,Al.iH)([]),h=(0,Al.iH)(["Start/End Time","Detailed Cost Report"]);async function u(){g(),fl.loading(),await m(),fl.clear()}async function m(){n.value=!1,e.fromDate&&e.toDate||(e.fromDate||(e.fromDate=jt()().startOf("month")),e.toDate||(e.toDate=jt()().endOf("month")));const t={pageNumber:a.value,pageSize:l.value,pagingEnabled:!0,sortBy:"CommonName",sortingType:"asc",employeeNumbers:e.employeeList,transDateFrom:e.fromDate?e.fromDate.format("YYYY-MM-DD"):null,transDateTo:e.toDate?e.toDate.format("YYYY-MM-DD"):null};await se.GetCostAnalysisV2(t).then((e=>{if((!e.response||0!==e.response.length)&&e.response)return c.value=e.response.map((e=>{const t={};return t.commonName=e.commonName,t.employeeNo=e.employeeNo,t.functionalArea=e.functionalArea,t.transDate=jt()(e.transDate).format("YYYY-MM-DD"),t.awardId=e.awardId,t.scheduledHours=e.scheduledUnits,t.actualHours=e.actualUnits,t.hoursVariance=Math.round(100*(t.actualHours-t.scheduledHours))/100,t.scheduledCost=e.scheduledCost?Math.round(100*e.scheduledCost)/100:null,t.actualCost=e.actualCost?Math.round(100*e.actualCost)/100:null,t.costVariance=Math.round(100*(t.actualCost-t.scheduledCost))/100,t.actStartTime=e.actStartTime?jt()(e.actStartTime).format("HH:mm"):null,t.actEndTime=e.actEndTime?jt()(e.actEndTime).format("HH:mm"):null,t.adjStartTime=e.adjStartTime?jt()(e.adjStartTime).format("HH:mm"):null,t.adjEndTime=e.adjEndTime?jt()(e.adjEndTime).format("HH:mm"):null,t})),i.value=e.totalPages,a.value=e.currentPageNumber,o.value=e.recordCount,r.value.calculatePageList(e.currentPageNumber,e.totalPages),e.response;n.value=!0}))}async function p(e){a.value=e,fl.loading(),await m(),fl.clear()}async function y(){if(n.value)return void fl.alert("No data to export");fl.loading();const e=await f();fl.clear();let t="data:text/csv;charset=utf-8,";t+=d.value.join(",")+"\r\n",e.map((e=>{t+=Object.values(e).join(",")+"\r\n"}));var a=encodeURI(t),l=document.createElement("a");l.setAttribute("href",a),l.setAttribute("download","Analytic.csv"),document.body.appendChild(l),l.click()}async function f(){const t={pageNumber:1,pageSize:1e4,pagingEnabled:!1,sortBy:"CommonName",sortingType:"asc",employeeNumbers:e.employeeList,transDateFrom:e.fromDate?e.fromDate.format("YYYY-MM-DD"):null,transDateTo:e.toDate?e.toDate.format("YYYY-MM-DD"):null};return await se.GetCostAnalysisV2(t).then((e=>e.response.map((e=>{const t={};return t.commonName=e.commonName,t.employeeNo=e.employeeNo,t.functionalArea=e.functionalArea,t.transDate=jt()(e.transDate).format("YYYY-MM-DD"),t.awardId=e.awardId,t.scheduledHours=e.scheduledUnits,t.actualHours=e.actualUnits,t.hoursVariance=Math.round(100*(t.actualHours-t.scheduledHours))/100,t.scheduledCost=e.scheduledCost?Math.round(100*e.scheduledCost)/100:null,t.actualCost=e.actualCost?Math.round(100*e.actualCost)/100:null,t.costVariance=Math.round(100*(t.actualCost-t.scheduledCost))/100,t.actStartTime=e.actStartTime?jt()(e.actStartTime).format("HH:mm"):null,t.actEndTime=e.actEndTime?jt()(e.actEndTime).format("HH:mm"):null,t.adjStartTime=e.adjStartTime?jt()(e.adjStartTime).format("HH:mm"):null,t.adjEndTime=e.adjEndTime?jt()(e.adjEndTime).format("HH:mm"):null,t}))))}function g(){a.value=1,i.value=5,n.value=!1}return(0,s.bv)((()=>{c.value=[],a.value=1,i.value=5,n.value=!1})),{data:t,dataHeadings:d,dataAnalysis:c,options:h,PaginatorRef:r,pageNumber:a,pageSize:l,totalPages:i,noDataError:n,recordCount:o,loadGridData:m,exportCSV:y,selectPage:p,loadGridDataFromParent:u}}});const hw=(0,oe.Z)(cw,[["render",dw],["__scopeId","data-v-d0e48bb2"]]);var uw,mw=hw;(function(e){e["simple"]="Start/End Time",e["detailed"]="Detailed Cost Report"})(uw||(uw={}));var pw=(0,s.aZ)({name:"AnalysisV2",components:{CostDetailAnalysisV2:KD,CostAnalysisV2:mw,Modal:xe,CustomSelect:qi,DatePicker:El},setup(){const e=(0,Yt.oR)(),t=(0,Al.iH)([]),a=(0,Al.iH)(1),l=(0,Al.iH)(20),i=(0,Al.iH)(5),o=(0,Al.iH)([]),n=(0,Al.iH)(0),r=(0,Al.iH)(!1),d=(0,Al.iH)(),c=(0,Al.iH)(),h=(0,Al.iH)(),u=(0,Al.iH)(null),m=(0,Al.iH)(null),p=(0,Al.iH)([]),y=(0,Al.iH)(""),f=(0,Al.iH)(""),g=(0,Al.iH)(0),D=(0,Al.iH)(0),w=(0,Al.iH)(null),v=(0,Al.iH)(null),S=(0,Al.iH)(jt()()),b=(0,Al.iH)(uw.simple),k=(0,Al.iH)([]),C=(0,Al.iH)(["Start/End Time","Detailed Cost Report"]);async function A(){fl.loading(),await e.dispatch(fi.getEmployees,Affinity.user.EmployeeNo).then((e=>{p.value=e.map((e=>e.employeeNo))})),await x(),fl.clear()}async function x(){try{if(u.value&&m.value&&m.value.diff(u.value,"weeks")>=6)throw fl.alert("Selected Date range must not be greater than 6 weeks."),"weeks error";"Start/End Time"===b.value?(a.value=1,await h.value.loadGridDataFromParent()):await c.value.loadGridDataFromParent()}catch(e){}}async function _(e,t){let a=e.target.getClientRects()[0];g.value=a.bottom,D.value=a.left,u&&(v.value=u.value.clone().subtract(1,"day"),w.value=null),S.value=m.value?m.value:jt()();const l=await E();m.value=l||void 0,f.value=m.value.format("DD/MM/YYYY")}async function T(e,t){let a=e.target.getClientRects()[0];g.value=a.bottom,D.value=a.left,m&&(v.value=null,w.value=m.value.clone().add(1,"day")),S.value=u.value?u.value:jt()();const l=await E();u.value=l||void 0,y.value=u.value.format("DD/MM/YYYY")}async function E(){return await d.value.toggleShow(S.value)}async function M(){b.value===uw.simple?await h.value.exportCSV():await c.value.exportCSV()}async function N(e){b.value=e,await x()}return(0,s.bv)((()=>{u.value&&m.value||(u.value||(u.value=jt()().startOf("month"),y.value=u.value.format("DD/MM/YYYY")),m.value||(m.value=jt()().endOf("month").startOf("day"),f.value=m.value.format("DD/MM/YYYY"))),A()})),{DatePickerRef:d,CostDetailAnalysisRef:c,CostAnalysisRef:h,data:t,dataAnalysis:k,options:C,selectedView:b,pageNumber:a,pageSize:l,totalPages:i,pageList:o,noDataError:r,recordCount:n,dateModalTop:g,dateModalLeft:D,datePickerMax:w,datePickerMin:v,datePickerTargetDay:S,fromDate:u,toDate:m,fromDateText:y,toDateText:f,employeeList:p,updateToDateTime:_,updateFromDateTime:T,exportCSVByView:M,selectGridData:N,loadGridDataBySelection:x}}});const yw=(0,oe.Z)(pw,[["render",CD],["__scopeId","data-v-ca59bc9e"]]);var fw=yw;const gw=[{path:"/login",name:"Login",component:pD},{path:"/my-schedules",name:"My Schedule",component:Fl},{path:"/availability",name:"Availability",component:Qg},{path:"/flex-schedule",name:"Flex Schedule",component:kf,beforeEnter:(e,t,a)=>{qt()?a("/flex-schedule-mobile"):a()}},{path:"/flex-schedule-mobile",name:"FlexScheduleMobile",component:$f},{path:"/team-schedules",name:"Schedule Management",component:jo},{path:"/employee-allocations",name:"Employee Allocation",component:Md},{path:"/cost-reports",name:"Analysis",component:fw},{path:"/",name:"Home",component:Fl}],Dw=(0,ea.p7)({history:(0,ea.PO)("/"),routes:gw});var ww=Dw;const vw={state:{magic:123},modules:{FlexSchedule:Gt,LookUp:Oh,EmployeeModule:Si}};var Sw=new Yt.ZP.Store(vw),bw=a(9652),kw=a(5158);const Cw={reformatDate(e){if(!e)return e;if("string"===typeof e)return e;if("object"===typeof e&&"Date"===e.constructor?.name){let t=jt()(e);return t.format("DD/MM/YYYY")}if(e.isValid()){let t=jt()(e);return null!=t&&t.isValid()?t.format("DD/MM/YYYY"):e}return e},reformatDateString(e,t){return e&&"string"===typeof e?jt()(e,t).format("DD/MM/YYYY"):e},reformatTime(e){if(!e)return e;let t=jt()(e);if(null==t||!t.isValid()){let t=jt()(e,"h:m");return null!=t&&t.isValid()?t.format("HH:mm"):e}return t.format("HH:mm")},reformatBreakHours(e){if(!e)return e;let t=e,a=Math.floor(t),l=t-a;return l>0&&(l=Math.round(60*l)),a&&l?`${a}:${l}`:a?`${a} hour`:l?`${l} min`:void 0},ordinalSuffix(e){let t=e%10,a=e%100;return 1==t&&11!=a?e+"st":2==t&&12!=a?e+"nd":3==t&&13!=a?e+"rd":e+"th"}};var Aw=Cw,xw=a(4435),_w=a(4829),Tw=a(9888),Ew=a(1211);const Mw={chevronUp:xw.Z,chevronLeft:_w.Z,chevronRight:Tw.Z,chevronDown:Ew.Z};var Nw=Mw;const Fw={};var Pw={install:e=>{function t(t){e.config.globalProperties.$CompanyConfig?e.config.globalProperties.$CompanyConfig.isAllowPersonal=t:e.config.globalProperties.$CompanyConfig={isAllowPersonal:t}}function a(t){e.config.globalProperties.$CompanyConfig?e.config.globalProperties.$CompanyConfig.isAllowSundayFirst=t:e.config.globalProperties.$CompanyConfig={isAllowSundayFirst:t}}function l(){return e.config.globalProperties.$CompanyConfig?e.config.globalProperties.$CompanyConfig.isAllowPersonal:null}function s(){return e.config.globalProperties.$CompanyConfig?e.config.globalProperties.$CompanyConfig.isAllowSundayFirst:null}Fw.setAllowPersonal=t,Fw.getAllowPersonal=l,Fw.setAllowSundayFirst=a,Fw.getAllowSundayFirst=s,e.provide("MANAGE_COMPANY_CONFIG",Fw)}},Ow=a(6549);const Hw=(0,bw.Z)();navigator.serviceWorker.getRegistrations().then((function(e){for(let t of e)t.unregister()}));let Yw=(0,l.ri)(Xt);Yw.config.globalProperties.emitter=Hw,Yw.use(kw.ZP),Yw.use(Ow.Z),Yw.use(Pw),Yw.use(Sw).use(ww).mount("#app"),Yw.config.globalProperties.$filters=Aw,Yw.config.globalProperties.$icons=Nw}},t={};function a(l){var s=t[l];if(void 0!==s)return s.exports;var i=t[l]={id:l,loaded:!1,exports:{}};return e[l].call(i.exports,i,i.exports,a),i.loaded=!0,i.exports}a.m=e,function(){var e=[];a.O=function(t,l,s,i){if(!l){var o=1/0;for(c=0;c<e.length;c++){l=e[c][0],s=e[c][1],i=e[c][2];for(var n=!0,r=0;r<l.length;r++)(!1&i||o>=i)&&Object.keys(a.O).every((function(e){return a.O[e](l[r])}))?l.splice(r--,1):(n=!1,i<o&&(o=i));if(n){e.splice(c--,1);var d=s();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[l,s,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,l){var s,i,o=l[0],n=l[1],r=l[2],d=0;if(o.some((function(t){return 0!==e[t]}))){for(s in n)a.o(n,s)&&(a.m[s]=n[s]);if(r)var c=r(a)}for(t&&t(l);d<o.length;d++)i=o[d],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(c)},l=self["webpackChunkschedule"]=self["webpackChunkschedule"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[998],(function(){return a(6584)}));l=a.O(l)})();
//# sourceMappingURL=app.js.map