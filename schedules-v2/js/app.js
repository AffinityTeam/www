(function(){var e={1732:function(e,t,a){"use strict";var l=a(1354),s=a.n(l),o=a(6314),i=a.n(o),n=i()(s());n.push([e.id,"@media print{.flex-sche-table{width:100%;background:#fff;border-collapse:collapse;-webkit-print-color-adjust:exact}.flex-sche-table td,.flex-sche-table th{border:1px solid #ddd;padding:8px}.flex-sche-table tr:nth-child(even){background:#f2f2f2}.flex-sche-table tr:hover{background:#ddd}.flex-sche-table thead th{padding:3px 5px 3px 5px;font-weight:normal;text-align:left;background:linear-gradient(to bottom, #fcfcfc 0%, #efefef 49%, #e2e2e2 51%, #d6d6d6 100%)}.flex-sche-table .leave-unit{width:100%;padding:2px 5px;background-color:#e0e0e0}}@media screen{.flex-sche-table{display:none}}","",{version:3,sources:["webpack://./src/components/FlexSchedule/Print/PrintableView.scss"],names:[],mappings:"AAAA,aACI,iBACI,UAAA,CACA,eAAA,CACA,wBAAA,CACA,gCAAA,CAEA,wCACI,qBAAA,CACA,WAAA,CAGJ,oCACI,kBAAA,CAGJ,0BACI,eAAA,CAIA,0BACI,uBAAA,CACA,kBAAA,CACA,eAAA,CACA,yFAAA,CAIR,6BACI,UAAA,CACA,eAAA,CACA,wBAAA,CAAA,CAMZ,cACI,iBACI,YAAA,CAAA",sourcesContent:["@media print {\r\n    .flex-sche-table {\r\n        width: 100%;\r\n        background: white;\r\n        border-collapse: collapse;\r\n        -webkit-print-color-adjust: exact;\r\n\r\n        td, th {\r\n            border: 1px solid #ddd;\r\n            padding: 8px;\r\n        }\r\n\r\n        tr:nth-child(even) {\r\n            background: #f2f2f2;\r\n        }\r\n\r\n        tr:hover {\r\n            background: #ddd;\r\n        }\r\n\r\n        thead {\r\n            th {\r\n                padding: 3px 5px 3px 5px;\r\n                font-weight: normal;\r\n                text-align: left;\r\n                background: linear-gradient(to bottom, #fcfcfc 0%, #efefef 49%, #e2e2e2 51%, #d6d6d6 100%);\r\n            }\r\n        }\r\n\r\n        .leave-unit {\r\n            width: 100%;\r\n            padding: 2px 5px;\r\n            background-color: #E0E0E0\r\n        }\r\n\r\n    }\r\n}\r\n\r\n@media screen {\r\n    .flex-sche-table {\r\n        display: none;\r\n    }\r\n}"],sourceRoot:""}])},5358:function(e,t,a){var l={"./af":5177,"./af.js":5177,"./ar":1509,"./ar-dz":1488,"./ar-dz.js":1488,"./ar-kw":8676,"./ar-kw.js":8676,"./ar-ly":2353,"./ar-ly.js":2353,"./ar-ma":4496,"./ar-ma.js":4496,"./ar-ps":6947,"./ar-ps.js":6947,"./ar-sa":2682,"./ar-sa.js":2682,"./ar-tn":9756,"./ar-tn.js":9756,"./ar.js":1509,"./az":5533,"./az.js":5533,"./be":8959,"./be.js":8959,"./bg":7777,"./bg.js":7777,"./bm":4903,"./bm.js":4903,"./bn":1290,"./bn-bd":7357,"./bn-bd.js":7357,"./bn.js":1290,"./bo":1545,"./bo.js":1545,"./br":1470,"./br.js":1470,"./bs":4429,"./bs.js":4429,"./ca":7306,"./ca.js":7306,"./cs":6464,"./cs.js":6464,"./cv":3635,"./cv.js":3635,"./cy":4226,"./cy.js":4226,"./da":3601,"./da.js":3601,"./de":7853,"./de-at":6111,"./de-at.js":6111,"./de-ch":4697,"./de-ch.js":4697,"./de.js":7853,"./dv":708,"./dv.js":708,"./el":4691,"./el.js":4691,"./en-au":3872,"./en-au.js":3872,"./en-ca":8298,"./en-ca.js":8298,"./en-gb":6195,"./en-gb.js":6195,"./en-ie":6584,"./en-ie.js":6584,"./en-il":5543,"./en-il.js":5543,"./en-in":9033,"./en-in.js":9033,"./en-nz":9402,"./en-nz.js":9402,"./en-sg":3004,"./en-sg.js":3004,"./eo":2934,"./eo.js":2934,"./es":7650,"./es-do":838,"./es-do.js":838,"./es-mx":7730,"./es-mx.js":7730,"./es-us":6575,"./es-us.js":6575,"./es.js":7650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":119,"./fa.js":119,"./fi":527,"./fi.js":527,"./fil":5995,"./fil.js":5995,"./fo":2477,"./fo.js":2477,"./fr":5498,"./fr-ca":6435,"./fr-ca.js":6435,"./fr-ch":7892,"./fr-ch.js":7892,"./fr.js":5498,"./fy":7071,"./fy.js":7071,"./ga":1734,"./ga.js":1734,"./gd":217,"./gd.js":217,"./gl":7329,"./gl.js":7329,"./gom-deva":2124,"./gom-deva.js":2124,"./gom-latn":3383,"./gom-latn.js":3383,"./gu":5050,"./gu.js":5050,"./he":1713,"./he.js":1713,"./hi":3861,"./hi.js":3861,"./hr":6308,"./hr.js":6308,"./hu":609,"./hu.js":609,"./hy-am":7160,"./hy-am.js":7160,"./id":4063,"./id.js":4063,"./is":9374,"./is.js":9374,"./it":8383,"./it-ch":1827,"./it-ch.js":1827,"./it.js":8383,"./ja":3827,"./ja.js":3827,"./jv":9722,"./jv.js":9722,"./ka":1794,"./ka.js":1794,"./kk":7088,"./kk.js":7088,"./km":6870,"./km.js":6870,"./kn":4451,"./kn.js":4451,"./ko":3164,"./ko.js":3164,"./ku":8174,"./ku-kmr":6181,"./ku-kmr.js":6181,"./ku.js":8174,"./ky":8474,"./ky.js":8474,"./lb":9680,"./lb.js":9680,"./lo":5867,"./lo.js":5867,"./lt":5766,"./lt.js":5766,"./lv":9532,"./lv.js":9532,"./me":8076,"./me.js":8076,"./mi":1848,"./mi.js":1848,"./mk":306,"./mk.js":306,"./ml":3739,"./ml.js":3739,"./mn":9053,"./mn.js":9053,"./mr":6169,"./mr.js":6169,"./ms":3386,"./ms-my":2297,"./ms-my.js":2297,"./ms.js":3386,"./mt":7075,"./mt.js":7075,"./my":2264,"./my.js":2264,"./nb":2274,"./nb.js":2274,"./ne":8235,"./ne.js":8235,"./nl":2572,"./nl-be":3784,"./nl-be.js":3784,"./nl.js":2572,"./nn":4566,"./nn.js":4566,"./oc-lnc":9330,"./oc-lnc.js":9330,"./pa-in":9849,"./pa-in.js":9849,"./pl":4418,"./pl.js":4418,"./pt":9834,"./pt-br":8303,"./pt-br.js":8303,"./pt.js":9834,"./ro":4457,"./ro.js":4457,"./ru":2271,"./ru.js":2271,"./sd":1221,"./sd.js":1221,"./se":3478,"./se.js":3478,"./si":7538,"./si.js":7538,"./sk":5784,"./sk.js":5784,"./sl":6637,"./sl.js":6637,"./sq":6794,"./sq.js":6794,"./sr":5719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":5719,"./ss":6e3,"./ss.js":6e3,"./sv":1011,"./sv.js":1011,"./sw":748,"./sw.js":748,"./ta":1025,"./ta.js":1025,"./te":1885,"./te.js":1885,"./tet":8861,"./tet.js":8861,"./tg":6571,"./tg.js":6571,"./th":5802,"./th.js":5802,"./tk":9527,"./tk.js":9527,"./tl-ph":9231,"./tl-ph.js":9231,"./tlh":1052,"./tlh.js":1052,"./tr":5096,"./tr.js":5096,"./tzl":9846,"./tzl.js":9846,"./tzm":1765,"./tzm-latn":7711,"./tzm-latn.js":7711,"./tzm.js":1765,"./ug-cn":8414,"./ug-cn.js":8414,"./uk":6618,"./uk.js":6618,"./ur":158,"./ur.js":158,"./uz":7609,"./uz-latn":2475,"./uz-latn.js":2475,"./uz.js":7609,"./vi":1135,"./vi.js":1135,"./x-pseudo":4051,"./x-pseudo.js":4051,"./yo":2218,"./yo.js":2218,"./zh-cn":2648,"./zh-cn.js":2648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":1541,"./zh-mo.js":1541,"./zh-tw":304,"./zh-tw.js":304};function s(e){var t=o(e);return a(t)}function o(e){if(!a.o(l,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return l[e]}s.keys=function(){return Object.keys(l)},s.resolve=o,e.exports=s,s.id=5358},3112:function(e,t,a){"use strict";a.d(t,{P:function(){return GS}});var l=a(3751),s=a(953),o=a(641);const i={class:"dashboard"},n={class:"pagewrapper"},r={class:"pagecontent"},c={class:"contentwrapper"},d={key:0,class:"v-application",tabindex:"2"};function u(e,t,a,l,s,u){const h=(0,o.g2)("schedules-navigation"),m=(0,o.g2)("alert"),p=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",n,[(0,o.Lk)("div",r,[(0,o.Lk)("div",c,[e.$user.value.EmployeeNo?((0,o.uX)(),(0,o.CE)("div",d,[(0,o.bF)(h),(0,o.bF)(m),(0,o.bF)(p)])):(0,o.Q3)("",!0)])])])])}var h=a(33);const m=e=>((0,o.Qi)("data-v-bfa10846"),e=e(),(0,o.jt)(),e),p={class:"schedules"},y={class:"sch-nav justify-space-between align-center body-2"},f=m((()=>(0,o.Lk)("div",{class:"sch-heading-text"},null,-1))),k={key:0,class:"d-flex sch-toolbar align-center"},v=m((()=>(0,o.Lk)("span",{class:"burger-menu"},null,-1))),g=[v],D={class:"sch-nav-options mr-1 pa-0"},S=["onClick"],b={href:"/help/index",class:"sch-nav-help ss-help-link align-center mr-2",target:"_blank"},C=m((()=>(0,o.Lk)("span",{class:"icon-help-round"},null,-1))),E=[C];function w(e,t,a,l,s,i){const n=(0,o.gN)("tooltip");return(0,o.uX)(),(0,o.CE)("div",p,[(0,o.Lk)("div",y,[f,e.user?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.Lk)("a",{tabindex:"1",onClick:t[0]||(t[0]=t=>e.toggleMobileMenu()),class:(0,h.C4)([e.isOpen?"open":"","mobile-menu"])},g,2),(0,o.Lk)("ul",D,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.authorizedMenus,(t=>((0,o.uX)(),(0,o.CE)("li",{class:(0,h.C4)(["nav-box mr-1 py-1 px-2 my-1 caption",{selected:t.selected}]),onClick:a=>e.selectMenu(t)},[(0,o.Lk)("div",null,(0,h.v_)(t.display),1)],10,S)))),256))]),(0,o.bo)(((0,o.uX)(),(0,o.CE)("a",b,E)),[[n,{content:"Help"},void 0,{top:!0}]])])):(0,o.Q3)("",!0)])])}var L=a(2505),T=a.n(L);let x=!1;({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_AXIOSHOST&&(x=!0,T().defaults.baseURL={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_AXIOSHOST),T().defaults.headers.common["X-Requested-With"]="XMLHttpRequest",T().interceptors.response.use((e=>e.request.responseURL.indexOf("aspxerrorpath")>-1?Promise.reject("asp error"):e),(e=>(e&&e.response&&401==e.response.status&&location.reload(),Promise.reject(e))));let A=function(e){return T().post("EmployeeWorkSchedule",e).then((e=>"string"===typeof e.data&&""!==e.data?JSON.parse(e.data):e.data))},F=function(){return T().post("Auth/GetInfo").then((e=>e.data))};function N(e){return T().get("StandardSchedules",{params:{allSchedules:e}}).then((e=>e.data))}async function M(){return T().get("ShiftTypes").then((e=>e.data))}function P(e){return T().get(`ScheduleDetail/${e}`).then((e=>e.data))}function O(e){return T().post("PostSchedule",e).then((e=>e.data))}function W(e){return T().get(`DeleteSchedule/${e}`).then((e=>e.data))}function R(e){return T().post("AllocateSchedule",e).then((e=>{if(e.data.Messages&&e.data.Messages.length>=1)throw new Error(e.data.Messages[0].Message);return e.data}))}function I(e,t){return T().get(`RemoveEmployeeWorkSchedule/${t}/${e}`).then((e=>e.data))}function Y(e,t){return T().post(`UpdateEmployeeWorkSchedule/${t}`,e).then((e=>{if(e.data.Messages&&e.data.Messages.length>=1)throw new Error(e.data.Messages[0].Message);return e.data}))}function _(){return T().get("EmployeeOptions").then((e=>e.data))}function H(e){return T().get(`EmployeeWorkSchedules/${e}`).then((e=>e.data))}function X(e){return T().get(`EmployeeWorkScheduleDetail/${e}`).then((e=>e.data))}function j(e){return T().get(`FlexScheduleDetail/${e}`).then((e=>e.data))}function V(e){return T().get("FlexSchedules",{params:e}).then((e=>e.data))}function $(e){return T().post("CreateFlexSchedule/",e).then((e=>e.data))}function K(e,t){return T().put(`UpdateFlexSchedule/${e}`,t).then((e=>e.data))}function B(e){return T().patch("PatchFlexSchedule",e).then((e=>e.data))}function U(e){return T().get(`GetManagedEmployees/${e}?fields=EmployeeNo,CommonName,StdHoursPerWeek,PositionCode,PositionTitle,Cost1,Cost2,Rate1,WorkerType,TaRole,DefaultRosterGroup,PayType`).then((e=>"string"===typeof e.data&&""!==e.data?JSON.parse(e.data):e.data))}function Q(e){return T().get(`GetPositions/${e}`).then((e=>e.data))}function G(){return T().get("GetCostElements").then((e=>e.data))}function z(e){return T().get("GetManagedLeaves",{params:e}).then((e=>"string"===typeof e.data?""===e.data?(e.data=[],e.data):JSON.parse(e.data):(e.data.forEach((e=>{e.dateFrom=e.datefrom,e.dateTo=e.dateto})),e.data)))}function J(e){return T().post("CopyFlexSchedule",e).then((e=>e.data))}function Z(e){return T()["delete"]("DeleteFlexSchedule",{data:e}).then((e=>e.data))}function q(e){return T().post("CreateAvailability",e).then((e=>e.data))}function ee(e){return T().get("GetAvailability",{params:{employeeNo:e}}).then((e=>e.data))}function te(e){return T().patch("PatchAvailability",e).then((e=>e.data))}function ae(e){return T()["delete"](`DeleteAvailability/${e}`).then((e=>e.data))}function le(e){return T().get("GetAdditionalDetails",{params:{employeeNo:e}}).then((e=>e.data))}function se(e){return T().post("PublishFlexSchedule",e).then((e=>e.data))}function oe(){return T().get("WorkTypes").then((e=>e.data))}function ie(){return T().get("ExcludedWorkTypes").then((e=>e.data))}function ne(e){return T().post("GetCostAnalysis",e).then((e=>e.data))}function re(e){return T().post("GetEmployeesCostCentres",e).then((e=>e.data))}function ce(e){return T().post("CostingAnalytic",e).then((e=>e.data))}function de(e){return T().post("CostingAnalyticSummary",e).then((e=>e.data))}function ue(e,t="value"){return T().post(`CostingDayView?reportType=${t}`,e).then((e=>e.data))}function he(e,t="value"){return T().post(`CostingEmployeePayDetailView?reportType=${t}`,e).then((e=>e.data))}function me(e,t="value"){return T().post(`CostingEmployeeView?reportType=${t}`,e).then((e=>e.data))}function pe(){return T().get("getManagers").then((e=>e.data))}x&&(A=function(e){return T().get("EmployeeWorkSchedule",e).then((e=>"string"===typeof e.data&&""!==e.data?JSON.parse(e.data):e.data),(e=>Promise.reject(e)))},F=function(){return T().get("Auth/GetInfo").then((e=>e.data))});var ye={EmployeeWorkSchedule:A,AuthGetInfo:F,StandardSchedules:N,ShiftTypes:M,ScheduleDetail:P,PostSchedule:O,DeleteSchedule:W,AllocateSchedule:R,RemoveEmployeeWorkSchedule:I,UpdateEmpSchedRequest:Y,EmployeesList:_,EmpWorkScheds:H,EmpSchedDetailRequest:X,GetFlexScheduleDetail:j,GetFlexSchedules:V,CreateFlexSchedule:$,UpdateFlexSchedule:K,PatchFlexSchedule:B,GetManagedEmployees:U,GetPosition:Q,GetCostelements:G,GetManagedLeaves:z,CopyFlexSchedule:J,DeleteFlexSchedule:Z,CreateAvailability:q,GetAvailabilities:ee,PatchAvailabilities:te,DeleteAvailabilities:ae,GetEmployeeExtraDetail:le,PublishFlexSchedule:se,GetWorkTypes:oe,GetDefaultWorkTypes:ie,GetCostAnalysis:ne,GetEmployeesCostCentres:re,GetCostAnalysisV2:ce,GetCostAnalysisDetailV2:de,GetCostingDayView:ue,CostingEmployeePayDetailView:he,CostingEmployeeView:me,getMyManager:pe},fe=(0,o.pM)({name:"scheduleNavigation",data(){return{user:null,menus:[{text:"Work Schedule",display:"My Schedules",route:"/my-schedules",selected:!1,default:!0},{text:"Availability",display:"My Availability",route:"/Availability",selected:!1,default:!1},{text:"Employee Team",display:"My Team",route:"/my-team",selected:!1,default:!1},{text:"Flex Schedule",display:"Flexi Schedules",route:"/flex-schedule",selected:!1,default:!1},{text:"Schedule Management",display:"Team Schedules",route:"/team-schedules",selected:!1,default:!1},{text:"Employee Allocation",display:"Employee Allocations",route:"/employee-allocations",selected:!1,default:!1},{text:"Cost Report",display:"Cost Analytics",route:"/cost-reports",selected:!1,default:!1}],selectedMenu:null,isOpen:!1}},computed:{userFullName(){let e=this.user;return e?`${e.FirstName} ${e.LastName}`:""},authorizedMenus(){var e=[],t=this.user.AccessibleMenus;let a=this.menus;for(var l=0;l<this.menus.length;l++){var s=a[l];-1!=t.indexOf(s.text)&&e.push(s)}return e}},methods:{selectMenu:function(e){if("/cost-reports"===e.route){const e=window.Affinity.config.Apps.find((e=>e.Link?.Url?.split(".")[0].toLowerCase().includes("costing")&&e.Link?.Enabled));if(e)return void(window.location.href=e.Link.Url)}this.$router.push(e.route),this.isOpen=!1,this.menus.forEach((e=>{e.selected=!1})),e.selected=!0},toggleMobileMenu:function(){this.isOpen=!this.isOpen},isSelected:function(e){return this.selectedMenu&&this.selectedMenu.text==e},assignAccessibleFeatures:function(){const e=(0,o.WQ)("MANAGE_COMPANY_CONFIG");if(!window.Affinity||window.Affinity&&!window.Affinity.user)console.log("no affinity requesting authInfo"),ye.AuthGetInfo().then((t=>{this.user=t;try{window.dispatchEvent(new CustomEvent("GAReady",{bubbles:!0,detail:{companyNumber:this.user.CompanyNo,employeeNumber:this.user.EmployeeNo,appVersion:"V2"}}))}catch(a){console.warn("GA tracking failed. Contact BenK.")}e.setAllowPersonal(t.AccessibleFeatures.includes("Personal Schedule")),e.setAllowSundayFirst(t.AccessibleFeatures.includes("Sunday First"))}));else{console.log("loading user from Affinity lib"),this.user=window.Affinity.user;try{window.dispatchEvent(new CustomEvent("GAReady",{bubbles:!0,detail:{companyNumber:this.user.CompanyNo,employeeNumber:this.user.EmployeeNo,appVersion:"V2"}}))}catch(t){console.warn("GA tracking failed. Contact BenK.")}e.setAllowPersonal(this.user.AccessibleFeatures.includes("Personal Schedule")),e.setAllowSundayFirst(this.user.AccessibleFeatures.includes("Sunday First"))}}},mounted:function(){this.assignAccessibleFeatures(),document.addEventListener("DBWDomReady",(e=>{this.assignAccessibleFeatures()}))}}),ke=a(6262);const ve=(0,ke.A)(fe,[["render",w],["__scopeId","data-v-bfa10846"]]);var ge=ve;const De=e=>((0,o.Qi)("data-v-46bedd7c"),e=e(),(0,o.jt)(),e),Se={class:"promt-box"},be={key:0,class:"mr-2 d-inline loader-icon"},Ce=De((()=>(0,o.Lk)("svg",{viewBox:"0 0 1024 1024",focusable:"false","data-icon":"loading-3-quarters",width:"28",height:"28",fill:"currentColor","aria-hidden":"true"},[(0,o.Lk)("path",{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"})],-1))),Ee=[Ce],we=["innerHTML"],Le={key:0,class:"promptButtons mt-4"},Te={class:"label text-capitalize"},xe={class:"label text-capitalize"};function Ae(e,t,a,l,s,i){const n=(0,o.g2)("modal");return(0,o.uX)(),(0,o.Wv)(n,{ref:"alertModalRef",noBox:!0},{body:(0,o.k6)((()=>[(0,o.Lk)("div",Se,[(0,o.Lk)("div",null,[e.showLoader?((0,o.uX)(),(0,o.CE)("div",be,Ee)):(0,o.Q3)("",!0),(0,o.Lk)("div",{class:"content",innerHTML:e.message},null,8,we)]),e.showButtons?((0,o.uX)(),(0,o.CE)("div",Le,[(0,o.Lk)("button",{type:"button",class:(0,h.C4)(["orange white--text small",{"mr-2":e.showCancel}]),tabindex:"9999998",onClick:t[0]||(t[0]=(...t)=>e.onOk&&e.onOk(...t))},[(0,o.Lk)("span",Te,(0,h.v_)(e.confirmButtonText),1)],2),e.showCancel?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"grey white--text small",small:"",tabindex:"9999999",onClick:t[1]||(t[1]=(...t)=>e.onCancel&&e.onCancel(...t))},[(0,o.Lk)("span",xe,(0,h.v_)(e.cancelButtonText),1)])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])])),_:1},512)}const Fe={class:"modal-wrapper"},Ne={class:"modal-header"},Me={class:"modal-footer"};function Pe(e,t,a,s,i,n){return(0,o.uX)(),(0,o.Wv)(l.eB,{name:"modal"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",null,[e.show?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-mask",style:(0,h.Tr)([e.modalIndex?{"z-index":e.modalIndex}:""])},[(0,o.Lk)("div",Fe,[(0,o.Lk)("div",{class:"modal-backdrop",onClick:t[0]||(t[0]=(...t)=>e.clickWrapper&&e.clickWrapper(...t))}),(0,o.Lk)("div",{class:(0,h.C4)(["modal-box",{"no-modal-box":e.noBox}]),style:(0,h.Tr)(e.getCustomPosition())},[(0,o.Lk)("div",Ne,[(0,o.RG)(e.$slots,"header",{},void 0,!0)]),(0,o.Lk)("div",{class:(0,h.C4)(["modal-body",{"no-overflow-auto-body":e.noOverflowAutoBody}])},[(0,o.RG)(e.$slots,"body",{},void 0,!0)],2),(0,o.Lk)("div",Me,[(0,o.RG)(e.$slots,"footer",{},void 0,!0)])],6)])],4)):(0,o.Q3)("",!0)])])),_:3})}var Oe=(0,o.pM)({name:"modal",props:{customPosition:{type:Boolean,default:!1},top:{type:Number},left:{type:Number},noBox:{type:Boolean},modalIndex:{type:Number},noOverflowAutoBody:{type:Boolean,default:!1}},data(){return{show:!1}},methods:{toggleShow(e){this.show=!0===e||!1===e?e:!this.show},clickWrapper(){this.show=!1,this.$emit("cancel")},getCustomPosition(){if(this.customPosition){let e={position:"absolute",top:`${this.top}px`,left:`${this.left}px`};return window.innerWidth<=800&&(e.left="auto"),e}return""}}});const We=(0,ke.A)(Oe,[["render",Pe],["__scopeId","data-v-430725c2"]]);var Re=We,Ie=(0,o.pM)({name:"alert",components:{Modal:Re},data(){return{dialog:!1,message:"some message ",showLoader:!1,showButtons:!1,showCancel:!1,confirmButtonText:"Ok",cancelButtonText:"Cancel"}},mounted(){GS.on("alert",(e=>{console.log("emitter alert"),this.dialog=!0,this.message=e,this.showLoader=!1,this.showButtons=!0})),GS.on("dialog--loading--request",(e=>{console.log("emitter loading request"),this.dialog=!0,this.message=e,this.showCancel=!1,this.showButtons=!1,this.showLoader=!0})),GS.on("clearDialog",(()=>{console.log("emitter clear dialog"),this.clearDialog(),this.dialog=!1})),GS.on("dialog",(e=>{console.log("emitter on dialog"),this.show(),this.dialog=!!e,this.message=e.message,this.showCancel=e.showCancel,this.showButtons=e.showButtons,this.showLoader=e.showLoader,this.confirmButtonText=e.confirmButtonText?e.confirmButtonText:"Ok",this.cancelButtonText=e.cancelButtonText?e.cancelButtonText:"Cancel",e.onOk&&(this.onOk=()=>{e.onOk(),this.dialog=!1,this.toggleShow()}),e.onCancel&&(this.onCancel=()=>{e.onCancel(),this.dialog=!1,this.toggleShow()})}))},methods:{clearDialog(){this.$refs.alertModalRef.toggleShow(!1)},toggleShow(){this.$refs.alertModalRef.toggleShow()},show(){this.$refs.alertModalRef.toggleShow(!0)},onOk(){this.$refs.alertModalRef.toggleShow()},onCancel(){this.$refs.alertModalRef.toggleShow()}}});const Ye=(0,ke.A)(Ie,[["render",Ae],["__scopeId","data-v-46bedd7c"]]);var _e,He,Xe=Ye,je=a(6278),Ve=a(2543),$e=a.n(Ve),Ke=a(5093),Be=a.n(Ke);(function(e){e["empty"]="",e["draft"]="draft",e["published"]="published",e["partial"]="partial"})(_e||(_e={})),function(e){e["OPEN_DRAFT_DIALOG"]="openDraftDialog",e["SELECT_EMPLOYEE_AND_PUBLISH"]="selectEmployeeAndPublish",e["OPEN_ANALYSIS_CHART"]="openAnalysisChart",e["OPEN_COST_ANALYSIS"]="openCostAnalysis",e["PRINT_FLEX_SCHEDULE"]="printFlexSchedule",e["CHANGE_CELL_CONTROL"]="changeCellControl",e["SELECT_COST_CENTER"]="selectCostCenter",e["CHANGE_WEEK"]="changeWeek"}(He||(He={}));const Ue={date:"",startTime:"",endTime:"",hours:0,breakLength:0,shiftId:"",position:"",costElement1:"",costElement2:"",scheduleType:"",notes:""},Qe=[{optionName:"Std Hours",selectable:!1,selected:!0,sort:"",width:90},{optionName:"Net Hours",selectable:!0,selected:!0,sort:"",width:90},{optionName:"Worker Type",selectable:!0,selected:!1,sort:"",width:90},{optionName:"Ta Role",selectable:!0,selected:!1,sort:"",width:70},{optionName:"Roster Group",selectable:!0,selected:!1,sort:"",width:100}];var Ge,ze,Je;(function(e){e["getWeekStatus"]="GET_WEEK_STATUS",e["hasFuturePaidDate"]="HAS_FUTURE_PAID_DATE"})(Ge||(Ge={})),function(e){e["loadTargetSchedule"]="LOAD_TARGET_SCHEDULE",e["loadFlexiSchedules"]="LOAD_FLEXI_SCHEDULES"}(ze||(ze={})),function(e){e["clearForm"]="CLEAR_FORM",e["setScheduleDay"]="SET_SCHEDULE_DAY",e["saveScheduleDayToWeek"]="SAVE_SCHEDULE_DAY_TO_WEEK",e["saveRemoteData"]="SAVE_REMOTE_DATA",e["updateEditConfig"]="UPDATE_EDIT_CONFIG",e["createNewScheduleDay"]="CREATE_NEW_SCHEDULE_DAY",e["setAnalysisData"]="SET_ANALYSIS_DATA",e["setConfigAllTrue"]="SET_CONFIG_ALL_TRUE",e["setWeekStatus"]="SET_WEEK_STATUS",e["setHasFuturePaidDate"]="SET_HAS_FUTURE_PAID_DATE",e["resetState"]="RESET_STATE",e["resetMultiColumnState"]="RESET_MULTI_COLUMN_STATE",e["employeeMultiColumnState"]="EMPLOYEE_MULTI_COLUMN_STATE"}(Je||(Je={}));const Ze={selectedDate:Be()(),calendarFocusDate:Be()(),selectedFlexDay:null,defaultWorkTypes:null,analysisHoursChartData:null,flexScheduleRemoteData:null,weekStatus:_e.empty,flexScheduleDay:{date:"",startTime:"",endTime:"",hours:0,breakLength:0,shiftId:"",position:"",costElement1:"",costElement2:"",scheduleType:"",notes:""},editFlexScheduleDayConfig:{startTime:!1,endTime:!1,hours:!1,breakLength:!1,shiftId:!1,position:!1,costElement1:!1,costElement2:!1},scheduleWeek:[],flexScheduleCellSetting:{showHours:{value:!1,name:"Net Hours"},showBreakLength:{value:!1,name:"Break Length"},showShiftId:{value:!1,name:"Shift ID"},showPosition:{value:!1,name:"Position"},showNotes:{value:!1,name:"Notes"}},leaveList:[],selectableColumn:Qe,employeeSelectableColumn:Qe.map((e=>(e.selected=!1,e))),hasFuturePaidDate:!1},qe={[Ge.getWeekStatus](e){return e.weekStatus},[Ge.hasFuturePaidDate]:e=>e.hasFuturePaidDate},et={[Je.clearForm](e){e.flexScheduleDay={...Ue}},[Je.createNewScheduleDay](e,t){e.flexScheduleDay=Ue,e.flexScheduleDay.scheduleType="",e.selectedFlexDay=t},[Je.setScheduleDay](e,t){e.selectedFlexDay=t,e.flexScheduleDay.startTime=t.startTime,e.flexScheduleDay.endTime=t.endTime,e.flexScheduleDay.hours=t.hours,e.flexScheduleDay.scheduleType=t.scheduleType,e.flexScheduleDay.notes=t.notes;let a=Object.fromEntries(Object.entries(t.scheduleDetail).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])));e.flexScheduleDay=$e().merge({},e.flexScheduleDay,a)},[Je.saveScheduleDayToWeek](e){e.selectedFlexDay?(e.selectedFlexDay.startTime=e.flexScheduleDay.startTime,e.selectedFlexDay.endTime=e.flexScheduleDay.endTime,e.selectedFlexDay.scheduleDetail=$e().merge({},e.selectedFlexDay.scheduleDetail,e.flexScheduleDay)):console.error("missing selected flex day")},[Je.updateEditConfig](e,t){e.editFlexScheduleDayConfig=$e().clone(t)},[Je.setAnalysisData](e,t){e.analysisHoursChartData=t},[Je.saveRemoteData](e,t){e.flexScheduleRemoteData=t},[Je.setConfigAllTrue](e,t){e.flexScheduleCellSetting.showHours.value=!0,e.flexScheduleCellSetting.showBreakLength.value=!0,e.flexScheduleCellSetting.showShiftId.value=!0,e.flexScheduleCellSetting.showPosition.value=!0,e.flexScheduleCellSetting.showNotes.value=!0},[Je.setWeekStatus](e,t){e.weekStatus=t},[Je.setHasFuturePaidDate](e,t){e.hasFuturePaidDate=t},[Je.resetMultiColumnState](e){lt(e.selectableColumn)},[Je.employeeMultiColumnState](e){e.selectableColumn=e.selectableColumn.map((e=>(e.selected=!1,e)))},[Je.resetState](e){$e().cloneDeep(Ze)}},tt={[ze.loadTargetSchedule]({commit:e},t){ye.GetFlexScheduleDetail(t).then((e=>{console.log("GetFlexScheduleDetail",e)}))},[ze.loadFlexiSchedules]({commit:e},t){const a={employeeNo:t.employeeNo,startDate:t.startDate.format("YYYY-MM-DD"),endDate:t.endDate.format("YYYY-MM-DD"),forManagedEmployees:!0};return ye.GetFlexSchedules(a).then((t=>{let a=t.FlexSchedules;a.forEach((e=>{e.id=e.Id,e.date=e.Date,e.employeeName=e.EmployeeName,e.employeeNo=e.EmployeeNo,e.startTime=e.StartTime?Be()(e.StartTime).format("HH:mm"):"",e.endTime=e.EndTime?Be()(e.EndTime).format("HH:mm"):"",e.hours=e.Hours,e.scheduleDetail=e.ScheduleData,e.scheduleDetail.breakLength=e.scheduleDetail.BreakLength,e.scheduleDetail.position=e.scheduleDetail.Position,e.scheduleDetail.positionTitle=e.scheduleDetail.PositionTitle,e.scheduleDetail.shiftId=e.scheduleDetail.ShiftId,e.scheduleDetail.costElement1=e.scheduleDetail.CostElement1,e.scheduleDetail.costElement2=e.scheduleDetail.CostElement2,e.scheduleType=e.ScheduleType,e.publishStatus=e.PublishStatus,e.isPaid=e.IsPaid,e.dayInWeek=Be()(e.Date).day(),e.notes=e.Notes})),e(Je.saveRemoteData,a);let l=t.Unavailabilities.map((e=>({id:e.EmpAvailability.Id,unavailabilityDate:e.UnavailabilityDate,employeeNo:e.EmpAvailability.EmployeeNo,startTime:e.EmpAvailability.StartTime,endTime:e.EmpAvailability.EndTime,reason:e.EmpAvailability.Reason})));return{flexSchedules:a,unAvailabilities:l}}))}},at={state:$e().cloneDeep(Ze),getters:qe,mutations:et,actions:tt};function lt(e){$e().clone(Qe)}var st=at;function ot(e){if(!e)return"";let t="Hmm";e.includes(":")&&(t="H:mm");let a=Be()(e,t);return a.isValid()?a.format("HH:mm"):"Invalid Time"}function it(){return window.innerWidth<1200}function nt(){return window.innerWidth<768}function rt(){return window.innerWidth<1e3}function ct(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))}var dt={parseTimeColumn:ot},ut={name:"App",components:{schedulesNavigation:ge,Alert:Xe},setup(){const e=(0,je.Pj)();function t(){let t=localStorage.getItem("clientStorageVersion");if("0.12"!==t)localStorage.clear(),localStorage.setItem("clientStorageVersion","0.12"),localStorage.setItem("flexScheduleCellSetting",JSON.stringify(e.state.FlexSchedule.flexScheduleCellSetting)),localStorage.setItem("flexScheduleSelectableColumn",JSON.stringify(e.state.FlexSchedule.selectableColumn));else{let t=e.state.FlexSchedule.flexScheduleCellSetting,a=JSON.parse(localStorage.getItem("flexScheduleCellSetting"));for(let e of Object.keys(a))t[e]&&(t[e]=a[e]);let l=e.state.FlexSchedule.selectableColumn,s=JSON.parse(localStorage.getItem("flexScheduleSelectableColumn"));for(let e of Object.keys(s))l[e]&&(l[e]=s[e])}}rt()?e.commit(Je.setConfigAllTrue):t()},mounted(){console.log("app vue created")}};const ht=(0,ke.A)(ut,[["render",u]]);var mt=ht,pt=a(5220);const yt={class:"mt-4 mt-md-10"},ft={class:"my-schedules-search-filter d-flex flex-wrap align-center mb-sm-4"},kt={class:"mr-2 mr-sm-6 date-searcher d-flex align-center"},vt=(0,o.Lk)("div",{class:"mr-2 d-inline caption bold date-searcher-label"},"Date From",-1),gt=["value"],Dt=(0,o.Lk)("span",{class:"icon-popup white xs-icon"},null,-1),St=[Dt],bt=(0,o.Lk)("span",{class:"icon-calendar white xs-icon"},null,-1),Ct=[bt],Et=(0,o.Lk)("span",{class:"icon-cross white"},null,-1),wt=[Et],Lt={class:"date-searcher d-flex align-center ml-lg-4"},Tt=(0,o.Lk)("div",{class:"mr-2 d-inline caption bold date-searcher-label"},"Date To",-1),xt=["value"],At=(0,o.Lk)("span",{class:"icon-popup white","x-small":""},null,-1),Ft=[At],Nt=(0,o.Lk)("span",{class:"icon-calendar white","x-small":""},null,-1),Mt=[Nt],Pt=(0,o.Lk)("span",{class:"icon-cross white","x-small":""},null,-1),Ot=[Pt],Wt=(0,o.Lk)("span",{class:"mr-1 icon-printer","x-small":""},null,-1),Rt=(0,o.Lk)("span",{class:"text-capitalize"},"Print",-1),It=[Wt,Rt],Yt={style:{"margin-top":"10px"}},_t={class:"schedules-data-small",style:{overflow:"auto"}},Ht={class:"",style:{width:"100%"}},Xt={class:"weekInfoDisplay py-2"},jt={class:"schedules-data-small-head"},Vt={class:"dayScheduleDisplay"},$t={key:0},Kt={key:0},Bt={key:1},Ut={key:2},Qt={key:3,class:"notes-ellips"},Gt={id:"workSchedules",class:"dbw-box schedules-data-medium section",style:{overflow:"auto"}},zt={class:"my-schedules aff-table"},Jt={key:0},Zt=(0,o.Lk)("th",null,"Week",-1),qt=(0,o.Lk)("th",null,"Sun",-1),ea=(0,o.Lk)("th",null,"Mon",-1),ta=(0,o.Lk)("th",null,"Tue",-1),aa=(0,o.Lk)("th",null,"Wed",-1),la=(0,o.Lk)("th",null,"Thu",-1),sa=(0,o.Lk)("th",null,"Fri",-1),oa=(0,o.Lk)("th",null,"Sat",-1),ia=[Zt,qt,ea,ta,aa,la,sa,oa],na={key:1},ra=(0,o.Lk)("th",null,"Week",-1),ca=(0,o.Lk)("th",null,"Mon",-1),da=(0,o.Lk)("th",null,"Tue",-1),ua=(0,o.Lk)("th",null,"Wed",-1),ha=(0,o.Lk)("th",null,"Thu",-1),ma=(0,o.Lk)("th",null,"Fri",-1),pa=(0,o.Lk)("th",null,"Sat",-1),ya=(0,o.Lk)("th",null,"Sun",-1),fa=[ra,ca,da,ua,ha,ma,pa,ya],ka={class:"myschedules-tr"},va={class:"weekInfoRows"},ga={class:"myschedules-td"},Da={key:0,class:"text-center"},Sa={class:"bold-text"},ba={key:0},Ca={key:1},Ea={key:2,class:"notes-ellips"};function wa(e,t,a,l,s,i){const n=(0,o.g2)("date-picker"),r=(0,o.gN)("tooltip");return(0,o.uX)(),(0,o.CE)("div",yt,[(0,o.Lk)("div",ft,[(0,o.Lk)("div",kt,[vt,(0,o.Lk)("input",{value:e.$filters.reformatDate(e.fromDate),class:"d-inline-flex ma-0 pa-0 mr-2 caption",style:{"max-width":"120px"},onChange:t[0]||(t[0]=t=>e.updateDateText(t,e.fromDate,"fromDate")),onClick:t[1]||(t[1]=t=>e.updateDateTime(t,e.fromDate,"fromDate")),"onClick:clear":t[2]||(t[2]=t=>e.fromDate=null)},null,40,gt),(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{class:"light-blue icon small ml-2 lh-0",onClick:t[3]||(t[3]=t=>e.updateDateTime(t,e.fromDate,"fromDate"))},St)),[[r,{content:"Open calendar"},void 0,{top:!0}]]),(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{class:"green small icon ml-1 lh-0",onClick:t[4]||(t[4]=t=>e.selectDateTodayForFromDate())},Ct)),[[r,{content:"Set to today"},void 0,{top:!0}]]),(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{class:"orange small ml-1 icon lh-0",onClick:t[5]||(t[5]=t=>e.fromDate=null)},wt)),[[r,{content:"Clear"},void 0,{top:!0}]])]),(0,o.Lk)("div",Lt,[Tt,(0,o.Lk)("input",{type:"text",value:e.$filters.reformatDate(e.toDate),outlined:"",dense:"","hide-details":"",class:"d-inline-flex ma-0 pa-0 mr-2 caption",style:{"max-width":"120px"},onChange:t[6]||(t[6]=t=>e.updateDateText(t,e.toDate,"toDate")),onClick:t[7]||(t[7]=t=>e.updateDateTime(t,e.toDate,"toDate")),"onClick:clear":t[8]||(t[8]=t=>e.toDate=null)},null,40,xt),(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{class:"light-blue small icon ml-2 lh-0",tile:"",onClick:t[9]||(t[9]=t=>e.updateDateTime(t,e.toDate,"toDate"))},Ft)),[[r,{content:"Open calendar"},void 0,{top:!0}]]),(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{class:"green small ml-1 icon lh-0",tile:"",onClick:t[10]||(t[10]=t=>e.selectDateTodayForToDate())},Mt)),[[r,{content:"Set to today"},void 0,{top:!0}]]),(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{class:"orange small ml-1 icon lh-0",tile:"",onClick:t[11]||(t[11]=t=>e.toDate=null)},Ot)),[[r,{content:"Clear"},void 0,{top:!0}]])]),(0,o.Lk)("button",{class:"light-blue white--text ml-lg-4 ml-sm-4 mt-sm-0 small",onClick:t[12]||(t[12]=t=>e.printWorkSchedule())},It)]),(0,o.Lk)("div",Yt,[(0,o.Lk)("div",_t,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.schedules,(t=>((0,o.uX)(),(0,o.CE)("div",Ht,[(0,o.Lk)("div",Xt,[(0,o.Lk)("div",jt,[(0,o.Lk)("div",null,[(0,o.Lk)("h3",null,(0,h.v_)(t.weekName),1)]),(0,o.Lk)("div",null,(0,h.v_)(t.weekDateRange),1)])]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.detailArr,((a,l)=>((0,o.uX)(),(0,o.CE)("div",Vt,[(0,o.Lk)("div",null,(0,h.v_)(t.weekName)+" - "+(0,h.v_)(e.getWeekDayByIndex(l)),1),e.displayScheduleDetail(a)?((0,o.uX)(),(0,o.CE)("div",$t,[(0,o.Lk)("div",null,(0,h.v_)(a.shiftDescription),1),a.startTime?((0,o.uX)(),(0,o.CE)("div",Kt,"Start Time:"+(0,h.v_)(a.startTime),1)):(0,o.Q3)("",!0),a.finishTime?((0,o.uX)(),(0,o.CE)("div",Bt,"Finish Time:"+(0,h.v_)(a.finishTime),1)):(0,o.Q3)("",!0),a.hours?((0,o.uX)(),(0,o.CE)("div",Ut,"Hours:"+(0,h.v_)(a.hours),1)):(0,o.Q3)("",!0),a.notes?(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",Qt,[(0,o.eW)(" Notes: "+(0,h.v_)(a.notes),1)])),[[r,{content:a.notes,placement:"top",triggers:["click"],autoHide:!0}]]):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])))),256))])))),256))]),(0,o.Lk)("div",Gt,[(0,o.Lk)("div",zt,[(0,o.Lk)("table",null,[(0,o.Lk)("thead",null,[e.sundayFirst?((0,o.uX)(),(0,o.CE)("tr",Jt,ia)):((0,o.uX)(),(0,o.CE)("tr",na,fa))]),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.schedules,(t=>((0,o.uX)(),(0,o.CE)("tr",ka,[(0,o.Lk)("td",va,[(0,o.Lk)("div",null,(0,h.v_)(t.weekName),1),(0,o.Lk)("div",null,(0,h.v_)(t.weekDateRange),1)]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.detailArr,(t=>((0,o.uX)(),(0,o.CE)("td",ga,[e.displayScheduleDetail(t)?((0,o.uX)(),(0,o.CE)("div",Da,[(0,o.Lk)("div",null,(0,h.v_)(t.date),1),(0,o.Lk)("div",Sa,(0,h.v_)(t.shiftDescription),1),t.hours?((0,o.uX)(),(0,o.CE)("div",ba,"Hours:"+(0,h.v_)(t.hours),1)):(0,o.Q3)("",!0),t.startTime?((0,o.uX)(),(0,o.CE)("div",Ca,(0,h.v_)(t.startTime)+" - "+(0,h.v_)(t.finishTime),1)):(0,o.Q3)("",!0),t.notes?(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",Ea,[(0,o.eW)(" Notes: "+(0,h.v_)(t.notes),1)])),[[r,{content:t.notes,placement:"top",triggers:["click"],autoHide:!0}]]):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])))),256))])))),256))])])])])]),(0,o.bF)(n,{ref:"DatePickerRef",top:e.dateModalTop,leftInput:e.dateModalLeft,"max-date":e.datePickerMax,"min-date":e.datePickerMin,date:e.datePickerTargetDay},null,8,["top","leftInput","max-date","min-date","date"])])}function La(){GS.emit("dialog",{message:"here is a test dialog",showButtons:!0,showCancel:!0,okColor:"orange"})}function Ta(e){GS.emit("dialog",{dialog:!0,message:e.message,showCancel:!0,showButtons:!0,showLoader:!1,confirmButtonText:e.confirmButtonText?e.confirmButtonText:"Yes",cancelButtonText:e.cancelButtonText?e.cancelButtonText:"No",onOk:()=>{e.onOk()},onCancel:()=>{e.onCancel&&e.onCancel()}})}function xa(e){return new Promise(((t,a)=>{GS.emit("dialog",{dialog:!0,message:e.message,showCancel:!0,showButtons:!0,showLoader:!1,confirmButtonText:e.confirmButtonText?e.confirmButtonText:"Yes",cancelButtonText:e.cancelButtonText?e.cancelButtonText:"No",onOk:()=>{t("ok")},onCancel:()=>{a("cancel")}})}))}function Aa(e){GS.emit("dialog",{dialog:!0,message:e,showLoader:!1,showButtons:!0,onOk:()=>{},onCancel:()=>{}})}function Fa(e){GS.emit("dialog",{dialog:!0,message:e||"Loading",showCancel:!1,showButtons:!1,showLoader:!0})}function Na(){GS.emit("clearDialog")}var Ma={testDialog:La,loading:Fa,clear:Na,checkChange:Ta,alert:Aa,confirmOrCancel:xa};const Pa={class:"v3-calendar"},Oa={class:"dp-heading"},Wa={class:"db-content"},Ra={class:"dp-week-of-day"},Ia={class:"dp-week-days"},Ya={class:"date-wrapper"},_a=["onClick"];function Ha(e,t,a,l,s,i){const n=(0,o.g2)("Modal");return(0,o.uX)(),(0,o.Wv)(n,{ref:"ModalRef",top:e.top,left:e.calculateLeft(e.left),customPosition:!(!e.top&&!e.left),onCancel:e.cancelPickDate},{body:(0,o.k6)((()=>[(0,o.Lk)("div",Pa,[(0,o.Lk)("section",Oa,[(0,o.Lk)("span",{class:"cursor-pointer icon-arrow-left px-4",onClick:t[0]||(t[0]=(...t)=>e.previousMonth&&e.previousMonth(...t))}),(0,o.Lk)("div",null,(0,h.v_)(e.selectedDate.format("YYYY MMM")),1),(0,o.Lk)("span",{class:"cursor-pointer icon-arrow-right px-4",onClick:t[1]||(t[1]=(...t)=>e.nextMonth&&e.nextMonth(...t))})]),(0,o.Lk)("section",Wa,[(0,o.Lk)("div",Ra,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.weekOfDays,(e=>((0,o.uX)(),(0,o.CE)("span",null,(0,h.v_)(e.shortName),1)))),256))]),(0,o.Lk)("div",Ia,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.calendarArr,(t=>((0,o.uX)(),(0,o.CE)("span",Ya,[(0,o.Lk)("span",{class:(0,h.C4)(["date-number-cell",{"today-target":e.colorToday(t),"not-valid":!t.isValid,"last-month-day":t.lastMonth,"next-month-day":t.nextMonth,selected:t.selected}]),onClick:a=>e.selectDate(t)},(0,h.v_)(t.dateNumber),11,_a)])))),256))])])])])),_:1},8,["top","left","customPosition","onCancel"])}var Xa=(0,o.pM)({name:"DatePicker",components:{Modal:Re},props:{top:{type:Number},leftInput:{type:Number},date:{type:Object},maxDate:{type:Object},minDate:{type:Object}},data(){return{left:0,currentYear:2021,datePickerPromise:null,resolve:null,reject:null,selectedDate:Be()(),manageCompanyConfig:null}},setup(){const e=(0,s.KR)([]),t=(0,s.KR)();t.value=Be()().month();const a=(0,s.KR)([{fullName:"Monday",shortName:"Mon",dayNumber:1},{fullName:"Tuesday",shortName:"Tue",dayNumber:2},{fullName:"Wednesday",shortName:"Wed",dayNumber:3},{fullName:"Thursday",shortName:"Thu",dayNumber:4},{fullName:"Friday",shortName:"Fri",dayNumber:5},{fullName:"Saturday",shortName:"Sat",dayNumber:6},{fullName:"Sunday",shortName:"Sun",dayNumber:0}]);return{currentMonth:t,calendarArr:e,weekOfDays:a}},mounted(){this.manageCompanyConfig=(0,o.WQ)("MANAGE_COMPANY_CONFIG"),console.log("company config",this.manageCompanyConfig?.getAllowSundayFirst()),this.manageCompanyConfig?.getAllowSundayFirst()&&(this.weekOfDays=[{fullName:"Sunday",shortName:"Sun",dayNumber:0},{fullName:"Monday",shortName:"Mon",dayNumber:1},{fullName:"Tuesday",shortName:"Tue",dayNumber:2},{fullName:"Wednesday",shortName:"Wed",dayNumber:3},{fullName:"Thursday",shortName:"Thu",dayNumber:4},{fullName:"Friday",shortName:"Fri",dayNumber:5},{fullName:"Saturday",shortName:"Sat",dayNumber:6}]),this.calculateMonth(),this.datePickerPromise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))},watch:{maxDate(){this.selectedDate?this.calculateBaseOnInput(this.selectedDate):this.calculateBaseOnInput()},minDate(){this.selectedDate?this.calculateBaseOnInput(this.selectedDate):this.calculateBaseOnInput()}},methods:{cancelPickDate(){this.reject()},calculateLeft(){return this.leftInput?(window.innerWidth<this.leftInput+370?this.left=window.innerWidth-400:this.left=this.leftInput,this.left):0},nextMonth(){this.currentMonth=this.currentMonth+1,this.calculateMonth()},previousMonth(){this.currentMonth=this.currentMonth-1,this.calculateMonth()},colorToday(e){const t=Be()();return t.year()===e.year&&t.month()+1===e.month&&t.date()===e.dateNumber},selectDateOnly(e){for(let t of this.calendarArr)t.year===e.year()&&t.month===e.month()+1&&t.dateNumber===e.date()?t.selected=!0:t.selected=!1},selectDate(e){this.selectedDate=this.selectedDate.date(e.dateNumber);for(let t of this.calendarArr)t.selected=!1;e.selected=!0,this.$refs.ModalRef.toggleShow(),this.resolve(this.selectedDate.clone())},calculateMonth(e){e||(e=Be()(),this.currentYear&&e.year(this.currentYear));let t=e.clone().month(this.currentMonth),a=t.startOf("month").day(),l=t.clone().endOf("month").day();t.startOf("day");let s,o=[],i=t.clone().date(0).date();if(s=this.manageCompanyConfig.getAllowSundayFirst()?i-(a-1):0===a?i-5:1===a?null:i-(a-2),s)for(s;s<=i;s++)o.push({year:t.clone().date(0).year(),month:t.clone().date(0).month()+1,dateNumber:s,selected:!1,lastMonth:!0});let n=1,r=t.clone().endOf("month").date();for(n;n<=r;n++)o.push({year:t.year(),month:t.month()+1,isValid:this.validDateRange(this.maxDate,this.minDate,t.clone().startOf("month").date(n)),dateNumber:n,selected:!1});let c,d=1;for(c=this.manageCompanyConfig.getAllowSundayFirst()?0===l?6:6-l:0===l?0:6-(l-1),d;d<=c;d++){let e=t.clone().add(1,"month");o.push({year:e.year(),month:e.month()+1,dateNumber:d,selected:!1,nextMonth:!0})}this.calendarArr=o,t.clone().endOf("month").date()<=this.selectedDate.date()?this.selectedDate=t.clone().endOf("month").startOf("day"):this.selectedDate=t.date(this.selectedDate.date())},validDateRange(e,t,a){return e&&t?a.diff(e,"day")<0&&a.diff(t,"day")>0:e?a.diff(e,"day")<0:!t||a.diff(t,"day")>0},calculateBaseOnInput(e){e?(this.currentMonth=e.month(),this.selectedDate=e.clone(),this.calculateMonth(e),this.currentYear=e.year(),this.selectDateOnly(e)):(e=Be()(),this.currentMonth=e.month(),this.selectedDate=e.clone(),this.calculateMonth(e),this.currentYear=e.year())},toggleShow(e){return e?this.calculateBaseOnInput(e):this.calculateBaseOnInput(),this.$refs.ModalRef.toggleShow(),this.datePickerPromise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),this.waitPickDate()},async waitPickDate(){return this.datePickerPromise}}});const ja=(0,ke.A)(Xa,[["render",Ha],["__scopeId","data-v-e5a9b2b2"]]);var Va,$a=ja;(function(e){e["fromDate"]="fromDate",e["toDate"]="toDate"})(Va||(Va={}));var Ka=(0,o.pM)({name:"mySchedules",components:{DatePicker:$a},inject:{manageCompanyConfig:"MANAGE_COMPANY_CONFIG"},data(){return{title:"Work Schedule",schedules:[],user:null,datePickerFormat:"dd/MM/yyyy",sundayFirst:!1,menu1:!1,menu2:!1,fromDate:null,toDate:null,dateModal:!1,dateModalTop:0,dateModalLeft:0,datePickerTargetDay:Be()(),selectedDateType:Va.fromDate,datePickerMax:null,datePickerMin:null}},mounted(){this.sundayFirst=!!this.manageCompanyConfig.getAllowSundayFirst(),[this.fromDate,this.toDate]=this.convertDateRange(Be()(),Be()()),this.loadSchedules(this.fromDate,this.toDate)},methods:{updateDateText(e,t,a){"toDate"===a?this.toDate=Be()(e.target.value,"DD/MM/YYYY"):this.fromDate=Be()(e.target.value,"DD/MM/YYYY"),this.dateModal=!1},updateDateTime(e,t,a){let l=e.target.getClientRects()[0];this.dateModalTop=l.bottom,this.dateModalLeft=l.left,this.selectedDateType=a,"toDate"===a?(this.fromDate&&(this.datePickerMin=this.fromDate,this.datePickerMax=null),this.datePickerTargetDay=this.toDate?this.toDate:Be()()):(this.toDate&&(this.datePickerMin=null,this.datePickerMax=this.toDate),this.datePickerTargetDay=this.fromDate?this.fromDate:Be()()),this.dateModal=!0,this.openDatePicker()},printWorkSchedule:function(){var e="left=5,top=5,resizable=yes,height=600,width=700,scrollbars=yes,status=1",t=document.getElementById("workSchedules").innerHTML,a=window.open("","Print",e);a.document.write("<html>"),a.document.write("<head>"),a.document.write('<style type="text/css">table {border-collapse: collapse;}</style>'),a.document.write('<style type="text/css">table, th, td {border: 1px solid #cbcbcb;text-align: center;}</style>'),a.document.write("</head>"),a.document.write("<body>"),a.document.write(t),a.document.write("</body></html>"),a.document.close(),a.focus(),a.print(),a.close()},loadSchedules:function(e,t){if(null!==e&&e.startOf("day"),null!==t&&""!==t&&t.startOf("day"),this.schedules=[],null===t&&null===e)return;null!==t&&null===e&&(e=t),null===t&&null!==e&&(t=e);let[a,l]=this.convertDateRange(this.fromDate,this.toDate);var s={employeeNo:null,fromDate:null,toDate:null};if(null!==a&&null!==l){var o=a.format("DD/MM/YYYY"),i=l.format("DD/MM/YYYY");s={employeeNo:this.$user.value.EmployeeNo,fromDate:o,toDate:i}}Ma.loading(),ye.EmployeeWorkSchedule(s).then((e=>{let t=e;for(const[a,l]of t.entries()){this.sundayFirst?l.weekDateRange=`${l.sundayScheduleDetail.date} - ${l.saturdayScheduleDetail.date}`:l.weekDateRange=`${l.mondayScheduleDetail.date} - ${l.sundayScheduleDetail.date}`,l.weekName=`Week ${a+1}`,this.manageCompanyConfig.getAllowSundayFirst()?(l.detailArr=[],l.detailArr.push(l.sundayScheduleDetail),l.detailArr.push(l.mondayScheduleDetail),l.detailArr.push(l.tuesdayScheduleDetail),l.detailArr.push(l.wednesdayScheduleDetail),l.detailArr.push(l.thursdayScheduleDetail),l.detailArr.push(l.fridayScheduleDetail),l.detailArr.push(l.saturdayScheduleDetail)):(l.detailArr=[],l.detailArr.push(l.mondayScheduleDetail),l.detailArr.push(l.tuesdayScheduleDetail),l.detailArr.push(l.wednesdayScheduleDetail),l.detailArr.push(l.thursdayScheduleDetail),l.detailArr.push(l.fridayScheduleDetail),l.detailArr.push(l.saturdayScheduleDetail),l.detailArr.push(l.sundayScheduleDetail));for(let e of l.detailArr)this.clearZeroHour(e)}this.schedules=t,Ma.clear()}),(e=>{console.log("err",e),Ma.clear()})).finally((()=>{Ma.clear()}))},clearZeroHour(e){e&&(("12:00 am"===e.finishTime&&"12:00 am"===e.startTime||"12:00 AM"===e.finishTime&&"12:00 AM"===e.startTime)&&(e.finishTime="",e.startTime=""),"0"===e.hours&&(e.hours="",e.shiftDescription=""))},convertDateRange(e,t){let a=e.clone(),l=t.clone();return this.manageCompanyConfig.getAllowSundayFirst()?(e.day()>a.startOf("week").day()&&(a=a.startOf("week")),t.day()<l.endOf("week").day()&&(l=l.endOf("week"))):(e.day()>1?a=a.subtract(e.day()-1,"day"):0===e.day()&&(a=a.subtract(6,"day")),t.day()>0&&(l=l.add(7-t.day(),"day"))),[a,l]},displayScheduleDetail(e){return 0!==e.hours&&null!==e.hours&&""!==e.hours},selectDateTodayForFromDate:function(){this.fromDate=Be()().startOf("day"),this.toDate=null,this.loadSchedules(this.fromDate,this.toDate)},selectDateTodayForToDate:function(){this.toDate=Be()(),this.toDate.hour(11),this.toDate.minute(59),this.toDate<this.fromDate&&(this.fromDate=null),this.loadSchedules(this.fromDate,this.toDate)},getWeekDayByIndex:function(e){let t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return t[e]},async openDatePicker(){let e;try{e=await this.$refs.DatePickerRef.toggleShow(this.datePickerTargetDay)}catch(t){return void console.log(t)}return this.selectedDateType===Va.toDate?this.toDate=e:this.selectedDateType===Va.fromDate&&(this.fromDate=e),this.loadSchedules(this.fromDate,this.toDate),e}}});const Ba=(0,ke.A)(Ka,[["render",wa]]);var Ua=Ba;const Qa=e=>((0,o.Qi)("data-v-360e1c0a"),e=e(),(0,o.jt)(),e),Ga={class:"vue-sched-management"},za={class:"dbw-box sched-card-default mr-xs-0"},Ja=Qa((()=>(0,o.Lk)("div",null,[(0,o.Lk)("h3",{class:"mt-2"},"Schedules")],-1))),Za={key:0,class:"dbw-box sched-card-default sched-detail-card sche-detail-mt"},qa={key:0},el=Qa((()=>(0,o.Lk)("h3",null,"Create New Schedule",-1))),tl=[el],al={key:1,class:"d-flex justify-space-between"},ll=Qa((()=>(0,o.Lk)("h3",null,"Schedule Details",-1))),sl={key:3,class:"sched-man-allocations mt-4"},ol=Qa((()=>(0,o.Lk)("div",{class:"caption font-weight-bold text-start"}," Employee Allocations ",-1))),il={class:"aff-table allowcated-employee-table mt-4"},nl=Qa((()=>(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",{class:"text-center"},"Employee Name"),(0,o.Lk)("th",{class:"text-center"},"Date From"),(0,o.Lk)("th",{class:"text-center"},"Date To")])],-1))),rl={class:"text-center"},cl={class:"text-center"},dl={class:"d-flex justify-end mt-2"};function ul(e,t,a,s,i,n){const r=(0,o.g2)("search-schedule"),c=(0,o.g2)("schedule-detail");return(0,o.uX)(),(0,o.CE)("div",Ga,[(0,o.bo)((0,o.Lk)("div",za,[Ja,(0,o.bF)(r,{ref:"searchScheduleRef",onCreateNewSchedule:e.createNewSchedule,onSelectSchedFromSearch:e.selectSchedulesDetail},null,8,["onCreateNewSchedule","onSelectSchedFromSearch"])],512),[[l.aG,!e.createNew]]),e.schedDetail?((0,o.uX)(),(0,o.CE)("div",Za,[e.createNew?((0,o.uX)(),(0,o.CE)("div",qa,tl)):((0,o.uX)(),(0,o.CE)("div",al,[ll,(0,o.Lk)("span",{class:"icon-cross vp-icon",onClick:t[0]||(t[0]=t=>e.closeScheduleDetail(!0))})])),e.schedDetail?((0,o.uX)(),(0,o.Wv)(c,{key:2,ref:"detail",shiftTypeList:e.shiftTypeList,detail:e.schedDetail,"read-only":0,onCancel:e.cancelScheduleDetail,onReload:e.reloadSchedulesDetail,onScheduleSaved:e.scheduleSaved,onScheduleDeleted:e.scheduleDeleted},null,8,["shiftTypeList","detail","onCancel","onReload","onScheduleSaved","onScheduleDeleted"])):(0,o.Q3)("",!0),e.schedDetail&&e.schedDetail.EmpAllocations&&e.schedDetail.EmpAllocations.length>0?((0,o.uX)(),(0,o.CE)("div",sl,[ol,(0,o.Lk)("div",il,[(0,o.Lk)("table",null,[nl,(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.schedDetail.EmpAllocations,(t=>((0,o.uX)(),(0,o.CE)("tr",{class:(0,h.C4)({"hide-none-active-detail":!t.isActive&&e.showActiveSchedule})},[(0,o.Lk)("td",null,(0,h.v_)(t.EmployeeName),1),(0,o.Lk)("td",rl,(0,h.v_)(e.$filters.reformatDateString(t.DateFrom,null)),1),(0,o.Lk)("td",cl,(0,h.v_)(e.$filters.reformatDateString(t.DateTo,null)),1)],2)))),256))])])]),(0,o.Lk)("div",dl,[(0,o.Lk)("button",{class:"grey white--text text-capitalize small",onClick:t[1]||(t[1]=(...t)=>e.toggleShowActiveSchedule&&e.toggleShowActiveSchedule(...t))},[(0,o.bo)((0,o.Lk)("span",null,"Show Active",512),[[l.aG,!e.showActiveSchedule]]),(0,o.bo)((0,o.Lk)("span",null,"Show All",512),[[l.aG,e.showActiveSchedule]])])])])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])}const hl=e=>((0,o.Qi)("data-v-2b1e04fd"),e=e(),(0,o.jt)(),e),ml={class:"default-form sched-detail-form mt-4"},pl={key:0,class:"caption d-flex"},yl={class:"d-flex align-center"},fl=hl((()=>(0,o.Lk)("label",{for:"personal",class:"ml-2 cursor-pointer"},"Create Personal Schedule",-1))),kl={class:"d-flex align-center ml-6"},vl=hl((()=>(0,o.Lk)("label",{for:"team",class:"ml-2 cursor-pointer"},"Create Team Schedule",-1))),gl={key:1,class:"red--text archive-text"},Dl=hl((()=>(0,o.Lk)("span",null,"Archived",-1))),Sl=[Dl],bl={class:"form-control mt-4"},Cl=hl((()=>(0,o.Lk)("div",{class:"form-label"},"Name",-1))),El={key:1},wl={key:2,class:"label-detail"},Ll={key:2,class:"form-control"},Tl=hl((()=>(0,o.Lk)("div",{class:"form-label"},[(0,o.Lk)("span",null,"Employee No")],-1))),xl={key:0,class:"employeeNo-autoComplete"},Al={key:1,class:"label-detail"},Fl={class:"form-control"},Nl=hl((()=>(0,o.Lk)("div",{class:"form-label"},"Description",-1))),Ml={class:"form-control effective-date"},Pl=hl((()=>(0,o.Lk)("div",{class:"form-label"},"Effective Date",-1))),Ol={class:"inline-block"},Wl=["value"],Rl=hl((()=>(0,o.Lk)("span",{class:"input-icon icon-calendar xs-icon"},null,-1))),Il={class:"form-control number-of-weeks"},Yl=hl((()=>(0,o.Lk)("div",{class:"form-label"},"Number of Weeks",-1))),_l=hl((()=>(0,o.Lk)("label",{for:"now"},null,-1))),Hl={class:"mobile-arrow"},Xl=hl((()=>(0,o.Lk)("span",{class:"icon-arrowhead-up arrow-icon"},null,-1))),jl=[Xl],Vl=hl((()=>(0,o.Lk)("span",{class:"mt-1 icon-arrowhead-down arrow-icon"},null,-1))),$l=[Vl],Kl={class:"section-table ui-gridbox-scrollable-titles mt-4"},Bl={class:"aff-table sched-detail-table"},Ul=(0,o.Fv)('<div class="head-cell" data-v-2b1e04fd>Week</div><div class="head-cell" data-v-2b1e04fd>Day</div><div class="head-cell" data-v-2b1e04fd>Hours</div><div class="head-cell" data-v-2b1e04fd>Start</div><div class="head-cell" data-v-2b1e04fd>Finish</div><div class="head-cell break-column-width" data-v-2b1e04fd> Unpaid Break </div>',6),Ql={class:"head-cell"},Gl={class:"head-cell"},zl={class:"aff-table-body"},Jl={class:"aff-table-body-cell"},Zl={class:"table-date-counter aff-table-body-cell"},ql={class:"mr-2"},es={class:"aff-table-body-cell"},ts=["onUpdate:modelValue","error","onChange","data-test"],as={class:"aff-table-body-cell"},ls=["value","onChange"],ss={class:"aff-table-body-cell"},os=["value","onChange"],is={class:"unpaid-break hide-arrow aff-table-body-cell"},ns=["onUpdate:modelValue","onChange"],rs=hl((()=>(0,o.Lk)("span",null,":",-1))),cs=["onUpdate:modelValue","onChange"],ds={key:0,class:"shift-select-td aff-table-body-cell"},us={key:1,class:"aff-table-body-cell",style:{width:"100px"}},hs={class:"schedules-buttons"},ms={key:0},ps={key:1},ys={key:0},fs={key:1},ks=["disabled"],vs=hl((()=>(0,o.Lk)("span",{class:"icon-trash mr-1"},null,-1))),gs=hl((()=>(0,o.Lk)("span",null,"Delete",-1))),Ds=[vs,gs],Ss=["disabled"],bs=hl((()=>(0,o.Lk)("span",{class:"icon-briefcase mr-1"},null,-1))),Cs=hl((()=>(0,o.Lk)("span",null,"Archive",-1))),Es=[bs,Cs],ws=["disabled"],Ls=hl((()=>(0,o.Lk)("span",{class:"icon-cancel mr-1"},null,-1))),Ts=hl((()=>(0,o.Lk)("span",null,"Cancel",-1))),xs=[Ls,Ts],As=["disabled"],Fs=hl((()=>(0,o.Lk)("span",{class:"icon-save mr-1"},null,-1))),Ns=hl((()=>(0,o.Lk)("span",null,"Save",-1))),Ms=[Fs,Ns];function Ps(e,t,a,s,i,n){const r=(0,o.g2)("auto-complete"),c=(0,o.g2)("custom-select"),d=(0,o.g2)("date-picker"),u=(0,o.gN)("tooltip");return(0,o.uX)(),(0,o.CE)("div",ml,[(0,o.Lk)("form",{onChange:t[23]||(t[23]=(...t)=>e.formUpdated&&e.formUpdated(...t)),onSubmit:t[24]||(t[24]=(0,l.D$)((t=>e.formSubmited(t)),["prevent"]))},[e.isNewSchedule&&e.$CompanyConfig.isAllowPersonal?((0,o.uX)(),(0,o.CE)("div",pl,[(0,o.Lk)("div",yl,[(0,o.bo)((0,o.Lk)("input",{type:"radio",id:"personal",value:"personal",class:"cursor-pointer","onUpdate:modelValue":t[0]||(t[0]=t=>e.createType=t)},null,512),[[l.XL,e.createType]]),fl]),(0,o.Lk)("div",kl,[(0,o.bo)((0,o.Lk)("input",{type:"radio",id:"team",value:"team",class:"cursor-pointer","onUpdate:modelValue":t[1]||(t[1]=t=>e.createType=t)},null,512),[[l.XL,e.createType]]),vl])])):(0,o.Q3)("",!0),e.detail.Archive?((0,o.uX)(),(0,o.CE)("div",gl,Sl)):(0,o.Q3)("",!0),(0,o.Lk)("div",bl,[Cl,e.isNewSchedule&&"team"===e.createType?(0,o.bo)(((0,o.uX)(),(0,o.CE)("input",{key:0,class:"caption underline-input full-width",name:"name",onKeyup:t[2]||(t[2]=t=>e.hasChanges=!0),counter:"49","onUpdate:modelValue":t[3]||(t[3]=t=>e.detail.Name=t)},null,544)),[[l.Jo,e.detail.Name]]):e.isNewSchedule&&"personal"===e.createType&&e.detail.EmployeeNo?((0,o.uX)(),(0,o.CE)("div",El,(0,h.v_)("Personal_"+e.detail.EmployeeNo),1)):(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",wl,[(0,o.eW)((0,h.v_)(e.detail.Name),1)])),[[u,{content:e.detail.Name,delay:{show:3e3,hide:100}},void 0,{top:!0}]])]),"personal"===e.createType&&e.$CompanyConfig.isAllowPersonal?((0,o.uX)(),(0,o.CE)("div",Ll,[Tl,e.isNewSchedule&&e.employees&&e.employees.length>0?((0,o.uX)(),(0,o.CE)("span",xl,[(0,o.bF)(r,{inputList:e.employees,optionName:"joinedName",onSelected:e.selectedEmployee},null,8,["inputList","onSelected"])])):(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",Al,[(0,o.eW)((0,h.v_)(e.detail.EmployeeNo),1)])),[[u,{content:e.detail.EmployeeNo,delay:{show:3e3,hide:100}},void 0,{top:!0}]])])):(0,o.Q3)("",!0),(0,o.Lk)("div",Fl,[Nl,(0,o.bo)((0,o.Lk)("textarea",{class:"caption description-area",rows:"2",onKeyup:t[4]||(t[4]=t=>e.hasChanges=!0),"onUpdate:modelValue":t[5]||(t[5]=t=>e.detail.Description=t)},"\r\n                ",544),[[l.Jo,e.detail.Description]])]),(0,o.Lk)("div",Ml,[Pl,(0,o.Lk)("div",Ol,[(0,o.Lk)("input",{class:"date-input",value:e.$filters.reformatDate(e.detail.StartDate),onClick:t[6]||(t[6]=(...t)=>e.openDatePicker&&e.openDatePicker(...t))},null,8,Wl),Rl])]),(0,o.Lk)("div",Il,[Yl,_l,(0,o.bo)((0,o.Lk)("input",{class:"number-input",max:"12",min:"1",step:"1",id:"now",name:"now",type:"number","onUpdate:modelValue":t[7]||(t[7]=t=>e.detail.NoOfWeeks=t),onChange:t[8]||(t[8]=(...t)=>e.updateNoOfWeeks&&e.updateNoOfWeeks(...t)),onKeydown:t[9]||(t[9]=(...t)=>e.numLimitKeyDown&&e.numLimitKeyDown(...t)),style:{width:"60px"}},null,544),[[l.Jo,e.detail.NoOfWeeks]]),(0,o.Lk)("div",Hl,[e.detail.NoOfWeeks<12?((0,o.uX)(),(0,o.CE)("button",{key:0,type:"button",class:"icon small",onClick:t[10]||(t[10]=(...t)=>e.increaseNumber&&e.increaseNumber(...t))},jl)):(0,o.Q3)("",!0),e.detail.NoOfWeeks>1?((0,o.uX)(),(0,o.CE)("button",{key:1,type:"button",class:"ml-2 icon small",onClick:t[11]||(t[11]=(...t)=>e.reduceNumber&&e.reduceNumber(...t))},$l)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",Kl,[(0,o.Lk)("div",Bl,[(0,o.Lk)("div",{class:(0,h.C4)(["sched-detail-days",{"shift-min-width":e.showMore}])},[(0,o.Lk)("div",{class:(0,h.C4)(["aff-table-head",{"show-shift-column":e.showMore,"show-work-week-column":e.showWorkWeek}])},[Ul,(0,o.bo)((0,o.Lk)("div",Ql,"Shift",512),[[l.aG,e.showMore]]),(0,o.bo)((0,o.Lk)("div",Gl,"Work Week",512),[[l.aG,e.showWorkWeek]])],2),(0,o.Lk)("div",zl,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.detail.Days,(a=>((0,o.uX)(),(0,o.CE)("div",{key:a.DayNumber,class:(0,h.C4)(["aff-table-body-row",{"show-shift-column":e.showMore,"show-work-week-column":e.showWorkWeek}])},[(0,o.Lk)("div",Jl,[(0,o.bo)((0,o.Lk)("span",null,(0,h.v_)(a.Week),513),[[l.aG,e.isFirstDayOfWeek(a.DayOfWeek)]])]),(0,o.Lk)("div",Zl,[(0,o.Lk)("span",ql,(0,h.v_)(a.DayNumber+1),1),(0,o.Lk)("span",null,(0,h.v_)(e.getDayOfWeek(a.DayOfWeek)),1)]),(0,o.Lk)("div",es,[(0,o.bo)((0,o.Lk)("input",{type:"number",step:"any",min:"0",max:"24","onUpdate:modelValue":e=>a.Hours=e,class:"caption sched-detail-table-input",name:"Sche Hour",autocomplete:"off","data-lpignore":"true",error:a.error,onKeydown:t[12]||(t[12]=t=>e.numLimitKeyDown(t,!0,!1)),onChange:t=>e.checkHour(a),"data-test":a.Hours},null,40,ts),[[l.Jo,a.Hours,void 0,{number:!0}]])]),(0,o.Lk)("div",as,[(0,o.Lk)("input",{value:e.$filters.reformatTime(a.StartTime),autocomplete:"off","data-lpignore":"true",class:"d-inline-flex ma-0 pa-0 caption sched-detail-table-input",onChange:t=>e.timeTextChanged(t,a,"StartTime"),onKeydown:t[13]||(t[13]=t=>e.numLimitKeyDown(t,!1,!0)),"onClick:clear":t[14]||(t[14]=t=>e.fromDate=null)},null,40,ls)]),(0,o.Lk)("div",ss,[(0,o.Lk)("input",{value:e.$filters.reformatTime(a.FinishTime),autocomplete:"off","data-lpignore":"true",class:"d-inline-flex ma-0 pa-0 caption sched-detail-table-input",onChange:t=>e.timeTextChanged(t,a,"FinishTime"),onKeydown:t[15]||(t[15]=t=>e.numLimitKeyDown(t,!1,!0)),"onClick:clear":t[16]||(t[16]=t=>e.fromDate=null)},null,40,os)]),(0,o.Lk)("div",is,[(0,o.bo)((0,o.Lk)("input",{class:"sched-detail-table-input",type:"number",max:"100","onUpdate:modelValue":e=>a.breakH=e,onChange:t=>e.calcBreakHour(a)},null,40,ns),[[l.Jo,a.breakH,void 0,{lazy:!0}]]),rs,(0,o.bo)((0,o.Lk)("input",{class:"sched-detail-table-input","onUpdate:modelValue":e=>a.breakM=e,onChange:t=>e.calcBreakHour(a)},null,40,cs),[[l.Jo,a.breakM,void 0,{lazy:!0}]])]),e.showMore?((0,o.uX)(),(0,o.CE)("div",ds,[(0,o.bF)(c,{class:"caption",options:e.shifts,selected:a.ShiftId,onSelectOption:t=>e.selectedShift(t,a)},null,8,["options","selected","onSelectOption"])])):(0,o.Q3)("",!0),e.showWorkWeek?((0,o.uX)(),(0,o.CE)("div",us,[(0,o.bF)(c,{options:["Start","End"],selected:a.WorkWeek,onSelectOption:t=>e.selectedWorkWeek(t,a)},null,8,["selected","onSelectOption"])])):(0,o.Q3)("",!0)],2)))),128))])],2)])]),(0,o.Lk)("div",hs,[(0,o.Lk)("button",{type:"button",class:"white--text grey caption text-capitalize mr-2 mt-2 small",onClick:t[17]||(t[17]=(...t)=>e.toggleWorkWeek&&e.toggleWorkWeek(...t))},[e.showWorkWeek?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",ms,"Show Work Week")),e.showWorkWeek?((0,o.uX)(),(0,o.CE)("span",ps,"Hide Work Week")):(0,o.Q3)("",!0)]),(0,o.Lk)("button",{type:"button",class:"white--text grey caption text-capitalize mr-2 mt-2 small",onClick:t[18]||(t[18]=(...t)=>e.toggleShift&&e.toggleShift(...t))},[e.showMore?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",ys,"Show Shift")),e.showMore?((0,o.uX)(),(0,o.CE)("span",fs,"Hide Shift")):(0,o.Q3)("",!0)]),!e.isNewSchedule&&e.detail.EmpAllocations&&0===e.detail.EmpAllocations.length?((0,o.uX)(),(0,o.CE)("button",{key:0,type:"button",class:"white--text red text-capitalize mr-2 mt-2 small",disabled:e.hasChanges,onClick:t[19]||(t[19]=t=>e.deleteSchedule())},Ds,8,ks)):(0,o.Q3)("",!0),e.detail.Archive||e.isNewSchedule||"team"!==e.createType?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:1,type:"button",class:"white--text red text-capitalize mr-2 mt-2 small",disabled:e.hasChanges,onClick:t[20]||(t[20]=t=>e.archiveSchedule())},Es,8,Ss)),(0,o.Lk)("button",{type:"button",class:"white--text grey text-capitalize mr-2 mt-2 small",disabled:!e.hasChanges&&!e.isNewSchedule,onClick:t[21]||(t[21]=t=>e.cancelChanges())},xs,8,ws),(0,o.Lk)("button",{type:"button",class:"white--text text-capitalize mr-1 mt-2 green small",disabled:!e.hasChanges,onClick:t[22]||(t[22]=t=>e.updateDetail())},Ms,8,As)])],32),(0,o.bF)(d,{ref:"DatePickerRef",top:e.dateModalTop,leftInput:e.dateModalLeft,date:e.detail.StartDate},null,8,["top","leftInput","date"])])}var Os,Ws,Rs;(function(e){e["getEmployees"]="GET_EMPLOYEES",e["getFilteredEmployees"]="GET_FILTERED_EMPLOYEES"})(Os||(Os={})),function(e){e["setEmployees"]="SET_EMPLOYEES",e["resetEmployees"]="RESET_EMPLOYEES"}(Ws||(Ws={})),function(e){e["getEmployees"]="GET_EMPLOYEES"}(Rs||(Rs={}));const Is={[Os.getEmployees](e){return e.employees},[Os.getFilteredEmployees](e){return e.filteredEmployees}},Ys={[Ws.setEmployees](e,t){e.employees=t,e.filteredEmployees=t.slice()},[Ws.resetEmployees](e){e.employees=[],e.employeesWithPeronsalSche=[],e.filteredEmployees=[]}},_s={[Rs.getEmployees]({commit:e,state:t,rootState:a},l){if(t.employees.length>0)return t.employees;const s=a.LookUp.workTypes;return ye.GetManagedEmployees(l).then((t=>{let a=t.map((e=>(e.employeeName=e.CommonName,e.workTypeName=Xs(e.WorkerType,s)?.description,Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t]))))));return e(Ws.setEmployees,a),a}))}},Hs={state:{employees:[],employeesWithPeronsalSche:[],filteredEmployees:[],managerNo:null},getters:Is,mutations:Ys,actions:_s};function Xs(e,t){return t.find((t=>t.code===Number(e)))}var js=Hs;const Vs={class:"custom-select",tabindex:"1",ref:"selectRef"},$s={class:"custom-select-selected"},Ks={class:"custom-select-items"},Bs=["tabindex","onClick"],Us={class:"cell-config"};function Qs(e,t,a,s,i,n){return(0,o.uX)(),(0,o.CE)("div",Vs,[(0,o.Lk)("div",$s,[(0,o.bo)((0,o.Lk)("input",{class:"custom-select-input",ref:"selectInputRef","onUpdate:modelValue":t[0]||(t[0]=t=>e.selectSearchInput=t),onKeyup:t[1]||(t[1]=(...t)=>e.updateSearchList&&e.updateSearchList(...t))},null,544),[[l.Jo,e.selectSearchInput]])]),(0,o.Lk)("div",Ks,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.dropDownList,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{class:(0,h.C4)(["custom-select-item",{targeting:t.targeting}]),ref_for:!0,ref:"selectDropdownRef",key:a,tabindex:a+99,onClick:a=>e.chooseOption(a,t)},[(0,o.Lk)("div",Us,(0,h.v_)(t.name),1)],10,Bs)))),128))])],512)}var Gs=(0,o.pM)({name:"AutoComplete",props:{inputList:{type:Array},optionName:{type:String}},data(){return{editing:!1,targetingIndex:null}},setup(e){e.optionName||console.error("need object, optionName is missing");const t=(0,s.KR)(e.inputList.map(((t,a)=>({targeting:!1,name:t[e.optionName],index:a})))),a=(0,s.KR)(t.value.slice()),l=(0,s.KR)("");return{originList:t,dropDownList:a,selectSearchInput:l}},methods:{updateSearchList(e){"ArrowDown"!==e.key?"ArrowUp"!==e.key?"Enter"===e.key&&this.targetingIndex?this.selectFromTarget():this.dropDownList=this.originList.filter((e=>(e.targeting=!1,e.name.toLowerCase().indexOf(this.selectSearchInput.toLowerCase())>-1))):this.moveTargetUp():this.moveTargetDown()},moveTargetDown(){null!==this.targetingIndex?(this.dropDownList[this.targetingIndex].targeting=!1,this.targetingIndex+1<this.dropDownList.length?(this.targetingIndex++,this.dropDownList[this.targetingIndex].targeting=!0):(this.targetingIndex,this.dropDownList.length,this.targetingIndex=0,this.dropDownList[this.targetingIndex].targeting=!0)):(this.targetingIndex=0,this.dropDownList[this.targetingIndex].targeting=!0)},moveTargetUp(){null!==this.targetingIndex?(this.dropDownList[this.targetingIndex].targeting=!1,this.targetingIndex-1>=0?(this.targetingIndex--,this.dropDownList[this.targetingIndex].targeting=!0):this.targetingIndex-1<0?(this.targetingIndex=this.dropDownList.length-1,this.dropDownList[this.targetingIndex].targeting=!0):(this.targetingIndex=0,this.dropDownList[this.targetingIndex].targeting=!0)):(this.targetingIndex=0,this.dropDownList[this.targetingIndex].targeting=!0)},selectFromTarget(){this.selectSearchInput=this.dropDownList[this.targetingIndex].name,this.$emit("selected",this.inputList[this.targetingIndex])},chooseOption(e,t){this.selectSearchInput=t.name,this.$emit("selected",this.inputList[t.index]),e.target.blur()}}});const zs=(0,ke.A)(Gs,[["render",Qs],["__scopeId","data-v-2dad74ce"]]);var Js=zs;const Zs=e=>((0,o.Qi)("data-v-21302fdd"),e=e(),(0,o.jt)(),e),qs={key:0,class:"custom-select-selected"},eo={key:0},to={key:1},ao={key:2,class:"custom-select-empty-selected"},lo={key:1,class:"custom-select-selected"},so={key:0},oo={key:1},io={key:2,class:"custom-select-empty-selected"},no=["onClick"],ro={class:"cell-config"},co={key:0},uo={key:1},ho=Zs((()=>(0,o.Lk)("label",null,null,-1)));function mo(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("span",null,[(0,o.Lk)("div",{class:"custom-select",style:(0,h.Tr)({width:e.width?e.width+"px":null}),tabindex:"1",ref:"selectRef",onMouseenter:t[2]||(t[2]=t=>e.setSelectItemsPosition())},[e.modelValue?((0,o.uX)(),(0,o.CE)("div",qs,[e.modelValue&&"object"===typeof e.modelValue&&e.displayKey?((0,o.uX)(),(0,o.CE)("span",eo,(0,h.v_)(e.modelValue[e.displayKey]),1)):e.modelValue?((0,o.uX)(),(0,o.CE)("span",to,(0,h.v_)(e.modelValue),1)):((0,o.uX)(),(0,o.CE)("span",ao)),e.modelValue||e.selected?((0,o.uX)(),(0,o.CE)("span",{key:3,class:"clear-icon",onClick:t[0]||(t[0]=t=>e.clearSelection(t))},"")):(0,o.Q3)("",!0)])):((0,o.uX)(),(0,o.CE)("div",lo,[e.selected&&"object"===typeof e.selected?((0,o.uX)(),(0,o.CE)("span",so,(0,h.v_)(e.selected[e.displayKey]),1)):e.selected?((0,o.uX)(),(0,o.CE)("span",oo,(0,h.v_)(e.selected),1)):((0,o.uX)(),(0,o.CE)("span",io)),e.modelValue||e.selected?((0,o.uX)(),(0,o.CE)("span",{key:3,class:"clear-icon",onClick:t[1]||(t[1]=t=>e.clearSelection(t))},"")):(0,o.Q3)("",!0)])),(0,o.Lk)("div",{class:"custom-select-items",style:(0,h.Tr)({left:e.left+"px",top:e.top+"px",width:e.width?e.width+"px":null})},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.options,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{class:"custom-select-item",key:a,onClick:a=>e.selectOption(a,t)},[(0,o.Lk)("div",ro,[e.displayKey?((0,o.uX)(),(0,o.CE)("label",co,(0,h.v_)(t[e.displayKey]),1)):((0,o.uX)(),(0,o.CE)("label",uo,(0,h.v_)(t),1)),ho])],8,no)))),128))],4)],36)])])}var po=(0,o.pM)({name:"CustomSelect",props:{options:{type:Array,default:[]},displayKey:{type:String,default:""},modelValue:{type:[String,Number]},width:{type:Number},selected:{}},data:function(){return{left:0,top:0}},mounted(){const e=this.$refs.selectRef.getClientRects()[0];this.left=e.left,this.top=e.top+e.height},methods:{selectOption(e,t){e.target.blur();let a=this.$refs.selectRef;a.blur(),this.modelValue?this.$emit("update:modelValue",t):this.$emit("selectOption",t)},setSelectItemsPosition(){const e=this.$refs.selectRef.getClientRects()[0];this.left=e.left,this.top=e.top+e.height},clearSelection(e){this.$emit("update:modelValue",null),this.$emit("selectOption",null);let t=this.$refs.selectRef;t.blur()}}});const yo=(0,ke.A)(po,[["render",mo],["__scopeId","data-v-21302fdd"]]);var fo=yo,ko=(0,o.pM)({name:"schedule-detail",components:{AutoComplete:Js,DatePicker:$a,CustomSelect:fo},props:["detail","shiftTypeList","readOnly"],data:function(){return{createType:"team",employees:[],week:1,tablePadding:"0 0;",hasChanges:!1,isDateToCleared:!1,shifts:[],showMore:!0,showWorkWeek:!0,initialEmpSched:null,startDateMenu:!1,dateModalTop:0,dateModalLeft:0,timePickerTargetDay:null,selectedTimeType:"Start"}},computed:{isNewSchedule(){let e=this.detail;return e.Id<=0}},mounted:function(){this.shifts=this.shiftTypeList,this.hasChanges=-1==this.detail.Id,this.$emit("dataChanged",this.hasChanges);let e=this.$store.getters[Os.getEmployees];e=e.filter((e=>!this.$store.state.EmployeeModule.employeesWithPeronsalSche.includes(e.employeeNo))),this.employees=e.map((e=>(e.joinedName=e.commonName+" "+e.employeeNo,e))),this.remapDays(),this.createType=0===this.detail.ScheduleType||void 0===this.detail.ScheduleType?"team":"personal"},watch:{["detail"](e,t){this.remapDays(),this.createType=0===this.detail.ScheduleType||void 0===this.detail.ScheduleType?"team":"personal",e!=t&&-1==e.Id&&(this.detail.Days=[],this.createNewDays(1,1))}},methods:{selectedWorkWeek(e,t){console.log("selectedWeek",e),t.WorkWeek=e,this.hasChanges=!0},selectedShift(e,t){t.ShiftId=e,this.hasChanges=!0},formSubmited(e){return e.preventDefault(),e.stopPropagation(),!1},increaseNumber(){this.detail.NoOfWeeks++,this.updateNoOfWeeks()},reduceNumber(){this.detail.NoOfWeeks--,this.updateNoOfWeeks()},toggleShift(){this.showMore=!this.showMore},toggleWorkWeek(){this.showWorkWeek=!this.showWorkWeek},remapDays(){for(var e=0,t=Be()(this.detail.StartDate),a=7*this.detail.NoOfWeeks,l=new Array(a),s=0;s<a;s++)s%7==0&&e++,l[s]={DayNumber:s,DayOfWeek:t.day(),Week:e,Date:Be()(t),Hours:0,StartTime:null,FinishTime:null,ShiftId:null,BreakHours:null,WorkWeek:null},t.add(1,"day");this.showMore=!1,this.showWorkWeek=!0,this.detail.Days.map((e=>{e.StartTime&&(l[e.DayNumber].StartTime=Be()(e.StartTime)),e.FinishTime&&(l[e.DayNumber].FinishTime=Be()(e.FinishTime)),l[e.DayNumber].Hours=e.Hours,l[e.DayNumber].ShiftId=e.ShiftId,l[e.DayNumber].BreakHours=e.BreakHours,l[e.DayNumber].WorkWeek=e.WorkWeek;let t=e.BreakHours,a=Math.floor(t),s=t-a;0!==a&&(l[e.DayNumber].breakH=a),s>0&&(l[e.DayNumber].breakM=Math.round(60*s))})),this.detail.Days=l,this.detail.StartDate=Be()(this.detail.StartDate),this.hasChanges=!1},timeTextChanged(e,t,a){let l;if(l=e.target.value.includes(":")?Be()(e.target.value,"HH:mm"):Be()(e.target.value,"Hmm"),"FinishTime"===a){if(!l.isValid())return e.target.value="InValid Time",void(t.FinishTime=null);if(t.FinishTime&&l.hour()===t.FinishTime.hour()&&l.minute()===t.FinishTime.minute())return;if(""===e)return void(t.FinishTime=null);t.FinishTime=l}else{if(t.StartTime&&l.hour()===t.StartTime.hour()&&l.minute()===t.StartTime.minute())return;if(!l.isValid())return e.target.value="InValid Time",void(t.StartTime=null);if(""===e)return void(t.StartTime=null);t.StartTime=l}this.timePickerTargetDay=t,this.autoCalcTime(a),this.hasChanges=!0},autoCalcTime(e){let t=this.timePickerTargetDay;if(!t.FinishTime||"00:00"===t.FinishTime.format("HH:mm")||!t.StartTime||"00:00"===t.StartTime.format("HH:mm")||t.Hours&&0!==t.Hours)if(!t.FinishTime||!t.Hours||t.StartTime&&"00:00"!==t.StartTime.format("HH:mm"))if(!t.StartTime||!t.Hours||t.FinishTime&&"00:00"!==t.FinishTime.format("HH:mm")){if(t.FinishTime&&"00:00"!==t.FinishTime.format("HH:mm")&&t.StartTime&&"00:00"!==t.StartTime.format("HH:mm")&&(t.Hours||0!==t.Hours)){const a=t.BreakHours?t.Hours+t.BreakHours:t.Hours;"StartTime"===e?t.FinishTime=t.StartTime.clone().add(a,"hours"):"FinishTime"===e&&(t.StartTime=t.FinishTime.clone().subtract(a,"hours"))}}else{const e=t.BreakHours?t.Hours+t.BreakHours:t.Hours;t.FinishTime=t.StartTime.clone().add(e,"hours")}else{const e=t.BreakHours?t.Hours+t.BreakHours:t.Hours;t.StartTime=t.FinishTime.clone().subtract(e,"hours")}else{t.FinishTime.year(t.StartTime.year()),t.FinishTime.month(t.StartTime.month()),t.FinishTime.day(t.StartTime.day());let e=t.FinishTime.startOf("minute").diff(t.StartTime.startOf("minute"),"hours",!0);t.BreakHours&&(e-=t.BreakHours),t.Hours=Math.round(100*e)/100}},updateDateText(e,t){this.startDateMenu=!1,t.set(Be()(e,"DD/MM/YYYY").toObject()),this.remapDays()},startDateDatePickerHandler(e){"string"===typeof e&&(e=Be()(e)),this.detail.StartDate=e,this.remapDays()},isFirstDayOfWeek:function(e){var t=Be()(this.detail.StartDate);return e==t.day()},calcBreakHour(e){e.breakH&&e.breakM?e.BreakHours=Number(e.breakH)+Math.round(Number(e.breakM)/60*1e3)/1e3:e.breakH?e.BreakHours=Number(e.breakH):e.breakM?e.BreakHours=Math.round(Number(e.breakM)/60*1e3)/1e3:(0===e.breakHours&&e.breakM,e.BreakHours=0),e.StartTime&&"00:00"!==e.StartTime.format("HH:mm")&&e.FinishTime&&"00:00"!==e.FinishTime.format("HH:mm")&&(e.Hours=e.FinishTime.startOf("minute").diff(e.StartTime.startOf("minute"),"hours",!0)-e.BreakHours)},getDayOfWeek:function(e){if(e<0||e>6)return console.error("day No not correct"),"unknown";var t=["Sun","Mon","Tue","Wed","Thur","Fri","Sat"];return t[e]},checkHour(e){if(this.hasChanges=!0,e.Hours>24)return Ma.alert("You can only enter up to 24 hours."),void(e.Hours=24);const t=e.BreakHours?e.Hours+e.BreakHours:e.Hours;e.StartTime&&e.Hours&&e.FinishTime||e.StartTime&&e.Hours?e.FinishTime=e.StartTime.clone().add(t,"hours"):e.Hours&&e.FinishTime&&(e.StartTime=e.FinishTime.clone().add(t,"hours"))},updateNoOfWeeks(e){let t=this.detail.Days.length,a=Math.floor(t/7);if(this.detail.NoOfWeeks>a)this.createNewDays(a+1,this.detail.NoOfWeeks);else{let e=7*this.detail.NoOfWeeks;this.detail.Days.splice(e)}},numLimitKeyDown:function(e,t,a){let l=[8,9,13,46,16,17];l.push(65,67,86,88),t&&l.push(190,110),a&&l.push(186),e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105||l.indexOf(e.keyCode)>-1||(e.preventDefault(),e.stopPropagation())},cancelChanges(){if(!this.hasChanges)return void this.$emit("cancel");let e="You haven't saved your changes.  <br /> Are you sure you want to cancel?";Ma.checkChange({message:e,confirmButtonText:"Yes",cancelButtonText:"No",onOk:()=>{this.hasChanges=!1,this.$emit("cancel")}})},reloadDetail:function(){this.hasChanges&&this.$emit("reload")},createNewDays:function(e,t){if(!(e>t)){var a=e,l=this.detail.Days.length;while(a<=t){var s=Be()(this.detail.StartDate);s.add(l,"day"),this.detail.Days.push({DayNumber:l,DayOfWeek:s.day(),Week:a,Date:s,Hours:0,StartTime:null,FinishTime:null,ShiftId:null,startDateModal:!1,endDateModal:!1,WorkWeek:null}),l++,a=Math.floor(l/7)+1}}},archiveSchedule:function(){this.hasChanges||(this.detail.Archive?Ma.alert("Unable to archive schedule, it's already archived."):Ma.confirmOrCancel({message:"Are you sure you want to archive this work schedule?"}).then((()=>{this.detail.Archive=!0,this.doUpdateDetail()})))},deleteSchedule:function(){this.hasChanges||(this.detail.EmpAllocations.length>0?Ma.alert("Unable to delete schedule, it's currently allocated to employees"):GS.emit("dialog",{message:"Are you sure you want to permanently delete this work schedule?",showButtons:!0,showCancel:!0,okColor:"red",onOk:()=>{this.doDeleteSchedule()},onCancel:()=>{}}))},doDeleteSchedule:function(){Ma.loading(),ye.DeleteSchedule(this.detail.Id).then((e=>{this.$emit("schedule-deleted"),Ma.clear()}))},updateDetail:function(){console.log("update detail"),this.hasChanges&&this.doUpdateValidation()&&this.doUpdateDetail()},doUpdateValidation:function(){if("team"===this.createType){if(!this.detail.Name&&!this.detail.Description||""===this.detail.Name&&""===this.detail.Description)return Ma.alert("Schedule name cannot be blank. <br /> Schedule description cannot be blank."),!1;if(!this.detail.Name||""===this.detail.Name)return Ma.alert("Schedule name cannot be blank."),!1}if(!this.detail.Description||""===this.detail.Description)return Ma.alert("Schedule description cannot be blank."),!1;if(void 0!==this.detail.Name&&null!==this.detail.Name&&this.detail.Name.length>50)return Ma.alert("Schedule names must be 50 characters or fewer (including spaces)."),!1;if(void 0!==this.detail.Description&&null!==this.detail.Description&&this.detail.Description.length>50)return Ma.alert("Schedule descriptions must be 50 characters or fewer (including spaces)."),!1;const e=this.validateWorkWeekPattern(this.detail.Days);return!!e||(Ma.alert("Invalid Work Week Configuration, Please correct to enable Schedule to be Saved, Refer to Help if needed."),!1)},validateWorkWeekPattern:function(e){let t=!1,a=0;for(const l of e)if("Start"===l.WorkWeek){if(t)return!1;t=!0}else if("End"===l.WorkWeek){if(!t)return!1;if(t=!1,a++,a>2*this.detail.NoOfWeeks)return!1}return!t},checkIfNoWorkWeek(e){for(const t of e)if(t.WorkWeek)return!1;return!0},doUpdateDetail:function(){let e=this.checkIfNoWorkWeek(this.detail.Days);console.log("do update detail, this.detail",this.detail);var t={Id:this.detail.Id,NoOfWeeks:this.detail.NoOfWeeks,StartDate:Be()(this.detail.StartDate).format("DD/MMM/YYYY"),Name:"team"===this.createType?this.detail.Name:"Personal_ "+this.detail.EmployeeNo,EmployeeNo:this.detail.EmployeeNo?this.detail.EmployeeNo:null,ScheduleType:this.detail.EmployeeNo?1:0,IsPersonal:!!this.detail.EmployeeNo,Description:this.detail.Description,Archive:this.detail.Archive,Days:[]};this.detail.Days.map((function(a){if(a.Hours>0||null!==a.ShiftId&&""!==a.ShiftId||null!==a.WorkWeek&&""!==a.WorkWeek||e&&(0===a.DayOfWeek||1===a.DayOfWeek)){let l=a.WorkWeek;""===a.ShiftId&&(a.ShiftId=null),e&&(1===a.DayOfWeek&&(l="Start"),0===a.DayOfWeek&&(l="End")),t.Days.push({DayNumber:a.DayNumber,StartTime:a.StartTime?a.StartTime.format("HH:mm"):null,FinishTime:a.FinishTime?a.FinishTime.format("HH:mm"):null,Hours:a.Hours>24?24:a.Hours,ShiftId:a.ShiftId,BreakHours:a.BreakHours?Number(a.BreakHours):null,WorkWeek:l})}})),Ma.loading(),ye.PostSchedule(t).then((e=>{e.Data?(this.$emit("schedule-saved",e.Data),Ma.clear()):!e.Data&&e.Messages&&e.Messages.length>0&&("That name is taken. Please use a different name."===e.Messages[0].Message?Ma.alert("This name is already in use. Please give your schedule a different name."):Ma.alert("An error occurred while saving the schedule."))})).catch((e=>{Ma.alert("An error occurred while saving the schedule.")}))},formUpdated(){console.log("form updated"),this.hasChanges=!0},async openDatePicker(e){let t=e.target.getClientRects()[0];this.dateModalTop=t.bottom,this.dateModalLeft=t.left;try{this.detail.StartDate=await this.$refs.DatePickerRef.toggleShow(this.detail.StartDate)}catch(a){return void(a&&console.error(a))}this.remapDays(),this.hasChanges=!0},selectedEmployee(e){this.detail.EmployeeNo=e.employeeNo,this.detail.Description=`${e.commonName} ${e.employeeNo} Personal Schedule`}}});const vo=(0,ke.A)(ko,[["render",Ps],["__scopeId","data-v-2b1e04fd"]]);var go=vo;const Do=e=>((0,o.Qi)("data-v-45fa04bf"),e=e(),(0,o.jt)(),e),So={id:"sched-man-list ",class:"sched-man-list mt-4"},bo={class:"sched-filters d-flex align-center"},Co={class:"filter-dropdown"},Eo={class:"custom-select",tabindex:"1",ref:"selectRef"},wo={class:"custom-select-selected"},Lo={class:"custom-select-items"},To=["tabindex","onClick"],xo={class:"cell-config"},Ao=Do((()=>(0,o.Lk)("span",{class:"icon-plus btn-icon white"},null,-1))),Fo=Do((()=>(0,o.Lk)("span",{class:"font-weight-regular text-capitalize white"},"Create",-1))),No=[Ao,Fo],Mo={class:"d-flex justify-start mt-2"},Po={class:"d-flex align-center"},Oo=Do((()=>(0,o.Lk)("label",{class:"ml-1"},"My Employees Only",-1))),Wo={class:"d-flex align-center ml-2"},Ro=Do((()=>(0,o.Lk)("label",{class:"ml-1"},"All Employees",-1))),Io={class:"aff-table sche-search-table mt-4"},Yo={class:"ui-grid"},_o={class:"table-head"},Ho={class:"table-body-box"},Xo=["onClick"],jo={class:"table-body-cell table-body-cell-first"},Vo={class:"table-body-cell"},$o={class:"sched-search-desc"},Ko={class:"table-body-cell text-center"},Bo={class:"table-body-cell text-center"},Uo={class:"table-body-cell text-center"};function Qo(e,t,a,s,i,n){const r=(0,o.g2)("perfect-scrollbar"),c=(0,o.gN)("tooltip");return(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",So,[(0,o.Lk)("div",null,[(0,o.Lk)("div",bo,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.filters.searchTerm=t),type:"text",placeholder:"Search for schedules","hide-details":"",class:"sched-search-box body-2 underline-input"},null,512),[[l.Jo,e.filters.searchTerm]]),(0,o.Lk)("div",Co,[(0,o.Lk)("div",Eo,[(0,o.Lk)("div",wo,(0,h.v_)(e.filters.selected),1),(0,o.Lk)("div",Lo,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.filters.options,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{class:"custom-select-item",key:a,tabindex:a+99,onClick:a=>e.choseFilter(a,t)},[(0,o.Lk)("div",xo,(0,h.v_)(t),1)],8,To)))),128))])],512)]),(0,o.Lk)("button",{class:"blue ml-2 small",onClick:t[1]||(t[1]=t=>e.createNewSchedule())},No)]),(0,o.Lk)("div",Mo,[(0,o.Lk)("div",Po,[(0,o.bo)((0,o.Lk)("input",{class:"ma-0",type:"radio",id:"myEmployee",value:"MyEmployee","onUpdate:modelValue":t[2]||(t[2]=t=>e.myEmployeeToggle=t),onChange:t[3]||(t[3]=(...t)=>e.getSchedulesList&&e.getSchedulesList(...t))},null,544),[[l.XL,e.myEmployeeToggle]]),Oo]),(0,o.Lk)("div",Wo,[(0,o.bo)((0,o.Lk)("input",{class:"my-0",type:"radio",id:"allEmployee",value:"AllEmployee","onUpdate:modelValue":t[4]||(t[4]=t=>e.myEmployeeToggle=t),onChange:t[5]||(t[5]=(...t)=>e.getSchedulesList&&e.getSchedulesList(...t))},null,544),[[l.XL,e.myEmployeeToggle]]),Ro])])]),(0,o.Lk)("div",Io,[(0,o.Lk)("div",Yo,[(0,o.Lk)("div",_o,[(0,o.Lk)("div",{class:"table-head-cell table-head-cell-first",onClick:t[6]||(t[6]=t=>e.updateSort(0))},[(0,o.eW)(" Name "),(0,o.Lk)("span",{class:(0,h.C4)({"icon-arrow-line-small-down":"Asc"===e.filters.orderByArrow[0],"icon-arrow-line-small-up":"Desc"===e.filters.orderByArrow[0]})},null,2)]),(0,o.Lk)("div",{class:"table-head-cell",onClick:t[7]||(t[7]=t=>e.updateSort(1))},[(0,o.eW)(" Description "),(0,o.Lk)("span",{class:(0,h.C4)({"icon-arrow-line-small-down":"Asc"===e.filters.orderByArrow[1],"icon-arrow-line-small-up":"Desc"===e.filters.orderByArrow[1]})},null,2)]),(0,o.Lk)("div",{class:"table-head-cell text-center",onClick:t[8]||(t[8]=t=>e.updateSort(2))},[(0,o.eW)(" Weeks "),(0,o.Lk)("span",{class:(0,h.C4)({"icon-arrow-line-small-down":"Asc"===e.filters.orderByArrow[2],"icon-arrow-line-small-up":"Desc"===e.filters.orderByArrow[2]})},null,2)]),(0,o.Lk)("div",{class:"table-head-cell text-center",onClick:t[9]||(t[9]=t=>e.updateSort(3))},[(0,o.eW)(" H/W "),(0,o.Lk)("span",{class:(0,h.C4)({"icon-arrow-line-small-down":"Asc"===e.filters.orderByArrow[3],"icon-arrow-line-small-up":"Desc"===e.filters.orderByArrow[3]})},null,2)]),(0,o.Lk)("div",{class:"table-head-cell text-center",onClick:t[10]||(t[10]=t=>e.updateSort(4))},[(0,o.eW)(" Allocated "),(0,o.Lk)("span",{class:(0,h.C4)({"icon-arrow-line-small-down":"Asc"===e.filters.orderByArrow[4],"icon-arrow-line-small-up":"Desc"===e.filters.orderByArrow[4]})},null,2)])]),(0,o.Lk)("div",Ho,[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.schedList,(t=>((0,o.uX)(),(0,o.CE)("div",{onClick:a=>e.selectSchedulesDetail(t),class:(0,h.C4)([t.classObject,"table-body"])},[(0,o.Lk)("div",jo,[(0,o.Lk)("div",null,(0,h.v_)(t.Name),1)]),(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",Vo,[(0,o.Lk)("div",$o,(0,h.v_)(t.Description),1)])),[[c,{content:t.Description,delay:{show:3e3,hide:100}},void 0,{right:!0}]]),(0,o.Lk)("div",Ko,[(0,o.Lk)("div",null,(0,h.v_)(t.NoOfWeeks),1)]),(0,o.Lk)("div",Bo,[(0,o.Lk)("div",null,(0,h.v_)(t.HoursPerWeek),1)]),(0,o.Lk)("div",Uo,[(0,o.Lk)("div",null,(0,h.v_)(t.Count),1)])],10,Xo)))),256))])),_:1})])])])],512)),[[l.aG,!e.createNew]])}var Go;(function(e){e["myEmployee"]="MyEmployee",e["allEmployee"]="AllEmployee"})(Go||(Go={}));var zo=(0,o.pM)({name:"SearchSchedule",inject:{manageCompanyConfig:"MANAGE_COMPANY_CONFIG"},data(){return{selectedSched:null,schedList:[],shiftTypeList:[],schedDetail:null,createNew:!1,empListHeight:"",showFilters:!0,myEmployeeToggle:Go.myEmployee,filters:{searchTerm:"",sort:"Name",sortOptions:["Name","Description","NoOfWeeks","HoursPerWeek","Count"],orderBy:"Asc",orderByArrow:["Asc","Asc","Asc","Asc","Asc"],partTimeSche:!1,fullTimeSche:!0,activeSche:!0,inActiveSche:!1,archivedSche:!1,options:[],selected:"Show Active",all:!1},searchTermFocus:!1}},mounted:function(){this.showFilters=!0,this.getSchedulesList(),this.manageCompanyConfig.getAllowPersonal()?this.filters.options=["Show All","Show Active","Show Inactive","Show Archived","Show Personal"]:this.filters.options=["Show All","Show Active","Show Inactive","Show Archived"],this.$watch("filters",this.refreshFilters,{deep:!0})},methods:{choseFilter(e,t){e.target.blur(),this.filters.selected=t;e.target.blur();let a=this.$refs.selectRef;a.blur()},createNewSchedule(){this.$emit("createNewSchedule")},selectSchedulesDetail(e){this.schedList.map((e=>{e.classObject.selected=!1})),e.classObject.selected=!0,this.selectedSched=e,this.$emit("selectSchedFromSearch",this.selectedSched)},deselectScheDetail(){this.schedList.forEach((e=>{e.classObject.selected=!1})),this.selectedSched=null},toggleFilters:function(){this.showFilters=!this.showFilters},refreshFilters:function(){var e=this;this.schedList.sort((function(t,a){var l,s,o=1;return"Desc"===e.filters.orderBy&&(o=-1),"string"===typeof t[e.filters.sort]?(l=t[e.filters.sort].toLowerCase(),s=a[e.filters.sort].toLowerCase()):(l=t[e.filters.sort],s=a[e.filters.sort]),l<s?-1*o:l>s?1*o:0}));var t=this.filters.searchTerm.toLowerCase().trim();this.schedList.forEach((a=>{a.classObject.selected=!!e.selectedSched&&e.selectedSched.Id==a.Id,a.classObject.visible=!0,this.filters.all?a.classObject.visible=!0:(a.classObject.visible=this.getDropDownFilterResult(a),a.classObject.visible&&0!=t.length&&(a.classObject.visible=(-1!==a.Name.toLowerCase().indexOf(t)||-1!==a.Description.toLowerCase().indexOf(t))&&a.classObject.visible)),a.classObject.hidden=!a.classObject.visible}))},getDropDownFilterResult(e){switch(this.filters.selected){case"Show All":return!0;case"Show Active":return!0===e.isActive&&!1===e.Archive&&0===e.ScheduleType;case"Show Inactive":return!1===e.isActive&&!1===e.Archive&&0===e.ScheduleType;case"Show Archived":return!0===e.Archive&&0===e.ScheduleType;case"Show Personal":return 1===e.ScheduleType}},getSchedulesList:function(){Ma.loading(),ye.StandardSchedules(this.myEmployeeToggle===Go.allEmployee).then((e=>{var t=[];let a=[],l=e.Data;this.manageCompanyConfig.getAllowPersonal()||(l=e.Data.filter((e=>0===e.ScheduleType))),l.map((e=>{if(e.Name.includes("Personal")){var l=e.Name.replace(/^\D+/g,"");a.push(Number(l))}e.classObject={selected:!1,visible:!0,hidden:!1},this.selectedSched&&this.selectedSched.Id===e.Id&&(this.selectedSched=e,e.classObject.selected=!0),t.push(e.NoOfWeeks)})),t.unshift("All"),this.schedList=l,this.$store.state.EmployeeModule.employeesWithPeronsalSche=a,this.refreshFilters(),Ma.clear()}))},updateSort:function(e){this.filters.orderBy=this.filters.orderByArrow[e]="Asc"===this.filters.orderByArrow[e]?"Desc":"Asc",this.filters.sort=this.filters.sortOptions[e],this.filters.orderByArrow.forEach(((t,a)=>{a!==e&&"Asc"}))}}});const Jo=(0,ke.A)(zo,[["render",Qo],["__scopeId","data-v-45fa04bf"]]);var Zo=Jo,qo=(0,o.pM)({name:"schedulesManagement",components:{SearchSchedule:Zo,"schedule-detail":go},data(){return{selectedSched:null,shiftTypeList:[],schedDetail:null,createNew:!1,empListHeight:"",showActiveSchedule:!0,employees:[]}},async mounted(){Ma.loading(),await Promise.all([this.getShiftTypeList(),this.getEmployees()]),Ma.clear()},methods:{async getShiftTypeList(){try{let e=await ye.ShiftTypes();this.shiftTypeList=e.map((e=>e.ShiftType))}catch(e){console.error(e)}},async getEmployees(){try{this.employees=await this.$store.dispatch(Rs.getEmployees,Affinity.user.EmployeeNo)}catch(e){console.error(e)}},toggleShowActiveSchedule(){this.showActiveSchedule=!this.showActiveSchedule},selectSchedulesDetail(e){this.$refs.detail&&this.$refs.detail.hasChanges?Ma.checkChange({message:"There are currently Schedule Detail changes <br /> Do you want to discard your changes?",onOk:()=>{this.loadScheduleDetail(e)}}):this.loadScheduleDetail(e)},loadScheduleDetail(e){Ma.loading(),ye.ScheduleDetail(e.Id).then((t=>{this.schedDetail=t.Data,this.checkEmpAllocationActive(),Ma.clear(),this.selectedSched=e}),(e=>{Ma.clear(),"Network Error"===e.message?Ma.alert("Lost Internet connection. Please try again after reconnect."):Ma.alert("Something went wrong")}))},checkEmpAllocationActive(){this.schedDetail.EmpAllocations.forEach((e=>{if(!e.DateTo)return void(e.isActive=!0);let t=Be()(e.DateFrom),a=Be()(e.DateTo);e.isActive=a.diff(Be()(),"day")>=0&&t.diff(Be()(),"day")<=0}))},createNewSchedule:function(){this.createNew=!0;let e=Be()();e.hour(0),e.minute(0),e.second(0),this.schedDetail={Id:-1,Name:"",Description:"",NoOfWeeks:1,StartDate:e,Days:[]},this.$refs.detail&&(this.$refs.detail.hasChanges=!0)},cancelScheduleDetail(){this.createNew&&(this.createNew=!1),this.schedDetail=null},reloadSchedulesDetail:function(){this.selectedSched?this.selectSchedulesDetail(this.selectedSched):this.schedDetail=null,this.createNew=!1},closeScheduleDetail(e){if(!e||!this.$refs.detail.hasChanges)return this.schedDetail=null,this.createNew=!1,this.selectedSched=null,void this.$refs.searchScheduleRef.deselectScheDetail();Ma.checkChange({message:"There are currently Schedule Detail changes <br /> Do you want to discard your changes?",onOk:()=>{this.closeScheduleDetail(!1)}})},scheduleSaved:function(e){this.selectedSched?(this.schedDetail=e,this.selectedSched={Id:e.Id}):this.schedDetail=null,this.$refs.searchScheduleRef.getSchedulesList(),this.createNew=!1},scheduleDeleted:function(){this.selectedSched=null,this.schedDetail=null,this.$refs.searchScheduleRef.getSchedulesList()}}});const ei=(0,ke.A)(qo,[["render",ul],["__scopeId","data-v-360e1c0a"]]);var ti=ei;const ai=e=>((0,o.Qi)("data-v-6eac65fd"),e=e(),(0,o.jt)(),e),li={class:"outter-h-scroll"},si={class:"fix-content-width"},oi={key:0,class:"dbw-box emp-detail pa-4"},ii={class:"section"},ni=ai((()=>(0,o.Lk)("div",{class:"d-flex justify-space-between"},[(0,o.Lk)("h3",null,"Selected Employees")],-1))),ri={class:"emp-selection-list mt-4 caption"},ci={class:"list-text"},di=["onClick"],ui=ai((()=>(0,o.Lk)("span",{class:"icon-calendar white lh-0"},null,-1))),hi=[ui],mi=["onClick"],pi=ai((()=>(0,o.Lk)("span",{class:"icon-minus white lh-0"},null,-1))),yi=[pi],fi=["onClick"],ki=ai((()=>(0,o.Lk)("span",{class:"icon-minus white lh-0"},null,-1))),vi=[ki],gi=["onClick"],Di=ai((()=>(0,o.Lk)("span",{class:"icon-calendar white lh-0"},null,-1))),Si=[Di],bi={class:"schedules-buttons mt-2 d-flex justify-end"},Ci=ai((()=>(0,o.Lk)("span",{class:"icon-cancel mr-2 vert-mid white lh-0"},null,-1))),Ei=ai((()=>(0,o.Lk)("span",{class:"text-capitalize white"},"Clear",-1))),wi=[Ci,Ei],Li=ai((()=>(0,o.Lk)("span",{class:"icon-cancel vert-mid white lh-0"},null,-1))),Ti=ai((()=>(0,o.Lk)("span",{class:"text-capitalize white"},"Clear",-1))),xi=[Li,Ti],Ai={class:"section mt-4",style:{height:"100%"}},Fi=ai((()=>(0,o.Lk)("h3",{class:"bold-text"},"Allocate Schedule",-1))),Ni={class:"mt-4 allocate-sche-form"},Mi={class:"custom-select",tabindex:"1",ref:"selectRef"},Pi={class:"custom-select-selected"},Oi={class:"custom-select-items"},Wi=["tabindex","onClick"],Ri={class:"cell-config"},Ii={key:0,class:"mt-4"},Yi=ai((()=>(0,o.Lk)("div",{class:"bold-text"},"Description",-1))),_i={class:"caption"},Hi={class:"bold-text mt-4"},Xi={class:"ml-4"},ji={class:"d-flex"},Vi={class:"mt-4 date-input-warpper"},$i=ai((()=>(0,o.Lk)("div",{class:"bold-text"},"Date From",-1))),Ki=["value"],Bi=ai((()=>(0,o.Lk)("span",{class:"input-icon icon-calendar xs-icon"},null,-1))),Ui={class:"mt-4 date-input-warpper"},Qi=ai((()=>(0,o.Lk)("div",{class:"bold-text"},"Date To",-1))),Gi=["value"],zi=ai((()=>(0,o.Lk)("span",{class:"input-icon icon-calendar xs-icon"},null,-1))),Ji={class:"mt-4"},Zi=ai((()=>(0,o.Lk)("div",{class:"bold-text"},"Notes",-1))),qi={class:"schedules-buttons mt-4 d-flex justify-end"},en=ai((()=>(0,o.Lk)("span",{class:"icon-cancel vert-mid lh-0 white--text mr-1"},null,-1))),tn=ai((()=>(0,o.Lk)("span",{class:"text-capitalize white--text"},"Cancel",-1))),an=[en,tn],ln=ai((()=>(0,o.Lk)("span",{class:"icon-paperplane vert-mid lh-0 white--text mr-1"},null,-1))),sn=ai((()=>(0,o.Lk)("span",{class:"text-capitalize white--text"},"Allocate",-1))),on=[ln,sn];function nn(e,t,a,s,i,n){const r=(0,o.g2)("search-employee"),c=(0,o.g2)("employee-schedule"),d=(0,o.g2)("date-picker"),u=(0,o.gN)("tooltip");return(0,o.uX)(),(0,o.CE)("div",li,[(0,o.Lk)("div",si,[(0,o.bF)(r,{class:"mr-4 mr-xs-0",ref:"SearchEmployeeRef",onUpdateSelectedEmpList:e.updateEmpList},null,8,["onUpdateSelectedEmpList"]),e.bulkEmpList.length>0?((0,o.uX)(),(0,o.CE)("div",oi,[(0,o.Lk)("div",ii,[ni,(0,o.Lk)("div",ri,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.bulkEmpList,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{class:(0,h.C4)(["d-flex justify-space-between align-center py-1 px-2",{"emp-select-item-odd":a%2}])},[(0,o.Lk)("div",null,[(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",ci,[(0,o.eW)((0,h.v_)(t.EmployeeName)+" ("+(0,h.v_)(t.EmployeeNo)+")",1)])),[[u,{content:"Remove from Employee Selection List"},void 0,{right:!0}]])]),(0,o.Lk)("div",null,[e.isMobileView?(0,o.Q3)("",!0):(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{key:0,class:"blue small icon",style:{"margin-right":"3px"},onClick:a=>e.showScheduleDetail(t)},hi,8,di)),[[u,{content:"View Schedule Allocations"},void 0,{right:!0}]]),e.isMobileView?(0,o.Q3)("",!0):(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{key:1,class:"orange small icon",onClick:a=>e.removeEmployee(t)},yi,8,mi)),[[u,{content:"Remove from Employee Selection List"},void 0,{right:!0}]]),e.isMobileView?((0,o.uX)(),(0,o.CE)("button",{key:2,class:"orange small icon",onClick:a=>e.removeEmployee(t)},vi,8,fi)):(0,o.Q3)("",!0),e.isMobileView?((0,o.uX)(),(0,o.CE)("button",{key:3,class:"blue ml-1 small icon",style:{"margin-right":"3px"},onClick:a=>e.showScheduleDetail(t)},Si,8,gi)):(0,o.Q3)("",!0)])],2)))),256))]),(0,o.Lk)("div",bi,[e.isMobileView?(0,o.Q3)("",!0):(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{key:0,class:"button grey small",onClick:t[0]||(t[0]=t=>e.clearSelectedEmployee())},wi)),[[u,{content:"Clear Employee Selection List"},void 0,{right:!0}]]),e.isMobileView?((0,o.uX)(),(0,o.CE)("button",{key:1,class:"button grey small",onClick:t[1]||(t[1]=t=>e.clearSelectedEmployee())},xi)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",{onSubmit:t[15]||(t[15]=(0,l.D$)(((...t)=>e.submitForm&&e.submitForm(...t)),["prevent"]))},[(0,o.Lk)("div",Ai,[Fi,(0,o.Lk)("div",Ni,[(0,o.Lk)("form",null,[(0,o.Lk)("div",Mi,[(0,o.Lk)("div",Pi,[(0,o.bo)((0,o.Lk)("input",{class:"custom-select-input",ref:"selectInputRef","onUpdate:modelValue":t[2]||(t[2]=t=>e.selectSearchInput=t),onKeyup:t[3]||(t[3]=(...t)=>e.updateSearchList&&e.updateSearchList(...t))},null,544),[[l.Jo,e.selectSearchInput]])]),(0,o.Lk)("div",Oi,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.cloneSchedList,((a,s)=>((0,o.uX)(),(0,o.CE)("div",{class:"custom-select-item",ref_for:!0,ref:"selectDropdownRef",key:s,tabindex:s+99,onKeyup:t[4]||(t[4]=(0,l.jR)(((...t)=>e.navDownList&&e.navDownList(...t)),["down"])),onClick:t=>e.chooseSchedule(t,a)},[(0,o.Lk)("div",Ri,(0,h.v_)(a.Name+" - "+a.Description),1)],40,Wi)))),128))])],512),e.selectedSchedule&&e.selectedSchedule.Name?((0,o.uX)(),(0,o.CE)("div",Ii,[Yi,(0,o.Lk)("div",_i,(0,h.v_)(e.selectedSchedule.Description),1),(0,o.Lk)("div",Hi,[(0,o.eW)(" No. of Weeks: "),(0,o.Lk)("span",Xi,(0,h.v_)(e.selectedSchedule.NoOfWeeks),1)])])):(0,o.Q3)("",!0),(0,o.Lk)("div",ji,[(0,o.Lk)("div",Vi,[$i,(0,o.Lk)("input",{value:e.$filters.reformatDate(e.schedAllocation.DateFrom),class:"d-inline-flex ma-0 pa-0 mr-2 caption date-input-width date-input",onChange:t[5]||(t[5]=t=>e.updateDateText(t,e.schedAllocation.DateFrom,"DateFrom")),onClick:t[6]||(t[6]=t=>e.updateDateTime(t,e.schedAllocation.DateFrom,"DateFrom")),"onClick:clear":t[7]||(t[7]=t=>e.fromDate=!1)},null,40,Ki),Bi]),(0,o.Lk)("div",Ui,[Qi,(0,o.Lk)("input",{value:e.$filters.reformatDate(e.schedAllocation.DateTo),class:"d-inline-flex ma-0 pa-0 caption date-input-width date-input",onChange:t[8]||(t[8]=t=>e.updateDateText(t,e.schedAllocation.DateTo,"DateTo")),onClick:t[9]||(t[9]=t=>e.updateDateTime(t,e.schedAllocation.DateTo,"DateTo")),"onClick:clear":t[10]||(t[10]=t=>e.toDateMenu=!1)},null,40,Gi),zi])]),(0,o.Lk)("div",Ji,[Zi,(0,o.bo)((0,o.Lk)("textarea",{rows:"3",class:"caption",onKeyup:t[11]||(t[11]=t=>e.hasChanges=!0),"onUpdate:modelValue":t[12]||(t[12]=t=>e.schedAllocation.Comment=t)},"\r\n                                    ",544),[[l.Jo,e.schedAllocation.Comment]])]),(0,o.Lk)("div",qi,[(0,o.Lk)("button",{class:"grey vert-mid small",onClick:t[13]||(t[13]=t=>e.closeSchedAllocation())},an),(0,o.Lk)("button",{class:"green ml-4 small",onClick:t[14]||(t[14]=t=>e.allocateEmployees())},on)])])])])],32)])):(0,o.Q3)("",!0),e.selectedEmpForDetail?((0,o.uX)(),(0,o.Wv)(c,{key:1,ref:"EmployeeScheduleRef",employee:e.selectedEmpForDetail,onClose:e.resetSelectedEmpForDetail},null,8,["employee","onClose"])):(0,o.Q3)("",!0),(0,o.bF)(d,{ref:"DatePickerRef",top:e.dateModalTop,left:e.dateModalLeft},null,8,["top","left"])])])}const rn=e=>((0,o.Qi)("data-v-18bc7f4c"),e=e(),(0,o.jt)(),e),cn={class:"dbw-box emp-workSched-card pa-4"},dn={class:"d-flex justify-space-between"},un={class:"d-flex justify-end align-center mt-4 caption"},hn=rn((()=>(0,o.Lk)("label",{class:"default-line-height"},"Active Only",-1))),mn={key:0,class:"section-table aff-table mt-2 mb-4"},pn=rn((()=>(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Schedule Name"),(0,o.Lk)("th",{class:"text-center"},"Date From"),(0,o.Lk)("th",{class:"text-center"},"Date To")])],-1))),yn=["onClick"],fn={class:"text-center"},kn={class:"text-center"},vn={key:1};function gn(e,t,a,s,i,n){const r=(0,o.g2)("emp-schedule-detail");return(0,o.uX)(),(0,o.CE)("div",cn,[(0,o.Lk)("div",dn,[(0,o.Lk)("h3",null,(0,h.v_)(e.selectedEmp.EmployeeName)+" ("+(0,h.v_)(e.selectedEmp.EmployeeNo)+") ",1),(0,o.Lk)("span",{class:"icon-cross vp-icon",onClick:t[0]||(t[0]=t=>e.closeEmployeeSchedule(!0))})]),(0,o.Lk)("div",un,[(0,o.bo)((0,o.Lk)("input",{class:"override-width mr-2",type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=t=>e.activeOnly=t),onChange:t[2]||(t[2]=(...t)=>e.updateActiveOnly&&e.updateActiveOnly(...t)),"true-value":1,"false-value":0},null,544),[[l.lH,e.activeOnly]]),hn]),e.empSchedList.length>0?((0,o.uX)(),(0,o.CE)("div",mn,[(0,o.Lk)("table",null,[pn,(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.empSchedList,(t=>((0,o.uX)(),(0,o.CE)("tr",{class:(0,h.C4)(t.classObject),onClick:a=>e.selectEmpSchedCheck(t)},[(0,o.Lk)("td",null,(0,h.v_)(t.WorkSchedName),1),(0,o.Lk)("td",fn,(0,h.v_)(e.$filters.reformatDate(t.DateFrom)),1),(0,o.Lk)("td",kn,(0,h.v_)(e.$filters.reformatDate(t.DateTo)),1)],10,yn)))),256))])])])):((0,o.uX)(),(0,o.CE)("div",vn,"Work schedule empty.")),e.selectedEmpSched?((0,o.uX)(),(0,o.Wv)(r,{key:2,ref:"empScheDetailRef",empSched:e.selectedEmpSched,onDeleted:e.deleteSelection,onUpdated:e.updatedEmpSchedule},null,8,["empSched","onDeleted","onUpdated"])):(0,o.Q3)("",!0)])}const Dn=e=>((0,o.Qi)("data-v-0c3bbc41"),e=e(),(0,o.jt)(),e),Sn={key:0,class:"section default-form sched-empSched-form mt-4"},bn=Dn((()=>(0,o.Lk)("h3",null,"Schedule Details",-1))),Cn={class:"caption mt-2"},En=Dn((()=>(0,o.Lk)("div",{class:"form-label"},"Name",-1))),wn={class:"label-empSched"},Ln={class:"caption d-flex mt-4"},Tn=Dn((()=>(0,o.Lk)("div",{class:"form-label"},"Number of Weeks",-1))),xn={class:"label-empSched"},An={class:"d-flex"},Fn={class:"caption mt-4 date-input-warpper"},Nn=Dn((()=>(0,o.Lk)("div",{class:"date-label"},"Date From",-1))),Mn=["value"],Pn={class:"caption mt-4 date-input-warpper"},On=Dn((()=>(0,o.Lk)("div",{class:"date-label"},"Date To",-1))),Wn=["value"],Rn={class:"caption mt-4"},In=Dn((()=>(0,o.Lk)("div",{class:"date-label"},"Notes",-1))),Yn={class:"section-table ui-gridbox-scrollable-titles mt-4"},_n={class:"aff-table sched-empSched-table"},Hn=(0,o.Fv)('<div class="head-cell" data-v-0c3bbc41>Week</div><div class="head-cell" data-v-0c3bbc41>Day</div><div class="head-cell" data-v-0c3bbc41>Hours</div><div class="head-cell" data-v-0c3bbc41>Start</div><div class="head-cell" data-v-0c3bbc41>Finish</div><div class="head-cell break-column-width" data-v-0c3bbc41> Unpaid Break </div><div class="head-cell" data-v-0c3bbc41>Shift</div><div class="head-cell" data-v-0c3bbc41>WorkWeek</div>',8),Xn=[Hn],jn={class:"aff-table-body"},Vn={class:"aff-table-body-row"},$n={class:"aff-table-body-cell"},Kn={class:"aff-table-body-cell"},Bn={class:"mr-2 days-width"},Un={class:"aff-table-body-cell"},Qn={class:"aff-table-body-cell"},Gn={class:"aff-table-body-cell"},zn={class:"aff-table-body-cell"},Jn={class:"aff-table-body-cell"},Zn={class:"aff-table-body-cell"},qn={class:"schedules-buttons form-row d-flex justify-end mt-4"},er=Dn((()=>(0,o.Lk)("span",{class:"icon-briefcase mr-1"},null,-1))),tr=Dn((()=>(0,o.Lk)("span",null,"Remove",-1))),ar=[er,tr],lr=["disabled"],sr=Dn((()=>(0,o.Lk)("span",{class:"icon-cancel mr-1"},null,-1))),or=Dn((()=>(0,o.Lk)("span",null,"Cancel",-1))),ir=[sr,or],nr=["disabled"],rr=Dn((()=>(0,o.Lk)("span",{class:"icon-save mr-1"},null,-1))),cr=Dn((()=>(0,o.Lk)("span",null,"Update",-1))),dr=[rr,cr];function ur(e,t,a,s,i,n){const r=(0,o.g2)("date-picker");return e.empSchedDetail&&e.empSchedDetail.Detail?((0,o.uX)(),(0,o.CE)("div",Sn,[bn,(0,o.Lk)("form",{onSubmit:t[11]||(t[11]=(0,l.D$)(((...t)=>e.submitForm&&e.submitForm(...t)),["prevent"]))},[(0,o.Lk)("div",Cn,[En,(0,o.Lk)("div",wn,(0,h.v_)(e.empSchedDetail.Detail.Name),1)]),(0,o.Lk)("div",Ln,[Tn,(0,o.Lk)("div",xn,(0,h.v_)(e.empSchedDetail.Detail.NoOfWeeks),1)]),(0,o.Lk)("div",An,[(0,o.Lk)("div",Fn,[Nn,(0,o.Lk)("input",(0,o.v6)({value:e.$filters.reformatDate(e.empSchedDetail.DateFrom)},e.attrs,(0,o.Tb)(e.on,!0),{outlined:"",dense:"","hide-details":"",autocomplete:"off",class:"d-inline-flex ma-0 pa-0 mr-2 caption date-input-width date-input","append-icon":"icon-calendar",onChange:t[0]||(t[0]=t=>e.updateDateText(t,e.empSchedDetail.DateFrom)),onClick:t[1]||(t[1]=t=>e.updateDateTime(t,e.empSchedDetail.DateFrom,"DateFrom")),"onClick:clear":t[2]||(t[2]=t=>e.fromDate=!1)}),null,16,Mn)]),(0,o.Lk)("div",Pn,[On,(0,o.Lk)("input",(0,o.v6)({value:e.$filters.reformatDate(e.empSchedDetail.DateTo)},e.attrs,(0,o.Tb)(e.on,!0),{autocomplete:"off",outlined:"",dense:"","hide-details":"",class:"d-inline-flex ma-0 pa-0 caption date-input-width date-input","append-icon":"icon-calendar",onChange:t[3]||(t[3]=t=>e.updateDateText(t,e.empSchedDetail.DateTo)),onClick:t[4]||(t[4]=t=>e.updateDateTime(t,e.empSchedDetail.DateTo,"DateTo")),"onClick:clear":t[5]||(t[5]=t=>e.toDateMenu=!1)}),null,16,Wn)])]),(0,o.Lk)("div",Rn,[In,(0,o.bo)((0,o.Lk)("textarea",{class:"caption schedule-textarea",onKeyup:t[6]||(t[6]=t=>e.hasChanges=!0),"hide-details":"",rows:"2",outlined:"",dense:"","onUpdate:modelValue":t[7]||(t[7]=t=>e.empSchedDetail.Comment=t)},"\r\n                ",544),[[l.Jo,e.empSchedDetail.Comment]])]),(0,o.Lk)("div",Yn,[(0,o.Lk)("div",_n,[(0,o.Lk)("div",{class:(0,h.C4)(["sched-detail-days",{"shift-min-width":e.showMore}])},[(0,o.Lk)("div",{class:(0,h.C4)(["aff-table-head",{"show-shift-column":e.showMore}])},Xn,2),(0,o.Lk)("div",jn,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.empSchedDetail.Detail.Days,(t=>((0,o.uX)(),(0,o.CE)("div",Vn,[(0,o.Lk)("div",$n,[(0,o.bo)((0,o.Lk)("span",null,(0,h.v_)(t.Week),513),[[l.aG,e.isFirstDayOfWeek(t.DayOfWeek)]])]),(0,o.Lk)("div",Kn,[(0,o.Lk)("span",Bn,(0,h.v_)(t.DayNumber+1),1),(0,o.Lk)("span",null,(0,h.v_)(e.getDayOfWeek(t.DayOfWeek)),1)]),(0,o.Lk)("div",Un,(0,h.v_)(t.Hours),1),(0,o.Lk)("div",Qn,[(0,o.Lk)("span",null,(0,h.v_)(e.$filters.reformatTime(t.StartTime)),1)]),(0,o.Lk)("div",Gn,[(0,o.Lk)("span",null,(0,h.v_)(e.$filters.reformatTime(t.FinishTime)),1)]),(0,o.Lk)("div",zn,[(0,o.Lk)("span",null,(0,h.v_)(e.$filters.reformatBreakHours(t.BreakHours)),1)]),(0,o.Lk)("div",Jn,[(0,o.Lk)("span",null,(0,h.v_)(t.ShiftId),1)]),(0,o.Lk)("div",Zn,[(0,o.Lk)("span",null,(0,h.v_)(t.WorkWeek),1)])])))),256))])],2)])]),(0,o.Lk)("div",qn,[(0,o.Lk)("button",{type:"button",class:"white--text small red text-capitalize mr-2",onClick:t[8]||(t[8]=t=>e.RemoveSchedule())},ar),(0,o.Lk)("button",{type:"button",class:"white--text small grey text-capitalize mr-2",disabled:!e.hasChanges,onClick:t[9]||(t[9]=t=>e.cancelChanges())},ir,8,lr),(0,o.Lk)("button",{type:"button",class:"white--text small green text-capitalize mr-1",disabled:!e.hasChanges,onClick:t[10]||(t[10]=t=>e.updateEmpSched())},dr,8,nr)])],32),(0,o.bF)(r,{ref:"DatePickerRef",top:e.dateModalTop,left:e.dateModalLeft},null,8,["top","left"])])):(0,o.Q3)("",!0)}var hr=(0,o.pM)({name:"emp-schedule-detail",props:["empSched"],components:{DatePicker:$a},data:function(){return{dateModalTop:null,dateModalLeft:null,datePickerTargetDay:null,dateType:"",empSchedDetail:null,hasChanges:!1,fromDateMenu:!1,toDateMenu:!1,fromDatePickerValue:"",toDatePickerValue:""}},computed:{},mounted:function(){this.$emit("dataChanged",this.hasChanges),this.getEmpSchedDetail()},watch:{["empSched"](e,t){e!=t&&(this.empSchedDetail=null,this.hasChanges=null,this.fromDateMenu=!1,this.toDateMenu=!1,this.getEmpSchedDetail())}},methods:{getEmpSchedDetail(){Ma.loading(),ye.EmpSchedDetailRequest(this.empSched.EmployeeNo+"/"+this.empSched.Id).then((e=>{if(this.empSchedDetail=e.Data,this.empSchedDetail.Detail){for(var t=0,a=Be()(this.empSchedDetail.Detail.StartDate),l=7*this.empSchedDetail.Detail.NoOfWeeks,s=new Array(l),o=0;o<l;o++)o%7==0&&t++,s[o]={DayNumber:o,DayOfWeek:a.day(),Week:t,Date:Be()(a),Hours:0,BreakHours:null,StartTime:null,FinishTime:null,ShiftId:null,WorkWeek:null},a.add(1,"day");this.empSchedDetail.Detail.Days.map((function(e){e.StartTime&&(s[e.DayNumber].StartTime=Be()(e.StartTime)),e.FinishTime&&(s[e.DayNumber].FinishTime=Be()(e.FinishTime)),s[e.DayNumber].Hours=e.Hours,s[e.DayNumber].ShiftId=e.ShiftId,s[e.DayNumber].BreakHours=e.BreakHours,s[e.DayNumber].WorkWeek=e.WorkWeek})),this.empSchedDetail.Detail.Days=s,this.empSchedDetail.Detail.StartDate=Be()(this.empSchedDetail.Detail.StartDate),e.Data.DateFrom&&(this.empSchedDetail.DateFrom=Be()(e.Data.DateFrom,"YYYY-MM-DD")),e.Data.DateTo&&(this.empSchedDetail.DateTo=Be()(e.Data.DateTo,"YYYY-MM-DD")),this.datePickerFormattedFromDate(),this.datePickerFormattedToDate()}})).finally((()=>Ma.clear()))},submitForm(){return!1},updateDateText(e,t){this.toDateMenu=!1,t.set(Be()(e,"DD/MM/YYYY").toObject()),this.datePickerFormattedFromDate(),this.datePickerFormattedToDate()},datePickerFormattedFromDate(){this.fromDatePickerValue=this.empSchedDetail.DateFrom?Be()(this.empSchedDetail.DateFrom).format("YYYY-MM-DD"):void 0},datePickerFormattedToDate(){this.toDatePickerValue=this.empSchedDetail.DateTo?Be()(this.empSchedDetail.DateTo).format("YYYY-MM-DD"):void 0},fromDateDatePickerHandler(e){"string"===typeof e&&(e=Be()(e)),this.empSchedDetail.DateFrom=e,this.hasChanges=!0,this.datePickerFormattedFromDate()},toDateDatePickerHandler(e){"string"===typeof e&&(e=Be()(e)),this.empSchedDetail.DateTo=e,this.hasChanges=!0,this.datePickerFormattedToDate()},isFirstDayOfWeek:function(e){var t=Be()(this.empSchedDetail.Detail.StartDate);return e==t.day()},getDayOfWeek:function(e){if(e<0||e>6)return"unknown";var t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return t[e]},RemoveSchedule(){Ma.checkChange({message:"Are you sure?",onOk:()=>{Ma.loading(),ye.RemoveEmployeeWorkSchedule(this.empSchedDetail.Id,this.empSched.EmployeeNo).then((e=>{this.$emit("deleted")})).finally((()=>Ma.clear()))}})},cancelChanges(){if(!this.hasChanges)return void this.getEmpSchedDetail();let e="There is currently unsaved schedule changes <br /> Do you want to discard your changes?";GS.emit("dialog",{message:e,showButtons:!0,showCancel:!0,okColor:"orange",onOk:()=>{this.getEmpSchedDetail(),this.hasChanges=!1},onCancel:()=>{}})},updateEmpSched(){var e=Be()(this.empSchedDetail.DateFrom),t=Be()(this.empSchedDetail.DateTo);if(e&&t&&e>t)Ma.alert("<br />Date From cannot be before Date To.");else{GS.emit("dialog",{message:"Updating Employee Schedule",showButtons:!1,showLoader:!0,noClose:!1}),Ma.loading();var a={Id:this.empSchedDetail.Id,DateFrom:e?e.format("DD/MMM/YYYY"):null,DateTo:t?t.format("DD/MMM/YYYY"):null,Comment:this.empSchedDetail.Comment};ye.UpdateEmpSchedRequest(a,this.empSched.EmployeeNo).then((e=>{Ma.clear(),this.$emit("updated")})).catch((e=>{Ma.alert(e.message),console.error("err",e)}))}},updateDateTime(e,t,a){let l=e.target.getClientRects()[0];const s=l.left+330>window.innerWidth;this.dateModalTop=l.bottom,this.dateModalLeft=s?window.innerWidth-330:l.left,this.datePickerTargetDay=t,this.dateType=a,this.openDatePicker()},async openDatePicker(){let e=await this.$refs.DatePickerRef.toggleShow(this.datePickerTargetDay);"DateTo"===this.dateType?this.empSchedDetail.DateTo=e:"DateFrom"===this.dateType&&(this.empSchedDetail.DateFrom=e),this.hasChanges=!0}}});const mr=(0,ke.A)(hr,[["render",ur],["__scopeId","data-v-0c3bbc41"]]);var pr=mr,yr=(0,o.pM)({name:"employeeSchedule",components:{EmpScheduleDetail:pr},props:["employee"],data:function(){return{selectedEmp:null,empSchedList:[],activeOnly:!1,selectedEmpSched:null}},setup(e){const t=(0,s.KR)(e.employee);return{selectedEmp:t}},mounted(){this.selectedEmp=this.employee,this.selectedEmp&&this.selectedEmp.EmployeeNo?this.getEmpWorkScheds():console.error("employee or employee number missing")},watch:{employee(){this.selectedEmp=this.employee,this.selectedEmp&&this.selectedEmp.EmployeeNo?this.getEmpWorkScheds():console.error("employee or employee number missing")}},methods:{selectEmpSchedCheck(e){this.$refs.empScheDetailRef&&this.$refs.empScheDetailRef.hasChanges?Ma.checkChange({message:"There are currently Schedule changes <br /> Do you want to discard your changes?",onOk:()=>{this.selectEmpSched(e)}}):this.selectEmpSched(e)},selectEmpSched(e){this.empSchedList.forEach((e=>{e.classObject.selected=!1})),e.classObject.selected=!0,this.selectedEmpSched=e},getEmpWorkScheds(){Ma.loading(),ye.EmpWorkScheds(this.selectedEmp.EmployeeNo+(this.activeOnly?"?activeOnly=true":"?activeOnly=false")).then((e=>{e.Data.map(((e,t)=>{e.classObject={selected:!1,odd:t%2},e.DateFrom=new Date(Date.parse(e.DateFrom)),e.DateTo&&(e.DateTo=new Date(Date.parse(e.DateTo)))})),this.empSchedList=e.Data,Ma.clear()}))},updateActiveOnly(){this.getEmpWorkScheds()},closeEmployeeSchedule(e){e&&this.$refs.empScheDetailRef&&(!this.$refs.empScheDetailRef||this.$refs.empScheDetailRef.hasChanges)?Ma.checkChange({message:"There are currently Schedule changes <br /> Do you want to discard your changes?",onOk:()=>{this.closeEmployeeSchedule(!1)}}):this.$emit("close")},deleteSelection(){this.selectedEmpSched=null,this.getEmpWorkScheds()},updatedEmpSchedule(){this.selectedEmpSched=null,this.getEmpWorkScheds()}}});const fr=(0,ke.A)(yr,[["render",gn],["__scopeId","data-v-18bc7f4c"]]);var kr=fr;const vr=e=>((0,o.Qi)("data-v-2267f2d8"),e=e(),(0,o.jt)(),e),gr={class:"section shadow dbw-box sched-card-default pa-4"},Dr=vr((()=>(0,o.Lk)("h3",{class:"mb-2"},"Select Employees",-1))),Sr={class:"aff-table mt-4"},br={class:"ui-grid"},Cr=["onClick"],Er={class:"name-text-width"},wr={class:"current-schedules-width"},Lr={class:"schedule-name"},Tr={class:"schedule-name"},xr=["onClick"],Ar=vr((()=>(0,o.Lk)("span",{class:"icon-add-to-list"},null,-1))),Fr=[Ar],Nr=["onClick"],Mr=vr((()=>(0,o.Lk)("span",{class:"icon-add-to-list"},null,-1))),Pr=[Mr],Or=["onClick"],Wr=vr((()=>(0,o.Lk)("span",{class:"icon-minus white--text small"},null,-1))),Rr=[Wr];function Ir(e,t,a,s,i,n){const r=(0,o.gN)("tooltip");return(0,o.uX)(),(0,o.CE)("div",gr,[Dr,(0,o.bo)((0,o.Lk)("input",{class:"mt-2 caption text-field-input","onUpdate:modelValue":t[0]||(t[0]=t=>e.searchTerm=t),"hide-details":"",dense:"",outlined:"",type:"text",placeholder:"Search for employees "},null,512),[[l.Jo,e.searchTerm]]),(0,o.Lk)("div",Sr,[(0,o.Lk)("table",br,[(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.empList,(t=>((0,o.uX)(),(0,o.CE)("tr",{class:(0,h.C4)(t.classObject),onClick:a=>e.toggleEmployeeSelect(t)},[(0,o.Lk)("td",null,[(0,o.Lk)("span",Er,(0,h.v_)(t.EmployeeName)+" ("+(0,h.v_)(t.EmployeeNo)+")",1),(0,o.Lk)("span",wr,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.WorkschedNames,(e=>((0,o.uX)(),(0,o.CE)("div",Lr,(0,h.v_)(e),1)))),256)),(0,o.Lk)("div",Tr,(0,h.v_)(t.PersonalSchedule),1)])]),(0,o.Lk)("td",null,[e.isMobileView||t.classObject.selected?(0,o.Q3)("",!0):(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{key:0,class:"green white--text fsmall",onClick:(0,l.D$)((a=>e.addEmployee(t)),["stop"])},Fr,8,xr)),[[r,{content:"Add to Employee Selection List"},void 0,{right:!0}]]),e.isMobileView&&!t.classObject.selected?((0,o.uX)(),(0,o.CE)("button",{key:1,class:"green white--text fsmall",onClick:(0,l.D$)((a=>e.addEmployee(t)),["stop"])},Pr,8,Nr)):(0,o.Q3)("",!0),t.classObject.selected?(0,o.bo)(((0,o.uX)(),(0,o.CE)("button",{key:2,class:"grey fsmall",onClick:(0,l.D$)((a=>e.removeEmployee(t)),["stop"])},Rr,8,Or)),[[r,{content:"Remove Employee From Selection List"},void 0,{right:!0}]]):(0,o.Q3)("",!0)])],10,Cr)))),256))])])])])}var Yr=(0,o.pM)({name:"SearchEmployee",data:function(){return{searchTerm:"",empList:[],selectedEmpList:[],selectedEmp:null,isMobileView:!1}},mounted(){navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?(console.log("is mobile view true"),this.isMobileView=!0):this.isMobileView=!1,this.getEmployeesList()},watch:{searchTerm:function(e,t){if(t!=e)if(0==e.trim().length)this.empList.forEach((function(e){e.classObject.visible=!0,e.classObject.hidden=!1}));else{var a=e.toLowerCase().trim();this.empList.forEach((e=>{e.classObject.visible=e.EmployeeName&&e.EmployeeName.toLowerCase().indexOf(a)>-1||e.EmployeeNo&&e.EmployeeNo.toString().indexOf(a)>-1,e.classObject.hidden=!e.classObject.visible}))}}},methods:{getEmployeesList(){Ma.loading(),ye.EmployeesList().then((e=>{e.Data.map(((e,t)=>{e.classObject={visible:!0,hidden:!1,selected:!1,odd:t%2}})),this.empList=e.Data})).finally((()=>{Ma.clear()}))},toggleEmployeeSelect:function(e){e.classObject.selected?this.removeEmployee(e):this.addEmployee(e)},removeEmployee:function(e){e.classObject.selected=!1,this.selectedEmpList.splice(this.selectedEmpList.indexOf(e),1),this.$emit("updateSelectedEmpList",this.selectedEmpList)},addEmployee:function(e){e.classObject.selected=!0,this.selectedEmpList.push(e),this.$emit("updateSelectedEmpList",this.selectedEmpList)},clearSelectedEmployeeList:function(){this.selectedEmpList.forEach((e=>{e.classObject.selected=!1})),this.selectedEmpList=[],this.$emit("updateSelectedEmpList",this.selectedEmpList)}}});const _r=(0,ke.A)(Yr,[["render",Ir],["__scopeId","data-v-2267f2d8"]]);var Hr=_r,Xr=(0,o.pM)({name:"employeeAllocation",components:{SearchEmployee:Hr,EmployeeSchedule:kr,DatePicker:$a},data:function(){return{bulkEmpList:[],schedList:[],hasChanges:!1,cloneSchedList:[],selectSearchInput:"",schedAllocation:{WorkschedId:-1,DateFrom:Be()(),DateTo:null,Comment:"",EndExistingScheds:!0},selectedSchedule:{},selectedEmpForDetail:null,startDateMenu:!1,toDateMenu:!1,startDatePickerValue:"",toDatePickerValue:"",datePickerTargetDay:null,dateType:"",isMobileView:!1,dateModalTop:null,dateModalLeft:null}},mounted:function(){this.isMobileView=this.checkIsMobileView(),ye.StandardSchedules().then((e=>{this.schedList=e.Data.filter((e=>!1===e.Archive&&0===e.ScheduleType)),this.cloneSchedList=this.schedList.slice()})),this.$watch("schedAllocation",((e,t)=>{e===t&&(this.hasChanges=!0)}),{deep:!0})},computed:{selectedSched(){if(-1===this.schedAllocation.WorkschedId)return!1;let e=this.schedList;return e.find((e=>e.Id===this.schedAllocation.WorkschedId))},capDate:function(){if(!this.schedAllocation.DateFrom)return;let e=this.schedAllocation,t=Be()(e.DateFrom),a=t.subtract(1,"day");return a.format("DD/MM/YYYY")}},methods:{navDownList(){},updateSearchList(e){"ArrowDown"===e.key&&this.$refs.selectDropdownRef.focus(),this.cloneSchedList=this.schedList.filter((e=>e.Name.toLowerCase().indexOf(this.selectSearchInput.toLowerCase())>-1))},updateDateText(e,t,a){this.startDateMenu=!1,this.toDateMenu=!1,t?t.set(Be()(e?.target?.value,"DD/MM/YYYY").toObject()):"DateTo"===a?this.schedAllocation.DateTo=Be()(e?.target?.value,"DD/MM/YYYY"):"DateFrom"===a&&(this.schedAllocation.DateFrom=Be()(e?.target?.value,"DD/MM/YYYY")),this.datePickerFormattedFromDate(),this.datePickerFormattedToDate()},datePickerFormattedFromDate(){this.startDatePickerValue=this.schedAllocation.DateFrom?Be()(this.schedAllocation.DateFrom).format("YYYY-MM-DD"):void 0},datePickerFormattedToDate(){this.toDatePickerValue=this.schedAllocation.DateTo?Be()(this.schedAllocation.DateTo).format("YYYY-MM-DD"):void 0},updateEmpList(e){this.bulkEmpList=e},startDateDatePickerHandler(e){"string"===typeof e&&(e=Be()(e)),this.schedAllocation.DateFrom=e,this.datePickerFormattedFromDate()},toDateDatePickerHandler(e){"string"===typeof e&&(e=Be()(e)),this.schedAllocation.DateTo=e,this.datePickerFormattedToDate()},removeEmployee:function(e){this.$refs.SearchEmployeeRef.removeEmployee(e)},clearSelectedEmployee:function(){this.hasChanges?Ma.checkChange({message:"There are currently Schedule Allocation changes <br /> Do you want to discard your changes?",onOk:()=>{this.$refs.SearchEmployeeRef.clearSelectedEmployeeList(),this.resetSchedAllocation()}}):this.$refs.SearchEmployeeRef.clearSelectedEmployeeList()},allocateEmployees:function(){var e="";if((this.selectedSchedule.Id<1||!this.selectedSchedule.Id)&&(e+="<br />Select a schedule that you want to allocate."),this.schedAllocation.DateFrom&&this.schedAllocation.DateTo&&this.schedAllocation.DateFrom.diff(this.schedAllocation.DateTo)>0&&(e+="<br />Date To cannot be before Date From."),""==e){var t={WorkschedId:this.selectedSchedule.Id,EmployeeList:[],DateFrom:Be()(this.schedAllocation.DateFrom)?Be()(this.schedAllocation.DateFrom).format("DD/MMM/YYYY"):null,DateTo:Be()(this.schedAllocation.DateTo)?Be()(this.schedAllocation.DateTo).format("DD/MMM/YYYY"):null,Comment:this.schedAllocation.Comment,EndExistingScheds:this.schedAllocation.EndExistingScheds};this.bulkEmpList.length>0&&this.bulkEmpList.forEach((e=>{t.EmployeeList.push(e.EmployeeNo)})),Ma.loading(),ye.AllocateSchedule(t).then((e=>{this.hasChanges=!1,this.resetSchedAllocation(),Ma.clear(),this.$refs.EmployeeScheduleRef&&this.$refs.EmployeeScheduleRef.getEmpWorkScheds()})).catch((e=>{Ma.alert(e.message),console.error("err",e)}))}else Ma.alert(e)},closeSchedAllocation:function(){this.hasChanges?Ma.checkChange({message:"You have unsaved changes. Are you sure to discard the changes?",onOk:()=>{this.resetSchedAllocation(),this.hasChanges=!1,this.$refs.SearchEmployeeRef.clearSelectedEmployeeList()}}):this.$refs.SearchEmployeeRef.clearSelectedEmployeeList()},showScheduleDetail:function(e){this.selectedEmpForDetail=e},resetSelectedEmpForDetail(){this.selectedEmpForDetail=null},resetSchedAllocation:function(){this.hasChanges=!1,this.schedAllocation={WorkschedId:-1,DateFrom:Be()(),DateTo:null,Comment:"",EndExistingScheds:!0}},checkIsMobileView:function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},chooseSchedule(e,t){e.target.blur(),this.selectedSchedule=t,this.selectSearchInput=this.selectedSchedule.Name+" - "+this.selectedSchedule.Description;e.target.blur();let a=this.$refs.selectRef;a.blur();let l=this.$refs.selectInputRef;l.blur()},updateDateTime(e,t,a){let l=e.target.getClientRects()[0];this.dateModalTop=l.bottom,this.dateModalLeft=l.left,this.datePickerTargetDay=t,this.dateType=a,this.openDatePicker()},async openDatePicker(){let e=await this.$refs.DatePickerRef.toggleShow(this.datePickerTargetDay);"DateTo"===this.dateType?this.schedAllocation.DateTo=e:"DateFrom"===this.dateType&&(this.schedAllocation.DateFrom=e)},submitForm(){}}});const jr=(0,ke.A)(Xr,[["render",nn],["__scopeId","data-v-6eac65fd"]]);var Vr=jr;function $r(e,t,a,l,s,i){const n=(0,o.g2)("TopFilters"),r=(0,o.g2)("FlexScheduleCalendar"),c=(0,o.g2)("edit-flex-schedule"),d=(0,o.g2)("date-picker"),u=(0,o.g2)("draft-creation-dialog"),h=(0,o.g2)("extra-emp-detail"),m=(0,o.g2)("analysis-chart"),p=(0,o.g2)("publish-dialog"),y=(0,o.g2)("cost-analysis-dialog"),f=(0,o.g2)("swap-schedule");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(n,{isEmployee:!1,onOpenDraftDialog:e.openDraftDialog,onOpenAnalysisChart:e.openAnalysisChart,onSelectEmployeeAndPublish:e.openPublishDialog,onOpenCostAnalysis:e.openCostAnalysis,onPrintFlexSchedule:e.printFlexSchedule,onChangeWeek:e.changeWeek},null,8,["onOpenDraftDialog","onOpenAnalysisChart","onSelectEmployeeAndPublish","onOpenCostAnalysis","onPrintFlexSchedule","onChangeWeek"]),(0,o.bF)(r,{ref:"FlexScheduleCalendarRef",isEmployee:!1,dayFocus:e.dayFocus,weekStart:e.weekStart,weekEnd:e.weekEnd,onOpenEditDialog:e.openEditDialog,onOpenEmployeeDetail:e.openEmployeeDetail},null,8,["dayFocus","weekStart","weekEnd","onOpenEditDialog","onOpenEmployeeDetail"]),(0,o.Lk)("div",null,[(0,o.bF)(c,{ref:"EditModalRef",isEdit:e.isEditingDialog,weekStatus:e.weekStatus,modalIndex:1999,onSwapSche:e.openSwapSche,onReload:e.reloadAfterEdit},null,8,["isEdit","weekStatus","onSwapSche","onReload"]),(0,o.bF)(d,{ref:"DatePickerRef",top:e.datePickerTop,left:e.datePickerLeft},null,8,["top","left"]),(0,o.bF)(u,{ref:"DraftCreationDialogRef",modalIndex:1999,onReload:e.reloadAfterEdit},null,8,["onReload"]),(0,o.bF)(h,{ref:"ExtraEmpDetailRef",externalDetail:e.externalDetail},null,8,["externalDetail"]),(0,o.bF)(m,{ref:"AnalysisChartRef",modalIndex:1999},null,512),(0,o.bF)(p,{ref:"PublishDialogRef",onPublish:e.publishCurrentWeek},null,8,["onPublish"]),(0,o.bF)(y,{ref:"CostAnalysisDialogRef",dayFocus:e.dayFocus},null,8,["dayFocus"]),(0,o.bF)(f,{ref:"SwapScheduleRef",modalIndex:1999,onReload:e.reloadAfterEdit},null,8,["onReload"])])],64)}const Kr=(0,o.Lk)("div",{class:"heading"},null,-1),Br={class:"content"},Ur={class:"clock-frame"},Qr={ref:"clockRef",width:"200",height:"200",style:{"background-color":"white"}},Gr=(0,o.Lk)("div",{class:"controls"},null,-1);function zr(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("div",null,[Kr,(0,o.Lk)("div",Br,[(0,o.Lk)("div",Ur,[(0,o.Lk)("canvas",Qr,null,512)]),Gr])])}var Jr=(0,o.pM)({name:"TimePicker",setup(){const e=(0,s.KR)([]),t=(0,s.KR)([]),a=(0,s.KR)(null);for(let l=0;l<12;l++)e.value.push(l);for(let l=0;l<=55;l+=5)t.value.push(l);return(0,o.sV)((()=>{let e=a.value,t=e.getContext("2d"),l=e.height/2;function s(){t.arc(0,0,l,0,2*Math.PI),t.fillStyle="lightGrey",t.fill(),o(t,l),i(t,l),n(t,l)}function o(e,t){e.beginPath(),e.arc(0,0,5,0,2*Math.PI),e.fillStyle="#333",e.fill()}function i(e,t){let a;e.font="18px arial",e.textBaseline="middle",e.textAlign="center";for(let l=1;l<13;l++)a=l*Math.PI/6,e.rotate(a),e.translate(0,.85*-t),e.rotate(-a),e.fillText(l.toString(),0,0),e.rotate(a),e.translate(0,.85*t),e.rotate(-a)}function n(e,t){new Date;var a=5,l=15;a%=12,a=a*Math.PI/6,r(e,a,.5*t,5),l=l*Math.PI/30,r(e,l,.7*t,3)}function r(e,t,a,l){e.beginPath(),e.lineWidth=l,e.lineCap="round",e.moveTo(0,0),e.rotate(t),e.lineTo(0,-a),e.stroke(),e.rotate(-t)}t.translate(l,l),l*=.9,s()})),{clockHours:e,clockMinutes:t,clockRef:a}}});const Zr=(0,ke.A)(Jr,[["render",zr]]);var qr=Zr;const ec=e=>((0,o.Qi)("data-v-2f3f7884"),e=e(),(0,o.jt)(),e),tc=ec((()=>(0,o.Lk)("div",{class:"shift-coverage-header"},[(0,o.Lk)("h3",null,"Shift Coverage")],-1))),ac={class:"shift-coverage-wrapper"},lc=ec((()=>(0,o.Lk)("label",{class:"mr-2"},"Select Date:",-1))),sc=["value"],oc={key:0,class:"d-flex justify-center mt-4"},ic={key:0,class:"choose-date-info"},nc={class:"analysisChart"},rc={class:"axis-canvas",id:"myChartHeader",height:"39",ref:"myChartHeaderRef"},cc={class:"main-canvas-wrapper"},dc={class:"main-canvas",ref:"myChartRef",id:"myChart",colours:"[ { fillColor: '#ffff00' }, { fillColor: '#0066ff' } ]"};function uc(e,t,a,s,i,n){const r=(0,o.g2)("Modal"),c=(0,o.g2)("date-picker");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(r,{ref:"ModalRef",onCancel:e.cancelModal,modalIndex:e.modalIndex},{header:(0,o.k6)((()=>[tc])),body:(0,o.k6)((()=>[(0,o.Lk)("div",ac,[(0,o.Lk)("div",null,[lc,(0,o.Lk)("input",{value:e.$filters.reformatDate(e.selectedDate),class:"d-inline-flex ma-0 pa-0 mr-2 ml-2 caption analysis-date-input",style:{"max-width":"120px"},onChange:t[0]||(t[0]=t=>e.updateDateText(t,e.selectedDate)),onClick:t[1]||(t[1]=t=>e.updateDateTime(t,e.selectedDate)),"onClick:clear":t[2]||(t[2]=t=>e.toDate=null)},null,40,sc)]),0===e.chartDatasets.length?((0,o.uX)(),(0,o.CE)("div",oc,[null!==e.selectedDate&&0===e.chartDatasets.length?((0,o.uX)(),(0,o.CE)("h3",ic,"There's no one scheduled on this day. Please choose another day.")):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("div",nc,[(0,o.Lk)("canvas",rc,null,512),(0,o.Lk)("div",cc,[(0,o.Lk)("div",{class:"myChart-wrapper",style:(0,h.Tr)({height:e.canvasHeight+"px"})},[(0,o.Lk)("canvas",dc,null,512)],4)])],512),[[l.aG,e.chartDatasets.length>0]])])])),_:1},8,["onCancel","modalIndex"]),(0,o.bF)(c,{ref:"DatePickerRef",top:e.dateModalTop,leftInput:e.dateModalLeft,date:e.datePickerTargetDay},null,8,["top","leftInput","date"])],64)}a(6929);var hc=a(1601);let mc=null;var pc=(0,o.pM)({name:"AnalysisChart",components:{Modal:Re,DatePicker:$a},props:{modalIndex:{type:Number}},data(){return{selectedDate:null,dateModal:!1,dateModalTop:0,dateModalLeft:0,datePickerTargetDay:Be()(),chartLabels:[],chartDatasets:[],min:0,max:100,canvasHeight:1,myChartHeader:null}},setup(){const e=(0,s.KR)(),t=(0,s.KR)();return{myChartRef:e,myChartHeaderRef:t}},methods:{toggleShow(){this.$refs.ModalRef.toggleShow()},updateDateText(e,t){this.selectedDate=Be()(e.target.value,"DD/MM/YYYY"),this.dateModal=!1},updateDateTime(e,t){let a=e.target.getClientRects()[0];this.dateModalTop=a.bottom,this.dateModalLeft=a.left,this.datePickerTargetDay=this.selectedDate,this.dateModal=!0,this.openDatePicker().then((e=>{this.prepareChartData()})).catch((e=>{console.log("err",e)}))},async openDatePicker(){let e=await this.$refs.DatePickerRef.toggleShow(this.datePickerTargetDay);return this.selectedDate=e,e},getData(e){return this.getDateData(e.clone().add(-1,"day"),e)},async getDateData(e,t){let a={};return e&&t&&(a={employeeNo:Affinity.user.EmployeeNo,startDate:e.format("YYYY-MM-DD"),endDate:t.format("YYYY-MM-DD"),forManagedEmployees:!0}),ye.GetFlexSchedules(a).then((e=>e.FlexSchedules.filter((e=>!!this.$store.state.EmployeeModule.filteredEmployees.find((t=>t.employeeNo===e.EmployeeNo))))))},staticWorkersPerHour(e){let t=e.map((e=>[Be()(e[0]),Be()(e[1])])),a=Array(24).fill(0);for(let l of t){let e=l[0],t=l[1],s=e.hour(),o=t.diff(e,"hour");for(let l=0;l<s+o;l++)l>=s&&(a[l]=a[l]+1)}return a},prepareChartData(){let e=Be()(this.selectedDate);Ma.loading(),this.getData(e).then((t=>{Ma.clear();let a=t,l=new Map,s=new Map,o=a.filter((e=>Be()(e.StartTime).day()===this.selectedDate?.day()));for(const f of o)if(f&&f.StartTime&&f.EndTime){let t=f.EmployeeName,a=Be()(f.StartTime),s=Be()(f.EndTime),o=e.clone();o.hour(a.hour()),o.minutes(a.minutes());let i,n=e.clone();n.hour(s.hours()),n.minutes(s.minutes()),i=n<o?[o.toISOString(),n.clone().add(1,"day").toISOString()]:[o.toISOString(),n.toISOString()],l.set(t,i)}a.filter((e=>Be()(e.Date).day()===this.selectedDate?.clone().add(-1,"day").day())).map((e=>{if(Be()(e.EndTime).hour()<Be()(e.StartTime).hour()){let t=[Be()(e.EndTime).clone().startOf("day").toISOString(),Be()(e.EndTime).toISOString()];return s.set(e.EmployeeName,t),t}return null}));console.log("chart data",l),console.log("nightshift",s);const i=Array.from(l).sort(),n=new Map;i.forEach((e=>n.set(e[0],e[1])));const r=Array.from(n.keys()).map((e=>s.has(e)?s.get(e):null)),c=[];s.forEach(((e,t)=>{console.log("value",e),n.has(t)||(c.push(t),r.push(e))}));let d=[...n.keys(),...c],u=[...n.values()];0===u.length&&d.length>0&&(u=[[null,null]]);let h=r;this.chartDatasets=u;let m=this.staticWorkersPerHour(u),p=Be()(e).startOf("day").valueOf(),y=Be()(e).endOf("day").valueOf();if(this.canvasHeight=30*d.length+100,mc)if(d.length<=0){let e=this.myChartHeaderRef.getContext("2d");e.clearRect(0,0,this.myChartHeaderRef.width,this.myChartHeaderRef.height),console.info("destroy chart"),mc.destroy(),mc=null}else console.info("update chart"),mc.options.scales.x.min=p,mc.options.scales.x.max=y,mc.options.scales.x1.ticks={callback:(e,t,a)=>m[t]},mc.data.labels=d,mc.data.datasets[0].data=u,mc.data.datasets[1].data=h,d.length<=0&&(mc.data.labels=[],mc.data.datasets=[],mc.options.scales.x.min=0,mc.options.scales.x.max=1),console.log("my chart",mc),mc.update();else if(d.length<=0);else{console.info("create new chart");let e=document.getElementById("myChart").getContext("2d"),t=this,a={type:"bar",data:{labels:d,datasets:[{label:"Work Hours",data:u,backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)"],borderWidth:2,borderSkipped:!1},{label:"nightShift",data:h,backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)"],borderWidth:2,borderSkipped:!1}]},grouped:!1,options:{responsive:!0,maintainAspectRatio:!1,devicePixelRatio:window.devicePixelRatio,indexAxis:"y",scales:{y:{stacked:!0},x:{id:"xAxis2",backgroundColor:"#ffffff",position:"top",type:"time",time:{unit:"hour",displayFormats:{hour:"HH:mm"}},title:{display:!0,text:"Time"},min:p,max:y,ticks:{stepSize:5e5}},x1:{id:"xAxis1",type:"time",position:"bottom",gridLines:{drawOnChartArea:!1},time:{unit:"hour",displayFormats:{hour:"HH:mm:ss"}},min:p,max:y,title:{display:!0,text:"Working Employees / Hour"},ticks:{callback:(e,t,a)=>m[t]}}},plugins:{title:{display:!1},legend:{display:!1},tooltip:{usePointStyle:!0,callbacks:{label:function(e){let t=e.raw;return` ${Be()(t[0]).format("HH:mm")} - ${Be()(t[1]).format("HH:mm")}`},labelPointStyle:function(e){return{pointStyle:"triangle",rotation:0}}}}},animation:{onComplete:function(e){let a=this.ctx.canvas,l=window.devicePixelRatio,s=this.canvas.width,o=this.scales.x.height*l,i=t.myChartHeaderRef.getContext("2d"),n=document.getElementById("myChartHeader");n.style.width=this.canvas.width/l+"px",n.style.height=o/l+"px",n.width=Math.floor(this.canvas.width),n.height=Math.floor(o),i.scale(l,l),i.drawImage(a,0,0,s,o,0,0,s/l,o/l)}}}};mc=new hc.A(e,a)}})).catch((()=>{Ma.clear(),Ma.alert("Something Wrong. Please try again later")}))},cancelModal(){mc&&(mc.destroy(),mc=null,this.selectedDate=null,this.canvasHeight=1,this.chartDatasets=[])}},beforeUnmount(){mc&&(mc.destroy(),mc=null,this.selectedDate=null,this.canvasHeight=1,this.chartDatasets=[])}});const yc=(0,ke.A)(pc,[["render",uc],["__scopeId","data-v-2f3f7884"]]);var fc=yc;const kc=e=>((0,o.Qi)("data-v-5eaadb08"),e=e(),(0,o.jt)(),e),vc=kc((()=>(0,o.Lk)("div",{class:"d-flex justify-center"},[(0,o.Lk)("h2",null,[(0,o.Lk)("b",null,"Period Analysis")])],-1))),gc={class:"d-flex justify-center mt-2"},Dc={key:0,class:"mt-4"},Sc=kc((()=>(0,o.Lk)("h3",null,"No Period Analysis Data",-1))),bc=[Sc],Cc={key:1,class:"mt-4 full-width costAnalaysisBody"},Ec={class:"display-option"},wc={class:"cost-grid mt-4"},Lc=kc((()=>(0,o.Lk)("div",{class:"table-cell"},null,-1))),Tc={class:"table-cell"},xc={key:0,class:"table-cell"},Ac={key:0},Fc={key:1},Nc=kc((()=>(0,o.Lk)("div",{class:"table-cell bold"}," Total ",-1))),Mc={key:0},Pc={key:1},Oc={class:"mt-4"};function Wc(e,t,a,l,s,i){const n=(0,o.g2)("multi-select"),r=(0,o.g2)("Modal");return(0,o.uX)(),(0,o.Wv)(r,{ref:"ModalRef",onCancel:e.cancelModal,modalIndex:e.modalIndex},{header:(0,o.k6)((()=>[vc,(0,o.Lk)("div",gc,[(0,o.Lk)("h3",null,(0,h.v_)(e.weekStart)+" - "+(0,h.v_)(e.weekEnd),1)])])),body:(0,o.k6)((()=>[e.data[0]?((0,o.uX)(),(0,o.CE)("div",Cc,[(0,o.Lk)("div",Ec,[(0,o.bF)(n,{class:"mt-4",selectOptionInput:e.displayOptions,targetString:"description","fixed-left":!1},null,8,["selectOptionInput"])]),(0,o.Lk)("div",wc,[(0,o.Lk)("div",{class:"day-arr cost-grid-heading",style:(0,h.Tr)(e.getGridTemplateStyle())},[Lc,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.displayList,(e=>((0,o.uX)(),(0,o.CE)("div",Tc,(0,h.v_)(e.heading),1)))),256))],4),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.data,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{class:"day-arr",style:(0,h.Tr)(e.getGridTemplateStyle())},[t.day?((0,o.uX)(),(0,o.CE)("div",xc,(0,h.v_)(t.day),1)):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Object.entries(e.displayList),(([l,s])=>((0,o.uX)(),(0,o.CE)("div",{class:(0,h.C4)(["table-cell",e.getDataStyle(e.calculatedData[a],l,s)])},[s.isCalculated?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",Ac,"$")),(0,o.Lk)("span",null,(0,h.v_)(t[l]),1),s.isCalculated?((0,o.uX)(),(0,o.CE)("span",Fc,"%")):(0,o.Q3)("",!0)],2)))),256))],4)))),256)),(0,o.Lk)("div",{class:"day-arr",style:(0,h.Tr)(e.getGridTemplateStyle())},[Nc,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Object.entries(e.displayList),(([t,a])=>((0,o.uX)(),(0,o.CE)("div",{class:(0,h.C4)(["table-cell bold",e.getDataStyle(e.totalInNumber,t,a)])},[a.isCalculated?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",Mc,"$")),(0,o.Lk)("span",null,(0,h.v_)(e.total[t]),1),a.isCalculated?((0,o.uX)(),(0,o.CE)("span",Pc,"%")):(0,o.Q3)("",!0)],2)))),256))],4)])])):((0,o.uX)(),(0,o.CE)("div",Dc,bc))])),footer:(0,o.k6)((()=>[(0,o.Lk)("div",Oc,[(0,o.Lk)("button",{class:"orange small white--text",onClick:t[0]||(t[0]=(...t)=>e.toggleShow&&e.toggleShow(...t))},"Close")])])),_:1},8,["onCancel","modalIndex"])}const Rc={class:"custom-select",tabindex:"1",ref:"selectRef"},Ic={class:"custom-select-selected"},Yc=["onClick"],_c={class:"cell-config"},Hc=["onUpdate:modelValue"],Xc={class:"ml-2"};function jc(e,t,a,s,i,n){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("span",null,[(0,o.Lk)("div",Rc,[(0,o.Lk)("div",Ic,[(0,o.Lk)("span",null,(0,h.v_)(e.getSelectedOptions()),1)]),(0,o.Lk)("div",{class:"custom-select-items",style:(0,h.Tr)(e.getLeft())},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.options,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{class:"custom-select-item",key:a,onClick:a=>e.selectOptionAction(t)},[(0,o.Lk)("div",_c,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":e=>t.isSelected=e},null,8,Hc),[[l.lH,t.isSelected]]),(0,o.Lk)("label",Xc,(0,h.v_)(t[e.targetString]),1)])],8,Yc)))),128))],4)],512)])])}var Vc=(0,o.pM)({name:"CustomSelect",props:{selectOptionInput:{type:Array},targetString:{type:String},allowAll:{type:Boolean},fixedLeft:{type:Boolean}},data(){return{options:[],left:0,selected:[]}},mounted(){this.$refs.selectRef.getClientRects()[0]&&(this.left=this.$refs.selectRef.getClientRects()[0].left),this.options=this.selectOptionInput;let e=!1;if(this.options.find((e=>e.isSelected))&&(e=!0),this.allowAll){const t={commonName:"All",isAll:!0,isSelected:!e};this.options.unshift(t)}this.options.find(((e,t)=>{if(t>0&&!e.isSelected)return!0}))?this.options[0].isSelected=!1:this.options[0].isSelected=!0},methods:{getSelectedOptions(){let e=this.options.filter((e=>e.isSelected)),t="";return e.map(((e,a)=>{t=a>0?t+", "+e[this.targetString]:e[this.targetString]})),t},getLeft(){return this.fixedLeft?{left:this.left+"px"}:{position:"absolute"}},selectOptionAction(e){e.isSelected=!e.isSelected,e.isAll&&1==e.isSelected?this.options.forEach(((e,t)=>{t>0&&(e.isSelected=!0)})):e.isAll&&!1===e.isSelected?this.options.forEach(((e,t)=>{t>0&&(e.isSelected=!1)})):!e.isAll&&this.options[0].isAll&&(this.options.find(((e,t)=>{if(t>0&&!e.isSelected)return!0}))?this.options[0].isSelected=!1:this.options[0].isSelected=!0)}}});const $c=(0,ke.A)(Vc,[["render",jc],["__scopeId","data-v-22d2033d"]]);var Kc=$c,Bc=a(4291),Uc=a.n(Bc),Qc=(0,o.pM)({name:"CostAnalysisDialog",components:{Modal:Re,MultiSelect:Kc},props:{dayFocus:{type:Object},modalIndex:{type:Number}},data(){return{selectedDate:null,data:[],calculatedData:[],total:{},totalInNumber:{},displayN:6,displayList:{},sourceDisplayList:{scheduled:{heading:"Schedule",isDisplay:!0,isCalculated:!1},actual:{heading:"Actual",isDisplay:!1,isCalculated:!1},budgeted:{heading:"Budget",isDisplay:!1,isCalculated:!1},sales:{heading:"Sales",isDisplay:!1,isCalculated:!1},scheduledVSBudgeted:{heading:"Schedule vs Budget",isDisplay:!1,isCalculated:!0},actualsVSBudgeted:{heading:"Actual vs Budget",isDisplay:!1,isCalculated:!0},actualsVSScheduled:{heading:"Actual vs Schedule",isDisplay:!1,isCalculated:!0},scheduledVSSales:{heading:"Schedule vs Sales",isDisplay:!1,isCalculated:!0},actualsVSSales:{heading:"Actual vs Sales",isDisplay:!1,isCalculated:!0}},weekStart:"",weekEnd:"",displayOptions:[{key:"scheduled",description:"Schedule",isSelected:!0},{key:"actual",description:"Actual",isSelected:!1},{key:"budgeted",description:"Budget",isSelected:!0},{key:"sales",description:"Sales",isSelected:!0},{key:"scheduledVSBudgeted",description:"Schedule vs Budget",isSelected:!1},{key:"actualsVSBudgeted",description:"Actual vs Budget",isSelected:!1},{key:"actualsVSScheduled",description:"Actual vs Schedule",isSelected:!1},{key:"scheduledVSSales",description:"Schedule vs Sales",isSelected:!1},{key:"actualsVSSales",description:"Actual vs Sales",isSelected:!1}],manageCompanyConfig:null}},setup(){},computed:{comparedValue(){let e=[];for(let[t,a]of Object.entries(this.displayList))a.isDisplay&&e.push(a);return e}},mounted(){const e=JSON.parse(localStorage.getItem("costAnalysisSetting_v1.3"));this.manageCompanyConfig=(0,o.WQ)("MANAGE_COMPANY_CONFIG"),e&&(this.displayOptions=e)},watch:{displayOptions:{handler(e,t){this.displayList={};for(const[a,l]of Object.entries(this.sourceDisplayList)){const t=e.find((e=>e.key===a));t&&t.isSelected?(this.displayList[a]=l,this.displayList[a].isDisplay=t.isSelected):console.error("key not found",a)}localStorage.setItem("costAnalysisSetting_v1.3",JSON.stringify(e))},deep:!0}},methods:{getDataStyle(e,t,a){if(a.isCalculated)return"scheduledVSBudgeted"===t||"actualsVSBudgeted"===t?e[t]>0?"positive-cell":"negative-cell":void 0},getGridTemplateStyle(){return this.calculateDisplayRow(),this.displayN>1?`grid-template-columns: 100px repeat( ${this.displayN} , 100px)`:`grid-template-columns: 100px repeat( ${this.displayN} , auto)`},open(){if(!this.dayFocus)throw new Error("dayFocus is not set");let e,t;Object.keys(this.displayList).forEach((e=>{this.displayList[e].isDisplay=!1})),this.manageCompanyConfig.getAllowSundayFirst()?(e=this.dayFocus.clone().startOf("week").format("DD/MMM/YYYY"),this.weekStart=e,t=this.dayFocus.clone().endOf("week").format("DD/MMM/YYYY"),this.weekEnd=t):(e=this.dayFocus.clone().startOf("isoWeek").format("DD/MMM/YYYY"),t=this.dayFocus.clone().endOf("isoWeek").format("DD/MMM/YYYY"));let a=this.$store.getters[Os.getFilteredEmployees].map((e=>e.employeeNo)),l={employeeNumbers:a,dateFrom:e,dateTo:t};Ma.loading();for(const[s,o]of Object.entries(this.sourceDisplayList)){const e=this.displayOptions.find((e=>e.key===s));e&&!0===e.isSelected?(this.displayList[s]=o,this.displayList[s].isDisplay=e.isSelected):console.error("key not found",s)}ye.GetCostAnalysis(l).then((e=>{if(!e[0])return this.data=[],this.total=[],this.$refs.ModalRef.toggleShow(),void Ma.clear();let t=e.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));this.calculatedData=[],this.data=t.map((e=>{let t={...e},a={};t.weekDay=Be()(e.date).format("dddd"),this.sourceDisplayList.scheduledVSBudgeted&&(t.scheduledVSBudgeted=this.calculateRatioPercentage(e.scheduled,e.budgeted)),this.sourceDisplayList.actualsVSBudgeted&&(t.actualsVSBudgeted=this.calculateRatioPercentage(e.actual,e.budgeted)),this.sourceDisplayList.actualsVSScheduled&&(t.actualsVSScheduled=this.calculateDiffPercentage(e.actual,e.scheduled)),this.sourceDisplayList.actualsVSSales&&(t.actualsVSSales=this.calculateRatioPercentage(e.actual,e.sales)),this.sourceDisplayList.scheduledVSSales&&(t.scheduledVSSales=this.calculateRatioPercentage(e.scheduled,e.sales));for(let[l,s]of Object.entries(t))Number.isNaN(s)&&(t[l]=0),a[l]="day"===l||"dayNumber"===l?s:Uc()(t[l]).format({symbol:""});return this.calculatedData.push(t),a})),this.calculateTotal(),Ma.clear(),this.$refs.ModalRef.toggleShow()})).catch((e=>{this.data=[],this.total=[]}))},calculateTotal(){const e=[];this.totalInNumber={};for(const[t,a]of Object.entries(this.sourceDisplayList))e.push(t);if(1!==e.length){for(let t of e){this.totalInNumber[t]=0;for(let e of this.calculatedData)e[t]||(e[t]=0),this.totalInNumber[t]=this.totalInNumber[t]+e[t]}this.sourceDisplayList.scheduledVSBudgeted&&(this.totalInNumber.scheduledVSBudgeted=this.calculateRatioPercentage(this.totalInNumber.scheduled,this.totalInNumber.budgeted)),this.sourceDisplayList.actualsVSBudgeted&&(this.totalInNumber.actualsVSBudgeted=this.calculateRatioPercentage(this.totalInNumber.actual,this.totalInNumber.budgeted)),this.sourceDisplayList.actualsVSScheduled&&(this.totalInNumber.actualsVSScheduled=this.calculateDiffPercentage(this.totalInNumber.actual,this.totalInNumber.scheduled)),this.sourceDisplayList.actualsVSSales&&(this.totalInNumber.actualsVSSales=this.calculateRatioPercentage(this.totalInNumber.actual,this.totalInNumber.sales)),this.sourceDisplayList.scheduledVSSales&&(this.totalInNumber.scheduledVSSales=this.calculateRatioPercentage(this.totalInNumber.scheduled,this.totalInNumber.sales));for(let[e,t]of Object.entries(this.totalInNumber))Number.isNaN(t)&&(this.totalInNumber[e]=0),this.total[e]=Uc()(this.totalInNumber[e]).format({symbol:""})}else this.totalInNumber[e[0]]=Math.round(100*this.calculatedData[0][e[0]])/100},calculateDiffPercentage(e,t){return t?(e-t)/t*100:0},calculateRatioPercentage(e,t){return t?e/t*100:0},calculateDisplayRow(){this.displayN=this.displayOptions.filter((e=>e.isSelected)).length},toggleShow(){this.data=[],this.total=[],this.calculatedData=[],this.$refs.ModalRef.toggleShow()},cancelModal(){this.data=[],this.total=[],this.calculatedData=[]}}});const Gc=(0,ke.A)(Qc,[["render",Wc],["__scopeId","data-v-5eaadb08"]]);var zc=Gc;const Jc=e=>((0,o.Qi)("data-v-053e469c"),e=e(),(0,o.jt)(),e),Zc={class:"day-cell-wrapper"},qc={key:0,class:"day-info"},ed=Jc((()=>(0,o.Lk)("span",{class:"white"},"Create",-1))),td=[ed],ad={key:1,class:"full-width"},ld={class:"full-width"},sd={key:0},od={key:1},id={key:2},nd={key:3},rd={key:4,class:"notes-ellips full-width"},cd=Jc((()=>(0,o.Lk)("span",{class:"white caption"},"Edit",-1))),dd=[cd],ud={key:2,class:"leave-unit mt-2"},hd={key:0},md={key:1},pd={key:3,class:"leave-unit mt-2"},yd=Jc((()=>(0,o.Lk)("span",null,"Leave",-1))),fd=[yd],kd={key:4,class:"leave-unit mt-2"},vd=Jc((()=>(0,o.Lk)("div",null,"Unavailable",-1))),gd={key:1,class:"day-info full-width"},Dd={key:0,class:"full-width"},Sd={class:"full-width"},bd={key:0},Cd={key:1},Ed={key:2,class:"notes-ellips full-width"},wd={key:1,class:"leave-unit mt-2"},Ld=Jc((()=>(0,o.Lk)("span",null,"Leave",-1))),Td=[Ld];function xd(e,t,a,s,i,n){const r=(0,o.gN)("tooltip");return(0,o.uX)(),(0,o.CE)("div",Zc,[e.isEmployee?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",qc,[(0,o.Lk)("div",{class:(0,h.C4)(["display-day",{"team-color-bg":"Team"===e.scheDay.scheduleType,"flexi-color-bg":"Flex"===e.scheDay.scheduleType,"personal-color-bg":"Personal"===e.scheDay.scheduleType}]),onClick:t[2]||(t[2]=(0,l.D$)(((...t)=>e.clickDayCell&&e.clickDayCell(...t)),["prevent"]))},[!e.scheDay.startTime&&!e.scheDay.endTime&&!e.scheDay.hours&&e.scheDay.allowCreateOrEdit&&e.checkMobileShowCreate()&&e.allowCreate?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,h.C4)(["create-day",{"create-day-show":!e.isMobileG()}])},[(0,o.Lk)("button",{class:"blue small",onClick:t[0]||(t[0]=t=>e.createSche(e.scheDay))},td)],2)):e.scheDay.startTime||e.scheDay.endTime||e.scheDay.hours?((0,o.uX)(),(0,o.CE)("div",ad,[(0,o.Lk)("div",ld,[e.scheDay.startTime||e.scheDay.endTime?((0,o.uX)(),(0,o.CE)("div",sd,[(0,o.Lk)("div",null,(0,h.v_)(e.scheDay.startTime)+" - "+(0,h.v_)(e.scheDay.endTime),1)])):(0,o.Q3)("",!0),e.shouldDisplayHours(e.scheDay)?((0,o.uX)(),(0,o.CE)("div",od,[(0,o.Lk)("div",null,"Net Hours: "+(0,h.v_)(Math.round(100*e.scheDay.hours)/100),1)])):(0,o.Q3)("",!0),e.cellSettings.showBreakLength.value&&e.scheDay.breakLength&&!e.isEmployee?((0,o.uX)(),(0,o.CE)("div",id,[(0,o.Lk)("div",null,"Break Length: "+(0,h.v_)(Math.round(100*e.scheDay.breakLength)/100),1)])):(0,o.Q3)("",!0),e.cellSettings.showShiftId.value&&e.scheDay.shiftId&&!e.isEmployee?((0,o.uX)(),(0,o.CE)("div",nd,[(0,o.Lk)("div",null,"Shift ID: "+(0,h.v_)(e.scheDay.shiftId),1)])):(0,o.Q3)("",!0),e.cellSettings.showNotes.value&&e.scheDay.notes?((0,o.uX)(),(0,o.CE)("div",rd,[(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",null,[(0,o.eW)("Notes: "+(0,h.v_)(e.scheDay.notes),1)])),[[r,{content:e.scheDay.notes,placement:"top",triggers:["click"],autoHide:!0},void 0,{right:!0}]])])):(0,o.Q3)("",!0)]),e.scheDay.allowCreateOrEdit&&!e.scheDay.isPaid&&e.checkMobileShowEdit()&&e.allowEdit?((0,o.uX)(),(0,o.CE)("button",{key:0,class:(0,h.C4)(["detail-button blue small mt-2",{"detail-button-auto-hide":!e.isMobileG()}]),onClick:t[1]||(t[1]=t=>e.moreDetail(e.scheDay))},dd,2)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0),e.scheDay.leaveUnit&&!e.isEmployee?((0,o.uX)(),(0,o.CE)("div",ud,["D"===e.scheDay.leaveUnit.calcUnit?((0,o.uX)(),(0,o.CE)("span",hd,"Leave: "+(0,h.v_)(e.scheDay.leaveUnit.daysAppliedFor)+" day",1)):((0,o.uX)(),(0,o.CE)("span",md,"Leave: "+(0,h.v_)(e.scheDay.leaveUnit.hoursAppliedFor)+" hours",1))])):e.scheDay.leaveUnit?((0,o.uX)(),(0,o.CE)("div",pd,fd)):(0,o.Q3)("",!0),e.scheDay.unAvailability&&!e.isEmployee?((0,o.uX)(),(0,o.CE)("div",kd,[vd,(0,o.Lk)("span",null,(0,h.v_)(e.scheDay.unAvailability.startTime)+" - "+(0,h.v_)(e.scheDay.unAvailability.endTime),1),(0,o.Lk)("div",null,(0,h.v_)(e.scheDay.unAvailability.reason),1)])):(0,o.Q3)("",!0)],2)])),e.isEmployee?((0,o.uX)(),(0,o.CE)("div",gd,["published"===e.scheDay.publishStatus?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,h.C4)(["display-day",{"team-color-bg":"Team"===e.scheDay.scheduleType,"flexi-color-bg":"Flex"===e.scheDay.scheduleType,"personal-color-bg":"Personal"===e.scheDay.scheduleType}]),onClick:t[3]||(t[3]=(0,l.D$)(((...t)=>e.clickDayCell&&e.clickDayCell(...t)),["prevent"]))},[e.scheDay.startTime||e.scheDay.endTime||e.scheDay.hours?((0,o.uX)(),(0,o.CE)("div",Dd,[(0,o.Lk)("div",Sd,[e.scheDay.startTime||e.scheDay.endTime?((0,o.uX)(),(0,o.CE)("div",bd,[(0,o.Lk)("div",null,(0,h.v_)(e.scheDay.startTime)+" - "+(0,h.v_)(e.scheDay.endTime),1)])):(0,o.Q3)("",!0),e.shouldDisplayHours(e.scheDay)?((0,o.uX)(),(0,o.CE)("div",Cd,[(0,o.Lk)("div",null,"Net Hours: "+(0,h.v_)(Math.round(100*e.scheDay.hours)/100),1)])):(0,o.Q3)("",!0),e.scheDay.notes?((0,o.uX)(),(0,o.CE)("div",Ed,[(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",null,[(0,o.eW)("Notes: "+(0,h.v_)(e.scheDay.notes),1)])),[[r,{content:e.scheDay.notes,placement:"top",triggers:["click"],autoHide:!0},void 0,{right:!0}]])])):(0,o.Q3)("",!0)])])):(0,o.Q3)("",!0)],2)):(0,o.Q3)("",!0),e.scheDay.leaveUnit?((0,o.uX)(),(0,o.CE)("div",wd,Td)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])}var Ad,Fd,Nd;(function(e){e["getWorkType"]="GET_WORKTYPE"})(Ad||(Ad={})),function(e){e["setShifts"]="SET_SHIFTS",e["setPosition"]="SET_POSITION",e["setCostElements"]="SET_COST_ELEMENTS",e["setWorkTypes"]="SET_WORK_TYPES",e["setCostCenters"]="SET_COST_CENTER"}(Fd||(Fd={})),function(e){e["getPositions"]="GET_POSITIONS",e["getShifts"]="GET_SHIFTS",e["getCostElement"]="GET_COST_ELEMENT",e["getWorkTypes"]="GET_WORK_TYPES",e["getCostCenters"]="GET_COST_CENTER"}(Nd||(Nd={}));Ad.getWorkType;const Md={[Fd.setShifts](e,t){e.shifts=t},[Fd.setPosition](e,t){e.positions=t},[Fd.setCostElements](e,t){e.costElements=t},[Fd.setWorkTypes](e,t){e.workTypes=t},[Fd.setCostCenters](e,t){e.costCenters=t}},Pd={[Nd.getPositions]({commit:e},t){ye.GetPosition(t).then((t=>{let a=t.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));e(Fd.setPosition,a)}))},[Nd.getShifts]({commit:e}){ye.ShiftTypes().then((t=>{let a=t.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));e(Fd.setShifts,a)}))},[Nd.getCostElement]({commit:e}){ye.GetCostelements().then((t=>{let a=t.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));e(Fd.setCostElements,a)}))},async[Nd.getWorkTypes]({commit:e}){return ye.GetWorkTypes().then((t=>{let a=t.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));a.map((e=>{e.isSelected=!1})),e(Fd.setWorkTypes,a)}))},[Nd.getCostCenters]({commit:e},t){return ye.GetEmployeesCostCentres(t).then((t=>{let a=t.data.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));return e(Fd.setCostCenters,a),a}))}},Od={state:{shifts:[],positions:[],costElements:[],workTypes:[],costCenters:[]},mutations:Md,actions:Pd};var Wd=Od,Rd=(0,o.pM)({name:"DayCell",props:{scheDay:{type:Object},employeeNo:{type:Number},employeeName:{type:String},allowEdit:{type:Boolean},allowCreate:{type:Boolean},isEmployee:{type:Boolean}},data(){return{mobileShowCreate:!1,mobileShowEdit:!1}},setup(){const e=(0,je.Pj)(),t=e.state.FlexSchedule.flexScheduleCellSetting,a=(0,o.EW)((()=>e.state.LookUp.shifts)),l=(0,o.EW)((()=>e.state.LookUp.positions));return{cellSettings:t,shiftOptions:a,positionOptions:l}},methods:{moreDetail(e){this.$store.dispatch(Nd.getPositions,this.employeeNo);const t=this.$store.state.FlexSchedule.flexScheduleRemoteData.find((t=>t.date===e.date&&t.employeeNo===this.employeeNo));t?(this.$store.commit(Je.setScheduleDay,t),this.$emit("openEditDialog",!0)):console.error("can not find selected schedule")},createSche(e){this.$store.dispatch(Nd.getPositions,this.employeeNo);let t=$e().clone(e);t.employeeNo=this.employeeNo,t.employeeName=this.employeeName,this.$store.commit(Je.createNewScheduleDay,t),this.$emit("openEditDialog",!1)},shouldDisplayHours(e){return!!this.cellSettings.showHours.value&&(!(!e.startTime&&!e.endTime||0!==e.hours)||!!e.hours)},isMobileG(){return rt()},clickDayCell(){this.mobileShowCreate=!this.mobileShowCreate,this.mobileShowEdit=!this.mobileShowEdit},checkMobileShowEdit(){return!rt()||this.mobileShowEdit},checkMobileShowCreate(){return!rt()||this.mobileShowCreate}}});const Id=(0,ke.A)(Rd,[["render",xd],["__scopeId","data-v-053e469c"]]);var Yd=Id;const _d=e=>((0,o.Qi)("data-v-c76a9f9c"),e=e(),(0,o.jt)(),e),Hd=_d((()=>(0,o.Lk)("div",null,[(0,o.Lk)("h2",null,[(0,o.Lk)("b",null,"Create Draft Schedule")])],-1))),Xd=_d((()=>(0,o.Lk)("div",{class:"line-break my-4"},null,-1))),jd={class:"d-flex align-center"},Vd={class:"mt-2 draft-option pa-2"},$d={key:0,class:"grey-wrapper"},Kd={class:"input-label"},Bd={class:"mt-2"},Ud={class:"input-label"},Qd={key:0,class:"mt-1"},Gd=_d((()=>(0,o.Lk)("span",{class:"red"},"Number of days cannot be greater than 14",-1))),zd=[Gd],Jd={class:"mt-2"},Zd={class:"input-label"},qd=_d((()=>(0,o.Lk)("div",{class:"line-break my-4"},null,-1))),eu={class:"d-flex"},tu={class:"container-half"},au=_d((()=>(0,o.Lk)("div",null," Paste Options ",-1))),lu={class:"px-2 mt-4"},su={class:"d-flex align-center"},ou={class:"d-flex align-center mt-2"},iu={class:"container-half"},nu=_d((()=>(0,o.Lk)("label",null,"Exclude Worker Type",-1))),ru=_d((()=>(0,o.Lk)("div",{class:"line-break my-4"},null,-1))),cu={class:"d-flex"},du={class:"d-flex justify-end full-width mt-4"};function uu(e,t,a,s,i,n){const r=(0,o.g2)("multi-select"),c=(0,o.g2)("date-picker"),d=(0,o.g2)("Modal"),u=(0,o.gN)("tooltip");return(0,o.uX)(),(0,o.Wv)(d,{ref:"ModalRef"},{header:(0,o.k6)((()=>[Hd])),body:(0,o.k6)((()=>[(0,o.Lk)("div",null,[(0,o.Lk)("form",null,[Xd,(0,o.Lk)("div",null,[(0,o.Lk)("div",jd,[(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",null,[(0,o.eW)("Copy from Flexi Schedules")])),[[u,{content:"Copies information from a previous flexi schedule and pastes it into a current or future flexi schedule.",classes:"tool-tip-width"},void 0,{top:!0}]])]),(0,o.Lk)("div",Vd,["copy"!==e.sourceMode?((0,o.uX)(),(0,o.CE)("div",$d)):(0,o.Q3)("",!0),(0,o.Lk)("div",null,[(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",Kd,[(0,o.eW)("From Date")])),[[u,{content:"The date to copy from."},void 0,{top:!0}]]),(0,o.bo)((0,o.Lk)("input",{class:"input-box",type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.copyFromDateText=t),onClick:t[1]||(t[1]=t=>e.updateDateTime(t,"copyFromDate"))},null,512),[[l.Jo,e.copyFromDateText]])]),(0,o.Lk)("div",Bd,[(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",Ud,[(0,o.eW)("Number of Days")])),[[u,{content:"The number of days to copy."},void 0,{top:!0}]]),(0,o.bo)((0,o.Lk)("input",{class:"input-box",type:"number",max:"14","onUpdate:modelValue":t[2]||(t[2]=t=>e.copyToDateDuration=t),onChange:t[3]||(t[3]=(...t)=>e.validNoDays&&e.validNoDays(...t))},null,544),[[l.Jo,e.copyToDateDuration,void 0,{number:!0}]]),e.showNoDaysError?((0,o.uX)(),(0,o.CE)("div",Qd,zd)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",Jd,[(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",Zd,[(0,o.eW)("Start On")])),[[u,{content:"The date in the flexi schedule when copied information will start. For example, if you copy a 5-day block from 1 April and start it on 11 July, it will run from 11- 15 July."},void 0,{top:!0}]]),(0,o.bo)((0,o.Lk)("input",{class:"input-box",type:"text","onUpdate:modelValue":t[4]||(t[4]=t=>e.targetDateText=t),onClick:t[5]||(t[5]=t=>e.updateDateTime(t,"targetDate"))},null,512),[[l.Jo,e.targetDateText]])])])])]),qd,(0,o.Lk)("div",eu,[(0,o.Lk)("div",tu,[au,(0,o.Lk)("div",lu,[(0,o.Lk)("div",su,[(0,o.bo)((0,o.Lk)("input",{type:"radio",name:"copyOption",value:"replace",class:"mt-0 ml-0","onUpdate:modelValue":t[6]||(t[6]=t=>e.copyOption=t)},null,512),[[l.XL,e.copyOption]]),(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",null,[(0,o.eW)("Replace All")])),[[u,{content:"When copied information is pasted in, it will replace all information on the days specified.",classes:"tool-tip-width"},void 0,{top:!0}]])]),(0,o.Lk)("div",ou,[(0,o.bo)((0,o.Lk)("input",{type:"radio",name:"copyOption",value:"merge",class:"mt-0 ml-0","onUpdate:modelValue":t[7]||(t[7]=t=>e.copyOption=t)},null,512),[[l.XL,e.copyOption]]),(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",null,[(0,o.eW)("Merge")])),[[u,{content:"When copied information is pasted in, it will replace information on the days specified only if there is a conflict."},void 0,{top:!0}]])])])]),(0,o.Lk)("div",iu,[nu,(0,o.bF)(r,{class:"mt-4",selectOptionInput:e.workTypeOptions,targetString:"description","fixed-left":!0},null,8,["selectOptionInput"])])]),ru,(0,o.Lk)("div",cu,[(0,o.Lk)("div",null,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=t=>e.overrideTeam=t)},null,512),[[l.lH,e.overrideTeam]]),(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",null,[(0,o.eW)("Override Team and Personal Schedules")])),[[u,{content:"Selecting this option will copy Flexi Schedules for all non-published employees as well as those employees who are already on a Team or a Personal Schedule."},void 0,{top:!0}]])])]),(0,o.bF)(c,{ref:"DatePickerRef",top:e.datePickerTop,left:e.datePickerLeft,"min-date":e.datePickerMin,"max-date":e.datePickerMax},null,8,["top","left","min-date","max-date"])])])),footer:(0,o.k6)((()=>[(0,o.Lk)("div",du,[(0,o.Lk)("button",{class:"blue xsmall white--text mr-2",onClick:t[9]||(t[9]=(...t)=>e.actionByMode&&e.actionByMode(...t))},"Create"),(0,o.Lk)("button",{class:"orange xsmall white--text",onClick:t[10]||(t[10]=(...t)=>e.cancel&&e.cancel(...t))},"Cancel")])])),_:1},512)}var hu;(function(e){e["copy"]="replace",e["merge"]="merge"})(hu||(hu={}));var mu=(0,o.pM)({name:"DraftCreationDialog",components:{Modal:Re,DatePicker:$a,MultiSelect:Kc},data(){return{datePickerTop:0,datePickerLeft:0,sourceMode:"copy",copyOption:"replace",overrideTeam:!1,scheduleStartDateText:"",copyFromDateText:"",targetDateText:"",scheduleStartDate:Be()(),copyFromDate:Be()(),copyToDateDuration:0,targetDate:Be()(),datePickerMax:null,datePickerMin:null,dateTarget:"",copyPersonalDuration:0,workTypeOptions:[],selected:{},options:[],left:0,showNoDaysError:!1}},mounted(){},methods:{selectOption(){},resetData(){this.datePickerTop=0,this.datePickerLeft=0,this.sourceMode="copy",this.copyOption="replace",this.scheduleStartDateText="",this.copyFromDateText="",this.targetDateText="",this.scheduleStartDate=Be()(),this.copyFromDate=Be()(),this.copyToDateDuration=0,this.targetDate=Be()(),this.dateTarget="",this.copyPersonalDuration=0,this.datePickerMax=null,this.datePickerMin=null,this.showNoDaysError=!1,this.workTypeOptions=this.$store.state.LookUp.workTypes},toggleShow(){this.resetData(),this.$refs.ModalRef.toggleShow()},actionByMode(){"copy"===this.sourceMode?this.createDraft():this.importFromPersonal()},importFromPersonal(){Ma.loading();let e=[];for(const a of this.$store.state.FlexSchedule.scheduleWeek.values())this.$store.state.EmployeeModule.filteredEmployees.find((e=>e.employeeNo===a.employeeNo))&&e.push(a.employeeNo);let t={CopyFromPersonalSchedule:!0,EmployeeNumbers:e,PersonalSchedCopyDurationInDays:this.copyPersonalDuration,TargetDate:this.scheduleStartDate.format("DD/MMM/YYYY"),CopyOption:this.copyOption,ExcludedworkTypes:this.getExcludedWorkTypes()};ye.CopyFlexSchedule(t).then((e=>{this.$refs.ModalRef.toggleShow(),this.$emit("reload")})).finally((()=>{}))},validForm(){return this.validNoDays()},validNoDays(){return this.copyToDateDuration>14?(this.showNoDaysError=!0,!1):(this.showNoDaysError=!1,!0)},createDraft(){if(!this.validForm())return;Ma.loading();let e=[];if(this.overrideTeam)for(const a of this.$store.state.FlexSchedule.scheduleWeek.values())(a.includeTeamOrPersonal||"published"!==a.empSchePublishState)&&e.push(a.employeeNo);else for(const a of this.$store.state.FlexSchedule.scheduleWeek.values())"published"!==a.empSchePublishState&&e.push(a.employeeNo);e=e.filter((e=>!!this.$store.state.EmployeeModule.filteredEmployees.find((t=>t.employeeNo===e))));let t={CopyFromPersonalSchedule:!1,EmployeeNumbers:e,CopyFromDate:this.copyFromDate.format("DD/MMM/YYYY"),CopyToDate:this.copyFromDate.add(this.copyToDateDuration-1,"days").format("DD/MMM/YYYY"),TargetDate:this.targetDate.format("DD/MMM/YYYY"),CopyOption:this.copyOption,ExcludedworkTypes:this.getExcludedWorkTypes(),OverrideTeam:this.overrideTeam};ye.CopyFlexSchedule(t).then((e=>{Ma.clear(),this.$refs.ModalRef.toggleShow(),Ma.alert("Your schedules are being copied. This process can take a few minutes. You will need to refresh your screen to see the updated schedules.")})).finally((()=>{}))},getExcludedWorkTypes(){let e=this.workTypeOptions.filter((e=>e.isSelected));return e.length<1&&(e=this.$store.state.FlexSchedule.defaultWorkTypes),e.map((e=>e.code))},async updateDateTime(e,t){let a=e.target.getClientRects()[0];this.datePickerTop=a.bottom,this.datePickerLeft=a.left;try{switch(t){case"ScheduleStartDate":return this.scheduleStartDate=await this.$refs.DatePickerRef.toggleShow(this.scheduleStartDate),void(this.scheduleStartDateText=this.scheduleStartDate.format("DD/MM/YYYY"));case"copyFromDate":return this.datePickerMax=null,this.datePickerMin=null,this.copyFromDate=await this.$refs.DatePickerRef.toggleShow(this.copyFromDate),void(this.copyFromDateText=this.copyFromDate.format("DD/MM/YYYY"));case"targetDate":return this.datePickerMax=null,this.datePickerMin=Be()().add(-2,"day"),this.targetDate=await this.$refs.DatePickerRef.toggleShow(this.targetDate),void(this.targetDateText=this.targetDate.format("DD/MM/YYYY"))}}catch(l){return}},cancel(){this.toggleShow()}}});const pu=(0,ke.A)(mu,[["render",uu],["__scopeId","data-v-c76a9f9c"]]);var yu=pu;const fu=e=>((0,o.Qi)("data-v-eb55bf94"),e=e(),(0,o.jt)(),e),ku={class:"bold"},vu={key:0},gu={key:1},Du={key:0},Su={key:1},bu={key:0,class:"mt-2"},Cu={key:1,class:"error-area red"},Eu={key:2,class:"error-area red"},wu={class:"edit-form mt-4 copy2"},Lu=fu((()=>(0,o.Lk)("label",null,"Date",-1))),Tu=fu((()=>(0,o.Lk)("label",null,"Employee Name",-1))),xu=fu((()=>(0,o.Lk)("label",null,"Employee No",-1))),Au=fu((()=>(0,o.Lk)("label",null,"Position",-1))),Fu={key:0},Nu=fu((()=>(0,o.Lk)("div",{class:"mt-4"},null,-1))),Mu=fu((()=>(0,o.Lk)("div",null,null,-1))),Pu=fu((()=>(0,o.Lk)("label",null,"Start Time",-1))),Ou=fu((()=>(0,o.Lk)("label",null,"Finish Time",-1))),Wu={key:0,class:"two-column orange"},Ru=fu((()=>(0,o.Lk)("div",{class:"mt-4"},null,-1))),Iu=fu((()=>(0,o.Lk)("div",null,null,-1))),Yu=fu((()=>(0,o.Lk)("label",null,"Unpaid Break",-1))),_u={class:"d-flex"},Hu={class:"break-parts"},Xu=fu((()=>(0,o.Lk)("span",{class:"font-small"},"Hours",-1))),ju=fu((()=>(0,o.Lk)("div",{class:"break-parts mobile-column ml-2 mr-2"},[(0,o.Lk)("span",null,":")],-1))),Vu={class:"break-parts"},$u=fu((()=>(0,o.Lk)("span",{class:"font-small"},"Minutes",-1))),Ku=fu((()=>(0,o.Lk)("label",null,"Net Hours",-1))),Bu=fu((()=>(0,o.Lk)("label",null,"Shift ID",-1))),Uu=fu((()=>(0,o.Lk)("div",{class:"copy2 mt-2"},"Notes",-1))),Qu=["value"],Gu={class:"mt-8 full-width d-flex justify-space-between"},zu=fu((()=>(0,o.Lk)("div",null,null,-1))),Ju=fu((()=>(0,o.Lk)("span",{class:"white"},"Save",-1))),Zu=[Ju],qu=fu((()=>(0,o.Lk)("span",{class:"white"},"Delete",-1))),eh=[qu],th=fu((()=>(0,o.Lk)("span",{class:"white"},"Swap",-1))),ah=[th],lh=fu((()=>(0,o.Lk)("span",{class:"white"},"Create",-1))),sh=[lh],oh=fu((()=>(0,o.Lk)("span",{class:"white"},"Cancel",-1))),ih=[oh];function nh(e,t,a,s,i,n){const r=(0,o.g2)("custom-select"),c=(0,o.g2)("Modal");return(0,o.uX)(),(0,o.Wv)(c,{ref:"ModalRef"},{header:(0,o.k6)((()=>[(0,o.Lk)("div",null,[(0,o.Lk)("h2",ku,[e.isEdit?((0,o.uX)(),(0,o.CE)("span",vu,"Edit Schedule")):((0,o.uX)(),(0,o.CE)("span",gu,["published"===e.weekStatus?((0,o.uX)(),(0,o.CE)("span",Du,"Create Schedule")):((0,o.uX)(),(0,o.CE)("span",Su,"Create Schedule"))]))])])])),body:(0,o.k6)((()=>[(0,o.Lk)("div",null,["Team"===e.day.scheduleType?((0,o.uX)(),(0,o.CE)("div",bu," This schedule is generated from team schedule. ")):(0,o.Q3)("",!0),e.showTimeHourError?((0,o.uX)(),(0,o.CE)("div",Cu," The value for Hours Unpaid Break field must be a whole number. Use Minutes field for breaks that last partial hours. ")):(0,o.Q3)("",!0),e.showTimeMinuteError?((0,o.uX)(),(0,o.CE)("div",Eu," The value for Minutes Unpaid Break field must be a whole number. ")):(0,o.Q3)("",!0),(0,o.Lk)("div",wu,[Lu,(0,o.eW)(),(0,o.Lk)("span",null,(0,h.v_)(e.dialogDate),1),Tu,(0,o.Lk)("span",null,(0,h.v_)(e.employeeDetail.employeeName),1),xu,(0,o.Lk)("span",null,(0,h.v_)(e.employeeDetail.employeeNo),1),Au,(0,o.Lk)("div",null,[e.positionOptions&&1===e.positionOptions.length?((0,o.uX)(),(0,o.CE)("span",Fu,(0,h.v_)(e.positionOptions[0].positionTitle),1)):e.positionOptions&&e.positionOptions.length>1?((0,o.uX)(),(0,o.Wv)(r,{key:1,options:e.positionOptions,displayKey:"positionTitle",selected:e.selectedPosition,onSelectOption:e.selectPositionCustom},null,8,["options","selected","onSelectOption"])):(0,o.bo)(((0,o.uX)(),(0,o.CE)("input",{key:2,"onUpdate:modelValue":t[0]||(t[0]=t=>e.day.position=t)},null,512)),[[l.Jo,e.day.position]])]),Nu,Mu,Pu,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.day.startTime=t),onChange:t[2]||(t[2]=t=>e.updateStartTime(e.day))},null,544),[[l.Jo,e.day.startTime]]),Ou,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.day.endTime=t),onChange:t[4]||(t[4]=t=>e.updateEndTime(e.day))},null,544),[[l.Jo,e.day.endTime]]),e.showUnAvaError?((0,o.uX)(),(0,o.CE)("span",Wu,"Note: This schedule's time overlaps with this person's unavailability time.")):(0,o.Q3)("",!0),Ru,Iu,Yu,(0,o.Lk)("div",_u,[(0,o.Lk)("div",Hu,[(0,o.bo)((0,o.Lk)("input",{type:"number",step:"any","onUpdate:modelValue":t[5]||(t[5]=t=>e.breakHours=t),onChange:t[6]||(t[6]=(...t)=>e.calcBreakHour&&e.calcBreakHour(...t)),onKeydown:t[7]||(t[7]=t=>e.breakValidation(t))},null,544),[[l.Jo,e.breakHours,void 0,{lazy:!0}]]),Xu]),ju,(0,o.Lk)("div",Vu,[(0,o.bo)((0,o.Lk)("input",{type:"number",step:"any","onUpdate:modelValue":t[8]||(t[8]=t=>e.breakMinutes=t),onChange:t[9]||(t[9]=(...t)=>e.calcBreakHour&&e.calcBreakHour(...t)),onKeydown:t[10]||(t[10]=t=>e.breakValidation(t))},null,544),[[l.Jo,e.breakMinutes,void 0,{lazy:!0}]]),$u])]),Ku,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=t=>e.fixedHours=t)},null,512),[[l.Jo,e.fixedHours,void 0,{lazy:!0}]]),Bu,(0,o.Lk)("div",null,[e.shiftOptions&&e.shiftOptions.length>0?((0,o.uX)(),(0,o.Wv)(r,{key:0,options:e.shiftOptions,displayKey:"description",selected:e.selectedShift,onSelectOption:e.selectShift},null,8,["options","selected","onSelectOption"])):(0,o.Q3)("",!0)])]),Uu,(0,o.Lk)("div",null,[(0,o.Lk)("textarea",{class:"note-textarea",value:e.day.notes,onChange:t[12]||(t[12]=(...t)=>e.updateNotes&&e.updateNotes(...t))},null,40,Qu)])])])),footer:(0,o.k6)((()=>[(0,o.Lk)("div",Gu,[zu,(0,o.Lk)("div",null,[e.isEdit?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"blue small copy2",onClick:t[13]||(t[13]=t=>e.updateSche())},Zu)):(0,o.Q3)("",!0),e.isEdit&&e.allowDelete()?((0,o.uX)(),(0,o.CE)("button",{key:1,class:"grey small copy2 ml-2",onClick:t[14]||(t[14]=t=>e.confirmIfDeleteSche())},eh)):(0,o.Q3)("",!0),e.isEdit&&e.allowSwap()?((0,o.uX)(),(0,o.CE)("button",{key:2,class:"grey small copy2 ml-2",onClick:t[15]||(t[15]=t=>e.confirmIfSwapSche())},ah)):(0,o.Q3)("",!0),e.isEdit?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:3,class:"blue small copy2",onClick:t[16]||(t[16]=t=>e.createSche())},sh)),(0,o.Lk)("button",{class:"ml-2 small orange copy2",onClick:t[17]||(t[17]=t=>e.cancel())},ih)])])])),_:1},512)}const rh="DD/MM/YYYY",ch="MM/DD/YYYY";function dh(e,t,a){return window.innerWidth<768?e.format(rh):0!==t||a?e.clone().day(t).format(rh):e.clone().day(t).add(7,"day").format(rh)}function uh(e,t,a){return window.innerWidth<768?e.format(ch):0!==t||a?e.clone().day(t).format(ch):e.clone().day(t).add(7,"day").format(ch)}function hh(e,t,a){if(console.log("start time",t),!t&&a){const t=Be()(e,ch),l=Be()(a,"HH:mm"),s=t.clone().hours(l.hour()).minutes(l.minutes());return[null,s]}if(t&&!a){const a=Be()(e,ch),l=Be()(t,"HH:mm"),s=a.clone().hours(l.hour()).minutes(l.minutes());return[s,null]}if(t||a){const l=Be()(e,ch),s=Be()(t,"HH:mm"),o=Be()(a,"HH:mm"),i=l.clone().hours(s.hour()).minutes(s.minutes()),n=l.clone().hours(o.hour()).minutes(o.minutes());let r=n.diff(i,"hours",!0);return r<=0&&n.add(1,"day"),[i.format("YYYY-MM-DDTHH:mm:ss"),n.format("YYYY-MM-DDTHH:mm:ss")]}return[null,null]}var mh=(0,o.pM)({name:"EditFlexSchedule",components:{Modal:Re,CustomSelect:fo},props:{isEdit:{type:Boolean},weekStatus:{type:String}},data(){return{day:{},unAvailability:null,selectedPosition:{},selectedShift:{},selectedCostElement1:{},selectedCostElement2:{},employeeDetail:{},dialogDate:"",showUnAvaError:!1,showTimeHourError:!1,showTimeMinuteError:!1,breakHours:null,breakMinutes:null,manageCompanyConfig:null,dayInWeek:null}},setup(){const e=(0,je.Pj)();return{shiftOptions:(0,o.EW)((()=>{let t={shiftType:"",description:"",isDefault:null,archive:"F"},a=e.state.LookUp.shifts.slice();return a.unshift(t),a})),costElementOptions:(0,o.EW)((()=>e.state.LookUp.costElements))}},computed:{positionOptions(){let e=this.$store.state.LookUp.positions;return 1===e.length&&(this.selectedPosition=e[0]),e},fixedHours:{get(){return this.day.hours?this.day.hours.toFixed(2):""},set(e){this.day.hours=Number(e)}},fixedBreakLength:{get(){return this.day.breakLength?this.day.breakLength.toFixed(2):""},set(e){this.day.breakLength=Number(e)}}},mounted(){this.manageCompanyConfig=(0,o.WQ)("MANAGE_COMPANY_CONFIG");this.$store;this.day=this.$store.state.FlexSchedule.flexScheduleDay,console.log("this day",this.day)},methods:{selectCostElement1(e){this.selectedCostElement1=e},selectCostElement2(e){this.selectedCostElement2=e},selectShift(e){this.selectedShift=e},selectPositionCustom(e){this.selectedPosition=e},selectPosition(e,t){this.selectedPosition=t,e.target.blur();let a=this.$refs.selectRef;a.blur()},updateStartTime(e){if(!e.startTime)return;let t;t=e.startTime.includes(":")?Be()(e.startTime,"HH:mm"):Be()(e.startTime,"Hmm"),t.isValid()?(e.startTime=t.format("HH:mm"),this.calcNetHour()):e.startTime="Invalid Time"},updateEndTime(e){if(!e.endTime)return;let t;t=e.endTime.includes(":")?Be()(e.endTime,"HH:mm"):Be()(e.endTime,"Hmm"),t.isValid()?(e.endTime=t.format("HH:mm"),this.calcNetHour()):e.endTime="Invalid Time"},breakValidation(e){e.key.match(/[-]/)&&e.preventDefault()},checkBreakHours(){if(this.day.breakLength){let e=this.day.breakLength,t=Math.floor(e),a=e-t;0!==t&&(this.breakHours=t),a>0&&(this.breakMinutes=Math.round(60*a))}},calcBreakHour(){this.breakHours&&this.breakMinutes?this.day.breakLength=Number(this.breakHours)+Math.round(Number(this.breakMinutes)/60*1e3)/1e3:this.breakHours?this.day.breakLength=Number(this.breakHours):this.breakMinutes?this.day.breakLength=Math.round(Number(this.breakMinutes)/60*1e3)/1e3:(0===this.breakHours&&this.breakMinutes,this.day.breakLength=0),this.calcNetHour()},calcNetHour(){if("Invalid Time"===this.day.startTime||"Invalid Time"===this.day.endTime)return;if(!this.day.startTime||!this.day.endTime)return;let e=Be()(this.day.startTime,"H:mm"),t=Be()(this.day.endTime,"H:mm"),a=t.diff(e,"hours",!0);a<=0&&(a=t.add(1,"day").diff(e,"hours",!0));let l=Math.round(100*a)/100;this.day.breakLength?this.day.hours=l-this.day.breakLength:this.day.hours=l,this.checkUnavailability()},checkUnavailability(){if(this.showUnAvaError=!1,!this.day.startTime||!this.day.endTime)return;if(!this.unAvailability||!this.unAvailability.endTime||!this.unAvailability.startTime)return;const e=Be()(this.day.startTime,"HH:mm"),t=Be()(this.day.endTime,"HH:mm"),a=Be()(this.unAvailability.startTime,"HH:mm"),l=Be()(this.unAvailability.endTime,"HH:mm");e<=l&&t>=a&&(console.log("show error for Fine time overlap"),this.showUnAvaError=!0)},clearForm(){this.$store.commit(Je.clearForm),this.showUnAvaError=!1,this.showTimeHourError=!1,this.showTimeMinuteError=!1},cancel(){this.$store.commit(Je.clearForm),this.showUnAvaError=!1,this.showTimeHourError=!1,this.showTimeMinuteError=!1,this.toggleShow()},getPublishStateBaseOnEmp(){if(rt())return"draft";const e=this.$store.state.FlexSchedule.selectedFlexDay.employeeNo,t=this.$store.state.FlexSchedule.scheduleWeek.get(e).empSchePublishState;return"published"===t?"published":"draft"},validateForm(){return this.showTimeHourError=!1,this.showTimeMinuteError=!1,this.breakHours&&this.breakHours.toString().indexOf(".")>-1?(this.showTimeHourError=!0,!1):!(this.breakMinutes&&this.breakMinutes.toString().indexOf(".")>-1)||(this.showTimeMinuteError=!0,!1)},updateSche(){if(!this.validateForm())return;const e=uh(this.$store.state.FlexSchedule.calendarFocusDate,this.dayInWeek,this.manageCompanyConfig.getAllowSundayFirst()),[t,a]=hh(e,this.day.startTime,this.day.endTime);Ma.loading();let l={Id:this.$store.state.FlexSchedule.selectedFlexDay.id,EmployeeNo:this.$store.state.FlexSchedule.selectedFlexDay.employeeNo,Date:e,StartTime:t,EndTime:a,Hours:this.day.hours,PublishStatus:this.$store.state.FlexSchedule.selectedFlexDay.publishStatus?this.$store.state.FlexSchedule.selectedFlexDay.publishStatus:this.getPublishStateBaseOnEmp(),ScheduleType:"Flex",ScheduleData:{ShiftId:this.selectedShift.shiftType,BreakLength:this.day.breakLength,Position:this.selectedPosition.positionCode,CostElement1:this.selectedCostElement1?this.selectedCostElement1.id:void 0,CostElement2:this.selectedCostElement1?this.selectedCostElement2.id:void 0},Notes:this.day.notes};ye.PatchFlexSchedule([l]).then((e=>{this.$emit("reload"),Ma.clear()}),(()=>{Ma.clear(),Ma.alert("Something went wrong. Update Schedule failed")})),this.$store.commit(Je.saveScheduleDayToWeek),this.toggleShow()},createSche(){if(!this.validateForm())return;const e=uh(this.$store.state.FlexSchedule.calendarFocusDate,this.dayInWeek,this.manageCompanyConfig.getAllowSundayFirst()),[t,a]=hh(e,this.day.startTime,this.day.endTime);Ma.loading();let l=[{EmployeeNo:this.$store.state.FlexSchedule.selectedFlexDay.employeeNo,Date:e,StartTime:t,EndTime:a,Hours:this.day.hours,PublishStatus:this.$store.state.FlexSchedule.selectedFlexDay.publishStatus?this.$store.state.FlexSchedule.selectedFlexDay.publishStatus:this.getPublishStateBaseOnEmp(),ScheduleType:"Flex",ScheduleData:{ShiftId:this.selectedShift.shiftType?this.selectedShift.shiftType:"",BreakLength:this.day.breakLength,Position:this.selectedPosition.positionCode,CostElement1:this.selectedCostElement1?this.selectedCostElement1.id:"",CostElement2:this.selectedCostElement2?this.selectedCostElement2.id:""},Notes:this.day.notes}];ye.CreateFlexSchedule(l).then((e=>{if(e.Error)throw e;this.$store.commit(Je.saveScheduleDayToWeek),Ma.clear(),this.toggleShow(),this.$emit("reload")})).catch((e=>{Ma.clear(),e.Error?Ma.alert(e.Error):Ma.alert("Something went wrong. Create Schedule failed")}))},allowDelete(){return 0!==this.$store.state.FlexSchedule.selectedFlexDay.id},allowSwap(){return!(Be()(this.dialogDate,"DD/MM/YYYY").diff(Be()().startOf("day"))<0)&&"published"===this.$store.state.FlexSchedule.selectedFlexDay.publishStatus},confirmIfDeleteSche(){this.$store.state.FlexSchedule.selectedFlexDay.id?Ma.confirmOrCancel({message:"Are you sure you want to delete this schedule?"}).then((()=>{this.deleteSche(this.$store.state.FlexSchedule.selectedFlexDay.id)})):Ma.alert("This record cannot be deleted yet, as it is too far away from today's date.")},deleteSche(e){Ma.loading();const t=uh(this.$store.state.FlexSchedule.calendarFocusDate,this.dayInWeek,this.manageCompanyConfig.getAllowSundayFirst()),[a,l]=hh(t,this.day.startTime,this.day.endTime);let s={Id:this.$store.state.FlexSchedule.selectedFlexDay.id,EmployeeNo:this.$store.state.FlexSchedule.selectedFlexDay.employeeNo,Date:t,StartTime:a,EndTime:l,Hours:this.day.hours,PublishStatus:this.$store.state.FlexSchedule.selectedFlexDay.publishStatus?this.$store.state.FlexSchedule.selectedFlexDay.publishStatus:"draft",ScheduleData:{ShiftId:this.selectedShift.shiftType,BreakLength:this.day.breakLength,Position:this.selectedPosition.positionCode,CostElement1:this.selectedCostElement1?this.selectedCostElement1.id:void 0,CostElement2:this.selectedCostElement1?this.selectedCostElement2.id:void 0}};ye.DeleteFlexSchedule(s).then((e=>{this.$emit("reload"),this.toggleShow()}),(e=>{Ma.alert("Something went wrong. Delete Schedule failed")})).finally((()=>{}))},updateNotes(e){const t=e.target;this.day.notes=t.value},confirmIfSwapSche(){this.$emit("swapSche",this.$store.state.FlexSchedule.selectedFlexDay),this.$refs.ModalRef.toggleShow()},openEdit(){let e;this.breakMinutes=null,this.breakHours=null,this.$store.state.FlexSchedule.selectedFlexDay.ScheduleData&&(e=this.shiftOptions.find((e=>e.shiftType===this.$store.state.FlexSchedule.selectedFlexDay.ScheduleData.ShiftId))),e&&(this.selectedShift=e),this.$store.state.FlexSchedule.selectedFlexDay.ScheduleData&&(this.selectedCostElement1=this.costElementOptions.find((e=>e.id===this.$store.state.FlexSchedule.selectedFlexDay.ScheduleData.CostElement1)),this.selectedCostElement2=this.costElementOptions.find((e=>e.id===this.$store.state.FlexSchedule.selectedFlexDay.ScheduleData.CostElement2))),this.employeeDetail={employeeName:this.$store.state.FlexSchedule.selectedFlexDay.employeeName,employeeNo:this.$store.state.FlexSchedule.selectedFlexDay.employeeNo},this.dayInWeek=this.$store.state.FlexSchedule.selectedFlexDay.dayInWeek,this.dialogDate=dh(this.$store.state.FlexSchedule.calendarFocusDate,this.dayInWeek,this.manageCompanyConfig.getAllowSundayFirst()),this.day=this.$store.state.FlexSchedule.flexScheduleDay,this.unAvailability=this.$store.state.FlexSchedule.selectedFlexDay?.unAvailability,this.checkUnavailability(),this.checkBreakHours(),this.$refs.ModalRef.toggleShow()},toggleShow(){this.$refs.ModalRef.toggleShow()}}});const ph=(0,ke.A)(mh,[["render",nh],["__scopeId","data-v-eb55bf94"]]);var yh=ph;const fh=e=>((0,o.Qi)("data-v-1c413fc7"),e=e(),(0,o.jt)(),e),kh=fh((()=>(0,o.Lk)("h2",{class:"bold"},"Employee Details",-1))),vh={class:"mt-4"},gh={class:"mt-4"};function Dh(e,t,a,l,s,i){const n=(0,o.g2)("cf-widget"),r=(0,o.g2)("Modal");return(0,o.uX)(),(0,o.Wv)(r,{ref:"ModalRef"},{header:(0,o.k6)((()=>[kh])),body:(0,o.k6)((()=>[(0,o.Lk)("div",vh,[(0,o.bF)(n,{title:e.title,icon:"",class:"my-pay-widget",data:e.externalDetail,loading:e.loading,error:e.error},null,8,["title","data","loading","error"])])])),footer:(0,o.k6)((()=>[(0,o.Lk)("div",gh,[(0,o.Lk)("button",{class:"grey small white--text",onClick:t[0]||(t[0]=(...t)=>e.toggleShow&&e.toggleShow(...t))}," Close ")])])),_:1},512)}const Sh={class:"cf-widget"};function bh(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("div",Sh,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.items,((e,t)=>((0,o.uX)(),(0,o.Wv)((0,o.$y)(e.Type),{data:e,class:"item",key:t},null,8,["data"])))),128))])}const Ch={class:"field-display"},Eh={class:"label"},wh=["href"],Lh=["href"],Th={key:2,class:"value"};function xh(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("div",Ch,[(0,o.Lk)("div",Eh,(0,h.v_)(a.data.Label),1),i.email?((0,o.uX)(),(0,o.CE)("a",{key:0,href:i.email,class:"value"},(0,h.v_)(a.data.Value),9,wh)):(0,o.Q3)("",!0),!i.email&&i.tel?((0,o.uX)(),(0,o.CE)("a",{key:1,href:i.tel,class:"value"},(0,h.v_)(a.data.Value),9,Lh)):(0,o.Q3)("",!0),i.email||i.tel?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Th,(0,h.v_)(a.data.Value),1))])}var Ah={props:["data"],computed:{tel(){return"string"==typeof this.data.Key&&(this.data.Key.includes("Phone")||this.data.Key.includes("Mobile"))?`tel:${this.data.Value}`:null},email(){return"string"==typeof this.data.Value&&this.data.Value.includes("@")?`mailto:${this.data.Value}`:null}}};const Fh=(0,ke.A)(Ah,[["render",xh]]);var Nh=Fh;const Mh={class:"separator"};function Ph(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("div",Mh)}var Oh={};const Wh=(0,ke.A)(Oh,[["render",Ph]]);var Rh=Wh;const Ih={class:"youtube-input"},Yh=["src"];function _h(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("div",Ih,[(0,o.Lk)("iframe",{class:"video-frame",src:"//www.youtube.com/embed/"+a.data.Value+"?autoplay=0&controls=1&rel=0&showinfo=0&theme=light&modestbranding=1"},null,8,Yh)])}var Hh={props:["data"]};const Xh=(0,ke.A)(Hh,[["render",_h]]);var jh=Xh;function Vh(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("p",null,(0,h.v_)(a.data.Label),1)}var $h={props:["data"]};const Kh=(0,ke.A)($h,[["render",Vh]]);var Bh=Kh;const Uh={class:"explanation"};function Qh(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("p",Uh,(0,h.v_)(a.data.Label),1)}var Gh={props:["data"]};const zh=(0,ke.A)(Gh,[["render",Qh]]);var Jh=zh;const Zh={class:"attachment"},qh={class:"label"},em={class:"value"},tm={href:"#"};function am(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("div",Zh,[(0,o.Lk)("div",qh,(0,h.v_)(a.data.Label),1),(0,o.Lk)("div",em,[(0,o.Lk)("a",tm,(0,h.v_)(a.data.Value.Display),1)])])}var lm={props:["data"]};const sm=(0,ke.A)(lm,[["render",am]]);var om=sm;const im={class:"subheading"},nm={class:"label"};function rm(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("div",im,[(0,o.Lk)("div",nm,(0,h.v_)(a.data.Label),1)])}var cm={props:["data"]};const dm=(0,ke.A)(cm,[["render",rm]]);var um=dm;const hm=["href"];function mm(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("a",{href:a.data.Value},(0,h.v_)(a.data.Label),9,hm)}var pm={props:["data"]};const ym=(0,ke.A)(pm,[["render",mm]]);var fm=ym,km={props:["title","icon","data","loading","error"],components:{FieldDisplay:Nh,Separator:Rh,YoutubeInput:jh,Paragraph:Bh,Explanation:Jh,AttachFile:om,Subheading:um,Link:fm},computed:{items(){if(this.data)return this.data.filter((e=>"Separator"===e.Type||"Subheading"===e.Type||"Explanation"===e.Type||"Paragraph"===e.Type||"YoutubeInput"===e.Type||"Link"===e.Type||e.Value))}}};const vm=(0,ke.A)(km,[["render",bh]]);var gm=vm,Dm=(0,o.pM)({name:"TestEmployeeList",components:{Modal:Re,CfWidget:gm},props:{externalDetail:{type:Array}},data(){return{title:"data title",loading:!1,error:null}},mounted(){},methods:{toggleShow(){this.$refs.ModalRef.toggleShow()}}});const Sm=(0,ke.A)(Dm,[["render",Dh],["__scopeId","data-v-1c413fc7"]]);var bm=Sm;const Cm=e=>((0,o.Qi)("data-v-702ec705"),e=e(),(0,o.jt)(),e),Em={class:"cell-config-list"},wm={class:"custom-select",tabindex:"1"},Lm=Cm((()=>(0,o.Lk)("div",{class:"custom-select-selected"},"Show/Hide Details",-1))),Tm={class:"custom-select-items"},xm=["onClick"],Am={class:"cell-config"},Fm=["onUpdate:modelValue"];function Nm(e,t,a,s,i,n){return(0,o.uX)(),(0,o.CE)("div",Em,[(0,o.Lk)("div",null,[(0,o.Lk)("div",wm,[Lm,(0,o.Lk)("div",Tm,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.cellSettings,((a,s)=>((0,o.uX)(),(0,o.CE)("div",{class:"custom-select-item",key:s,onClick:t=>e.checkOptions(a)},[(0,o.Lk)("div",Am,[(0,o.Lk)("label",null,(0,h.v_)(a.name),1),(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":e=>a.value=e,onChange:t[0]||(t[0]=(...t)=>e.optionChanged&&e.optionChanged(...t))},null,40,Fm),[[l.lH,a.value]])])],8,xm)))),128))])])])])}var Mm=(0,o.pM)({name:"FlexScheduleCellControl",setup(){const e=(0,je.Pj)(),t=(0,s.KR)(!1),a=(0,s.KR)([]),l=e.state.FlexSchedule.flexScheduleCellSetting;return{open:t,cellSettings:l,optionSelected:a}},methods:{optionChanged(){localStorage.setItem("flexScheduleCellSetting",JSON.stringify(this.cellSettings))},checkOptions(e){this.$emit("checkOptions",e)}}});const Pm=(0,ke.A)(Mm,[["render",Nm],["__scopeId","data-v-702ec705"]]);var Om=Pm;const Wm=e=>((0,o.Qi)("data-v-822aebcc"),e=e(),(0,o.jt)(),e),Rm={class:"cell-config-list costCenter-wrapper"},Im={class:"custom-select",tabindex:"1"},Ym=Wm((()=>(0,o.Lk)("div",{class:"custom-select-selected"}," Select Cost Centre ",-1))),_m={class:"custom-select-items"},Hm=["onClick"],Xm={class:"cell-config"},jm=["onUpdate:modelValue"];function Vm(e,t,a,s,i,n){const r=(0,o.gN)("tooltip");return(0,o.uX)(),(0,o.CE)("div",Rm,[(0,o.Lk)("div",null,[(0,o.Lk)("div",Im,[Ym,(0,o.Lk)("div",_m,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.costCenterOptions,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{class:"custom-select-item",key:a,onClick:a=>{e.checkOptions(t)}},[(0,o.Lk)("div",Xm,[(0,o.bo)(((0,o.uX)(),(0,o.CE)("label",null,[(0,o.eW)((0,h.v_)(t.description),1)])),[[r,{content:t.description},void 0,{top:!0}]]),(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":e=>t.selected=e},null,8,jm),[[l.lH,t.selected]])])],8,Hm)))),128))])])])])}var $m=(0,o.pM)({name:"FlexScheduleCostCenter",props:{costCenterOptions:{type:Array}},setup(){const e=(0,je.Pj)(),t=(0,s.KR)(!1),a=(0,s.KR)([]),l=e.state.LookUp.costCenters;return{open:t,costCenters:l,optionSelected:a}},methods:{checkOptions(e){if(e.selected=!e.selected,-1===e.costCentreId&&this.costCenterOptions){for(const e of this.costCenterOptions)e.selected=!1;this.costCenterOptions[0].selected=!0}else this.costCenterOptions[0].selected=!1;this.$emit("selectOption",this.costCenterOptions)}}});const Km=(0,ke.A)($m,[["render",Vm],["__scopeId","data-v-822aebcc"]]);var Bm=Km;const Um=e=>((0,o.Qi)("data-v-7325b36b"),e=e(),(0,o.jt)(),e),Qm=Um((()=>(0,o.Lk)("div",null,[(0,o.Lk)("h2",null,[(0,o.Lk)("b",null,"Publish Flexi Schedule")])],-1))),Gm={class:"full-width mt-4"},zm={key:0},Jm=Um((()=>(0,o.Lk)("br",null,null,-1))),Zm={key:1},qm={key:0},ep=Um((()=>(0,o.Lk)("span",null,"Publish by individual employee(s)",-1))),tp=[ep],ap={key:1},lp={class:"container-half mt-4"},sp=Um((()=>(0,o.Lk)("label",null,"Select Employees",-1))),op=Um((()=>(0,o.Lk)("div",{class:"line-break mt-4"},null,-1))),ip={class:"d-flex justify-end full-width mt-4"};function np(e,t,a,l,s,i){const n=(0,o.g2)("multi-select"),r=(0,o.g2)("Modal");return(0,o.uX)(),(0,o.Wv)(r,{ref:"ModalRef","no-overflow-auto-body":!0},{header:(0,o.k6)((()=>[Qm])),body:(0,o.k6)((()=>[(0,o.Lk)("div",Gm,[(0,o.Lk)("div",null,[!1===e.showPublishByEmployee?((0,o.uX)(),(0,o.CE)("span",zm,[(0,o.eW)("Are you sure you want to publish the schedule for week "+(0,h.v_)(e.selectedDate)+"? ",1),Jm,(0,o.eW)(" This will publish the schedule for all employees.")])):(0,o.Q3)("",!0),!0===e.showPublishByEmployee?((0,o.uX)(),(0,o.CE)("span",Zm,"Are you sure you want to publish the schedule for week "+(0,h.v_)(e.selectedDate)+"?",1)):(0,o.Q3)("",!0)]),!1===e.showPublishByEmployee?((0,o.uX)(),(0,o.CE)("div",qm,[(0,o.Lk)("button",{class:"text-button mt-4",onClick:t[0]||(t[0]=t=>e.showPublishByEmployee=!0)},tp)])):(0,o.Q3)("",!0),!0===e.showPublishByEmployee?((0,o.uX)(),(0,o.CE)("div",ap,[(0,o.Lk)("div",lp,[sp,(0,o.bF)(n,{class:"mt-2",targetString:"commonName",allowAll:!0,selectOptionInput:e.selectOptions},null,8,["selectOptionInput"])])])):(0,o.Q3)("",!0),op])])),footer:(0,o.k6)((()=>[(0,o.Lk)("div",ip,[(0,o.Lk)("button",{class:"blue xsmall white--text mr-2",onClick:t[1]||(t[1]=(...t)=>e.publish&&e.publish(...t))},"Publish"),(0,o.Lk)("button",{class:"orange xsmall white--text",onClick:t[2]||(t[2]=(...t)=>e.cancel&&e.cancel(...t))},"Cancel")])])),_:1},512)}var rp=(0,o.pM)({name:"PublishDialog",components:{Modal:Re,MultiSelect:Kc},data(){return{selectOptions:[],selectedDate:"",showPublishByEmployee:!1}},mounted(){this.showPublishByEmployee=!1,this.selectOptions=this.$store.getters[Os.getFilteredEmployees].slice()},methods:{selectOption(){},resetData(){this.showPublishByEmployee=!1},publish(){if(!this.showPublishByEmployee){const e=this.selectOptions.map((e=>e.employeeNo));return this.$emit("publish",e),void this.$refs.ModalRef.toggleShow()}if(this.selectOptions[0].isAll&&this.selectOptions[0].isSelected)return void this.publishAllEmployee();let e=this.selectOptions.filter((e=>e.isSelected)).map((e=>e.employeeNo));this.$emit("publish",e),this.$refs.ModalRef.toggleShow()},publishAllEmployee(){let e=this.selectOptions.slice();e.shift();const t=e.map((e=>e.employeeNo));this.$emit("publish",t),this.$refs.ModalRef.toggleShow()},cancel(){this.toggleShow()},setSelectedDate(e){this.selectedDate=e},toggleShow(){console.log("toggle show"),this.resetData(),this.selectOptions=this.$store.getters[Os.getFilteredEmployees].slice(),this.$refs.ModalRef.toggleShow()}}});const cp=(0,ke.A)(rp,[["render",np],["__scopeId","data-v-7325b36b"]]);var dp=cp;const up=e=>((0,o.Qi)("data-v-33330b0a"),e=e(),(0,o.jt)(),e),hp={class:"schedules-data-medium mt-4"},mp={class:"flex-sche-table-wrap"},pp={class:"flex-sche-table"},yp=up((()=>(0,o.Lk)("div",{class:"table-cell table-head-corner"},null,-1))),fp={key:0,class:"table-cell"},kp={key:0,class:"schedules-arr-name sticky-left"},vp=["onClick"],gp={key:0},Dp={key:1,class:"published-icon"},Sp=up((()=>(0,o.Lk)("span",null,"P",-1))),bp=[Sp],Cp={key:0,class:"content-cell"},Ep={key:1,class:"content-cell"},wp={key:2,class:"content-cell"},Lp={key:3,class:"content-cell"},Tp={key:4,class:"content-cell"},xp={key:0,class:""};function Ap(e,t,a,l,s,i){const n=(0,o.g2)("day-cell"),r=(0,o.g2)("perfect-scrollbar"),c=(0,o.g2)("printable-view"),d=(0,o.gN)("tooltip");return(0,o.uX)(),(0,o.CE)("div",hp,[(0,o.Lk)("div",mp,[(0,o.Lk)("div",pp,[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",{class:"table-head",style:(0,h.Tr)(e.tableMinWidthStyle)},[(0,o.Lk)("div",{class:"schedule-head-grid",style:(0,h.Tr)(e.gridColumnsStyle)},[yp,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.selectableColumns,((e,t)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:t},[e&&e.selected?((0,o.uX)(),(0,o.CE)("div",fp,(0,h.v_)(e.optionName),1)):(0,o.Q3)("",!0)],64)))),128)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.weekDays,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{class:"table-cell-flex",key:t},(0,h.v_)(e.day),1)))),128))],4)],4),(0,o.Lk)("div",{class:"table-contents",ref:"TableContentsRef",style:(0,h.Tr)(e.tableMinWidthStyle)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.scheduleWeekMap.keys(),((t,a)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:a},[e.scheduleWeekMap.get(t)&&e.scheduleWeekMap.get(t).show?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"schedules-arr-body",style:(0,h.Tr)(e.gridColumnsStyle)},[e.scheduleWeekMap.get(t)&&e.scheduleWeekMap.get(t).show?((0,o.uX)(),(0,o.CE)("div",kp,[(0,o.Lk)("div",{class:(0,h.C4)(["content-cell content-employee-name",{"content-employee-name-hover":!e.isEmployee}]),onClick:a=>e.openEmployeeDetail(t)},[(0,o.Lk)("span",null,(0,h.v_)(e.scheduleWeekMap.get(t).employeeName),1),e.cellSettings.showPosition.value&&!e.isEmployee?((0,o.uX)(),(0,o.CE)("div",gp,[(0,o.Lk)("span",null,(0,h.v_)(e.scheduleWeekMap.get(t).positionTitle),1)])):(0,o.Q3)("",!0),"published"!==e.scheduleWeekMap.get(t).empSchePublishState||e.isEmployee?(0,o.Q3)("",!0):(0,o.bo)(((0,o.uX)(),(0,o.CE)("span",Dp,bp)),[[d,{content:"Schedule for the week is published. "},void 0,{top:!0}]])],10,vp)])):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.selectableColumns,((a,l)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:l},[a&&a.selected&&"Std Hours"===a.optionName?((0,o.uX)(),(0,o.CE)("div",Cp,(0,h.v_)(e.scheduleWeekMap.get(t).stdHoursPerWeek?.toFixed(2)),1)):(0,o.Q3)("",!0),a&&a.selected&&"Net Hours"===a.optionName?((0,o.uX)(),(0,o.CE)("div",Ep,(0,h.v_)(e.scheduleWeekMap.get(t).netHours%1!==0?e.scheduleWeekMap.get(t).netHours.toFixed(2):Math.floor(e.scheduleWeekMap.get(t).netHours)),1)):(0,o.Q3)("",!0),a&&a.selected&&"Ta Role"===a.optionName?((0,o.uX)(),(0,o.CE)("div",wp,(0,h.v_)(e.scheduleWeekMap.get(t).taRole),1)):(0,o.Q3)("",!0),a&&a.selected&&"Worker Type"===a.optionName?((0,o.uX)(),(0,o.CE)("div",Lp,(0,h.v_)(e.scheduleWeekMap.get(t).workTypeName),1)):(0,o.Q3)("",!0),a&&a.selected&&"Roster Group"===a.optionName?((0,o.uX)(),(0,o.CE)("div",Tp,(0,h.v_)(e.scheduleWeekMap.get(t).defaultRosterGroup),1)):(0,o.Q3)("",!0)],64)))),128)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.scheduleWeekMap.get(t).sche,((a,l)=>((0,o.uX)(),(0,o.CE)("div",{class:"content-cell-flex",key:l,style:(0,h.Tr)(a.column)},[(0,o.bF)(n,{scheDay:a,employeeNo:t,employeeName:e.scheduleWeekMap.get(t).employeeName,allowEdit:!e.isEmployee,allowCreate:!e.isEmployee,isEmployee:e.isEmployee,onOpenEditDialog:e.openEditDialog},null,8,["scheDay","employeeNo","employeeName","allowEdit","allowCreate","isEmployee","onOpenEditDialog"])],4)))),128))],4)):(0,o.Q3)("",!0)],64)))),128))],4)])),_:1})])]),e.weekDays&&e.weekDays.length>0?((0,o.uX)(),(0,o.CE)("div",xp,[(0,o.bF)(c,{scheduleWeek:e.scheduleWeekMap,weekDays:e.weekDays,selectableColumns:e.selectableColumns,ref:"PrintableViewRef"},null,8,["scheduleWeek","weekDays","selectableColumns"])])):(0,o.Q3)("",!0)])}function Fp(e){return{id:e.id,startTime:e.startTime,endTime:e.endTime,hours:e.hours,date:e.date,isPaid:e.isPaid,scheduleType:e.scheduleType,dayInWeek:e.dayInWeek,publishStatus:e.publishStatus,breakLength:e.scheduleDetail.breakLength,position:e.scheduleDetail.position,positionTitle:e.scheduleDetail.positionTitle,shiftId:e.scheduleDetail.shiftId,notes:e.notes}}function Np(e,t,a){let l=a.flexSchedules;const s=new Map;for(let o of t){const e={...o};e.show=!0,s.set(o.employeeNo,e)}for(let o of l){const e=s.get(o.EmployeeNo);if(e&&!e.sche)e.sche=[Fp(o)];else if(e){const t=Fp(o);e.sche.push(t)}}return s}function Mp(e,t,a){let l=a.flexSchedules;const s=new Map;for(let o of t){const e={...o};e.show=!0,s.set(o.employeeNo,e)}for(let o of l){const e=s.get(o.EmployeeNo);e&&(e.sche=Fp(o))}for(let o of s.values())o.sche||(o.sche={},o.sche.dayInWeek=0,o.sche.employeeName=o.employeeName,o.sche.employeeNo=o.employeeNo),o.sche.allowCreateOrEdit=!0,o.sche.editing=!1;return s}function Pp(e,t,a){for(let l of t)if(l.leaveUnits)for(let t of l.leaveUnits){let s=Be()(t.leaveDate).diff(e,"days");s<0||(t.calcUnit=l.calcUnit,t.leaveCode=l.leaveCode,t.leaveName=l.leaveName,a.get(l.employeeNo)?.sche[s]&&(a.get(l.employeeNo).sche[s].leaveUnit=t))}}function Op(e,t){for(let a of e)if(a.leaveUnits)for(let e of a.leaveUnits)e.calcUnit=a.calcUnit,e.leaveCode=a.leaveCode,e.leaveName=a.leaveName,t.get(a.employeeNo)?.sche&&(t.get(a.employeeNo).sche.leaveUnit=e)}function Wp(e,t){for(let a of e.unAvailabilities){let e=Be()(a.unavailabilityDate).day();t.get(a.employeeNo)&&t.get(a.employeeNo).sche&&t.get(a.employeeNo).sche[e]&&(t.get(a.employeeNo).sche[e].unAvailability=a)}}function Rp(e,t){for(let a of e.unAvailabilities)t.get(a.employeeNo)&&t.get(a.employeeNo).sche&&(t.get(a.employeeNo).sche.unAvailability=a)}function Ip(e,t,a){console.log("gridDataset",t);Be()();for(let l of t.values()){let e=l.employeeName||l.EmployeeName,t=l.employeeNo||l.EmployeeNo,s=0;for(let o=0;o<=6;o++){let i;if(l.sche?i=l.sche.find((e=>{let t;return a?t=o:(t=o+1,t>6&&(t=0)),e.dayInWeek===t})):l.sche=[],l.sche[o]?.hours&&(s+=l.sche[o].hours),!i)if(0!==o||l.sche[0]&&null!==l.sche[0].dayInWeek&&void 0!==l.sche[0].dayInWeek){let s;a?s=o:(s=o+1,s>6&&(s=0)),l.sche.push({dayInWeek:s,employeeName:e,employeeNo:t})}else l.sche[0]={},l.sche[0].dayInWeek=a?0:1,l.sche[0].employeeName=e,l.sche[0].employeeNo=t}if(l.sche.sort(((e,t)=>e.dayInWeek-t.dayInWeek)),!a){const e=l.sche.shift();l.sche.push(e)}it();for(let[a,o]of l.sche.entries())o.allowCreateOrEdit=!0,o.editing=!1;l.netHours=s}}var Yp={prepareGridData:Np,prepareGridDataMobile:Mp,scheDaysToColumn:Ip,addLeaveToGrid:Pp,addUnAvaToGrid:Wp,addUnAvaToGridMobile:Rp,addLeaveToGridMobile:Op},_p=a(4849);const Hp=e=>((0,o.Qi)("data-v-f3206f84"),e=e(),(0,o.jt)(),e),Xp={class:"cell-config-list multi-column-wrapper"},jp={class:"custom-select",tabindex:"1"},Vp=Hp((()=>(0,o.Lk)("div",{class:"custom-select-selected"}," Add Extra Columns ",-1))),$p={class:"custom-select-items"},Kp={class:"cell-config"},Bp=["onUpdate:modelValue","onClick"];function Up(e,t,a,s,i,n){const r=(0,o.g2)("Icon");return(0,o.uX)(),(0,o.CE)("div",Xp,[(0,o.Lk)("div",null,[(0,o.Lk)("div",jp,[Vp,(0,o.Lk)("div",$p,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.selectionOption,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{class:"custom-select-item",key:a},[(0,o.Lk)("div",Kp,[(0,o.Lk)("label",null,(0,h.v_)(t.optionName),1),(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":e=>t.selected=e,onClick:a=>{e.checkOptions(t)}},null,8,Bp),[[l.lH,t.selected]]),t.selected?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},["Ascend"===t.sort||""===t.sort?((0,o.uX)(),(0,o.Wv)(r,{key:0,icon:e.$icons.chevronUp,height:"15",class:(0,h.C4)({"sort-selected":"Ascend"===t.sort}),onClick:a=>e.selectSort(t)},null,8,["icon","class","onClick"])):(0,o.Q3)("",!0),"Descend"===t.sort?((0,o.uX)(),(0,o.Wv)(r,{key:1,icon:e.$icons.chevronDown,height:"15",class:(0,h.C4)({"sort-selected":"Descend"===t.sort}),onClick:a=>e.selectSort(t)},null,8,["icon","class","onClick"])):(0,o.Q3)("",!0)],64)):(0,o.Q3)("",!0)])])))),128))])])])])}var Qp=(0,o.pM)({name:"FlexScheduleMultiColumn",components:{Icon:_p.In},props:{isEmployee:{type:Boolean,default:!1}},setup(e){const t=(0,je.Pj)(),a=(0,s.KR)(!1),l=(0,s.KR)([]),o=(0,s.KR)([]);return e.isEmployee?o.value=t.state.FlexSchedule.employeeSelectableColumn:o.value=t.state.FlexSchedule.selectableColumn,{open:a,optionSelected:l,selectionOption:o}},methods:{checkOptions(e){e.selected=!e.selected,e.selected||(e.sort=""),this.$emit("optionChanged"),localStorage.setItem("flexScheduleSelectableColumn",JSON.stringify(this.selectionOption))},selectSort(e){switch(this.selectionOption.forEach((t=>{t.optionName!==e.optionName&&(t.sort="")})),e.sort){case"Ascend":e.sort="Descend";break;case"Descend":e.sort="";break;case"":e.sort="Ascend";break;default:console.error("select sort error state")}localStorage.setItem("flexScheduleSelectableColumn",JSON.stringify(this.selectionOption)),this.$emit("sortChanged")}}});const Gp=(0,ke.A)(Qp,[["render",Up],["__scopeId","data-v-f3206f84"]]);var zp=Gp;const Jp=e=>((0,o.Qi)("data-v-77707ca0"),e=e(),(0,o.jt)(),e),Zp={class:"flex-sche-table",id:"FlexSchedules"},qp={class:"table-head"},ey=Jp((()=>(0,o.Lk)("th",{class:"table-cell"},null,-1))),ty={key:0,class:"table-cell"},ay={class:"table-cell"},ly={class:"table-body"},sy={key:0,class:"schedules-arr"},oy={class:"content-cell content-employee-name"},iy={key:0},ny={key:0,class:"content-cell"},ry={key:1,class:"content-cell"},cy={key:2,class:"content-cell"},dy={key:3,class:"content-cell"},uy={key:4,class:"content-cell"},hy={key:0,class:"leave-unit mt-2"},my={key:0},py={key:1};function yy(e,t,a,l,s,i){return(0,o.uX)(),(0,o.CE)("table",Zp,[(0,o.Lk)("thead",null,[(0,o.Lk)("tr",qp,[ey,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.selectableColumns,(e=>((0,o.uX)(),(0,o.CE)(o.FK,null,[e&&e.selected?((0,o.uX)(),(0,o.CE)("th",ty,(0,h.v_)(e.optionName),1)):(0,o.Q3)("",!0)],64)))),256)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.weekDays,(e=>((0,o.uX)(),(0,o.CE)("th",ay,(0,h.v_)(e.day),1)))),256))])]),(0,o.Lk)("tbody",ly,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.scheduleWeek.keys(),(t=>((0,o.uX)(),(0,o.CE)(o.FK,null,[e.scheduleWeek.get(t)&&e.scheduleWeek.get(t).show?((0,o.uX)(),(0,o.CE)("tr",sy,[(0,o.Lk)("td",oy,[(0,o.Lk)("div",null,(0,h.v_)(e.scheduleWeek.get(t).employeeName),1),e.cellSettings.showPosition.value?((0,o.uX)(),(0,o.CE)("div",iy,[(0,o.Lk)("span",null,(0,h.v_)(e.scheduleWeek.get(t).positionTitle),1)])):(0,o.Q3)("",!0)]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.selectableColumns,(a=>((0,o.uX)(),(0,o.CE)(o.FK,null,[a&&a.selected&&"Std Hours"===a.optionName?((0,o.uX)(),(0,o.CE)("td",ny,(0,h.v_)(e.scheduleWeek.get(t).stdHoursPerWeek?.toFixed(2)),1)):(0,o.Q3)("",!0),a&&a.selected&&"Net Hours"===a.optionName?((0,o.uX)(),(0,o.CE)("td",ry,(0,h.v_)(e.scheduleWeek.get(t).netHours),1)):(0,o.Q3)("",!0),a&&a.selected&&"Ta Role"===a.optionName?((0,o.uX)(),(0,o.CE)("td",cy,(0,h.v_)(e.scheduleWeek.get(t).taRole),1)):(0,o.Q3)("",!0),a&&a.selected&&"Worker Type"===a.optionName?((0,o.uX)(),(0,o.CE)("td",dy,(0,h.v_)(e.scheduleWeek.get(t).workTypeName),1)):(0,o.Q3)("",!0),a&&a.selected&&"Roster Group"===a.optionName?((0,o.uX)(),(0,o.CE)("td",uy,(0,h.v_)(e.scheduleWeek.get(t).defaultRosterGroup),1)):(0,o.Q3)("",!0)],64)))),256)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.scheduleWeek.get(t).sche,(e=>((0,o.uX)(),(0,o.CE)("td",{class:"content-cell",style:(0,h.Tr)(e.column)},[(0,o.Lk)("div",null,(0,h.v_)(e.startTime)+" - "+(0,h.v_)(e.endTime),1),e.leaveUnit?((0,o.uX)(),(0,o.CE)("div",hy,["D"===e.leaveUnit.calcUnit?((0,o.uX)(),(0,o.CE)("span",my,"Leave: "+(0,h.v_)(e.leaveUnit.daysAppliedFor)+" day",1)):((0,o.uX)(),(0,o.CE)("span",py,"Leave: "+(0,h.v_)(e.leaveUnit.hoursAppliedFor)+" hours",1))])):(0,o.Q3)("",!0)],4)))),256))])):(0,o.Q3)("",!0)],64)))),256))])])}var fy=(0,o.pM)({name:"PrintableView",props:{scheduleWeek:{type:Object},weekDays:{type:Array},selectableColumns:{type:Array}},setup(){const e=(0,je.Pj)(),t=e.state.FlexSchedule.flexScheduleCellSetting;return{cellSettings:t}},methods:{getTotalHour(e){let t=0;for(let a of e)a.hours&&(t+=a.hours);return t.toFixed(2)},printFlexSchedule(){var e="left=5,top=5,resizable=yes,height=600,width=700,scrollbars=yes,status=1",t=document.getElementById("FlexSchedules").outerHTML,l=window.open("","Print",e);const s=a(1732).toString();l.document.write("<html>"),l.document.write("<head>"),l.document.write('<style type="text/css">table {border-collapse: collapse;}</style>'),l.document.write('<style type="text/css">table, th, td {border: 1px solid #cbcbcb;text-align: center;}</style>'),l.document.write(`<style type="text/css">${s}</style>`),l.document.write("</head>"),l.document.write("<body>"),l.document.write(t),l.document.write("</body></html>"),l.document.close(),l.focus(),l.print(),l.close()}}});const ky=(0,ke.A)(fy,[["render",yy],["__scopeId","data-v-77707ca0"]]);var vy,gy=ky;(function(e){e["empty"]="",e["draft"]="draft",e["published"]="published",e["partial"]="partial"})(vy||(vy={}));var Dy=(0,o.pM)({name:"FlexScheduleCalendar",components:{DayCell:Yd,Icon:_p.In,FlexScheduleMultiColumn:zp,PrintableView:gy},props:{dayFocus:{type:Object,default:Be()()},weekStart:{type:Object,default:null},weekEnd:{type:Object,default:null},isEmployee:{type:Boolean,default:!1}},data(){return{weekDays:[],datePickerTop:0,datePickerLeft:0,employeeList:[],employeeHeightArr:[],scheduleWeekMap:new Map,weekStatus:vy.empty,showControl:!1,extraEmpDetail:[],isAdmin:!1,hasFuturePaidDate:!1,costCenterOptions:[],selectableColumns:[],gridColumnsStyle:{},tableMinWidthStyle:{},manageCompanyConfig:null}},setup(e){const t=(0,s.KR)(!1),a=(0,s.KR)([]),l=(0,s.KR)([]),o=(0,s.KR)({}),i=(0,s.KR)(),n=(0,je.Pj)(),r=n.state.FlexSchedule.flexScheduleCellSetting;let c=(0,s.KR)(Affinity.user.EmployeeNo);function d(){i.value.printFlexSchedule()}return n.commit(Ws.resetEmployees),e.isEmployee&&(c.value=n.state.EmployeeModule.managerNo),{TableContentsRef:l,TableNameRef:o,PrintableViewRef:i,isEditingDialog:t,externalDetail:a,cellSettings:r,printFlexSchedule:d,scheEmployeeNo:c}},computed:{selectedColumn(){return this.isEmployee?this.$store.state.FlexSchedule.employeeSelectableColumn:this.$store.state.FlexSchedule.selectableColumn}},watch:{weekStart(e,t){console.log("old val",t),console.log("newval",e),e.format()!==t.format()&&null!==t&&this.refreshScheduleData(e,this.weekEnd)},selectedColumn:{deep:!0,handler(e,t){this.multiColumnSelected()}}},async mounted(){console.log("mounted in calendar"),this.manageCompanyConfig=(0,o.WQ)("MANAGE_COMPANY_CONFIG"),this.$store.dispatch(Nd.getPositions,this.scheEmployeeNo),this.$store.dispatch(Nd.getShifts),this.$store.dispatch(Nd.getCostElement),await this.$store.dispatch(Nd.getWorkTypes),this.loadDate(this.weekStart,this.weekEnd),ye.GetDefaultWorkTypes().then((e=>{this.$store.state.FlexSchedule.defaultWorkTypes=e})),this.scheEmployeeNo>=5e6&&(this.isAdmin=!0),this.isEmployee?this.selectableColumns=this.$store.state.FlexSchedule.employeeSelectableColumn:this.selectableColumns=this.$store.state.FlexSchedule.selectableColumn,this.multiColumnSelected()},methods:{multiColumnSelected(){let e="120px ";for(const t of this.selectableColumns)t.selected&&(e=e+" "+t.width+"px");e+=" repeat(7, 1fr)",this.gridColumnsStyle={"grid-template-columns":e},this.calculateTableMinWidth(),this.sortWeekScheduleData()},calculateTableMinWidth(){let e=120;for(const a of this.selectableColumns)a.selected&&(e+=a.width);e+=770;const t=e+"px";this.tableMinWidthStyle={"min-width":t}},sortWeekScheduleData(){const e=this.$store.state.FlexSchedule.selectableColumn,t=Array.from(this.scheduleWeekMap.values());let a;const l=e.filter((e=>e.selected&&!!e.sort));if(l&&l.length>0){const s=this.getOptionNameKey(l[0].optionName),o=t.filter((e=>null!==e[s]&&void 0!==e[s])),i=t.filter((e=>null===e[s]||void 0===e[s]));let n=[],r=[];for(let t of e)t.selected&&""!==t.sort&&(n.push(this.getOptionNameKey(t.optionName)),"Ascend"===t.sort?r.push("asc"):"Descend"===t.sort&&r.push("desc"));0===n.length?a=$e().orderBy(t,(e=>e.employeeName.toLowerCase()),["asc"]):(a=$e().orderBy(o,n,r),i&&i.length>0&&(a=[...a,...i]))}else a=$e().orderBy(t,(e=>e.employeeName.toLowerCase()),["asc"]);const s=new Map;a.map((e=>{s.set(e.employeeNo,e)})),this.scheduleWeekMap=this.$store.state.FlexSchedule.scheduleWeek=s,this.$nextTick((()=>{this.resetEmployeeHeight()}))},getOptionNameKey(e){switch(e){case"Std Hours":return"stdHoursPerWeek";case"Net Hours":return"netHours";case"Worker Type":return"workTypeName";case"Ta Role":return"taRole";case"Roster Group":return"defaultRosterGroup";default:return""}},showCopy(){return!this.hasFuturePaidDate&&Be()().diff(this.dayFocus.clone().endOf("week"),"day")<=0},async reloadAfterEdit(){await this.refreshScheduleData(this.weekStart,this.weekEnd),this.multiColumnSelected()},async loadDate(e,t){console.log("load date in calendar"),this.weekStatus=vy.empty,this.showControl=!1,this.hasFuturePaidDate=!1;let a={managerEmployeeNo:this.scheEmployeeNo,dateFrom:e.format("YYYY-MM-DD"),dateTo:t.format("YYYY-MM-DD")};Ma.loading();let[l,s,o]=await Promise.all([this.$store.dispatch(ze.loadFlexiSchedules,{startDate:e,endDate:t,employeeNo:this.scheEmployeeNo}),ye.GetManagedLeaves(a),this.$store.dispatch(Rs.getEmployees,this.scheEmployeeNo)]).finally((()=>{Ma.clear()}));Ma.clear(),this.setupGridData(l,s,o,e),this.$store.state.FlexSchedule.leaveList=s,this.setupDate(e),console.log("week start",e),this.checkStatus(this.scheduleWeekMap),this.setupCostCenterList(o),this.sortWeekScheduleData(),console.log("this.scheduleWeekMap",this.scheduleWeekMap),this.$nextTick((()=>{this.resetEmployeeHeight()}))},setupCostCenterList(e){const t=e.map((e=>e.cost1)),a=[...new Set(t)];this.$store.dispatch(Nd.getCostCenters,a)},resetEmployeeHeight(){let e=0;for(const t of this.TableContentsRef.children)this.employeeHeightArr[e]=Math.round(100*t.getBoundingClientRect().height)/100,e++},async refreshScheduleData(e,t){console.log("refresh get called"),this.weekStatus=vy.empty,this.showControl=!1,this.hasFuturePaidDate=!1,Ma.loading();let a={managerEmployeeNo:this.scheEmployeeNo,dateFrom:e.format("YYYY-MM-DD"),dateTo:t.format("YYYY-MM-DD")};const[l,s]=await Promise.all([this.$store.dispatch(ze.loadFlexiSchedules,{startDate:e,endDate:t,employeeNo:this.scheEmployeeNo}),ye.GetManagedLeaves(a)]);this.$store.state.FlexSchedule.leaveList=s,Ma.clear(),this.setupGridData(l,s,this.$store.getters[Os.getEmployees],e),this.checkStatus(this.scheduleWeekMap),this.setupDate(e);for(const[o,i]of this.scheduleWeekMap.entries())i.show=!1;for(const o of this.$store.state.EmployeeModule.filteredEmployees){const e=this.scheduleWeekMap.get(o.employeeNo);e.show=!0}this.$nextTick((()=>{console.log(" refreshScheduleData For loop is all done rendering everything!"),this.resetEmployeeHeight()}))},setupGridData(e,t,a,l){let s=Yp.prepareGridData(l,a,e);this.manageCompanyConfig.getAllowSundayFirst()?Yp.scheDaysToColumn(l,s,!0):Yp.scheDaysToColumn(l,s,!1),Yp.addLeaveToGrid(l,t,s),Yp.addUnAvaToGrid(e,s),this.scheduleWeekMap=this.$store.state.FlexSchedule.scheduleWeek=s,console.log("week map",this.scheduleWeekMap)},setupDate(e){this.$store.state.FlexSchedule.calendarFocusDate=this.dayFocus,this.weekDays=this.getSelectedWeek(e)},checkStatus(e){let t=new Set;for(const a of e.values()){a.empSchePublishState="";for(const t of a.sche)t.publishStatus&&(t.publishStatus===vy.draft?a.empSchePublishState=vy.draft:t.publishStatus===vy.published&&(a.empSchePublishState=vy.published)),!this.hasFuturePaidDate&&t.isPaid&&Be()(0,"HH").diff(Be()(t.date),"days")<=-1&&(this.hasFuturePaidDate=!0);""===a.empSchePublishState?t.add(vy.empty):t.add(a.empSchePublishState);let e=a.sche.find((e=>"Personal"===e.scheduleType||"Team"===e.scheduleType));e&&(a.includeTeamOrPersonal=!0)}t.has(vy.published)?t.has(vy.draft)&&t.has(vy.published)||t.has(vy.empty)&&t.has(vy.published)?(this.weekStatus=vy.partial,this.$store.commit(Je.setWeekStatus,vy.partial)):(this.weekStatus=vy.published,this.$store.commit(Je.setWeekStatus,vy.published)):(this.weekStatus=vy.draft,this.$store.commit(Je.setWeekStatus,vy.draft))},getSelectedWeek(e){let t=[];for(let a=0;a<=6;a++){let e=Be()(this.weekStart).add(a,"days");t.push({momentDay:e,day:e.format("ddd, MMM Do")})}return t},openEmployeeDetail(e){this.isEmployee||this.$emit("openEmployeeDetail",e)},openEditDialog(e){this.$emit("openEditDialog",e)}}});const Sy=(0,ke.A)(Dy,[["render",Ap],["__scopeId","data-v-33330b0a"]]);var by=Sy;const Cy=e=>((0,o.Qi)("data-v-212a9743"),e=e(),(0,o.jt)(),e),Ey={class:"filters-legends"},wy=(0,o.Fv)('<div class="left-box" data-v-212a9743><div class="background-legend" data-v-212a9743><div data-v-212a9743><div class="flexi-legend mr-2" data-v-212a9743></div><div class="legend-label" data-v-212a9743>Flexi Schedule</div></div><div class="ml-8" data-v-212a9743><div class="team-legend mr-2" data-v-212a9743></div><div class="legend-label" data-v-212a9743>Team Schedule</div></div><div class="ml-8" data-v-212a9743><div class="personal-legend mr-2" data-v-212a9743></div><div class="legend-label" data-v-212a9743>Personal Schedule</div></div></div></div>',1),Ly={class:"weekDetail"},Ty={class:"status-section right-box"},xy={key:0,class:"copy2 ml-2 text-capitalize"},Ay={key:0,class:"flex-sched-filter"},Fy={class:"d-flex align-center"},Ny={key:0},My={class:"custom-select",tabindex:"1",ref:"selectRef"},Py=Cy((()=>(0,o.Lk)("span",{class:"inline-block-middle white"},"Actions",-1))),Oy={class:"inline-block-middle ml-1",style:{height:"15px"}},Wy={key:0,class:"custom-select-items"},Ry={key:1},Iy={key:0},Yy={class:"custom-select",tabindex:"1",ref:"selectRef"},_y=Cy((()=>(0,o.Lk)("span",{class:"inline-block-middle"},"Actions",-1))),Hy={class:"inline-block-middle ml-1",style:{height:"15px"}},Xy={class:"custom-select-items"},jy={class:"action-buttons"};var Vy=(0,o.pM)({__name:"TopFilters",props:{isEmployee:{type:Boolean,required:!0}},emits:[He.OPEN_DRAFT_DIALOG,He.SELECT_EMPLOYEE_AND_PUBLISH,He.OPEN_ANALYSIS_CHART,He.OPEN_COST_ANALYSIS,He.PRINT_FLEX_SCHEDULE,He.CHANGE_CELL_CONTROL,He.SELECT_COST_CENTER,He.CHANGE_WEEK],setup(e,{emit:t}){const a=(0,je.Pj)();let l=(0,s.KR)(!1),i=(0,s.KR)(Be()()),n=(0,s.KR)(!1),r=(0,s.KR)(0),c=(0,s.KR)(0);const d=(0,s.KR)(),u=t;(0,o.KC)((()=>{window.Affinity.user.EmployeeNo>=5e6&&(n.value=!0)}));const m=(0,o.EW)((()=>{let e=a.state.LookUp.costCenters;return e=e.map((e=>(e.selected=!1,e))),e.unshift({costCentreId:-1,description:"All",selected:!0}),e})),p=(0,o.EW)((()=>a.getters[Ge.getWeekStatus])),y=()=>{l.value=!l.value},f=()=>!0!==a.getters[Ge.hasFuturePaidDate]&&Be()().diff(i.value.clone().endOf("week"),"day")<=0,k=()=>{u(He.OPEN_DRAFT_DIALOG)},v=()=>{u(He.SELECT_EMPLOYEE_AND_PUBLISH)},g=()=>{u(He.OPEN_ANALYSIS_CHART)},D=()=>{u(He.OPEN_COST_ANALYSIS)},S=()=>{console.log("printFlexSchedule",123),u(He.PRINT_FLEX_SCHEDULE)},b=()=>{u(He.CHANGE_CELL_CONTROL)},C=()=>{console.log("dayFocus.value",i.value),i.value=i.value.subtract(7,"days").clone(),u(He.CHANGE_WEEK,i.value)},E=()=>{i.value=i.value.add(7,"days").clone(),u(He.CHANGE_WEEK,i.value)},w=async e=>{let t,a=e.target.getClientRects()[0];r.value=a.bottom+10,c.value=a.left-80;try{t=await(d.value?.toggleShow(i.value))}catch(l){return}await L(t)},L=e=>{console.log("date",e),i.value=e,a.state.FlexSchedule.calendarFocusDate=e,u(He.CHANGE_WEEK,i.value)},T=()=>p.value===_e.empty||p.value===_e.draft?"Draft":p.value===_e.partial?"Partially Published":p.value===_e.published?"Published":p.value,x=e=>{const t=a.state.FlexSchedule.scheduleWeek,l=(m.value.filter((e=>e.selected)),e.map((e=>!!e.selected&&e.costCentreId)));if(l.find((e=>-1===e))){for(const[e,a]of t.entries())a.show=!0;return void(a.state.EmployeeModule.filteredEmployees=a.state.EmployeeModule.employees)}let s=a.state.EmployeeModule.employees.filter((e=>!!l.find((t=>t===e.cost1))));a.state.EmployeeModule.filteredEmployees=s;for(const[a,o]of t.entries())o.show=!1;for(const a of s){const e=t.get(a.employeeNo);e.show=!0}};return(t,a)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",Ey,[wy,(0,o.Lk)("div",Ly,[(0,o.Lk)("span",{class:"arrow-height button icon small mr-4",onClick:C},[(0,o.bF)((0,s.R1)(_p.In),{icon:t.$icons.chevronLeft,height:"30",style:{color:"#FFFFFF"}},null,8,["icon"])]),(0,o.Lk)("span",{onClick:w},(0,h.v_)(t.$filters.ordinalSuffix((0,s.R1)(i).week()))+" Week, "+(0,h.v_)((0,s.R1)(i).format("DD/MM/YYYY")),1),(0,o.Lk)("span",{class:"arrow-height button icon small ml-4",onClick:E},[(0,o.bF)((0,s.R1)(_p.In),{icon:t.$icons.chevronRight,height:"30",style:{color:"#FFFFFF"}},null,8,["icon"])])]),(0,o.Lk)("div",Ty,[e.isEmployee?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",xy," Status: "+(0,h.v_)(T()),1))])]),e.isEmployee?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Ay,[(0,o.Lk)("div",Fy,[(0,o.bF)(Om,{class:"inline-block",onCheckOptions:b}),(0,o.bF)(Bm,{class:"ml-2",costCenterOptions:m.value,onSelectOption:x},null,8,["costCenterOptions"]),(0,o.bF)(zp,{class:"ml-2",isEmployee:e.isEmployee},null,8,["isEmployee"])]),"published"===p.value?((0,o.uX)(),(0,o.CE)("div",Ny,[(0,o.Lk)("div",My,[(0,o.Lk)("div",null,[(0,o.Lk)("button",{class:"grey small copy2 white--text action-button-width",onClick:y},[Py,(0,o.Lk)("span",Oy,[(0,o.bF)((0,s.R1)(_p.In),{icon:t.$icons.chevronDown,height:"15",style:{color:"#FFFF"}},null,8,["icon"])])])]),e.isEmployee?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Wy,[(0,o.Lk)("div",{class:"action-buttons"},[(0,o.Lk)("button",{class:"ghost small copy2 mt-2",onClick:g}," Coverage "),(0,o.Lk)("button",{class:"ghost small copy2 mt-2",onClick:D}," Cost "),(0,o.Lk)("button",{class:"ghost small copy2 mt-2",onClick:S}," Print ")])]))],512)])):((0,o.uX)(),(0,o.CE)("div",Ry,[(0,s.R1)(n)?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Iy,[(0,o.Lk)("span",null,[(0,o.Lk)("div",Yy,[(0,o.Lk)("div",null,[(0,o.Lk)("button",{class:"grey small copy2 white--text action-button-width",onClick:y},[_y,(0,o.Lk)("span",Hy,[(0,o.bF)((0,s.R1)(_p.In),{icon:t.$icons.chevronDown,height:"15",style:{color:"#FFFF"}},null,8,["icon"])])])]),(0,o.Lk)("div",Xy,[(0,o.Lk)("div",jy,[f()?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"ghost small copy2",onClick:k}," Copy ")):(0,o.Q3)("",!0),"draft"===p.value||"partial"===p.value?((0,o.uX)(),(0,o.CE)("button",{key:1,class:"ghost small copy2",onClick:v}," Publish ")):(0,o.Q3)("",!0),(0,o.Lk)("button",{class:"ghost small copy2",onClick:g}," Coverage "),(0,o.Lk)("button",{class:"ghost small copy2",onClick:D}," Costs "),(0,o.Lk)("button",{class:"ghost small copy2",onClick:S}," Print ")])])],512)])]))]))])),(0,o.bF)($a,{ref_key:"DatePickerRef",ref:d,top:(0,s.R1)(r),left:(0,s.R1)(c)},null,8,["top","left"])],64))}});const $y=(0,ke.A)(Vy,[["__scopeId","data-v-212a9743"]]);var Ky=$y;const By=e=>((0,o.Qi)("data-v-0b927762"),e=e(),(0,o.jt)(),e),Uy=By((()=>(0,o.Lk)("div",null,[(0,o.Lk)("h2",{class:"bold"},[(0,o.Lk)("span",null,"Swap Schedules")])],-1))),Qy={class:"flex swap-body mt-4"},Gy={class:"swap-sche-body edit-form"},zy=By((()=>(0,o.Lk)("h3",null,"Schedule 1",-1))),Jy=By((()=>(0,o.Lk)("div",null,null,-1))),Zy=By((()=>(0,o.Lk)("label",null,"Date",-1))),qy=By((()=>(0,o.Lk)("label",null,"Employee Name",-1))),ef=By((()=>(0,o.Lk)("label",null,"Employee No",-1))),tf=By((()=>(0,o.Lk)("label",null,"Position",-1))),af=By((()=>(0,o.Lk)("label",null,"Start Time",-1))),lf=By((()=>(0,o.Lk)("label",null,"Finish Time",-1))),sf=By((()=>(0,o.Lk)("label",null,"Unpaid Break",-1))),of=By((()=>(0,o.Lk)("label",null,"Net Hours",-1))),nf=By((()=>(0,o.Lk)("label",null,"Shift ID",-1))),rf=By((()=>(0,o.Lk)("label",null,"Notes",-1))),cf={class:"swap-sche-body edit-form mobile-margin-top"},df=By((()=>(0,o.Lk)("h3",null,"Schedule 2",-1))),uf=By((()=>(0,o.Lk)("div",null,null,-1))),hf=By((()=>(0,o.Lk)("label",null,"Date",-1))),mf=By((()=>(0,o.Lk)("label",null,"Employee Name",-1))),pf=By((()=>(0,o.Lk)("label",null,"Employee No",-1))),yf=By((()=>(0,o.Lk)("label",null,"Position",-1))),ff=By((()=>(0,o.Lk)("label",null,"Start Time",-1))),kf=By((()=>(0,o.Lk)("label",null,"Finish Time",-1))),vf=By((()=>(0,o.Lk)("label",null,"Unpaid Break",-1))),gf=By((()=>(0,o.Lk)("label",null,"Net Hours",-1))),Df=By((()=>(0,o.Lk)("label",null,"Shift ID",-1))),Sf=By((()=>(0,o.Lk)("label",null,"Notes",-1))),bf={class:"mt-4 full-width"},Cf={class:"d-flex justify-end"};function Ef(e,t,a,l,s,i){const n=(0,o.g2)("DatePickerInput"),r=(0,o.g2)("custom-select"),c=(0,o.g2)("Modal");return(0,o.uX)(),(0,o.Wv)(c,{ref:"ModalRef",onCancel:e.cancelSwap},{header:(0,o.k6)((()=>[Uy])),body:(0,o.k6)((()=>[(0,o.Lk)("div",Qy,[(0,o.Lk)("div",Gy,[zy,(0,o.eW)(),Jy,Zy,(0,o.bF)(n,{initSourceData:e.sch1Data.date,minDate:e.minDate,onUpdateDate:e.updateScheDate1},null,8,["initSourceData","minDate","onUpdateDate"]),qy,(0,o.bF)(r,{options:e.employeeList,displayKey:"commonName",selected:e.sch1Data.employee,onSelectOption:e.selectEmployee1},null,8,["options","selected","onSelectOption"]),ef,(0,o.Lk)("label",null,(0,h.v_)(e.sch1Data.employeeNo),1),tf,(0,o.Lk)("span",null,(0,h.v_)(e.sch1Data.scheduleDetail?.positionTitle),1),af,(0,o.Lk)("span",null,(0,h.v_)(e.sch1Data.startTime),1),lf,(0,o.Lk)("span",null,(0,h.v_)(e.sch1Data.endTime),1),sf,(0,o.Lk)("span",null,(0,h.v_)(e.sch1Data.scheduleDetail?.breakLength),1),of,(0,o.Lk)("span",null,(0,h.v_)(e.sch1Data.hours),1),e.sch1Data.scheduleDetail?.shiftId?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[nf,(0,o.Lk)("span",null,(0,h.v_)(e.sch1Data.scheduleDetail?.shiftId),1)],64)):(0,o.Q3)("",!0),rf,(0,o.Lk)("span",null,(0,h.v_)(e.sch1Data.notes),1)]),(0,o.Lk)("div",cf,[df,(0,o.eW)(),uf,hf,(0,o.bF)(n,{initSourceData:e.sch2Data.date,minDate:e.minDate,onUpdateDate:e.updateScheDate2},null,8,["initSourceData","minDate","onUpdateDate"]),mf,(0,o.bF)(r,{options:e.employeeList,displayKey:"commonName",selected:e.sch2Data.employee,onSelectOption:e.selectEmployee2},null,8,["options","selected","onSelectOption"]),pf,(0,o.Lk)("label",null,(0,h.v_)(e.sch2Data.employeeNo),1),e.sch2Data&&e.sch2Data.employee&&e.sch2Data.date?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[yf,(0,o.Lk)("span",null,(0,h.v_)(e.sch2Data.scheduleDetail?.positionTitle),1),ff,(0,o.Lk)("span",null,(0,h.v_)(e.sch2Data.startTime),1),kf,(0,o.Lk)("span",null,(0,h.v_)(e.sch2Data.endTime),1),vf,(0,o.Lk)("span",null,(0,h.v_)(e.sch2Data.scheduleDetail?.breakLength),1),gf,(0,o.Lk)("span",null,(0,h.v_)(e.sch2Data.hours),1),e.sch2Data.scheduleDetail?.shiftId?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[Df,(0,o.Lk)("span",null,(0,h.v_)(e.sch2Data.scheduleDetail?.shiftId),1)],64)):(0,o.Q3)("",!0),Sf,(0,o.Lk)("span",null,(0,h.v_)(e.sch2Data.notes),1)],64)):(0,o.Q3)("",!0)])])])),footer:(0,o.k6)((()=>[(0,o.Lk)("div",bf,[(0,o.Lk)("div",Cf,[(0,o.Lk)("button",{class:"white small copy2",onClick:t[0]||(t[0]=t=>e.swap())}," Swap "),(0,o.Lk)("button",{class:"orange small copy2 ml-4",onClick:t[1]||(t[1]=t=>e.close())}," Cancel ")])])])),_:1},8,["onCancel"])}const wf=["value"];function Lf(e,t,a,l,s,i){const n=(0,o.g2)("date-picker");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("input",{ref:"InputRef",value:e.$filters.reformatDate(e.pickerDate),class:"d-inline-flex ma-0 pa-0 mr-2 caption",style:{"max-width":"120px"},onChange:t[0]||(t[0]=t=>e.updateDateText(t)),onClick:t[1]||(t[1]=t=>e.updateDateTime(t)),"onClick:clear":t[2]||(t[2]=t=>e.pickerDate=null)},null,40,wf),(0,o.bF)(n,{ref:"DatePickerRef",top:e.datePickerTop,left:e.datePickerLeft,minDate:e.minDate},null,8,["top","left","minDate"])])}var Tf=(0,o.pM)({name:"DatePickerInput",components:{DatePicker:$a},props:{initSourceData:{type:String,default:null},minDate:{type:Object,default:null}},setup(e,{emit:t}){const a=(0,s.KR)(Be()()),l=(0,s.KR)(!1),o=(0,s.KR)(0),i=(0,s.KR)(0),n=(0,s.KR)(),r=(0,s.KR)();e.initSourceData&&(a.value=Be()(e.initSourceData));const c=e=>{const s=e.target;a.value=Be()(s.value,"DD/MM/YYYY"),l.value=!1,console.log("updated date text"),t("updateDate",a.value)},d=e=>{console.log("updateDateTime",e);const s=e.target;let r=s.getClientRects()[0];o.value=r.bottom,i.value=r.left,l.value=!0,n.value.toggleShow(a.value).then((e=>{console.log("picker val",e),a.value=e,t("updateDate",a.value)})).catch((e=>{console.log("picker err",e)}))};return{pickerDate:a,updateDateText:c,updateDateTime:d,datePickerTop:o,datePickerLeft:i,DatePickerRef:n,InputRef:r}}});const xf=(0,ke.A)(Tf,[["render",Lf],["__scopeId","data-v-5b09a712"]]);var Af=xf;async function Ff(e,t){console.log("sourceScheInput",e);const a=$e().cloneDeep(e),l=$e().cloneDeep(t);return await Mf(e),await Mf(t),a.date=l.date,a.employeeNo=l.employeeNo,l.date=e.date,l.employeeNo=e.employeeNo,await Nf(a),await Nf(l),!0}function Nf(e){const t=Be()(e.date).format(ch),[a,l]=hh(t,e.startTime,e.endTime),s={EmployeeNo:e.employeeNo,Date:t,StartTime:a,EndTime:l,Hours:e.hours,PublishStatus:e.publishStatus,ScheduleType:"Flex",ScheduleData:{ShiftId:e.scheduleDetail.shiftId?e.scheduleDetail.shiftId:"",BreakLength:e.scheduleDetail.breakLength,Position:e.scheduleDetail.position,CostElement1:e.scheduleDetail.costElement1?e.scheduleDetail.costElement1.id:"",CostElement2:e.scheduleDetail.costElement2?e.scheduleDetail.costElement2.id:""},Notes:e.notes};return ye.CreateFlexSchedule([s])}function Mf(e){const t=Be()(e.date).format(ch),[a,l]=hh(t,e.startTime,e.endTime);let s={Id:e.id,EmployeeNo:e.employeeNo,Date:t,StartTime:a,EndTime:l,Hours:e.hours,PublishStatus:e.publishStatus,ScheduleData:{ShiftId:e.scheduleDetail.shiftId,BreakLength:e.scheduleDetail.breakLength,Position:e.scheduleDetail.position,CostElement1:e.scheduleDetail.costElement1?e.scheduleDetail.costElement1.id:void 0,CostElement2:e.scheduleDetail.costElement2?e.scheduleDetail.costElement2.id:void 0},Notes:e.notes};return ye.DeleteFlexSchedule(s)}var Pf=(0,o.pM)({components:{Modal:Re,CustomSelect:fo,DatePickerInput:Af},setup(e,t){const a=(0,je.Pj)(),l=(0,s.KR)([]),i=(0,s.KR)({}),n=(0,s.KR)({}),r=(0,s.KR)(Be()().subtract(2,"days")),c=(0,s.KR)();function d(e){console.log("selectEmployee1",e),i.value.employee=e,i.value.employeeName=e.employeeName,i.value.employeeNo=e.employeeNo,(0,o.dY)(h)}function u(e){console.log("selectEmployee2",e),n.value.employee=e,n.value.employeeName=e.employeeName,n.value.employeeNo=e.employeeNo,(0,o.dY)(m)}function h(){if(!g(i.value))return;console.log("sch2Data",i.value);const e=Be()(i.value.date).format("YYYY-MM-DD"),t={employeeNo:i.value.employeeNo,startDate:e,endDate:e,forManagedEmployees:!1};ye.GetFlexSchedules(t).then((e=>{console.log("res",e);const t=e.FlexSchedules[0];t?(i.value.scheduleDetail=ct(t.ScheduleData),i.value.startTime=t.StartTime?Be()(t.StartTime).format("HH:mm"):"",i.value.endTime=t.EndTime?Be()(t.EndTime).format("HH:mm"):"",i.value.hours=t.Hours,i.value.scheduleType=t.ScheduleType,i.value.notes=t.Notes,i.value.id=t.Id):f()}))}function m(){if(!g(n.value))return;console.log("sch2Data",n.value);const e=Be()(n.value.date).format("YYYY-MM-DD"),t={employeeNo:n.value.employeeNo,startDate:e,endDate:e,forManagedEmployees:!1};ye.GetFlexSchedules(t).then((e=>{console.log("res",e);const t=e.FlexSchedules[0];t?(n.value.scheduleDetail=ct(t.ScheduleData),n.value.startTime=t.StartTime?Be()(t.StartTime).format("HH:mm"):"",n.value.endTime=t.EndTime?Be()(t.EndTime).format("HH:mm"):"",n.value.hours=t.Hours,n.value.notes=t.Notes,n.value.scheduleType=t.ScheduleType,n.value.id=t.Id,n.value.publishStatus=t.PublishStatus):k()}))}function p(e){n.value.date=e.format(),(0,o.dY)(m)}function y(e){i.value.date=e.format(),(0,o.dY)(h)}function f(){i.value.scheduleDetail=null,i.value.startTime=void 0,i.value.endTime=void 0,i.value.hours=void 0,i.value.notes=void 0,i.value.scheduleType="",i.value.id=void 0}function k(){n.value.scheduleDetail=null,n.value.startTime=void 0,n.value.endTime=void 0,n.value.hours=void 0,n.value.notes=void 0,n.value.scheduleType="",n.value.id=void 0}function v(e){return l.value.find((t=>t.employeeNo===e))}function g(e){return""!==e.date&&null!==e.employee}function D(){c.value.toggleShow(!0),i.value=$e().clone(a.state.FlexSchedule.selectedFlexDay),l.value=a.getters[Os.getEmployees],console.log("flex day",i.value),i.value.employee=v(i.value.employeeNo),n.value.date=Be()(i.value.date).add(1,"days").format()}async function S(){console.log("sch1Data",i.value),console.log("sch2Data",n.value),i.value.hours?n.value.employee?n.value.date?n.value.employee||n.value.date?n.value.hours?"published"===i.value.publishStatus&&"published"===n.value.publishStatus?Ma.confirmOrCancel({message:"Are you sure you want to swap this schedule?"}).then((async()=>{try{Ma.loading(),await Ff(i.value,n.value),C(),Ma.clear(),t.emit("reload")}catch(e){Ma.alert("Swap Schedule failed.")}}),(()=>{Ma.clear()})):Ma.alert("You can only swap published schedules."):Ma.alert("The schedule 2 employee currently has no schedule."):Ma.alert("Please select an employee and date for schedule 2."):Ma.alert("Please select the date for schedule 2."):Ma.alert("Please select an employee for schedule 2."):Ma.alert("Please select an employee and date for schedule 1.")}function b(){f(),k(),n.value.employee=null,n.value.employeeNo=null}function C(){b(),c.value.toggleShow(!1)}function E(){b()}return n.value.date=Be()().format(),console.log("employeeList",l.value),{employeeList:l,sch1Data:i,sch2Data:n,minDate:r,ModalRef:c,selectEmployee1:d,selectEmployee2:u,updateScheDate1:y,updateScheDate2:p,open:D,close:C,cancelSwap:E,swap:S,getSch1Data:h,getSche2Data:m}}});const Of=(0,ke.A)(Pf,[["render",Ef],["__scopeId","data-v-0b927762"]]);var Wf,Rf=Of;(function(e){e["empty"]="",e["draft"]="draft",e["published"]="published",e["partial"]="partial"})(Wf||(Wf={}));var If=(0,o.pM)({name:"FlexSchedule",components:{FlexScheduleCalendar:by,SwapSchedule:Rf,TopFilters:Ky,FlexScheduleCostCenter:Bm,CostAnalysisDialog:zc,AnalysisChart:fc,DraftCreationDialog:yu,DatePicker:$a,TimePicker:qr,EditFlexSchedule:yh,DayCell:Yd,FlexScheduleCellControl:Om,Icon:_p.In,AutoComplete:Js,ExtraEmpDetail:bm,PublishDialog:dp,CustomSelect:fo,FlexScheduleMultiColumn:zp},data(){return{dayFocus:Be()(),weekDays:[],weekStart:Be()().startOf("week"),weekEnd:Be()().endOf("week"),datePickerTop:0,datePickerLeft:0,employeeList:[],employeeHeightArr:[],scheduleWeekMap:new Map,weekStatus:Wf.empty,initialFSData:null,showControl:!1,extraEmpDetail:[],isAdmin:!1,hasFuturePaidDate:!1,costCenterOptions:[],selectableColumns:[],gridColumnsStyle:{},tableMinWidthStyle:{},manageCompanyConfig:null}},setup(){const e=(0,pt.rd)();nt()&&e.push({name:"FlexScheduleMobile"});const t=(0,je.Pj)(),a=(0,s.KR)(),l=(0,s.KR)(),o=(0,s.KR)(),i=(0,s.KR)(),n=(0,s.KR)(),r=(0,s.KR)(),c=(0,s.KR)(!1),d=(0,s.KR)([]),u=(0,s.KR)({}),h=(0,s.KR)(),m=(0,s.KR)(),p=t.state.FlexSchedule.flexScheduleCellSetting;function y(){r.value.open()}function f(){a.value.toggleShow()}function k(){i.value.toggleShow()}function v(){n.value.toggleShow()}function g(e){c.value=e,l.value.openEdit()}function D(e){Ma.loading(),ye.GetEmployeeExtraDetail(e).then((e=>{d.value=e.map((e=>("DateTime"===e.InputType?(e.remoteKeyValue=e.KeyValue,e.remoteValue=e.Value,e.KeyValue=Be()(e.KeyValue).format("ddd DD MMM YYYY"),e.Value=Be()(e.Value).format("ddd DD MMM YYYY")):"Double"===e.InputType&&(e.remoteKeyValue=e.KeyValue,e.remoteValue=e.Value,e.KeyValue=Math.round(100*e.KeyValue)/100,e.Value=Math.round(100*e.Value)/100),e))),Ma.clear(),o.value.toggleShow()}),(e=>{Ma.clear(),Ma.alert("Something went wrong")}))}function S(){m.value.open()}function b(){h.value.printFlexSchedule()}return t.commit(Je.resetState),{openDraftDialog:f,openEditDialog:g,openEmployeeDetail:D,openAnalysisChart:k,openSwapSche:S,printFlexSchedule:b,openPublishDialog:v,openCostAnalysis:y,DraftCreationDialogRef:a,EditModalRef:l,ExtraEmpDetailRef:o,AnalysisChartRef:i,PublishDialogRef:n,CostAnalysisDialogRef:r,FlexScheduleCalendarRef:h,SwapScheduleRef:m,TableNameRef:u,isEditingDialog:c,externalDetail:d,cellSettings:p}},async mounted(){this.manageCompanyConfig=(0,o.WQ)("MANAGE_COMPANY_CONFIG"),this.$store.dispatch(Nd.getPositions,Affinity.user.EmployeeNo),this.$store.dispatch(Nd.getShifts),this.$store.dispatch(Nd.getCostElement),await this.$store.dispatch(Nd.getWorkTypes),this.manageCompanyConfig.getAllowSundayFirst()?(this.weekStart=this.dayFocus.clone().startOf("week"),this.weekEnd=this.dayFocus.clone().endOf("week")):(this.weekStart=this.dayFocus.clone().startOf("isoWeek"),this.weekEnd=this.dayFocus.clone().endOf("isoWeek")),ye.GetDefaultWorkTypes().then((e=>{this.$store.state.FlexSchedule.defaultWorkTypes=e})),Affinity.user.EmployeeNo>=5e6&&(this.isAdmin=!0),this.selectableColumns=this.$store.state.FlexSchedule.selectableColumn},methods:{reloadAfterEdit(){console.log("reload requested"),this.FlexScheduleCalendarRef.reloadAfterEdit()},changeWeek(e){console.log("changed week",e),this.dayFocus=e,this.manageCompanyConfig.getAllowSundayFirst()?(this.weekStart=this.dayFocus.clone().startOf("week"),this.weekEnd=this.dayFocus.clone().endOf("week")):(this.weekStart=this.dayFocus.clone().startOf("isoWeek"),this.weekEnd=this.dayFocus.clone().endOf("isoWeek"))},selectEmployeeAndPublish(){this.PublishDialogRef.setSelectedDate(this.dayFocus.week().toString()),this.openPublishDialog()},publishCurrentWeek(e){this.manageCompanyConfig.getAllowSundayFirst()?(this.weekStart=this.dayFocus.clone().startOf("week"),this.weekEnd=this.dayFocus.clone().endOf("week")):(this.weekStart=this.dayFocus.clone().startOf("isoWeek"),this.weekEnd=this.dayFocus.clone().endOf("isoWeek"));let t={EmployeeNumbers:e,DateFrom:this.weekStart.format("YYYY-MM-DD"),DateTo:this.weekEnd.format("YYYY-MM-DD")};Ma.loading(),ye.PublishFlexSchedule(t).then((()=>{Ma.clear(),this.FlexScheduleCalendarRef.reloadAfterEdit()}),(e=>{408!=e.response.status?(console.error(e),Ma.alert("Something went wrong.")):Ma.alert("Your schedules are being published. This process can take a few minutes. You will need to refresh your screen to see the published schedules.")}))},changeDisplayControl(){this.showControl=!this.showControl}}});const Yf=(0,ke.A)(If,[["render",$r],["__scopeId","data-v-00304566"]]);var _f=Yf;const Hf=e=>((0,o.Qi)("data-v-55a1c796"),e=e(),(0,o.jt)(),e),Xf={class:"mt-4"},jf=(0,o.Fv)('<div class="left-box" data-v-55a1c796><div class="background-legend" data-v-55a1c796><div data-v-55a1c796><div class="flexi-legend" data-v-55a1c796></div><div class="legend-label" data-v-55a1c796>Flexi Schedule</div></div><div data-v-55a1c796><div class="team-legend" data-v-55a1c796></div><div class="legend-label" data-v-55a1c796>Team Schedule</div></div><div data-v-55a1c796><div class="personal-legend" data-v-55a1c796></div><div class="legend-label" data-v-55a1c796>Personal Schedule</div></div></div></div>',1),Vf={class:"weekDetail d-flex align-center justify-center"},$f={class:"mt-4",style:{overflow:"auto"}},Kf={class:"flex-sche-table"},Bf=Hf((()=>(0,o.Lk)("div",{class:"table-head"},[(0,o.Lk)("div",{class:"schedule-head-grid"},[(0,o.Lk)("div",{class:"table-cell"},"Employee"),(0,o.Lk)("div",{class:"table-cell"},"Schedule")])],-1))),Uf={class:"table-body"},Qf={class:"schedules-arr"},Gf=["onClick"],zf={key:0,class:"published-icon"},Jf=Hf((()=>(0,o.Lk)("span",null,"P",-1))),Zf=[Jf],qf={class:"content-cell"};function ek(e,t,a,l,s,i){const n=(0,o.g2)("Icon"),r=(0,o.g2)("day-cell"),c=(0,o.g2)("perfect-scrollbar"),d=(0,o.g2)("edit-flex-schedule"),u=(0,o.g2)("date-picker"),m=(0,o.g2)("extra-emp-detail"),p=(0,o.g2)("swap-schedule");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",Xf,[jf,(0,o.Lk)("div",Vf,[(0,o.Lk)("span",{class:"arrow-height mr-4",onClick:t[0]||(t[0]=t=>e.getLastDate())},[(0,o.bF)(n,{icon:e.$icons.chevronLeft,height:"30",style:{color:"#0000008a"}},null,8,["icon"])]),(0,o.Lk)("span",{onClick:t[1]||(t[1]=(...t)=>e.chooseCalendarDate&&e.chooseCalendarDate(...t))},(0,h.v_)(e.$filters.ordinalSuffix(e.dayFocus.week()))+" Week, "+(0,h.v_)(e.dayFocus.format("DD/MM/YYYY")),1),(0,o.Lk)("span",{class:"arrow-height ml-4",onClick:t[2]||(t[2]=t=>e.getNextDate())},[(0,o.bF)(n,{icon:e.$icons.chevronRight,height:"30",style:{color:"#0000008a"}},null,8,["icon"])])])]),(0,o.Lk)("div",$f,[(0,o.Lk)("div",Kf,[Bf,(0,o.bF)(c,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",Uf,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.scheduleWeekMap.keys(),(t=>((0,o.uX)(),(0,o.CE)("div",Qf,[(0,o.Lk)("div",{class:"content-cell content-employee-name",onClick:a=>e.openEmployeeDetail(t)},[(0,o.Lk)("span",null,(0,h.v_)(e.scheduleWeekMap.get(t).employeeName),1),"published"===e.scheduleWeekMap.get(t).empSchePublishState?((0,o.uX)(),(0,o.CE)("span",zf,Zf)):(0,o.Q3)("",!0)],8,Gf),(0,o.Lk)("div",qf,[(0,o.bF)(r,{scheDay:e.scheduleWeekMap.get(t).sche,employeeNo:e.scheduleWeekMap.get(t).employeeNo,employeeName:e.scheduleWeekMap.get(t).employeeName,allowEdit:!0,allowCreate:!0,isEmployee:!1,onOpenEditDialog:e.openEditDialog},null,8,["scheDay","employeeNo","employeeName","onOpenEditDialog"])])])))),256))])])),_:1})])]),(0,o.Lk)("div",null,[(0,o.bF)(d,{ref:"EditModalRef",isEdit:e.isEditingDialog,weekStatus:e.weekStatus,modalIndex:1999,onSwapSche:e.openSwapSche,onReload:e.reloadAfterEdit},null,8,["isEdit","weekStatus","onSwapSche","onReload"]),(0,o.bF)(u,{ref:"DatePickerRef",top:e.datePickerTop,left:e.datePickerLeft},null,8,["top","left"]),(0,o.bF)(m,{ref:"ExtraEmpDetailRef",externalDetail:e.externalDetail},null,8,["externalDetail"]),(0,o.bF)(p,{ref:"SwapScheduleRef",modalIndex:1999,onReload:e.reloadAfterEdit},null,8,["onReload"])])],64)}var tk;(function(e){e["empty"]="",e["draft"]="draft",e["published"]="published",e["partial"]="partial"})(tk||(tk={}));var ak=(0,o.pM)({name:"FlexScheduleM",components:{CostAnalysisDialog:zc,AnalysisChart:fc,PrintableView:gy,DraftCreationDialog:yu,DatePicker:$a,TimePicker:qr,EditFlexSchedule:yh,DayCell:Yd,FlexScheduleCellControl:Om,Icon:_p.In,AutoComplete:Js,ExtraEmpDetail:bm,PublishDialog:dp,SwapSchedule:Rf},data(){return{dayFocus:Be()(),weekDays:[],datePickerTop:0,datePickerLeft:0,employeeList:[],scheduleWeekMap:new Map,weekStatus:tk.empty,showControl:!1,extraEmpDetail:[],isAdmin:!1,hasFuturePaidDate:!1}},setup(){const e=(0,s.KR)(),t=(0,s.KR)(),a=(0,s.KR)(),l=(0,s.KR)(!1),o=(0,s.KR)([]),i=(0,pt.rd)();function n(t){l.value=t,e.value.openEdit()}function r(e){Ma.loading(),ye.GetEmployeeExtraDetail(e).then((e=>{o.value=e.map((e=>("DateTime"===e.InputType?(e.remoteKeyValue=e.KeyValue,e.remoteValue=e.Value,e.KeyValue=Be()(e.KeyValue).format("ddd DD MMM YYYY"),e.Value=Be()(e.Value).format("ddd DD MMM YYYY")):"Double"===e.InputType&&(e.remoteKeyValue=e.KeyValue,e.remoteValue=e.Value,e.KeyValue=Math.round(100*e.KeyValue)/100,e.Value=Math.round(100*e.Value)/100),e))),Ma.clear(),t.value.toggleShow()}),(e=>{Ma.clear(),Ma.alert("Something went wrong")}))}function c(){a.value.open()}return console.log("window.innerWidth",window.innerWidth),nt()||i.push({name:"Flex Schedule"}),{EditModalRef:e,ExtraEmpDetailRef:t,SwapScheduleRef:a,isEditingDialog:l,externalDetail:o,openEditDialog:n,openEmployeeDetail:r,openSwapSche:c}},async mounted(){this.$store.dispatch(Nd.getPositions,Affinity.user.EmployeeNo),this.$store.dispatch(Nd.getShifts),this.$store.dispatch(Nd.getCostElement),this.$store.dispatch(Nd.getWorkTypes),this.loadDate(),ye.GetDefaultWorkTypes().then((e=>{this.$store.state.FlexSchedule.defaultWorkTypes=e})),Affinity.user.EmployeeNo>=5e6&&(this.isAdmin=!0)},methods:{showCopy(){return!this.hasFuturePaidDate&&Be()().diff(this.dayFocus.endOf("week"),"day")<=0},reloadAfterEdit(){this.loadDate()},getCurrentWeekStatus(){return this.weekStatus===tk.empty||this.weekStatus===tk.draft?"Draft":this.weekStatus===tk.partial?"Partially Published":this.weekStatus===tk.published?"Published":this.weekStatus},async loadDate(){this.weekStatus=tk.empty,this.showControl=!1,this.hasFuturePaidDate=!1;let e={managerEmployeeNo:Affinity.user.EmployeeNo,dateFrom:this.dayFocus.format("YYYY-MM-DD"),dateTo:this.dayFocus.format("YYYY-MM-DD")};Ma.loading();let[t,a,l]=await Promise.all([this.$store.dispatch(ze.loadFlexiSchedules,{startDate:this.dayFocus,endDate:this.dayFocus,employeeNo:Affinity.user.EmployeeNo}),ye.GetManagedLeaves(e),this.$store.dispatch(Rs.getEmployees,Affinity.user.EmployeeNo).then((e=>e.map((e=>({employeeName:e.commonName,employeeNo:e.employeeNo,stdHoursPerWeek:e.stdHoursPerWeek,positionCode:e.positionCode})))))]).finally((()=>{Ma.clear()}));Ma.clear();let s=Yp.prepareGridDataMobile(this.dayFocus,l,t);this.scheduleWeekMap=s,Yp.addUnAvaToGridMobile(t,s),Yp.addLeaveToGridMobile(a,s)},checkStatus(e){let t=new Set;for(const a of e.values()){a.empSchePublishState="";for(const e of a.sche)e.publishStatus&&(e.publishStatus===tk.draft?a.empSchePublishState=tk.draft:e.publishStatus===tk.published&&(a.empSchePublishState=tk.published)),!this.hasFuturePaidDate&&e.isPaid&&Be()(0,"HH").diff(Be()(e.date),"days")<=-1&&(this.hasFuturePaidDate=!0);""===a.empSchePublishState?t.add(tk.empty):t.add(a.empSchePublishState)}t.has(tk.published)?t.has(tk.draft)&&t.has(tk.published)||t.has(tk.empty)&&t.has(tk.published)?this.weekStatus=tk.partial:this.weekStatus=tk.published:this.weekStatus=tk.draft},async chooseCalendarDate(e){let t,a=e.target.getClientRects()[0];this.datePickerTop=a.bottom,this.datePickerLeft=a.left;try{t=await this.$refs.DatePickerRef.toggleShow(this.dayFocus)}catch(l){return}await this.selectDate(t)},async selectDate(e){this.dayFocus=e,this.$store.state.FlexSchedule.calendarFocusDate=e,await this.loadDate()},getSelectedWeek(e){var t=e.clone().startOf("week");e.clone().endOf("week");let a=[];for(let l=0;l<=6;l++){let e=Be()(t).add(l,"days");a.push({momentDay:e,day:e.format("ddd, MMM Do")})}return a},getLastDate(){this.dayFocus=this.dayFocus.clone().subtract(1,"days"),this.$store.state.FlexSchedule.calendarFocusDate=this.dayFocus,this.loadDate()},getNextDate(){this.dayFocus=this.dayFocus.clone().add(1,"days"),this.$store.state.FlexSchedule.calendarFocusDate=this.dayFocus,this.loadDate()},moreDetail(e){this.$store.commit(Je.setScheduleDay,e)},getTotalHour(e){let t=0;for(let a of e)a.hours&&(t+=a.hours);return t.toFixed(2)},confirmEdit(e){e.editing=!1},cancelEdit(e){},editScheDay(e){e.editing=!0},publishCurrentWeek(e){let t=this.dayFocus.clone().startOf("week"),a=this.dayFocus.clone().endOf("week"),l={EmployeeNumbers:e,DateFrom:t.format("YYYY-MM-DD"),DateTo:a.format("YYYY-MM-DD")};Ma.loading(),ye.PublishFlexSchedule(l).then((()=>{this.reloadAfterEdit(),Ma.clear()}),(e=>{console.error(e),Ma.alert("Something went wrong.")}))},changeDisplayControl(){this.showControl=!this.showControl}}});const lk=(0,ke.A)(ak,[["render",ek],["__scopeId","data-v-55a1c796"]]);var sk=lk;const ok={key:0};function ik(e,t,a,l,s,i){const n=(0,o.g2)("TopFilters"),r=(0,o.g2)("FlexScheduleCalendar");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(n,{isEmployee:!0,onChangeWeek:e.changeWeek},null,8,["onChangeWeek"]),e.managerNo&&e.weekStart?((0,o.uX)(),(0,o.CE)("div",ok,[(0,o.bF)(r,{ref:"FlexScheduleCalendarRef",dayFocus:e.dayFocus,weekStart:e.weekStart,weekEnd:e.weekEnd,isEmployee:!0},null,8,["dayFocus","weekStart","weekEnd"])])):(0,o.Q3)("",!0)],64)}var nk;(function(e){e["empty"]="",e["draft"]="draft",e["published"]="published",e["partial"]="partial"})(nk||(nk={}));var rk=(0,o.pM)({name:"FlexSchedule",components:{FlexScheduleCalendar:by,TopFilters:Ky},data(){return{weekStart:null,weekEnd:null,managerNo:null,dayFocus:Be()(),weekDays:[],datePickerTop:0,datePickerLeft:0,employeeList:[],employeeHeightArr:[],scheduleWeekMap:new Map,weekStatus:nk.empty,showControl:!1,extraEmpDetail:[],isAdmin:!1,hasFuturePaidDate:!1,costCenterOptions:[],gridColumnsStyle:{},tableMinWidthStyle:{},manageCompanyConfig:null}},setup(){const e=(0,pt.rd)(),t=(0,s.KR)({}),a=(0,je.Pj)(),l=(0,s.KR)(),o=a.state.FlexSchedule.flexScheduleCellSetting;return nt()&&e.push({name:"EmployeeTeamScheduleMobile"}),a.commit(Je.resetState),{FlexScheduleCalendarRef:l,TableNameRef:t,cellSettings:o}},async mounted(){this.manageCompanyConfig=(0,o.WQ)("MANAGE_COMPANY_CONFIG");const e=await ye.getMyManager();this.$store.state.EmployeeModule.managerNo=e[0].EmployeeNo,this.managerNo=e[0].EmployeeNo,this.$store.dispatch(Nd.getPositions,this.managerNo),this.$store.dispatch(Nd.getShifts),this.$store.dispatch(Nd.getCostElement),await this.$store.dispatch(Nd.getWorkTypes),this.manageCompanyConfig.getAllowSundayFirst()?(this.weekStart=this.dayFocus.clone().startOf("week"),this.weekEnd=this.dayFocus.clone().endOf("week")):(this.weekStart=this.dayFocus.clone().startOf("isoWeek"),this.weekEnd=this.dayFocus.clone().endOf("isoWeek")),ye.GetDefaultWorkTypes().then((e=>{this.$store.state.FlexSchedule.defaultWorkTypes=e}))},methods:{reloadAfterEdit(){console.log("reload requested"),this.FlexScheduleCalendarRef.reloadAfterEdit()},changeWeek(e){console.log("changed week",e),this.dayFocus=e,this.manageCompanyConfig.getAllowSundayFirst()?(this.weekStart=this.dayFocus.clone().startOf("week"),this.weekEnd=this.dayFocus.clone().endOf("week")):(this.weekStart=this.dayFocus.clone().startOf("isoWeek"),this.weekEnd=this.dayFocus.clone().endOf("isoWeek"))}}});const ck=(0,ke.A)(rk,[["render",ik],["__scopeId","data-v-77ec3ea9"]]);var dk=ck;const uk=e=>((0,o.Qi)("data-v-3ef779ad"),e=e(),(0,o.jt)(),e),hk={class:"mt-4"},mk=(0,o.Fv)('<div class="left-box" data-v-3ef779ad><div class="background-legend" data-v-3ef779ad><div data-v-3ef779ad><div class="flexi-legend" data-v-3ef779ad></div><div class="legend-label" data-v-3ef779ad>Flexi Schedule</div></div><div data-v-3ef779ad><div class="team-legend" data-v-3ef779ad></div><div class="legend-label" data-v-3ef779ad>Team Schedule</div></div><div data-v-3ef779ad><div class="personal-legend" data-v-3ef779ad></div><div class="legend-label" data-v-3ef779ad>Personal Schedule</div></div></div></div>',1),pk={class:"weekDetail d-flex align-center justify-center"},yk={class:"mt-4",style:{overflow:"auto"}},fk={class:"flex-sche-table"},kk=uk((()=>(0,o.Lk)("div",{class:"table-head"},[(0,o.Lk)("div",{class:"schedule-head-grid"},[(0,o.Lk)("div",{class:"table-cell"},"Employee"),(0,o.Lk)("div",{class:"table-cell"},"Schedule")])],-1))),vk={class:"table-body"},gk={class:"schedules-arr"},Dk={class:"content-cell content-employee-name"},Sk={class:"content-cell"};function bk(e,t,a,l,s,i){const n=(0,o.g2)("Icon"),r=(0,o.g2)("day-cell"),c=(0,o.g2)("perfect-scrollbar");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",hk,[mk,(0,o.Lk)("div",pk,[(0,o.Lk)("span",{class:"arrow-height mr-4",onClick:t[0]||(t[0]=t=>e.getLastDate())},[(0,o.bF)(n,{icon:e.$icons.chevronLeft,height:"30",style:{color:"#0000008a"}},null,8,["icon"])]),(0,o.Lk)("span",{onClick:t[1]||(t[1]=(...t)=>e.chooseCalendarDate&&e.chooseCalendarDate(...t))},(0,h.v_)(e.$filters.ordinalSuffix(e.dayFocus.week()))+" Week, "+(0,h.v_)(e.dayFocus.format("DD/MM/YYYY")),1),(0,o.Lk)("span",{class:"arrow-height ml-4",onClick:t[2]||(t[2]=t=>e.getNextDate())},[(0,o.bF)(n,{icon:e.$icons.chevronRight,height:"30",style:{color:"#0000008a"}},null,8,["icon"])])])]),(0,o.Lk)("div",yk,[(0,o.Lk)("div",fk,[kk,(0,o.bF)(c,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",vk,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.scheduleWeekMap.keys(),(t=>((0,o.uX)(),(0,o.CE)("div",gk,[(0,o.Lk)("div",Dk,[(0,o.Lk)("span",null,(0,h.v_)(e.scheduleWeekMap.get(t).employeeName),1)]),(0,o.Lk)("div",Sk,[(0,o.bF)(r,{scheDay:e.scheduleWeekMap.get(t).sche,employeeNo:e.scheduleWeekMap.get(t).employeeNo,employeeName:e.scheduleWeekMap.get(t).employeeName,onOpenEditDialog:e.openEditDialog},null,8,["scheDay","employeeNo","employeeName","onOpenEditDialog"])])])))),256))])])),_:1})])])],64)}var Ck;(function(e){e["empty"]="",e["draft"]="draft",e["published"]="published",e["partial"]="partial"})(Ck||(Ck={}));var Ek=(0,o.pM)({name:"FlexScheduleM",components:{DatePicker:$a,TimePicker:qr,EditFlexSchedule:yh,DayCell:Yd,FlexScheduleCellControl:Om,Icon:_p.In,AutoComplete:Js},data(){return{dayFocus:Be()(),weekDays:[],datePickerTop:0,datePickerLeft:0,employeeList:[],scheduleWeekMap:new Map,weekStatus:Ck.empty,showControl:!1,extraEmpDetail:[],isAdmin:!1,hasFuturePaidDate:!1}},setup(){const e=(0,pt.rd)();return console.log("window.innerWidth",window.innerWidth),nt()||e.push({name:"EmployeeTeamSchedule"}),{}},async mounted(){this.$store.dispatch(Nd.getPositions,Affinity.user.EmployeeNo),this.$store.dispatch(Nd.getShifts),this.$store.dispatch(Nd.getCostElement),this.$store.dispatch(Nd.getWorkTypes),this.loadDate(),ye.GetDefaultWorkTypes().then((e=>{this.$store.state.FlexSchedule.defaultWorkTypes=e})),Affinity.user.EmployeeNo>=5e6&&(this.isAdmin=!0)},methods:{showCopy(){return!this.hasFuturePaidDate&&Be()().diff(this.dayFocus.endOf("week"),"day")<=0},reloadAfterEdit(){this.loadDate()},getCurrentWeekStatus(){return this.weekStatus===Ck.empty||this.weekStatus===Ck.draft?"Draft":this.weekStatus===Ck.partial?"Partially Published":this.weekStatus===Ck.published?"Published":this.weekStatus},async loadDate(){this.weekStatus=Ck.empty,this.showControl=!1,this.hasFuturePaidDate=!1;Affinity.user.EmployeeNo,this.dayFocus.format("YYYY-MM-DD"),this.dayFocus.format("YYYY-MM-DD");Ma.loading();let[e,t]=await Promise.all([this.$store.dispatch(ze.loadFlexiSchedules,{startDate:this.dayFocus,endDate:this.dayFocus,employeeNo:Affinity.user.EmployeeNo}),this.$store.dispatch(Rs.getEmployees,Affinity.user.EmployeeNo).then((e=>e.map((e=>({employeeName:e.commonName,employeeNo:e.employeeNo,stdHoursPerWeek:e.stdHoursPerWeek,positionCode:e.positionCode})))))]).finally((()=>{Ma.clear()}));Ma.clear();let a=Yp.prepareGridDataMobile(this.dayFocus,t,e);this.scheduleWeekMap=a},async chooseCalendarDate(e){let t,a=e.target.getClientRects()[0];this.datePickerTop=a.bottom,this.datePickerLeft=a.left;try{t=await this.$refs.DatePickerRef.toggleShow(this.dayFocus)}catch(l){return}await this.selectDate(t)},async selectDate(e){this.dayFocus=e,this.$store.state.FlexSchedule.calendarFocusDate=e,await this.loadDate()},getSelectedWeek(e){var t=e.clone().startOf("week");e.clone().endOf("week");let a=[];for(let l=0;l<=6;l++){let e=Be()(t).add(l,"days");a.push({momentDay:e,day:e.format("ddd, MMM Do")})}return a},getLastDate(){this.dayFocus=this.dayFocus.clone().subtract(1,"days"),this.$store.state.FlexSchedule.calendarFocusDate=this.dayFocus,this.loadDate()},getNextDate(){this.dayFocus=this.dayFocus.clone().add(1,"days"),this.$store.state.FlexSchedule.calendarFocusDate=this.dayFocus,this.loadDate()},moreDetail(e){this.$store.commit(Je.setScheduleDay,e)},getTotalHour(e){let t=0;for(let a of e)a.hours&&(t+=a.hours);return t.toFixed(2)}}});const wk=(0,ke.A)(Ek,[["render",bk],["__scopeId","data-v-3ef779ad"]]);var Lk=wk;const Tk=e=>((0,o.Qi)("data-v-f2f8a0e6"),e=e(),(0,o.jt)(),e),xk={class:"dbw-box"},Ak=Tk((()=>(0,o.Lk)("p",{class:"mt-4"},[(0,o.eW)("I am "),(0,o.Lk)("b",null,"unavailable"),(0,o.eW)(" during these times:")],-1))),Fk={class:"available-table"},Nk={class:"service-grid"},Mk=(0,o.Fv)('<div class="grid-heading" data-v-f2f8a0e6>Day of Week</div><div class="grid-heading" data-v-f2f8a0e6>Start Time</div><div class="grid-heading" data-v-f2f8a0e6>End Time</div><div class="grid-heading" data-v-f2f8a0e6>Repeat</div><div class="grid-heading" data-v-f2f8a0e6>Starts On</div><div class="grid-heading" data-v-f2f8a0e6>Ends On</div><div class="grid-heading" data-v-f2f8a0e6>Actions</div><div class="grid-heading" data-v-f2f8a0e6>Reason</div>',8),Pk={class:"grid-item"},Ok={class:"grid-item"},Wk={class:"grid-item"},Rk={class:"grid-item"},Ik={class:"grid-item"},Yk={class:"grid-item"},_k={class:"grid-item"},Hk=["onClick"],Xk=["onClick"],jk={class:"grid-item"},Vk={class:"d-flex justify-end mt-4 mb-4"};function $k(e,t,a,l,s,i){const n=(0,o.g2)("edit-availability");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",xk,[Ak,(0,o.Lk)("div",Fk,[(0,o.Lk)("div",null,[(0,o.Lk)("div",Nk,[Mk,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.gridData,(t=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",Pk,(0,h.v_)(t.dayOfWeek),1),(0,o.Lk)("div",Ok,(0,h.v_)(t.startTime),1),(0,o.Lk)("div",Wk,(0,h.v_)(t.endTime),1),(0,o.Lk)("div",Rk,(0,h.v_)(t.frequencyType),1),(0,o.Lk)("div",Ik,(0,h.v_)(t.startDate),1),(0,o.Lk)("div",Yk,(0,h.v_)(t.endDate),1),(0,o.Lk)("div",_k,[(0,o.Lk)("button",{class:"green white--text xsmall",onClick:a=>e.openEditDialog(!0,t)}," Edit ",8,Hk),(0,o.Lk)("button",{class:"grey white--text xsmall ml-2",onClick:a=>e.confirmDelete(t)}," Delete ",8,Xk)]),(0,o.Lk)("div",jk,(0,h.v_)(t.reason),1)],64)))),256))])])]),(0,o.Lk)("div",Vk,[(0,o.Lk)("button",{class:"green small white--text",onClick:t[0]||(t[0]=t=>e.openEditDialog(!1))}," Create ")])]),(0,o.bF)(n,{ref:"EditAvailabilityRef",isEdit:e.isEditingDialog,onReload:e.loadAvailability,modalIndex:1999},null,8,["isEdit","onReload"])],64)}const Kk=e=>((0,o.Qi)("data-v-1bf93356"),e=e(),(0,o.jt)(),e),Bk={class:"bold"},Uk={key:0},Qk={key:1},Gk={class:"edit-form mt-4 copy2"},zk={class:"form-control mt-4"},Jk=Kk((()=>(0,o.Lk)("label",{class:"form-label"},"Start Time ",-1))),Zk={class:"form-control"},qk=Kk((()=>(0,o.Lk)("label",{class:"form-label"},"End Time ",-1))),ev={class:"form-control"},tv=Kk((()=>(0,o.Lk)("label",{class:"form-label"},"Day of Week",-1))),av={class:"select-day-of-week"},lv={class:"form-control"},sv=Kk((()=>(0,o.Lk)("label",{class:"form-label"},"Repeat",-1))),ov={class:"select-repeat"},iv={class:"form-control"},nv=Kk((()=>(0,o.Lk)("label",{class:"form-label"},"Start On",-1))),rv={class:"form-control endDateWidth"},cv={key:0},dv=Kk((()=>(0,o.Lk)("label",{class:"form-label"},"End On",-1))),uv={class:"ml-2"},hv=Kk((()=>(0,o.Lk)("label",{class:"checkbox-label"},"No End Date",-1))),mv={class:"form-control"},pv=Kk((()=>(0,o.Lk)("label",{class:"form-label mb-1"},"Reason",-1))),yv={class:"mt-4 full-width d-flex justify-end"},fv=Kk((()=>(0,o.Lk)("span",{class:"white"},"Save",-1))),kv=[fv],vv=Kk((()=>(0,o.Lk)("span",{class:"white"},"Delete",-1))),gv=[vv],Dv=Kk((()=>(0,o.Lk)("span",{class:"white"},"Create",-1))),Sv=[Dv],bv=Kk((()=>(0,o.Lk)("span",{class:"white"},"Cancel",-1))),Cv=[bv];function Ev(e,t,a,s,i,n){const r=(0,o.g2)("custom-select"),c=(0,o.g2)("date-picker"),d=(0,o.g2)("Modal");return(0,o.uX)(),(0,o.Wv)(d,{ref:"ModalRef"},{header:(0,o.k6)((()=>[(0,o.Lk)("div",null,[(0,o.Lk)("h2",Bk,[e.isEdit?((0,o.uX)(),(0,o.CE)("span",Uk,"Edit Unavailability")):((0,o.uX)(),(0,o.CE)("span",Qk,"Create Unavailability"))])])])),body:(0,o.k6)((()=>[(0,o.Lk)("div",null,[(0,o.Lk)("div",Gk,[(0,o.Lk)("div",zk,[Jk,(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.startTime=t),onChange:t[1]||(t[1]=(...t)=>e.updateStartTime&&e.updateStartTime(...t))},null,544),[[l.Jo,e.startTime]])]),(0,o.Lk)("div",Zk,[qk,(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.endTime=t),onChange:t[3]||(t[3]=(...t)=>e.updateEndTime&&e.updateEndTime(...t))},null,544),[[l.Jo,e.endTime]])]),(0,o.Lk)("div",ev,[tv,(0,o.Lk)("div",av,[(0,o.bF)(r,{options:e.dayOfWeekOption,modelValue:e.selectedDayOfWeek,"onUpdate:modelValue":t[4]||(t[4]=t=>e.selectedDayOfWeek=t),modelModifiers:{modelValue:!0}},null,8,["options","modelValue"])])]),(0,o.Lk)("div",lv,[sv,(0,o.Lk)("div",ov,[(0,o.bF)(r,{options:e.repeatOption,modelValue:e.selectedRepeat,"onUpdate:modelValue":[t[5]||(t[5]=t=>e.selectedRepeat=t),e.updateRepeat],modelModifiers:{modelValue:!0}},null,8,["options","modelValue","onUpdate:modelValue"])])]),(0,o.Lk)("div",iv,[nv,(0,o.bo)((0,o.Lk)("input",{class:"input-box",type:"text","onUpdate:modelValue":t[6]||(t[6]=t=>e.startDateText=t),onChange:t[7]||(t[7]=t=>e.updateDateTimeText("startDate")),onClick:t[8]||(t[8]=t=>e.updateDateTime(t,"startDate"))},null,544),[[l.Jo,e.startDateText]])]),(0,o.Lk)("div",rv,[e.endDateDisable?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",cv,[dv,(0,o.bo)((0,o.Lk)("input",{class:"input-box",type:"text","onUpdate:modelValue":t[9]||(t[9]=t=>e.endDateText=t),onChange:t[10]||(t[10]=t=>e.updateDateTimeText("endDate")),onClick:t[11]||(t[11]=t=>e.updateDateTime(t,"endDate"))},null,544),[[l.Jo,e.endDateText]]),(0,o.Lk)("span",uv,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=t=>e.noEndDate=t),onChange:t[13]||(t[13]=(...t)=>e.clickedNoEndDate&&e.clickedNoEndDate(...t))},null,544),[[l.lH,e.noEndDate]]),hv])]))]),(0,o.Lk)("div",mv,[pv,(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[14]||(t[14]=t=>e.reason=t)},null,512),[[l.Jo,e.reason]])])]),(0,o.bF)(c,{ref:"DatePickerRef",top:e.datePickerTop,left:e.datePickerLeft},null,8,["top","left"])])])),footer:(0,o.k6)((()=>[(0,o.Lk)("div",yv,[e.isEdit?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"blue normal copy2",onClick:t[15]||(t[15]=t=>e.updateAvailability())},kv)):(0,o.Q3)("",!0),e.isEdit?((0,o.uX)(),(0,o.CE)("button",{key:1,class:"grey normal copy2 ml-2",onClick:t[16]||(t[16]=t=>e.confirmDelete())},gv)):(0,o.Q3)("",!0),e.isEdit?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:2,class:"blue normal copy2",onClick:t[17]||(t[17]=t=>e.createAvailability())},Sv)),(0,o.Lk)("button",{class:"ml-2 normal orange copy2",onClick:t[18]||(t[18]=t=>e.cancel())},Cv)])])),_:1},512)}const wv=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Lv=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Tv=["Once","Weekly","Fortnightly"];function xv(e){return Lv[wv.indexOf(e)]}function Av(e){return wv[Lv.indexOf(e)]}const Fv={shortWeekDays:wv,fullWeekDays:Lv,frequencyCycle:Tv,findFullDaysByShort:xv,findShortDayByFull:Av};var Nv=Fv,Mv=(0,o.pM)({name:"EditAvailability",components:{Modal:Re,CustomSelect:fo,DatePicker:$a},props:{isEdit:{type:Boolean},weekStatus:{type:String}},data(){return{ava:null,employeeNo:0,startTime:"",endTime:"",dayOfWeekOption:Nv.fullWeekDays,selectedDayOfWeek:"Monday",repeatOption:Nv.frequencyCycle,selectedRepeat:"Weekly",datePickerTop:0,datePickerLeft:0,startDate:Be()(),startDateText:"",endDate:Be()(),endDateText:"",reason:"",noEndDate:!0,endDateDisable:!1}},setup(){return{}},watch:{selectedDayOfWeek(e,t){}},methods:{reset(){this.ava=null,this.employeeNo=0,this.startTime="",this.endTime="",this.startDate=Be()(),this.startDateText="",this.endDate=Be()(),this.endDateText="",this.reason="",this.selectedRepeat="Weekly",this.noEndDate=!0,this.endDateDisable=!1},updateStartTime(){this.startTime=dt.parseTimeColumn(this.startTime)},updateEndTime(){this.endTime=dt.parseTimeColumn(this.endTime)},updateRepeat(){"Once"===this.selectedRepeat?this.endDateDisable=!0:this.endDateDisable=!1},clickedNoEndDate(){this.noEndDate&&(this.endDateText="",this.endDate=null)},createAvailability(){Ma.loading();let e=this.endDateText?this.endDate.format("DD/MMM/YYYY"):null;e=this.noEndDate||this.endDateDisable?null:e;let t=[{employeeNo:Affinity.user.EmployeeNo,startTime:this.startTime,endTime:this.endTime,dayOfWeek:Nv.findShortDayByFull(this.selectedDayOfWeek),dayOfMonth:null,frequencyType:this.selectedRepeat,startDate:this.startDate.format("DD/MMM/YYYY"),endDate:e,reason:this.reason,hasNoEndDate:this.noEndDate}];ye.CreateAvailability(t).then((e=>{Ma.clear(),this.$emit("reload"),this.$refs.ModalRef.toggleShow()}))},updateDateTimeText(e){if("endDate"===e)if(""===this.endDateText)this.endDate=null;else{this.noEndDate=!1;const e=Be()(this.endDateText,"DD/MM/YYYY");e.isValid()&&(this.endDate=e)}else if("startDate"===e)if(""===this.startDateText)this.startDate=null;else{this.noEndDate=!1;const e=Be()(this.startDateText,"DD/MM/YYYY");e.isValid()&&(this.startDate=e)}},confirmDelete(){Ma.confirmOrCancel({message:"Are you sure you want to delete this period of unavailability?"}).then((()=>{ye.DeleteAvailabilities(this.ava.id).then((e=>{this.$emit("reload"),this.$refs.ModalRef.toggleShow()}),(e=>{Ma.alert("Something went wrong. Delete Availability failed")}))}))},updateAvailability(){let e=this.endDateText?this.endDate.format("DD/MMM/YYYY"):null;e=this.noEndDate||this.endDateDisable?null:e,Ma.loading();let t=[{Id:this.ava.id,StartTime:this.startTime,EndTime:this.endTime,DayOfWeek:Nv.findShortDayByFull(this.selectedDayOfWeek),DayOfMonth:null,FrequencyType:this.selectedRepeat,StartDate:this.startDate.format("DD/MMM/YYYY"),EndDate:e,Reason:this.reason,HasNoEndDate:this.noEndDate}];ye.PatchAvailabilities(t).then((e=>{Ma.clear(),this.$emit("reload"),this.$refs.ModalRef.toggleShow()}))},async updateDateTime(e,t){let a=e.target.getClientRects()[0];this.datePickerTop=a.bottom,this.datePickerLeft=a.left;try{switch(t){case"startDate":return this.startDate=await this.$refs.DatePickerRef.toggleShow(this.startDate),void(this.startDateText=this.startDate.format("DD/MM/YYYY"));case"endDate":return this.endDate&&this.endDate.isValid()||(this.endDate=Be()()),this.endDate=await this.$refs.DatePickerRef.toggleShow(this.endDate),this.endDateText=this.endDate.format("DD/MM/YYYY"),void(this.noEndDate=!1)}}catch(l){return}},openEditDialog(e){e?(this.ava=e,this.employeeNo=Affinity.user.EmployeeNo,this.startTime=e.startTime,this.endTime=e.endTime,this.selectedDayOfWeek=e.dayOfWeek,this.selectedRepeat=e.frequencyType,this.startDateText=e.startDate,this.startDate=Be()(this.startDateText,"DD/MM/YYYY"),this.endDateText=e.endDate?e.endDate:"",this.endDate=Be()(this.endDateText,"DD/MM/YYYY"),this.reason=e.reason,this.noEndDate=e.hasNoEndDate):this.reset(),this.$refs.ModalRef.toggleShow()},cancel(){this.toggleShow()},toggleShow(){this.$refs.ModalRef.toggleShow()}}});const Pv=(0,ke.A)(Mv,[["render",Ev],["__scopeId","data-v-1bf93356"]]);var Ov=Pv,Wv=(0,o.pM)({components:{EditAvailability:Ov},data(){return{}},setup(){const e=(0,s.KR)(!1),t=(0,s.KR)(),a=(0,s.KR)([]),l=(0,s.KR)();function i(a,l){e.value=a,t.value.openEditDialog(l)}function n(){ye.GetAvailabilities(Affinity.user.EmployeeNo).then((e=>{let t=e.map((e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[e.charAt(0).toLowerCase()+e.slice(1),t])))));a.value=t.map((e=>(e.startDate=Be()(e.startDate).format("DD/MM/YYYY"),e.endDate&&(e.endDate=Be()(e.endDate).format("DD/MM/YYYY")),e.dayOfWeek=Nv.findFullDaysByShort(e.dayOfWeek),e)))}))}return(0,o.sV)((()=>{n()})),{gridData:a,openEditDialog:i,selectedAva:l,loadAvailability:n,isEditingDialog:e,EditAvailabilityRef:t}},mounted(){},methods:{confirmDelete(e){Ma.confirmOrCancel({message:"Are you sure you want to delete this period of unavailability?"}).then((()=>{this.deleteAva(e.id)}))},deleteAva(e){ye.DeleteAvailabilities(e).then((e=>{this.loadAvailability()}),(e=>{Ma.alert("Something went wrong. Delete Availability failed")}))}}});const Rv=(0,ke.A)(Wv,[["render",$k],["__scopeId","data-v-f2f8a0e6"]]);var Iv=Rv;const Yv=(0,o.Lk)("link",{href:"https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css",rel:"stylesheet",integrity:"sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1",crossorigin:"anonymous"},null,-1),_v={class:"col-sm-4"},Hv=(0,o.Lk)("p",null,"Login form style 3",-1),Xv={class:"card"},jv={class:"card-body"},Vv=(0,o.Lk)("h4",{class:"card-title text-center mb-4 mt-1"},"Sign in",-1),$v=(0,o.Lk)("hr",null,null,-1),Kv=(0,o.Lk)("p",{class:"text-success text-center"},"Some message goes here",-1),Bv={class:"form-group"},Uv={class:"input-group"},Qv={class:"form-group mt-2"},Gv={class:"input-group"},zv=(0,o.Lk)("div",{class:"form-group mt-4"},[(0,o.Lk)("button",{type:"submit",class:"btn btn-primary btn-block"}," Login ")],-1);function Jv(e,t,a,s,i,n){return(0,o.uX)(),(0,o.CE)(o.FK,null,[Yv,(0,o.Lk)("aside",_v,[Hv,(0,o.Lk)("div",Xv,[(0,o.Lk)("article",jv,[Vv,$v,Kv,(0,o.Lk)("form",{onSubmit:t[2]||(t[2]=(0,l.D$)(((...e)=>n.login&&n.login(...e)),["prevent"]))},[(0,o.Lk)("div",Bv,[(0,o.Lk)("div",Uv,[(0,o.bo)((0,o.Lk)("input",{name:"",class:"form-control",placeholder:"Email or login","onUpdate:modelValue":t[0]||(t[0]=e=>i.username=e)},null,512),[[l.Jo,i.username]])])]),(0,o.Lk)("div",Qv,[(0,o.Lk)("div",Gv,[(0,o.bo)((0,o.Lk)("input",{class:"form-control",placeholder:"******",type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>i.password=e)},null,512),[[l.Jo,i.password]])])]),zv],32)])])])],64)}var Zv={name:"Login",data(){return{username:"",password:""}},methods:{login(){console.log("login"),console.log(this.username),console.log(this.password),T().post("http://localhost:11140/api/Authentication/post",{username:this.username,password:this.password}).then((e=>{console.log("res",e)}))}}};const qv=(0,ke.A)(Zv,[["render",Jv]]);var eg=qv;const tg=e=>((0,o.Qi)("data-v-2be9851b"),e=e(),(0,o.jt)(),e),ag={class:"cost-report-controls"},lg={class:"select-view"},sg={key:0,class:"select-unit ml-2"},og={key:1,class:"select-employee ml-2"},ig={class:"ml-2"},ng=tg((()=>(0,o.Lk)("label",null,"From",-1))),rg={class:"ml-2"},cg=tg((()=>(0,o.Lk)("label",null,"To",-1))),dg={class:"btn-show-wrap ml-2"},ug={key:0},hg={key:0,class:"cost-report-wrap"},mg={key:1,class:"cost-report-wrap"},pg={key:2,class:"cost-report-wrap"},yg={key:3,class:"cost-report-wrap"},fg={key:4,class:"cost-report-wrap"};function kg(e,t,a,s,i,n){const r=(0,o.g2)("custom-select"),c=(0,o.g2)("multi-select"),d=(0,o.g2)("DetailCostReport"),u=(0,o.g2)("SimpleAnalysis"),h=(0,o.g2)("CostAnalysisWeekly"),m=(0,o.g2)("EmployeeWeekly"),p=(0,o.g2)("PayDetailView"),y=(0,o.g2)("date-picker");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",null,[(0,o.Lk)("div",ag,[(0,o.Lk)("div",lg,[(0,o.bF)(r,{options:e.options,selected:e.selectedViewFromDropdown,onSelectOption:e.selectGridData},null,8,["options","selected","onSelectOption"])]),e.selectedViewFromDropdown!==e.SelectableView.simple&&e.selectedViewFromDropdown!==e.SelectableView.detailed?((0,o.uX)(),(0,o.CE)("div",sg,[(0,o.bF)(r,{options:e.unitOptions,selected:e.selectedUnit,width:100,onSelectOption:e.selectUnitOption},null,8,["options","selected","onSelectOption"])])):(0,o.Q3)("",!0),e.selectableEmployeeList.length>0?((0,o.uX)(),(0,o.CE)("div",og,[(0,o.bF)(c,{selectOptionInput:e.selectableEmployeeList,targetString:"commonName",allowAll:!0},null,8,["selectOptionInput"])])):(0,o.Q3)("",!0),(0,o.Lk)("div",ig,[ng,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.fromDateText=t),class:"input-box date-box ml-2",type:"text",onClick:t[1]||(t[1]=t=>e.updateFromDateTime(t,e.fromDate))},null,512),[[l.Jo,e.fromDateText]])]),(0,o.Lk)("div",rg,[cg,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.toDateText=t),class:"input-box date-box ml-2",type:"text",onClick:t[3]||(t[3]=t=>e.updateToDateTime(t,e.toDate))},null,512),[[l.Jo,e.toDateText]])]),(0,o.Lk)("div",dg,[(0,o.Lk)("button",{class:"light-blue small action-button white",onClick:t[4]||(t[4]=t=>e.loadGridDataBySelection())}," Show ")]),(0,o.Lk)("button",{class:"export-csv light-blue small action-button white ml-2",onClick:t[5]||(t[5]=(...t)=>e.exportCSVByView&&e.exportCSVByView(...t))}," Export CSV ")])]),e.employeeList.length>0?((0,o.uX)(),(0,o.CE)("div",ug,[(0,o.Lk)("div",null,[e.selectedView===e.SelectableView.detailed?((0,o.uX)(),(0,o.CE)("div",hg,[(0,o.bF)(d,{ref:"CostDetailAnalysisRef",fromDate:e.fromDate,toDate:e.toDate,"employee-list":e.selectedEmployeeList()},null,8,["fromDate","toDate","employee-list"])])):(0,o.Q3)("",!0),e.selectedView===e.SelectableView.simple?((0,o.uX)(),(0,o.CE)("div",mg,[(0,o.bF)(u,{ref:"SimpleAnalysisRef",fromDate:e.fromDate,toDate:e.toDate,"employee-list":e.selectedEmployeeList()},null,8,["fromDate","toDate","employee-list"])])):(0,o.Q3)("",!0),e.selectedView===e.SelectableView.weekly?((0,o.uX)(),(0,o.CE)("div",pg,[(0,o.bF)(h,{ref:"CostAnalysisWeeklyRef",fromDate:e.fromDate,toDate:e.toDate,selectedUnit:e.selectedUnit,"employee-list":e.selectedEmployeeList()},null,8,["fromDate","toDate","selectedUnit","employee-list"])])):(0,o.Q3)("",!0),e.selectedView===e.SelectableView.employeeWeekly?((0,o.uX)(),(0,o.CE)("div",yg,[(0,o.bF)(m,{ref:"EmployeeWeeklyRef",fromDate:e.fromDate,toDate:e.toDate,selectedUnit:e.selectedUnit,"employee-list":e.selectedEmployeeList()},null,8,["fromDate","toDate","selectedUnit","employee-list"])])):(0,o.Q3)("",!0),e.selectedView===e.SelectableView.payDetailView?((0,o.uX)(),(0,o.CE)("div",fg,[(0,o.bF)(p,{ref:"PayDetailViewRef",fromDate:e.fromDate,toDate:e.toDate,selectedUnit:e.selectedUnit,"employee-list":e.selectedEmployeeList()},null,8,["fromDate","toDate","selectedUnit","employee-list"])])):(0,o.Q3)("",!0)])])):(0,o.Q3)("",!0),(0,o.bF)(y,{ref:"DatePickerRef",top:e.dateModalTop,leftInput:e.dateModalLeft,"max-date":e.datePickerMax,"min-date":e.datePickerMin,date:e.datePickerTargetDay},null,8,["top","leftInput","max-date","min-date","date"])])}const vg=e=>((0,o.Qi)("data-v-dfa56768"),e=e(),(0,o.jt)(),e),gg={class:"mt-4 full-width grid-section"},Dg={key:0,class:"d-flex justify-center mt-4"},Sg=vg((()=>(0,o.Lk)("h3",null,"No data found.",-1))),bg=[Sg],Cg={key:1,class:"dbw-box"},Eg={class:"heading-cell"},wg={class:"grid-body"},Lg={class:"grid-body-cell"},Tg={class:"pagination-wrap"},xg={key:0,class:"no-records"};function Ag(e,t,a,s,i,n){const r=(0,o.g2)("perfect-scrollbar"),c=(0,o.g2)("paginator");return(0,o.uX)(),(0,o.CE)("div",gg,[e.noDataError?((0,o.uX)(),(0,o.CE)("div",Dg,bg)):(0,o.Q3)("",!0),!e.noDataError&&e.dataHeadings.length>0?((0,o.uX)(),(0,o.CE)("div",Cg,[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",{class:"grid-extra-width",style:(0,h.Tr)(e.gridWidthStyle)},[(0,o.Lk)("div",{class:"grid-heading",style:(0,h.Tr)(e.headingStyle)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.dataHeadings,(e=>((0,o.uX)(),(0,o.CE)("div",Eg,(0,h.v_)(e),1)))),256))],4),(0,o.Lk)("div",wg,[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.dataAnalysis,(t=>((0,o.uX)(),(0,o.CE)("div",{class:"grid-body-row",style:(0,h.Tr)(e.headingStyle)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Object.entries(t),(([e,t])=>((0,o.uX)(),(0,o.CE)("div",Lg,(0,h.v_)(t),1)))),256))],4)))),256))])),_:1})])],4)])),_:1})])):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("div",Tg,[(0,o.bF)(c,{ref:"PaginatorRef",totalPage:e.totalPage,currentPage:e.pageNumber,onSelectPage:e.selectPage},null,8,["totalPage","currentPage","onSelectPage"]),e.recordCount>0?((0,o.uX)(),(0,o.CE)("div",xg," No. of Records: "+(0,h.v_)(e.recordCount),1)):(0,o.Q3)("",!0)],512),[[l.aG,!e.noDataError&&e.dataHeadings.length>0]])])}const Fg={key:0},Ng={class:"pagination"},Mg={class:"total-page-small"},Pg=["onClick"],Og={key:2,class:"ml-2"},Wg={key:0,class:"ml-4"};function Rg(e,t,a,l,s,i){return e.pageList.length>0?((0,o.uX)(),(0,o.CE)("div",Fg,[(0,o.Lk)("div",Ng,[(0,o.Lk)("div",Mg,[e.totalPage>1&&e.currentPage>1?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"previous-button page-button",onClick:t[0]||(t[0]=t=>e.selectNextPage(-1))}," <")):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.pageList,(t=>((0,o.uX)(),(0,o.CE)("div",{class:(0,h.C4)(["page-button",{selected:e.currentPage===t}]),onClick:a=>e.selectPage(t)},(0,h.v_)(t),11,Pg)))),256)),e.totalPage>1&&e.currentPage<e.totalPage?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"next-button page-button",onClick:t[1]||(t[1]=t=>e.selectNextPage(1))}," >")):(0,o.Q3)("",!0),e.totalPage>5?((0,o.uX)(),(0,o.CE)("div",Og,"Total Pages: "+(0,h.v_)(e.totalPage),1)):(0,o.Q3)("",!0)])]),e.recordCount>0?((0,o.uX)(),(0,o.CE)("div",Wg,"No. of Records: "+(0,h.v_)(e.recordCount),1)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)}var Ig=(0,o.pM)({name:"Paginator",props:{totalPage:{type:Number,default:1},currentPage:{type:Number,default:1}},setup(e,{emit:t}){const a=(0,s.KR)(20),l=(0,s.KR)([]),o=(0,s.KR)(0);function i(e,t){l.value=t<=5?Array.from(Array(t).keys()).map((e=>e+1)):e<=3?Array.from(Array(5).keys()).map((e=>e+1)):t>e+2?Array.from(Array(5).keys()).map((t=>t+e-2)):Array.from(Array(5).keys()).map((e=>e+t-4))}async function n(e){t("selectPage",e)}async function r(a=1){let l=e.currentPage+a;t("selectPage",l)}return{pageSize:a,pageList:l,recordCount:o,selectPage:n,selectNextPage:r,calculatePageList:i}}});const Yg=(0,ke.A)(Ig,[["render",Rg],["__scopeId","data-v-5f769ad4"]]);var _g,Hg,Xg=Yg;(function(e){e["setEmployees"]="SET_EMPLOYEES",e["setSimpleViewData"]="SET_SIMPLE_VIEW_DATA",e["setDetailedCostReportData"]="SET_DETAILED_COST_REPORT_DATA",e["setWeeklyAnalysisData"]="SET_WEEKLY_ANALYSIS_DATA",e["setEmployeeWeeklyAnalysisData"]="SET_EMPLOYEE_WEEKLY_ANALYSIS_DATA",e["setPayDetailViewData"]="SET_PAY_DETAIL_VIEW_DATA"})(_g||(_g={})),function(e){e["fetchEmployees"]="GET_EMPLOYEES",e["fetchSimpleViewData"]="GET_SIMPLE_VIEW_DATA",e["fetchDetailedCostReportData"]="GET_DETAILED_COST_REPORT_DATA",e["fetchWeeklyAnalysisData"]="GET_WEEKLY_ANALYSIS_DATA",e["fetchEmployeeWeeklyAnalysisData"]="GET_EMPLOYEE_WEEKLY_ANALYSIS_DATA",e["fetchPayDetailViewData"]="GET_PAY_DETAIL_VIEW_DATA"}(Hg||(Hg={}));const jg={state:{employees:[],simpleViewData:[],detailedCostReportData:[],weeklyAnalysisData:[],employeeWeeklyAnalysisData:[],payDetailViewData:[]},getters:{getEmployees:e=>e.employees,getSimpleViewData:e=>e.simpleViewData,getDetailedCostReportData:e=>e.detailedCostReportData,getWeeklyAnalysisData:e=>e.weeklyAnalysisData,getEmployeeWeeklyAnalysisData:e=>e.employeeWeeklyAnalysisData,getPayDetailViewData:e=>e.payDetailViewData},mutations:{[_g.setEmployees]:(e,t)=>{e.employees=t},[_g.setSimpleViewData]:(e,t)=>{e.simpleViewData=t},[_g.setDetailedCostReportData]:(e,t)=>{e.detailedCostReportData=t},[_g.setWeeklyAnalysisData]:(e,t)=>{e.weeklyAnalysisData=t},[_g.setEmployeeWeeklyAnalysisData]:(e,t)=>{e.employeeWeeklyAnalysisData=t},[_g.setPayDetailViewData]:(e,t)=>{e.payDetailViewData=t}},actions:{[Hg.fetchSimpleViewData]:async({commit:e},t)=>{const a={pageNumber:t.pageNumber,pageSize:t.pageSize,pagingEnabled:t.pagingEnabled,sortBy:"CommonName",sortingType:"asc",employeeNumbers:t.employeeNumbers,transDateFrom:t.fromDate,transDateTo:t.toDate};try{const t=await ye.GetCostAnalysisV2(a);return e(_g.setSimpleViewData,t),t}catch(l){}},[Hg.fetchDetailedCostReportData]:async({commit:e},t)=>{const a={sortBy:"CommonName",sortingType:"asc",pagingEnabled:!0,pageNumber:t.pageNumber,pageSize:t.pageSize,employeeNumbers:t.employeeNumbers,transDateFrom:t.fromDate,transDateTo:t.toDate};try{const t=await ye.GetCostAnalysisDetailV2(a);return e(_g.setDetailedCostReportData,t),t}catch(l){}},[Hg.fetchWeeklyAnalysisData]:async({commit:e},t)=>{const a={sortBy:"CommonName",sortingType:"asc",pagingEnabled:!0,pageNumber:t.pageNumber,pageSize:t.pageSize,employeeNumbers:t.employeeNumbers,transDateFrom:t.weekStart,transDateTo:t.weekEnd};try{const l=await ye.GetCostingDayView(a,Vg(t.selectedUnit));return e(_g.setWeeklyAnalysisData,l),l}catch(l){}},[Hg.fetchEmployeeWeeklyAnalysisData]:async({commit:e},t)=>{const a={sortBy:"CommonName",sortingType:"asc",pagingEnabled:!0,pageNumber:t.pageNumber,pageSize:t.pageSize,employeeNumbers:t.employeeNumbers,transDateFrom:t.weekStart,transDateTo:t.weekEnd};try{const l=await ye.CostingEmployeeView(a,Vg(t.selectedUnit));return e(_g.setEmployeeWeeklyAnalysisData,l),l}catch(l){}},[Hg.fetchPayDetailViewData]:async({commit:e},t)=>{const a={sortBy:"CommonName",sortingType:"asc",pagingEnabled:!0,pageNumber:t.pageNumber,pageSize:t.pageSize,payCodes:t.payCodes,employeeNumbers:t.employeeNumbers,transDateFrom:t.weekStart,transDateTo:t.weekEnd};try{const l=await ye.CostingEmployeePayDetailView(a,Vg(t.selectedUnit));return e(_g.setPayDetailViewData,l),l}catch(l){}}}},Vg=e=>"values"===e?"value":"units"===e?"unit":void 0;var $g=jg,Kg=(0,o.pM)({name:"DetailCostReport",components:{Paginator:Xg},props:{fromDate:{type:Object},toDate:{type:Object},employeeList:{type:Array}},setup(e){const t=(0,je.Pj)(),a=(0,s.KR)([]),l=(0,s.KR)(0),i=(0,s.KR)(1),n=(0,s.KR)(20),r=(0,s.KR)(5),c=(0,s.KR)(0),d=(0,s.KR)(),u=(0,s.KR)([]),h=(0,s.KR)(),m=(0,s.KR)(2e3),p=(0,s.KR)({width:"2000px"}),y=(0,s.KR)([]),f=(0,s.KR)(["Start/End Time","Detailed Cost Report"]),k=(0,s.KR)(!1);async function v(){Ma.loading(),k.value=!1;let a=e.fromDate,s=e.toDate,o=e.employeeList;a&&s||(a=Be()().startOf("month"),s=Be()().endOf("month")),await t.dispatch(Hg.fetchDetailedCostReportData,{fromDate:e.fromDate?e.fromDate.format("YYYY-MM-DD"):null,toDate:e.toDate?e.toDate.format("YYYY-MM-DD"):null,employeeNumbers:o.filter((e=>null!==e&&void 0!==e)),pageNumber:i.value,pageSize:n.value}).then((e=>{if(e.response&&0===e.response.length||!e.response)return void(k.value=!0);const t=e.response.slice();t.forEach((e=>{e.TransDate=Be()(e.TransDate).format("YYYY-MM-DD"),e.TotalCost=Math.round(100*e.TotalCost)/100;for(const[t,a]of Object.entries(e))"number"===typeof a&&(e[t]=Math.round(100*a)/100)}));const a=t.map((e=>{const t=Object.values(e);return t[0]=e.CommonName,t[1]=e.EmployeeNo,t}));let s=-1;const o=e.response[0];for(const l of Object.keys(o))l.indexOf("Cost")>-1&&s++;l.value=s,u.value=g(l.value),D(),S(),i.value=e.currentPageNumber,c.value=e.recordCount,r.value=e.totalPages,d.value.calculatePageList(e.currentPageNumber,e.totalPages),y.value=a})),Ma.clear()}function g(e){const t=["Employee Name","Employee Number","Functional Area","Date","Pay Rate","Total Hours","Total Cost"],a=["Description","Hours","Cost"];let l=t.slice(),s=0;while(s<e){const e=a.map((e=>e+(s+1)));l.push(...e),s++}return l}function D(){let e="";Array.from(Array(l.value)).map(((t,a)=>{e+=" 150px 100px 100px"})),h.value={"grid-template-columns":`150px 150px 150px 100px 100px 100px 100px${e}`}}function S(){return m.value=850+350*l.value+3*l.value+6,p.value={width:`${m.value}px`},m.value}async function b(e){i.value=e,Ma.loading(),await v(),Ma.clear()}async function C(){if(k.value)return void Ma.alert("No data to export");Ma.loading();const e=await E();Ma.clear();let t="data:text/csv;charset=utf-8,";t+=u.value.join(",")+"\r\n",e.map((e=>{t+=Object.values(e).join(",")+"\r\n"}));var a=encodeURI(t),l=document.createElement("a");l.setAttribute("href",a),l.setAttribute("download","Analytic.csv"),l.setAttribute("Content-Type","application/octet-stream"),document.body.appendChild(l),l.click()}async function E(){const t={pageNumber:1,pageSize:1e4,pagingEnabled:!1,sortBy:"CommonName",sortingType:"asc",employeeNumbers:e.employeeList.filter((e=>null!==e&&void 0!==e)),transDateFrom:e.fromDate?e.fromDate.format("YYYY-MM-DD"):null,transDateTo:e.toDate?e.toDate.format("YYYY-MM-DD"):null};return await ye.GetCostAnalysisDetailV2(t).then((e=>{const t=e.response.map((e=>{e.TransDate=Be()(e.TransDate).format("YYYY-MM-DD"),e.TotalCost=Math.round(100*e.TotalCost)/100;for(const[a,l]of Object.entries(e))"number"===typeof l&&(e[a]=Math.round(100*l)/100);const t=Object.values(e);return t[0]=e.CommonName,t[1]=e.EmployeeNo,t}));let a=-1;const s=e.response[0];for(const l of Object.keys(s))l.indexOf("Cost")>-1&&a++;l.value=a,u.value=g(l.value);const o=Object.values(e.resultSummary).map((e=>"number"===typeof e?Math.round(100*e)/100:e));let i=Array(7).fill(null).concat(o);return t.push(i),t}))}function w(){k.value=!1,i.value=1,r.value=5}return(0,o.sV)((async()=>{console.log("cost detail report mounted"),y.value=[],i.value=1,r.value=5,k.value=!1,w(),Ma.loading(),await v(),Ma.clear()})),{data:a,dataHeadings:u,dataAnalysis:y,options:f,headingStyle:h,gridWidthStyle:p,pageNumber:i,pageSize:n,totalPage:r,noDataError:k,recordCount:c,PaginatorRef:d,selectPage:b,exportCSV:C,loadGridData:v}}});const Bg=(0,ke.A)(Kg,[["render",Ag],["__scopeId","data-v-dfa56768"]]);var Ug=Bg;const Qg=e=>((0,o.Qi)("data-v-04feada9"),e=e(),(0,o.jt)(),e),Gg={class:"mt-4 full-width grid-section"},zg={key:0,class:"d-flex justify-center mt-4"},Jg=Qg((()=>(0,o.Lk)("h3",null,"No data found.",-1))),Zg=[Jg],qg={key:1,class:"dbw-box"},eD={class:"grid-extra-width"},tD={class:"grid-heading"},aD={class:"heading-cell"},lD={class:"grid-body"},sD={class:"grid-body-row"},oD={class:"grid-body-cell"},iD={class:"pagination-wrap"},nD={key:0,class:"no-records"};function rD(e,t,a,s,i,n){const r=(0,o.g2)("perfect-scrollbar"),c=(0,o.g2)("paginator");return(0,o.uX)(),(0,o.CE)("div",Gg,[e.noDataError?((0,o.uX)(),(0,o.CE)("div",zg,Zg)):((0,o.uX)(),(0,o.CE)("div",qg,[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",eD,[(0,o.Lk)("div",tD,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.dataHeadings,(e=>((0,o.uX)(),(0,o.CE)("div",aD,(0,h.v_)(e),1)))),256))]),(0,o.Lk)("div",lD,[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.dataAnalysis,(e=>((0,o.uX)(),(0,o.CE)("div",sD,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Object.entries(e),(([e,t])=>((0,o.uX)(),(0,o.CE)("div",oD,(0,h.v_)(t),1)))),256))])))),256))])),_:1})])])])),_:1})])),(0,o.bo)((0,o.Lk)("div",iD,[(0,o.bF)(c,{ref:"PaginatorRef",totalPage:e.totalPages,currentPage:e.pageNumber,onSelectPage:e.selectPage},null,8,["totalPage","currentPage","onSelectPage"]),e.recordCount>0?((0,o.uX)(),(0,o.CE)("div",nD," No. of Records: "+(0,h.v_)(e.recordCount),1)):(0,o.Q3)("",!0)],512),[[l.aG,!e.noDataError]])])}var cD=(0,o.pM)({name:"SimpleAnalysis",components:{Paginator:Xg},props:{fromDate:{type:Object},toDate:{type:Object},employeeList:{type:Array}},setup(e){const t=(0,je.Pj)(),a=(0,s.KR)([]),l=(0,s.KR)(1),i=(0,s.KR)(20),n=(0,s.KR)(5),r=(0,s.KR)(0),c=(0,s.KR)(!1),d=(0,s.KR)(),u=(0,s.KR)(["Employee Name","Employee Number","Functional Area","Date","Award","Schedule Hours","Actual Hours","Hours Variance","Schedule Cost","Actual Cost","Cost Variance","Actual Start","Actual Finish","Adjusted Start","Adjusted Finish"]),h=(0,s.KR)([]);async function m(){console.log("load grid data from cost analysis v2"),c.value=!1,e.fromDate&&e.toDate||(e.fromDate||(e.fromDate=Be()().startOf("month")),e.toDate||(e.toDate=Be()().endOf("month"))),Ma.loading(),await t.dispatch(Hg.fetchSimpleViewData,{fromDate:e.fromDate?e.fromDate.format("YYYY-MM-DD"):null,toDate:e.toDate?e.toDate.format("YYYY-MM-DD"):null,employeeNumbers:e.employeeList.filter((e=>null!==e&&void 0!==e)),pagingEnabled:!0,pageNumber:l.value,pageSize:i.value}).then((e=>e.response&&0===e.response.length||!e.response?(v(),void(c.value=!0)):(h.value=e.response.map((e=>{const t={};return t.commonName=e.commonName,t.employeeNo=e.employeeNo,t.functionalArea=e.functionalArea,t.transDate=Be()(e.transDate).format("YYYY-MM-DD"),t.awardId=e.awardId,t.scheduledHours=p(e.scheduledUnits),t.actualHours=p(e.actualUnits),t.hoursVariance=p(t.actualHours-t.scheduledHours),t.scheduledCost=p(e.scheduledCost),t.actualCost=p(e.actualCost),t.costVariance=p(t.actualCost-t.scheduledCost),t.actStartTime=e.actStartTime?Be()(e.actStartTime).format("HH:mm"):null,t.actEndTime=e.actEndTime?Be()(e.actEndTime).format("HH:mm"):null,t.adjStartTime=e.adjStartTime?Be()(e.adjStartTime).format("HH:mm"):null,t.adjEndTime=e.adjEndTime?Be()(e.adjEndTime).format("HH:mm"):null,t})),n.value=e.totalPages,l.value=e.currentPageNumber,r.value=e.recordCount,d.value.calculatePageList(e.currentPageNumber,e.totalPages),e.response))).finally((()=>{Ma.clear()}))}function p(e){return null===e?null:Math.round(100*e)/100}async function y(e){l.value=e,Ma.loading(),await m(),Ma.clear()}async function f(){if(c.value)return void Ma.alert("No data to export");Ma.loading();const e=await k();Ma.clear();let t="data:text/csv;charset=utf-8,";t+=u.value.join(",")+"\r\n",e.map((e=>{t+=Object.values(e).join(",")+"\r\n"}));var a=encodeURI(t),l=document.createElement("a");l.setAttribute("href",a),l.setAttribute("download","Analytic.csv"),document.body.appendChild(l),l.click()}async function k(){const t={pageNumber:1,pageSize:1e4,pagingEnabled:!1,sortBy:"CommonName",sortingType:"asc",employeeNumbers:e.employeeList.filter((e=>null!==e&&void 0!==e)),transDateFrom:e.fromDate?e.fromDate.format("YYYY-MM-DD"):null,transDateTo:e.toDate?e.toDate.format("YYYY-MM-DD"):null};return await ye.GetCostAnalysisV2(t).then((e=>e.response.map((e=>{const t={};return t.commonName=e.commonName,t.employeeNo=e.employeeNo,t.functionalArea=e.functionalArea,t.transDate=Be()(e.transDate).format("YYYY-MM-DD"),t.awardId=e.awardId,t.scheduledHours=p(e.scheduledUnits),t.actualHours=p(e.actualUnits),t.hoursVariance=p(t.actualHours-t.scheduledHours),t.scheduledCost=p(e.scheduledCost),t.actualCost=p(e.actualCost),t.costVariance=p(t.actualCost-t.scheduledCost),t.actStartTime=e.actStartTime?Be()(e.actStartTime).format("HH:mm"):null,t.actEndTime=e.actEndTime?Be()(e.actEndTime).format("HH:mm"):null,t.adjStartTime=e.adjStartTime?Be()(e.adjStartTime).format("HH:mm"):null,t.adjEndTime=e.adjEndTime?Be()(e.adjEndTime).format("HH:mm"):null,t}))))}function v(){l.value=1,n.value=5,c.value=!1}return(0,o.sV)((async()=>{h.value=[],l.value=1,n.value=5,c.value=!1,v(),await m()})),{data:a,dataHeadings:u,dataAnalysis:h,PaginatorRef:d,pageNumber:l,pageSize:i,totalPages:n,noDataError:c,recordCount:r,loadGridData:m,exportCSV:f,selectPage:y}}});const dD=(0,ke.A)(cD,[["render",rD],["__scopeId","data-v-04feada9"]]);var uD,hD=dD;(function(e){e["simple"]="Start/Finish",e["detailed"]="Detailed Costs",e["weekly"]="Period Analysis",e["employeeWeekly"]="Employee Analysis",e["payDetailView"]="Pay Detail"})(uD||(uD={}));const mD=e=>((0,o.Qi)("data-v-c226ebb6"),e=e(),(0,o.jt)(),e),pD={key:0,class:"mt-4"},yD=mD((()=>(0,o.Lk)("h3",null,"No data found.",-1))),fD=[yD],kD={key:1,class:"mt-4 costAnalaysisBody"},vD={class:"display-option mt-4"},gD=mD((()=>(0,o.Lk)("label",null,"Columns: ",-1))),DD={class:"cost-grid mt-4"},SD=mD((()=>(0,o.Lk)("div",{class:"table-cell"},null,-1))),bD=mD((()=>(0,o.Lk)("div",{class:"table-cell"},null,-1))),CD={class:"table-cell"},ED={key:0,class:"table-cell"},wD={class:"table-cell"},LD=mD((()=>(0,o.Lk)("div",{class:"table-cell bold"}," Total ",-1))),TD=mD((()=>(0,o.Lk)("div",{class:"table-cell bold"},null,-1))),xD={class:"main-canvas-wrapper"},AD={class:"myChart-wrapper",style:{height:"600px"}},FD={class:"main-canvas",ref:"myChartRef",id:"myChart",colours:"[ { fillColor: '#ffff00' }, { fillColor: '#0066ff' } ]"};function ND(e,t,a,l,s,i){const n=(0,o.g2)("multi-select"),r=(0,o.g2)("perfect-scrollbar");return(0,o.uX)(),(0,o.CE)(o.FK,null,[e.data[0]?((0,o.uX)(),(0,o.CE)("div",kD,[(0,o.Lk)("div",vD,[gD,(0,o.bF)(n,{class:"ml-4",selectOptionInput:e.displayOptions,targetString:"description","fixed-left":!1},null,8,["selectOptionInput"])]),(0,o.Lk)("div",DD,[(0,o.Lk)("div",{class:"day-arr cost-grid-heading",style:(0,h.Tr)(e.getGridTemplateStyle())},[SD,bD,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.displayList,(e=>((0,o.uX)(),(0,o.CE)("div",CD,(0,h.v_)(e.heading),1)))),256))],4),(0,o.bF)(r,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.data,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{class:"day-arr",style:(0,h.Tr)(e.getGridTemplateStyle())},[t.day?((0,o.uX)(),(0,o.CE)("div",ED,(0,h.v_)(t.day),1)):(0,o.Q3)("",!0),(0,o.Lk)("div",wD,(0,h.v_)(t.weekDay),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Object.entries(e.displayList),(([l,s])=>((0,o.uX)(),(0,o.CE)("div",{class:(0,h.C4)(["table-cell",e.getDataStyle(e.calculatedData[a],l,s)])},[(0,o.Lk)("span",null,(0,h.v_)(e.getDisplayValue(t[l],s.isCalculated)),1)],2)))),256))],4)))),256)),(0,o.Lk)("div",{class:"day-arr",style:(0,h.Tr)(e.getGridTemplateStyle())},[LD,TD,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Object.entries(e.displayList),(([t,a])=>((0,o.uX)(),(0,o.CE)("div",{class:(0,h.C4)(["table-cell bold",e.getDataStyle(e.totalInNumber,t,a)])},[(0,o.Lk)("span",null,(0,h.v_)(e.getDisplayValue(e.total[t],a.isCalculated)),1)],2)))),256))],4)])),_:1})])])):((0,o.uX)(),(0,o.CE)("div",pD,fD)),(0,o.Lk)("div",xD,[(0,o.Lk)("div",AD,[(0,o.Lk)("canvas",FD,null,512)])])],64)}const MD=[{key:"scheduled",description:"Schedule",isSelected:!0},{key:"actual",description:"Actual",isSelected:!1},{key:"budgeted",description:"Budget",isSelected:!0},{key:"sales",description:"Sales",isSelected:!0},{key:"scheduledVSBudgeted",description:"Schedule vs Budget",isSelected:!1},{key:"actualsVSBudgeted",description:"Actual vs Budget",isSelected:!1},{key:"actualsVSScheduled",description:"Actual vs Schedule",isSelected:!1},{key:"scheduledVSSales",description:"Schedule vs Sales",isSelected:!1},{key:"actualsVSSales",description:"Actual vs Sales",isSelected:!1}],PD={scheduled:{heading:"Schedule",isDisplay:!0,isCalculated:!1},actual:{heading:"Actual",isDisplay:!1,isCalculated:!1},budgeted:{heading:"Budget",isDisplay:!1,isCalculated:!1},sales:{heading:"Sales",isDisplay:!1,isCalculated:!1},scheduledVSBudgeted:{heading:"Schedule vs Budget",isDisplay:!1,isCalculated:!0},actualsVSBudgeted:{heading:"Actual vs Budget",isDisplay:!1,isCalculated:!0},actualsVSScheduled:{heading:"Actual vs Schedule",isDisplay:!1,isCalculated:!0},scheduledVSSales:{heading:"Schedule vs Sales",isDisplay:!1,isCalculated:!0},actualsVSSales:{heading:"Actual vs Sales",isDisplay:!1,isCalculated:!0}},OD=[["Employee","Schedule","","","Worked","","","Variance","",""],["","Ordinary","Time & Half","Double","Ordinary","Time & Half","Double","Ordinary","Time & Half","Double"]];var WD;(function(e){e["unit"]="Units",e["value"]="Values"})(WD||(WD={}));let RD=null;var ID=(0,o.pM)({name:"CostAnalysisWeekly",components:{Modal:Re,MultiSelect:Kc,Dialog:Ma},props:{dayFocus:{type:Object},fromDate:{type:Object},toDate:{type:Object},selectedUnit:{type:String},modalIndex:{type:Number},employeeList:{type:Array}},setup(e){const t=(0,je.Pj)(),a=(0,s.KR)(null),l=(0,s.KR)([]),i=(0,s.KR)([]),n=(0,s.KR)({}),r=(0,s.KR)({}),c=(0,s.KR)(6),d=(0,s.KR)({}),u=(0,s.KR)(PD),h=(0,s.KR)(""),m=(0,s.KR)(""),p=(0,s.KR)(MD),y=(0,s.KR)(!1),f=(0,s.KR)(e.selectedUnit),k=(e,t,a)=>{if(a.isCalculated)return"scheduledVSBudgeted"===t||"actualsVSBudgeted"===t?e[t]>0?"positive-cell":"negative-cell":void 0},v=()=>(C(),c.value>1?`grid-template-columns: 100px 100px repeat( ${c.value} , 100px)`:`grid-template-columns: 100px 100px repeat( ${c.value} , auto)`),g=async()=>{let a,s;Object.keys(d.value).forEach((e=>{d.value[e].isDisplay=!1})),a=e.fromDate?e.fromDate.clone().format("YYYY-MM-DD"):Be()().startOf("week").format("YYYY-MM-DD"),s=e.toDate?e.toDate.clone().format("YYYY-MM-DD"):Be()().endOf("week").format("YYYY-MM-DD"),Ma.loading();for(const[e,t]of Object.entries(u.value)){const a=p.value.find((t=>t.key===e));a&&!0===a.isSelected&&(d.value[e]=t,d.value[e].isDisplay=a.isSelected)}try{const r=await t.dispatch(Hg.fetchWeeklyAnalysisData,{weekStart:a,weekEnd:s,employeeNumbers:e.employeeList.filter((e=>null!==e&&void 0!==e)),selectedUnit:e.selectedUnit.toLowerCase(),pageNumber:1,pageSize:99});if(!r.response||!r.response[0])return l.value=[],n.value=[],void Ma.clear();let c=r.response;i.value=[],l.value=c.map((e=>{e.actual=e.worked||0,e.budgeted=e.budget||0,e.sales=e.sales||0;let t={...e},a={};t.day=Be()(e.transDate).format("YYYY-MM-DD"),t.weekDay=Be()(e.transDate).format("dddd"),u.value.scheduledVSBudgeted&&(t.scheduledVSBudgeted=b(e.scheduled,e.budgeted)),u.value.actualsVSBudgeted&&(t.actualsVSBudgeted=b(e.actual,e.budgeted)),u.value.actualsVSScheduled&&(t.actualsVSScheduled=S(e.actual,e.scheduled)),u.value.actualsVSSales&&(t.actualsVSSales=b(e.actual,e.sales)),u.value.scheduledVSSales&&(t.scheduledVSSales=b(e.scheduled,e.sales));for(let[l,s]of Object.entries(t))Number.isNaN(s)&&(t[l]=0),a[l]="day"===l||"dayNumber"===l||"transDate"===l||"date"===l||"weekDay"===l?s:Uc()(t[l]).format({symbol:""});return i.value.push(t),a})),D(),(0,o.dY)((()=>{E(),Ma.clear()})),f.value=e.selectedUnit}catch(r){l.value=[],n.value=[]}},D=()=>{const e=[];for(const[t]of Object.entries(u.value))e.push(t);if(1!==e.length){for(let t of e){r.value[t]=0;for(let e of i.value)e[t]||(e[t]=0),r.value[t]+=e[t]}u.value.scheduledVSBudgeted&&(r.value.scheduledVSBudgeted=b(r.value.scheduled,r.value.budgeted)),u.value.actualsVSBudgeted&&(r.value.actualsVSBudgeted=b(r.value.actual,r.value.budgeted)),u.value.actualsVSScheduled&&(r.value.actualsVSScheduled=S(r.value.actual,r.value.scheduled)),u.value.actualsVSSales&&(r.value.actualsVSSales=b(r.value.actual,r.value.sales)),u.value.scheduledVSSales&&(r.value.scheduledVSSales=b(r.value.scheduled,r.value.sales));for(let[e,t]of Object.entries(r.value))Number.isNaN(t)&&(r.value[e]=0),n.value[e]=Uc()(r.value[e]).format({symbol:""})}else r.value[e[0]]=Math.round(100*i.value[0][e[0]])/100},S=(e,t)=>t?(e-t)/t*100:0,b=(e,t)=>t?e/t*100:0,C=()=>{c.value=p.value.filter((e=>e.isSelected)).length},E=()=>{if(!i.value||i.value.length<1)return;let e=[],t=[{label:"Schedule",data:[],backgroundColor:["#e65d79"],hidden:!1},{label:"Actual",data:[],backgroundColor:["#6375ff"],hidden:!1},{label:"Budget",data:[],backgroundColor:["#ffe04e"],hidden:!1},{label:"Sales",data:[],backgroundColor:["#96ff8c"],hidden:!1}];for(let s of p.value)"scheduled"!==s.key||s.isSelected||(t[0].hidden=!0),"actual"!==s.key||s.isSelected||(t[1].hidden=!0),"budgeted"!==s.key||s.isSelected||(t[2].hidden=!0),"sales"!==s.key||s.isSelected||(t[3].hidden=!0);for(const s of i.value)e.push(s.day),t[0].data.push(s.scheduled),t[1].data.push(s.actual),t[2].data.push(s.budgeted),t[3].data.push(s.sales);let a=document.getElementById("myChart").getContext("2d"),l={type:"bar",data:{labels:e,datasets:t},options:{responsive:!0,plugins:{legend:{labels:{filter:function(e){return!e.hidden}}}}}};RD?null===RD.ctx?RD=new hc.A(a,l):(RD.data.labels=e,RD.data.datasets=t,RD.update()):RD=new hc.A(a,l)};function w(e,t){return t?e+"%":f.value===WD.unit?e||0:"$"+e||0}async function L(){if(y.value)return void Ma.alert("No data to export");Ma.loading();const e=i.value;Ma.clear();let t="data:text/csv;charset=utf-8,",a=[];for(let i in d.value)a.push(d.value[i].heading);t+=",,"+a.join(",")+"\r\n";const l=e.map(((e,t)=>{const a=[e.day,e.weekDay,...Object.entries(d.value).map((([t,a])=>{let l="";return void 0===e[t]||null===e[t]?"":(l+=e[t]?e[t]:"",a.isCalculated&&(l+="%"),l)}))];return a.join(",")}));t+=l.join("\r\n"),t+="\r\n";let s=["Total","",...Object.entries(d.value).map((([e,t])=>{let a="";return void 0===n.value[e]||null===n.value[e]?"":(a+=n.value[e]?n.value[e]:"",a=a.replace(/,/g,""),t.isCalculated&&(a+="%"),a)}))];s.join(","),t+=s,t+="\r\n";var o=encodeURI(t),r=document.createElement("a");r.setAttribute("href",o),r.setAttribute("download","Analytic.csv"),document.body.appendChild(r),r.click()}return(0,o.wB)(p,((e,t)=>{d.value={};for(const[a,l]of Object.entries(u.value)){const t=e.find((e=>e.key.toLowerCase()===a.toLowerCase()));t&&t.isSelected&&(d.value[a]=l,d.value[a].isDisplay=t.isSelected)}E(),localStorage.setItem("costAnalysisSetting_v1.3",JSON.stringify(e))}),{deep:!0}),(0,o.sV)((()=>{console.log("weekly mounted");const e=JSON.parse(localStorage.getItem("costAnalysisSetting_v1.3"));e&&(p.value=e),g()})),(0,o.hi)((()=>{RD.destroy(),RD=null})),{selectedDate:a,data:l,calculatedData:i,total:n,totalInNumber:r,displayN:c,displayList:d,sourceDisplayList:u,weekStart:h,weekEnd:m,displayOptions:p,getDisplayValue:w,getDataStyle:k,getGridTemplateStyle:v,loadGridData:g,calculateTotal:D,exportCSV:L}},computed:{comparedValue(){let e=[];for(let[t,a]of Object.entries(this.displayList))a.isDisplay&&e.push(a);return e}}});const YD=(0,ke.A)(ID,[["render",ND],["__scopeId","data-v-c226ebb6"]]);var _D=YD;const HD=e=>((0,o.Qi)("data-v-3d31e713"),e=e(),(0,o.jt)(),e),XD={key:0,class:"mt-4"},jD=HD((()=>(0,o.Lk)("h3",null,"No data found.",-1))),VD=[jD],$D={key:1,class:"mt-4 costAnalaysisBody"},KD={class:"cost-grid"},BD={class:"day-arr cost-grid-heading"},UD=HD((()=>(0,o.Lk)("div",{class:"table-cell"},null,-1))),QD={key:0,class:"table-cell"},GD={class:"day-arr"},zD={key:0,class:"table-cell bold"},JD={class:"main-canvas-wrapper"},ZD={class:"myChart-wrapper",style:{height:"600px"}},qD={class:"main-canvas",ref:"myChartRef",id:"employeeWeeklyChart"},eS={class:"mt-4 ml-4"};function tS(e,t,a,s,i,n){const r=(0,o.g2)("perfect-scrollbar");return(0,o.uX)(),(0,o.CE)(o.FK,null,[e.data[0]?((0,o.uX)(),(0,o.CE)("div",$D,[(0,o.Lk)("div",KD,[(0,o.Lk)("div",BD,[UD,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.displayList,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{class:"table-cell",key:t},(0,h.v_)(e),1)))),128))]),(0,o.bF)(r,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.formattedData,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{class:"day-arr",key:t},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e,((e,t)=>((0,o.uX)(),(0,o.CE)("span",{class:"day-cell",key:t},[null!==e&&void 0!==e?((0,o.uX)(),(0,o.CE)("div",QD,(0,h.v_)(e),1)):(0,o.Q3)("",!0)])))),128))])))),128)),(0,o.Lk)("div",GD,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.formattedTotal,((e,t)=>((0,o.uX)(),(0,o.CE)("span",{class:"day-cell",key:t},[null!==e&&void 0!==e?((0,o.uX)(),(0,o.CE)("div",zD,(0,h.v_)(e),1)):(0,o.Q3)("",!0)])))),128))])])),_:1})])])):((0,o.uX)(),(0,o.CE)("div",XD,VD)),(0,o.bo)((0,o.Lk)("div",JD,[(0,o.Lk)("div",ZD,[(0,o.Lk)("canvas",qD,null,512)])],512),[[l.aG,e.currentEmployeeList.length<=20]]),(0,o.bo)((0,o.Lk)("div",eS,"Graphs can only show up to 20 employees.",512),[[l.aG,e.currentEmployeeList.length>20]])],64)}let aS=null;var lS=(0,o.pM)({name:"EmployeeWeekly",components:{CustomSelect:fo,Modal:Re,Dialog:Ma},props:{dayFocus:{type:Object},fromDate:{type:Object},toDate:{type:Object},selectedUnit:{type:String},modalIndex:{type:Number},employeeList:{type:Array}},setup(e){const t=(0,je.Pj)(),a=(0,s.KR)(null),l=(0,s.KR)([]),i=(0,s.KR)([]),n=(0,s.KR)([]),r=(0,s.KR)([]),c=(0,s.KR)(["hours","unit"]),d=(0,s.KR)([]),u=(0,s.KR)({}),h=(0,s.KR)({}),m=(0,s.KR)(6),p=(0,s.KR)({}),y=(0,s.KR)({scheduled:{heading:"Schedule",isDisplay:!0,isCalculated:!1},actual:{heading:"Actual",isDisplay:!1,isCalculated:!1},budgeted:{heading:"Budget",isDisplay:!1,isCalculated:!1},sales:{heading:"Sales",isDisplay:!1,isCalculated:!1}}),f=(0,s.KR)(""),k=(0,s.KR)(""),v=(0,s.KR)(!1),g=(0,s.KR)(),D=(0,s.KR)(e.selectedUnit),S=(0,s.KR)(e.employeeList);(0,o.sV)((()=>{b()})),(0,o.hi)((()=>{aS.destroy(),aS=null}));const b=()=>{S.value=e.employeeList,D.value=e.selectedUnit,D.value===WD.value?g.value={symbol:"$",precision:2}:g.value={symbol:"",precision:2};let a=e.fromDate.clone().format("YYYY-MM-DD"),s=e.toDate.clone().format("YYYY-MM-DD");Ma.loading(),t.dispatch(Hg.fetchEmployeeWeeklyAnalysisData,{weekStart:a,weekEnd:s,employeeNumbers:e.employeeList.filter((e=>null!==e&&void 0!==e)),selectedUnit:e.selectedUnit?.toLowerCase(),pageNumber:1,pageSize:1e3}).then((e=>{console.log("res",e.response),p.value=["Schedule","Actual","Variance"],l.value=e.response.map((e=>[e.employee,e.scheduled,e.actual,e.variance])),i.value=e.response.map((e=>[e.employee,Uc()(e.scheduled).format(g.value),Uc()(e.actual).format(g.value),Uc()(e.variance).format(g.value)]));const t=l.value.reduce(((e,t)=>(e[0]+=t[1],e[1]+=t[2],e[2]+=t[3],e)),[0,0,0]);u.value=t,h.value=["Total",...t.map((e=>Uc()(e).format(g.value)))],(0,o.dY)((()=>{C(),Ma.clear()}))}))},C=()=>{console.log("data",l.value);let e=[],t=[{label:"Scheduled",data:[],backgroundColor:["rgba(255, 99, 132)"]},{label:"Actual",data:[],backgroundColor:"#93e093"}];e=l.value.map((e=>e[0]));for(const o of l.value)t[0].data.push(o[1]),t[1].data.push(o[2]);let a=document.getElementById("employeeWeeklyChart").getContext("2d"),s={type:"bar",data:{labels:e,datasets:t},options:{responsive:!0}};aS?(console.log("my chart",aS),null===aS.ctx?aS=new hc.A(a,s):(aS.data.labels=e,aS.data.datasets=t,aS.update())):aS=new hc.A(a,s)};async function E(){if(v.value)return void Ma.alert("No data to export");Ma.loading();const e=l.value;Ma.clear();let t="data:text/csv;charset=utf-8,";t+=","+p.value.join(",")+"\r\n",e.map((e=>{t+=Object.values(e).join(",")+"\r\n"})),t+=["Total",...u.value].slice().join(",")+"\r\n";var a=encodeURI(t),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download","Analytic.csv"),document.body.appendChild(s),s.click()}return{selectedDate:a,data:l,formattedData:i,dataHours:n,dataUnits:r,unitOptions:c,calculatedData:d,total:u,formattedTotal:h,displayN:m,displayList:p,sourceDisplayList:y,weekStart:f,weekEnd:k,currentEmployeeList:S,loadDataBySelection:b,setGraphData:C,exportCSV:E}}});const sS=(0,ke.A)(lS,[["render",tS],["__scopeId","data-v-3d31e713"]]);var oS=sS;const iS=e=>((0,o.Qi)("data-v-7131e53c"),e=e(),(0,o.jt)(),e),nS={key:0,class:"mt-4"},rS=iS((()=>(0,o.Lk)("h3",null,"No data found.",-1))),cS=[rS],dS={key:1,class:"mt-4 costAnalaysisBody"},uS={class:"d-flex align-center"},hS=iS((()=>(0,o.Lk)("span",null,"Select Data",-1))),mS={class:"cost-grid mt-4"},pS=iS((()=>(0,o.Lk)("div",{class:"table-cell"},null,-1))),yS=iS((()=>(0,o.Lk)("div",{class:"table-cell"},null,-1))),fS={key:0,class:"table-cell"},kS={key:0,class:"table-cell bold"},vS={class:"main-canvas-wrapper"},gS={class:"myChart-wrapper",style:{"min-height":"600px"}},DS={class:"main-canvas",ref:"myChartRef",id:"payDetailChart",colours:"[ { fillColor: '#ffff00' }, { fillColor: '#0066ff' } ]"},SS={class:"mt-4"};function bS(e,t,a,s,i,n){const r=(0,o.g2)("multi-select"),c=(0,o.g2)("perfect-scrollbar");return e.data[0]?((0,o.uX)(),(0,o.CE)("div",dS,[(0,o.Lk)("div",uS,[hS,(0,o.bF)(r,{class:"ml-2",selectOptionInput:e.selectableOption,targetString:"value",onSelectOption:e.selectChartOption},null,8,["selectOptionInput","onSelectOption"])]),(0,o.Lk)("div",mS,[(0,o.Lk)("div",{class:"cost-grid-heading",style:(0,h.Tr)(e.headingStyle)},[pS,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.heading,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{class:"table-cell",key:t},(0,h.v_)(e),1)))),128))],4),(0,o.Lk)("div",{class:"cost-grid-second-heading",style:(0,h.Tr)(e.secondHeadingStyle)},[yS,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.secondHeading,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{class:"table-cell",key:t},(0,h.v_)(e),1)))),128))],4),(0,o.bF)(c,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.data,((t,a)=>((0,o.uX)(),(0,o.CE)("div",{class:"day-arr",key:a,style:(0,h.Tr)(e.secondHeadingStyle)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t,((e,t)=>((0,o.uX)(),(0,o.CE)("span",{class:"day-cell",key:t},[null!==e&&void 0!==e?((0,o.uX)(),(0,o.CE)("div",fS,(0,h.v_)(e),1)):(0,o.Q3)("",!0)])))),128))],4)))),128)),(0,o.Lk)("div",{class:"day-arr",style:(0,h.Tr)(e.secondHeadingStyle)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.totals,((e,t)=>((0,o.uX)(),(0,o.CE)("span",{class:"day-cell",key:t},[null!==e&&void 0!==e?((0,o.uX)(),(0,o.CE)("div",kS,(0,h.v_)(e),1)):(0,o.Q3)("",!0)])))),128))],4)])),_:1})]),(0,o.bo)((0,o.Lk)("div",vS,[(0,o.Lk)("div",gS,[(0,o.Lk)("canvas",DS,null,512)])],512),[[l.aG,e.currentEmployeeList.length<=20]]),(0,o.bo)((0,o.Lk)("div",SS,"Graphs can only show up to 20 employees.",512),[[l.aG,e.currentEmployeeList.length>20]])])):((0,o.uX)(),(0,o.CE)("div",nS,cS))}let CS=null;var ES;(function(e){e["Z1Scheduled01NormalHours"]="z1Scheduled 01 - Normal Hours",e["Z1Scheduled02TimeAndHalf"]="z1Scheduled 02 - Time & Half",e["Z1Scheduled03Double"]="z1Scheduled 03 - Double",e["Z2Actual01NormalHours"]="z2Actual 01 - Normal Hours",e["Z2Actual02TimeAndHalf"]="z2Actual 02 - Time & Half",e["Z2Actual03Double"]="z2Actual 03 - Double",e["Z3Variance01NormalHours"]="z3Variance 01 - Normal Hours",e["Z3Variance02TimeAndHalf"]="z3Variance 02 - Time & Half",e["Z3Variance03"]="z3Variance 03 - Double"})(ES||(ES={}));var wS=(0,o.pM)({name:"PayDetailView",components:{Dialog:Ma,CustomSelect:fo,Modal:Re,MultiSelect:Kc},props:{dayFocus:{type:Object},fromDate:{type:Object},toDate:{type:Object},selectedUnit:{type:String},employeeList:{type:Array},modalIndex:{type:Number}},setup(e){const t=(0,je.Pj)(),a=(0,s.KR)(null),l=(0,s.KR)([]),i=(0,s.KR)([]),n=(0,s.KR)([]),r=(0,s.KR)([]),c=(0,s.KR)([]),d=(0,s.KR)(["hours","unit"]),u=(0,s.KR)([{key:"normalHours",value:"Ordinary",isSelected:!0},{key:"timeAndHalf",value:"Time & Half",isSelected:!0},{key:"double",value:"Double",isSelected:!0}]),h=(0,s.KR)([]),m=(0,s.KR)(6),p=(0,s.KR)({}),y=(0,s.KR)(["Schedule","Actual","Variance"]),f=(0,s.KR)(["Ordinary","Time & Half","Double","Ordinary","Time & Half","Double","Ordinary","Time & Half","Double"]),k=(0,s.KR)(""),v=(0,s.KR)(""),g=(0,s.KR)(),D=(0,s.KR)(),S=(0,s.KR)(!1),b=(0,s.KR)({"grid-template-columns":"100px repeat(3, 242px)"}),C=(0,s.KR)({"grid-template-columns":"repeat(3, 80px)"}),E=(0,s.KR)(),w=(0,s.KR)(e.selectedUnit),L=(0,s.KR)(),T=(0,s.KR)(),x=(0,s.KR)(e.employeeList);async function A(){Ma.loading();let a=e.fromDate.clone().format("YYYY-MM-DD"),s=e.toDate.clone().format("YYYY-MM-DD");w.value=e.selectedUnit,x.value=e.employeeList,w.value===WD.value?E.value={symbol:"$",precision:2}:E.value={symbol:"",precision:2};const r=await t.dispatch(Hg.fetchPayDetailViewData,{weekStart:a,weekEnd:s,employeeNumbers:e.employeeList.filter((e=>null!==e&&void 0!==e)),selectedUnit:e.selectedUnit?.toLowerCase(),pageNumber:1,pageSize:1e3,payCodes:["01","02","03","04","05"]});if(!r)return;n.value=r.response.map((e=>[e.CommonName,e[ES.Z1Scheduled01NormalHours],e[ES.Z1Scheduled02TimeAndHalf],e[ES.Z1Scheduled03Double],e[ES.Z2Actual01NormalHours],e[ES.Z2Actual02TimeAndHalf],e[ES.Z2Actual03Double],e[ES.Z3Variance01NormalHours],e[ES.Z3Variance02TimeAndHalf],e[ES.Z3Variance03]])),i.value=r.response.map((e=>[e.CommonName,Uc()(e[ES.Z1Scheduled01NormalHours],{precision:2}).format(E.value),Uc()(e[ES.Z1Scheduled02TimeAndHalf],{precision:2}).format(E.value),Uc()(e[ES.Z1Scheduled03Double],{precision:2}).format(E.value),Uc()(e[ES.Z2Actual01NormalHours],{precision:2}).format(E.value),Uc()(e[ES.Z2Actual02TimeAndHalf],{precision:2}).format(E.value),Uc()(e[ES.Z2Actual03Double],{precision:2}).format(E.value),Uc()(e[ES.Z3Variance01NormalHours],{precision:2}).format(E.value),Uc()(e[ES.Z3Variance02TimeAndHalf],{precision:2}).format(E.value),Uc()(e[ES.Z3Variance03],{precision:2}).format(E.value)])),l.value=$e().clone(r.response);const c=n.value.reduce(((e,t)=>{for(let a=1;a<t.length;a++)e[a-1]+=t[a];return e}),new Array(10).fill(0));L.value=c,console.log("sourceTotal",L.value),T.value=c.map((e=>Uc()(e,{precision:2}).format(E.value))),T.value.unshift("Total"),T.value.pop();let d=u.value.filter((e=>!0===e.isSelected));W(d.length),R(d.length),(0,o.dY)((()=>{F(),M(),Ma.clear()}))}function F(){let e=["Ordinary","Time & Half","Double","Ordinary","Time & Half","Double","Ordinary","Time & Half","Double"];u.value.map((t=>{!t.isSelected&&t.value&&(e=e.filter((e=>t.value!==e)))})),f.value=e,i.value=l.value.map((e=>{let t=[];return t.push(e.CommonName),u.value[0].isSelected&&t.push(Uc()(e[ES.Z1Scheduled01NormalHours],{precision:2}).format(E.value)),u.value[1].isSelected&&t.push(Uc()(e[ES.Z1Scheduled02TimeAndHalf],{precision:2}).format(E.value)),u.value[2].isSelected&&t.push(Uc()(e[ES.Z1Scheduled03Double],{precision:2}).format(E.value)),u.value[0].isSelected&&t.push(Uc()(e[ES.Z2Actual01NormalHours],{precision:2}).format(E.value)),u.value[1].isSelected&&t.push(Uc()(e[ES.Z2Actual02TimeAndHalf],{precision:2}).format(E.value)),u.value[2].isSelected&&t.push(Uc()(e[ES.Z2Actual03Double],{precision:2}).format(E.value)),u.value[0].isSelected&&t.push(Uc()(e[ES.Z3Variance01NormalHours],{precision:2}).format(E.value)),u.value[1].isSelected&&t.push(Uc()(e[ES.Z3Variance02TimeAndHalf],{precision:2}).format(E.value)),u.value[2].isSelected&&t.push(Uc()(e[ES.Z3Variance03],{precision:2}).format(E.value)),t}));let t=[];t.push("Total"),u.value[0].isSelected&&t.push(Uc()(L.value[0],{precision:2}).format(E.value)),u.value[1].isSelected&&t.push(Uc()(L.value[1],{precision:2}).format(E.value)),u.value[2].isSelected&&t.push(Uc()(L.value[2],{precision:2}).format(E.value)),u.value[0].isSelected&&t.push(Uc()(L.value[3],{precision:2}).format(E.value)),u.value[1].isSelected&&t.push(Uc()(L.value[4],{precision:2}).format(E.value)),u.value[2].isSelected&&t.push(Uc()(L.value[5],{precision:2}).format(E.value)),u.value[0].isSelected&&t.push(Uc()(L.value[6],{precision:2}).format(E.value)),u.value[1].isSelected&&t.push(Uc()(L.value[7],{precision:2}).format(E.value)),u.value[2].isSelected&&t.push(Uc()(L.value[8],{precision:2}).format(E.value)),console.log("newTotal",t),T.value=t;let a=u.value.filter((e=>!0===e.isSelected));W(a.length),R(a.length),O()}function N(){let e={schedule:{ordinary:{label:"Schedule - Ordinary",backgroundColor:"#ff6384",data:[]},half:{label:"Schedule - Time & Half",backgroundColor:"#464531",data:[]},double:{label:"Schedule - Double",backgroundColor:"#1B5583",data:[]}},actual:{ordinary:{label:"Actual - Ordinary",backgroundColor:"#93e093",data:[]},half:{label:"Actual - Time & Half",backgroundColor:"#1f77b4",data:[]},double:{label:"Actual - Double",backgroundColor:"#ff7f0e",data:[]}},variance:{ordinary:{label:"Variance - Ordinary",backgroundColor:"#2ca02c",data:[]},half:{label:"Variance - Time & Half",backgroundColor:"#d62728",data:[]},double:{label:"Variance - Double",backgroundColor:"#9467bd",data:[]}}};for(const a of n.value)e.schedule.ordinary.data.push(a[1]),e.actual.half.data.push(a[2]),e.variance.double.data.push(a[3]),e.actual.ordinary.data.push(a[4]),e.schedule.half.data.push(a[5]),e.schedule.double.data.push(a[6]),e.variance.ordinary.data.push(a[7]),e.variance.half.data.push(a[8]),e.variance.double.data.push(a[9]);let t=[];return u.value[0].isSelected&&(t.push(e.schedule.ordinary),t.push(e.actual.ordinary),t.push(e.variance.ordinary)),u.value[1].isSelected&&(t.push(e.schedule.half),t.push(e.actual.half),t.push(e.variance.half)),u.value[2].isSelected&&(t.push(e.schedule.double),t.push(e.actual.double),t.push(e.variance.double)),t}function M(){let e=[];e=i.value.map((e=>e[0]));let t=document.getElementById("payDetailChart");if(!t)return;let a=t.getContext("2d"),l={type:"bar",data:{labels:e,datasets:N()},options:{responsive:!0}};CS?O():CS=new hc.A(a,l)}async function P(){if(S.value)return void Ma.alert("No data to export");Ma.loading();const e=i.value;Ma.clear();let t="data:text/csv;charset=utf-8,";t+=OD[0].join(",")+"\r\n"+OD[1].join(",")+"\r\n",e.map((e=>{t+=e.map((e=>`"${e}"`)).join(",")+"\r\n"})),t+=[...T.value].slice().map((e=>`"${e}"`)).join(",")+"\r\n";var a=encodeURI(t),l=document.createElement("a");l.setAttribute("href",a),l.setAttribute("download","Analytic.csv"),document.body.appendChild(l),l.click()}function O(){if(!CS)return;const e=i.value.map((e=>e[0]));CS.data.labels=e,CS.data.datasets=N(),CS.update()}function W(e){b.value={"grid-template-columns":`100px repeat(3, ${80*e+e-1}px)`}}function R(e){C.value={"grid-template-columns":`100px repeat(${3*e}, 80px)`}}return(0,o.sV)((()=>{console.log(" pay detailed view mounted"),(0,o.dY)((()=>{M()}))})),(0,o.hi)((()=>{CS&&(CS.destroy(),CS=null)})),(0,o.wB)(u,(async e=>{await F()}),{deep:!0}),A(),{selectableOption:u,fromDate:g,toDate:D,graphData:n,data:i,selectedDate:a,dataHours:r,dataUnits:c,unitOptions:d,calculatedData:h,totals:T,displayN:m,displayList:p,heading:y,secondHeading:f,weekStart:k,weekEnd:v,headingStyle:b,secondHeadingStyle:C,currentEmployeeList:x,loadDataBySelection:A,selectChartOption:F,setGraphData:M,exportCSV:P}}});const LS=(0,ke.A)(wS,[["render",bS],["__scopeId","data-v-7131e53c"]]);var TS=LS,xS=(0,o.pM)({name:"Analysis",components:{PayDetailView:TS,DetailCostReport:Ug,SimpleAnalysis:hD,CostAnalysisWeekly:_D,EmployeeWeekly:oS,Modal:Re,CustomSelect:fo,MultiSelect:Kc,DatePicker:$a},setup(){const e=(0,je.Pj)(),t=(0,s.KR)([]),a=(0,s.KR)(1),l=(0,s.KR)(20),i=(0,s.KR)(5),n=(0,s.KR)([]),r=(0,s.KR)(0),c=(0,s.KR)(!1),d=(0,s.KR)(),u=(0,s.KR)(),h=(0,s.KR)(),m=(0,s.KR)(),p=(0,s.KR)(),y=(0,s.KR)(),f=(0,s.KR)(WD.value),k=(0,s.KR)([WD.value,WD.unit]),v=(0,s.KR)(null),g=(0,s.KR)(null),D=(0,s.KR)([]),S=(0,s.KR)([]),b=(0,s.KR)(""),C=(0,s.KR)(""),E=(0,s.KR)(0),w=(0,s.KR)(0),L=(0,s.KR)(null),T=(0,s.KR)(null),x=(0,s.KR)(Be()()),A=(0,s.KR)(uD.weekly),F=(0,s.KR)(uD.weekly),N=(0,s.KR)([]),M=(0,s.KR)([uD.simple,uD.detailed,uD.weekly,uD.employeeWeekly,uD.payDetailView]),P=(0,o.nI)(),O=Affinity.user||P.appContext.config.globalProperties.$user;async function W(){await e.dispatch(Rs.getEmployees,O.EmployeeNo).then((e=>{S.value=e.filter((e=>"B"!==e.payType&&"S"!==e.payType)).map((e=>(e.isSelected=!0,e))),D.value=e.filter((e=>"B"!==e.PayType&&"S"!==e.PayType)).map((e=>e.employeeNo))})),await R()}async function R(){try{if(v.value&&g.value&&g.value.diff(v.value,"weeks")>=6)throw Ma.alert("You can only view information up to six weeks in the past."),"weeks error";F.value=A.value,F.value===uD.simple?u.value.loadGridData():F.value===uD.detailed?h.value.loadGridData():F.value===uD.weekly?m.value.loadGridData():F.value===uD.employeeWeekly?p.value.loadDataBySelection():F.value===uD.payDetailView&&y.value.loadDataBySelection()}catch(e){}}async function I(e,t){let a=e.target.getClientRects()[0];E.value=a.bottom,w.value=a.left,v&&(T.value=v.value.clone().subtract(1,"day"),L.value=null),x.value=g.value?g.value:Be()();const l=await _();g.value=l||void 0,C.value=g.value.format("DD/MM/YYYY")}async function Y(e,t){let a=e.target.getClientRects()[0];E.value=a.bottom,w.value=a.left,g&&(T.value=null,L.value=g.value.clone().add(1,"day")),x.value=v.value?v.value:Be()();const l=await _();v.value=l||void 0,b.value=v.value.format("DD/MM/YYYY")}async function _(){return await d.value.toggleShow(x.value)}async function H(){F.value===uD.simple?await u.value.exportCSV():F.value===uD.detailed?await h.value.exportCSV():F.value===uD.weekly?await m.value.exportCSV():F.value===uD.employeeWeekly?await p.value.exportCSV():F.value===uD.payDetailView&&await y.value.exportCSV()}async function X(e){A.value=e}function j(e){f.value=e}function V(){return S.value.filter((e=>e.isSelected)).map((e=>e.employeeNo))}return(0,o.sV)((()=>{v.value&&g.value||(v.value||(v.value=Be()().startOf("month"),b.value=v.value.format("DD/MM/YYYY")),g.value||(g.value=Be()().endOf("month").startOf("day"),C.value=g.value.format("DD/MM/YYYY"))),W()})),{DatePickerRef:d,CostDetailAnalysisRef:h,SimpleAnalysisRef:u,CostAnalysisWeeklyRef:m,EmployeeWeeklyRef:p,PayDetailViewRef:y,data:t,dataAnalysis:N,options:M,selectedView:F,selectedViewFromDropdown:A,pageNumber:a,pageSize:l,totalPages:i,pageList:n,noDataError:c,recordCount:r,selectedUnit:f,unitOptions:k,dateModalTop:E,dateModalLeft:w,datePickerMax:L,datePickerMin:T,datePickerTargetDay:x,fromDate:v,toDate:g,fromDateText:b,toDateText:C,employeeList:D,selectableEmployeeList:S,updateToDateTime:I,updateFromDateTime:Y,exportCSVByView:H,selectGridData:X,loadGridDataBySelection:R,selectUnitOption:j,selectedEmployeeList:V,SelectableView:uD}}});const AS=(0,ke.A)(xS,[["render",kg],["__scopeId","data-v-2be9851b"]]);var FS=AS;const NS=[{path:"/login",name:"Login",component:eg},{path:"/my-schedules",name:"My Schedule",component:Ua},{path:"/availability",name:"Availability",component:Iv},{path:"/flex-schedule",name:"Flex Schedule",component:_f,beforeEnter:(e,t,a)=>{nt()?a("/flex-schedule-mobile"):a()}},{path:"/flex-schedule-mobile",name:"FlexScheduleMobile",component:sk},{path:"/my-team",name:"EmployeeTeamSchedule",component:dk},{path:"/my-team-mobile",name:"EmployeeTeamScheduleMobile",component:Lk},{path:"/team-schedules",name:"Schedule Management",component:ti},{path:"/employee-allocations",name:"Employee Allocation",component:Vr},{path:"/cost-reports",name:"Analysis",component:FS},{path:"/",name:"Home",component:Ua}],MS=(0,pt.aE)({history:(0,pt.LA)("/"),routes:NS});var PS=MS;const OS={state:{magic:123},modules:{FlexSchedule:st,LookUp:Wd,EmployeeModule:js,AnalysisModule:$g}};var WS=new je.Ay.Store(OS),RS=a(6720),IS=a(9241);const YS={reformatDate(e){if(!e)return e;if("string"===typeof e)return e;if("object"===typeof e&&"Date"===e.constructor?.name){let t=Be()(e);return t.format("DD/MM/YYYY")}if(e.isValid()){let t=Be()(e);return null!=t&&t.isValid()?t.format("DD/MM/YYYY"):e}return e},reformatDateString(e,t){return e&&"string"===typeof e?Be()(e,t).format("DD/MM/YYYY"):e},reformatTime(e){if(!e)return e;let t=Be()(e);if(null==t||!t.isValid()){let t=Be()(e,"h:m");return null!=t&&t.isValid()?t.format("HH:mm"):e}return t.format("HH:mm")},reformatBreakHours(e){if(!e)return e;let t=e,a=Math.floor(t),l=t-a;return l>0&&(l=Math.round(60*l)),a&&l?`${a}:${l}`:a?`${a} hour`:l?`${l} min`:void 0},ordinalSuffix(e){let t=e%10,a=e%100;return 1==t&&11!=a?e+"st":2==t&&12!=a?e+"nd":3==t&&13!=a?e+"rd":e+"th"}};var _S=YS,HS=a(9594),XS=a(8534),jS=a(9169),VS=a(6495);const $S={chevronUp:HS.A,chevronLeft:XS.A,chevronRight:jS.A,chevronDown:VS.A};var KS=$S;const BS={};var US={install:e=>{function t(t){e.config.globalProperties.$CompanyConfig?e.config.globalProperties.$CompanyConfig.isAllowPersonal=t:e.config.globalProperties.$CompanyConfig={isAllowPersonal:t}}function a(t){e.config.globalProperties.$CompanyConfig?e.config.globalProperties.$CompanyConfig.isAllowSundayFirst=t:e.config.globalProperties.$CompanyConfig={isAllowSundayFirst:t}}function l(){return e.config.globalProperties.$CompanyConfig?e.config.globalProperties.$CompanyConfig.isAllowPersonal:null}function s(){return e.config.globalProperties.$CompanyConfig?e.config.globalProperties.$CompanyConfig.isAllowSundayFirst:null}BS.setAllowPersonal=t,BS.getAllowPersonal=l,BS.setAllowSundayFirst=a,BS.getAllowSundayFirst=s,e.provide("MANAGE_COMPANY_CONFIG",BS)}},QS=a(7022);const GS=(0,RS.A)();navigator.serviceWorker.getRegistrations().then((function(e){for(let t of e)t.unregister()})),window.$globalConfig={t:""},window.$globalUser={t:""},window.myVue=(0,l.Ef)(mt),window.myVue.config.globalProperties.emitter=GS,window.myVue.config.globalProperties.$config=(0,s.KR)(window.$globalConfig),window.myVue.config.globalProperties.$user=(0,s.KR)(window.$globalUser),window.myVue.use(IS.Ay),window.myVue.use(QS.A),window.myVue.use(US),window.myVue.use(WS).use(PS).mount("#app"),window.myVue.config.globalProperties.$filters=_S,window.myVue.config.globalProperties.$icons=KS}},t={};function a(l){var s=t[l];if(void 0!==s)return s.exports;var o=t[l]={id:l,loaded:!1,exports:{}};return e[l].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=e,function(){var e=[];a.O=function(t,l,s,o){if(!l){var i=1/0;for(d=0;d<e.length;d++){l=e[d][0],s=e[d][1],o=e[d][2];for(var n=!0,r=0;r<l.length;r++)(!1&o||i>=o)&&Object.keys(a.O).every((function(e){return a.O[e](l[r])}))?l.splice(r--,1):(n=!1,o<i&&(i=o));if(n){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[l,s,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,l){var s,o,i=l[0],n=l[1],r=l[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(s in n)a.o(n,s)&&(a.m[s]=n[s]);if(r)var d=r(a)}for(t&&t(l);c<i.length;c++)o=i[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},l=self["webpackChunkschedule"]=self["webpackChunkschedule"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[504],(function(){return a(3112)}));l=a.O(l)})();
//# sourceMappingURL=app.js.map