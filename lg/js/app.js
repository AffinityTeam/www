(function(e){function t(t){for(var i,n,o=t[0],l=t[1],d=t[2],u=0,h=[];u<o.length;u++)n=o[u],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&h.push(a[n][0]),a[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);c&&c(t);while(h.length)h.shift()();return r.push.apply(r,d||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],i=!0,o=1;o<s.length;o++){var l=s[o];0!==a[l]&&(i=!1)}i&&(r.splice(t--,1),e=n(n.s=s[0]))}return e}var i={},a={app:0},r=[];function n(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=i,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=l;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"15d0":function(e,t,s){"use strict";s("2df7")},"2df7":function(e,t,s){},3789:function(e,t,s){},"3c61":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("88a7"),s("271a"),s("5494");var i=s("2b0e"),a=function(){var e=this,t=e._self._c;return t("router-view")},r=[],n=(s("d4d0"),s("3c61"),{name:"Setup",mounted(){}}),o=n,l=s("2877"),d=Object(l["a"])(o,a,r,!1,null,null,null),c=d.exports,u=s("8c4f"),h=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"login-underlay",attrs:{id:"login-underlay"}},[t("Header"),t("Footer")],1),t("div",{staticClass:"login"},[t("div",{staticClass:"login-box-bg hidden",attrs:{id:"login-box-bg"}}),t("div",{staticClass:"login-box-wrapper"},[t("div",{staticClass:"login-box smaller",attrs:{id:"login-box"}},[t("div",{staticClass:"box-title"},[e._v("Login")]),t("div",{staticClass:"box-body"},[this.error?t("div",{staticClass:"errormsg",domProps:{innerHTML:e._s(this.error)}}):e._e(),t("form",{on:{submit:function(t){return t.preventDefault(),e.handleFormSubmit.apply(null,arguments)}}},[t("fieldset",[t("div",{staticClass:"errormsg hidden"},[e._v("We could not log you in")]),t("div",{staticClass:"login-box-row label"},[t("input",{ref:"userName",attrs:{type:"text",id:"username",name:"username",autocomplete:"off",placeholder:"Username or email"},on:{change:e.checkEmail}}),t("a",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.unHelpTooltip,expression:"unHelpTooltip"}],staticClass:"username-question"},[t("span",{staticClass:"icon-help-round"})])]),e.showEmailUsers?t("div",{staticClass:"login-box-row label"},[t("div",{staticClass:"select"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.emailUser,expression:"emailUser"}],attrs:{id:"emailuser",name:"emailuser"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.emailUser=t.target.multiple?s:s[0]}}},[t("option",{attrs:{value:"null",disabled:"",selected:""}},[e._v("Username and company")]),e._l(e.availableEmailUsers,(function(s){return t("option",{key:s.UserName,domProps:{value:s.UserName}},[e._v(" "+e._s(s.UserName)+", "+e._s(s.CompanyName)+" ("+e._s(s.CompanyNumber)+") ")])}))],2)])]):e._e(),t("div",{staticClass:"login-box-row label"},[t("input",{ref:"password",attrs:{type:"password",id:"password",name:"password",autocomplete:"off",placeholder:"Password"}})]),t("div",{staticClass:"login-box-row buttons"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"loader"}),t("input",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"button green",attrs:{type:"submit",value:"Login",id:"loginButton"}})]),t("div",{staticClass:"login-box-row buttons"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.rememberMe,expression:"rememberMe"}],attrs:{type:"checkbox",id:"rememberMe",name:"rememberMe"},domProps:{checked:Array.isArray(e.rememberMe)?e._i(e.rememberMe,null)>-1:e.rememberMe},on:{change:function(t){var s=e.rememberMe,i=t.target,a=!!i.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);i.checked?n<0&&(e.rememberMe=s.concat([r])):n>-1&&(e.rememberMe=s.slice(0,n).concat(s.slice(n+1)))}else e.rememberMe=a}}}),t("label",{attrs:{for:"rememberMe"}},[e._v("Remember my username")])]),t("div",{staticClass:"login-box-row buttons stacked"},[t("router-link",{attrs:{to:{path:"/Recover",query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0}}},[e._v(" I have forgotten my password ")])],1)])])])])]),t("CitrixLogin")],1),e.displayMaintenance&&e.maintenanceHeading?t("div",{staticClass:"incidentBox"},[t("span",{staticClass:"alert-icon incident-icon mr-2"}),t("div",{staticClass:"incident-body"},[t("div",{staticClass:"incidentHeading"},[t("span",{staticClass:"align-middle incident-text"},[e._v(e._s(e.maintenanceHeading))])]),t("div",{staticClass:"incidentTime"},[e._v(" "+e._s(e.maintenanceTimeDate)+" from "+e._s(e.maintenanceTimeStart)+" to "+e._s(e.maintenanceTimeEnd)+" ")]),e._m(0)]),t("span",{staticClass:"cross-icon incident-icon ml-2",on:{click:function(t){return e.closeIncident()}}})]):e.displayIncident&&e.incidentsHeading?t("div",{staticClass:"incidentBox incidentBox-incident",class:{"incidentBox-incident":"minor"===e.incidentInpact,"incidentBox-incident-major":"minor"!==e.incidentInpact}},[t("span",{staticClass:"alert-icon incident-icon mr-2"}),t("div",{staticClass:"incident-body"},[t("div",{staticClass:"incidentHeading"},[t("span",{staticClass:"align-middle incident-text"},[e._v(e._s(e.incidentsHeading))])]),t("div",{staticClass:"incidentTime"},[e._v(" Created at "+e._s(e.incidentsTimeStart)+" ")]),t("div",[t("a",{staticClass:"incidentUrl",attrs:{href:e.incidentsshortLink,target:"_blank"}},[e._v("View Latest Update")])])]),t("span",{staticClass:"cross-icon incident-icon ml-2",on:{click:function(t){return e.closeIncident()}}})]):e._e()])},p=[function(){var e=this,t=e._self._c;return t("div",[t("a",{staticClass:"incidentUrl",attrs:{href:"https://affinityteam.statuspage.io/",target:"_blank"}},[e._v("View Latest Update")])])}],m=(s("14d9"),function(){var e=this;e._self._c;return e._m(0)}),v=[function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"citrixlogin"}},[t("a",{attrs:{href:"https://citrix.affinitylogon.com/"}},[e._v("Affinity Desktop User Login")])])}],f={name:"CitrixLogin"},g=f,w=Object(l["a"])(g,m,v,!1,null,null,null),y=w.exports,b=function(){var e=this;e._self._c;return e._m(0)},C=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-underlay-header"},[t("div",{staticClass:"companylogo"},[t("img",{attrs:{alt:"",src:"https://cdn.jsdelivr.net/gh/affinityteam/www-assets/v1/images/logo/affinity1_300_90.png"}})]),t("div",{staticClass:"heading"},[e._v("Affinity Self Service")]),t("div",{staticClass:"heading mobile"},[e._v("Self Service")])])}],A={name:"Header"},P=A,S=Object(l["a"])(P,b,C,!1,null,null,null),_=S.exports,x=function(){var e=this;e._self._c;return e._m(0)},U=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-underlay-footer"},[t("img",{attrs:{alt:"",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAAWCAMAAACi/q9qAAADAFBMVEXA1tbIz9DI3d2ClpaQenv4AACwOzigoKD////KAAB6goKlISOsAAC0s7OSmpnFxcW0AACMjIyJiYmLi4uUlJR4eHjyGhHsAATqAATyDw/mBAnp9/ff4+ONkpJTZWVYWFiUkpFoa2vqFhAAAADjFRXI//+c19yleXuABQWCBweQpqaolJSGGxvVPDyYx8jOzs7JKCujc3ZePT2DPz9wGxvLdXdvb2/mhYepFBLLeHorAADgGxqMFxdPJCafeXndAAHnAADMoKNnAACXRkjaFRrwAAXllJSILi7fSUnSsbHaVVXo9PSZJyjN7O/vMTN2h4nCOTzKCQuOYGHCCw7mdHO1urqzNznNeXzx7Oy75ujLaGrQ7O20AAC+ERTOhYXb8/WSNDbjtrfQ///ZHiLZgILdw8TE7+6yFhnH1NTr6+vo1tfE6elyTU3CICLe39/Pi42pEBXRDA7Yi43MX2HNpqc3AADIvb1jAADYAADxAAbdMjO/JSnC+/7D19iwCg/WbXDKs7Ow6e69AADHPkG4Gx3k7u/CZmfEQ0azLjHPUVPEmpyjDA98AAC4QkW4PD7Gxsfs0dLdu7zIEBLv2NnXmZrmxsXPfH6bAANIAABRAAB5AABxAAKpuLm7yszAPkGzsLDKGx6ux8ifAgWqpqe3wcP4AAChHB3BTE/1+fn89/agCQzGVFe0JSfWj5Lx29z37O3HyspbAADg5ufNAADEAAXR8vPn///4//+zAgfhoKDQMzS+NTfJYWPR4uPbJymAAADdmJrHAQW6AAC+REewHyGzAAPx1db18vLFAQbU2dr8///sv8DCWVu5LC7HAADdCAymAADuzc68AAXx///qAADeqqytAADTAgX05eXgAADt//+xAADG5eaKAAD04OCjAgWeAADaDRCqAQWYAADg///TAACqAACrAACGAADmAwnDAADEAAawAQXdAQScAgWSAADeAACPAAChAACoAACVAACTAADyAAbpAASaAADqAACXAADyAAXEAQbnAwn////6AAXsvBa+AAAAJHRSTlPO9Ljmtb2ZwTxygebOZlnj4CfdQfGPntzAHTxZHKUiOv4KwgBSaHnXAAAD/ElEQVR42pWSZVQcZxiFp+6eagTo1t29TTVGXJvQeNI0RjyhuLtbAsHdncWlaJYVdgMrLGuwygJZdnYG5gz0a95hz8nv9DnnvXPnnnn+DcYCnJZz+l0fWsH6PzCigys6/mEN0j34wKt3yQsvM6JTFXrWwWnF/UP1W4b/tTMBZy8TcHfaYrc/XgHxebSEBTyyVf6x+QawMDm5sDBZB7HInReYGerqmLwJ4pLjzzHi07hLHm0cn5IIbcZRo9BoM/QaDb2NRtuoxGY0GHolNptQ0jsqNMLS2NgIYibHiREf16R7RZI0XcaNrTgWKOqrCNEc6cRxfp9xnNunuoC3iETcFlzYVKE6L5RMTYGYG8Na9sSjTz5m2ZFefT3ShDp7yjRITJUjiwj1aBCiVSpNKcJDS7/qREQnUvegbnx8HETHzKeKOGnZCt/ctGvV1QcQQRNnkVpZiKyyvsqEBBmJopVnEaESd4Qisvi8kkDdlFoN4hdFAzu2nvpk0wZnx29SUn5BGi3VgyJMsTIlihYlJ6qsKKqjHJnQPhMXsrwjCpVQOTkY65mahk/J083NJZ9Vsb+/VP1znEyVaD0oE1UWaFEBoUw6YyqvTCreqVTJYitDlbzipOI91qu3bmGsvIbILdubxE3b2zs4+y+lXEnVUARhvVpitWhpQkvAWakI0qIlCdpKUlaihAAPRAf2e7VH2vz8/Hbv+7ZDfuradZOWpCxawkKSBHwMlSJoLa3VWkiLlaJIi4Wkchhx+bvCdfL6Pe7tYbtbu37IA7G7f+CEZmf/7w0VdFQRiqN5RRFUQll0v6w/keTBHKvB1eoc7L7V+rW6jfk+n4crcse+87qSSg4kCg8e60YZLRm2ATEffc1D3ngDvxB5ZyB+60BLS7dwHMDeeXuMsyHfx3N/Gyc7i2hLNeEn2Gf4whB5cLBx85A3XsjnyRsNzh4Z8rJCeWCpnBc8JZkCsLS3pvPSR8TsoaCg7HiCraRH/ZNd2SEeOvHRvQG6bV1df7Tq/LtqPDbr4nS7oIuPnu66CWD3HnB703Nb7Zr3uUOO0vVBhCH+pwVz266P6s1mQfyhUkFbcsChLEF9VoCL+aKvudXFbL4h+AfAlq71z8pG3KbOmg96asPDbWb9RUVMlbT5z78UMfoLJxVV5/SXFQpffdhJfbPnuTCYL+v1UqkUY6F1tYFputff2FTg1qzbK5COzPzaPjMyPTg4ODYzMwZ1ZOXhwzAwb9MrYR2bmQYw1sNojV5QsHq92c19yKd2em5ubnh4GA6Aag9Ie7HPDPCvLnVe5f7axGD7qoYvR378bX5+fvbvWYhZCKjzwGK1b8zM8BKIrGVYemZuptc9G/Pz/7tLXmTdBlo1OE6PvWbFAAAAAElFTkSuQmCC"}})])}],E={name:"Footer"},k=E,R=Object(l["a"])(k,x,U,!1,null,null,null),T=R.exports,O=s("5a0c"),N=s.n(O);function I(e,t,s){const i=new Date,a={value:t,expiry:i.getTime()+s};localStorage.setItem(e,JSON.stringify(a))}function q(e){const t=localStorage.getItem(e);if(!t)return null;const s=JSON.parse(t),i=new Date;return i.getTime()>s.expiry?(localStorage.removeItem(e),null):s.value}var $={name:"Login",props:["errorMsg"],components:{CitrixLogin:y,Header:_,Footer:T},created(){this.populatePage()},data(){return{unHelpTooltip:{content:"This can be your username, email, or membership number (but not your surname).",trigger:"hover focus click"},error:this.errorMsg||"",loading:!1,availableEmailUsers:null,rememberMe:!1,redirectUrl:"",emailUser:null,title:"",displayMaintenance:!0,maintenanceHeading:"",maintenanceTimeStart:"",maintenanceTimeEnd:"",maintenanceTimeDate:"",displayIncident:!0,incidentsHeading:"",incidentsTimeStart:"",incidentsshortLink:"",incidentInpact:""}},computed:{showEmailUsers(){return this.availableEmailUsers&&this.availableEmailUsers.length>1}},methods:{populatePage(){this.loading=!0,"undefined"!=typeof this.$route.query&&"undefined"!=typeof this.$route.query.redirectUrl&&(this.redirectUrl=this.$route.query.redirectUrl),this.$ajax.post("/auth/PopulatePage",{RedirectUrl:this.$validUrl(this.redirectUrl)?this.redirectUrl:""}).then(async e=>{if("undefined"!=typeof e.data){const{Error:s,ClientRedirect:i,RedirectUrl:a,RedirectPage:r,UserName:n,RememberMe:o,EmailUsers:l}=e.data;if(s)this.error=e.data.Error;else if(i&&a)window.location.href=a;else if(null!=r){var t={};"SetupQuestions"==r&&Questions.length&&(t={questions:Questions}),this.$router.push({name:r,params:t,query:a?{redirectUrl:a}:void 0})}o&&n&&(this.$refs.userName.value=n,this.rememberMe=!0),null!=l&&null!=l.Users&&(this.availableEmailUsers=l.Users)}}).catch(()=>{}).then(()=>{this.loading=!1})},checkEmail(){let e=this.$refs.userName.value;e&&this.$validateEmail(e)&&(this.loading=!0,this.$ajax.get("/auth/CheckEmail",{params:{email:e}}).then(t=>{const{AllowedForNewAuth:s,Users:i,EmailAddress:a}=t.data;e==a&&(this.availableEmailUsers=s?null:i)}).catch().then(()=>{this.loading=!1}))},handleFormSubmit(){let e={redirectUrl:this.$validUrl(this.redirectUrl)?this.redirectUrl:"",userName:this.$refs.userName.value,password:this.$refs.password.value,rememberMe:this.rememberMe,emailUser:this.emailUser};this.error="",""==e.userName&&""==e.password?this.error="Username and Password cannot be blank.":""==e.userName?this.error="Username cannot be blank.":""==e.password&&(this.error="Password cannot be blank."),""==this.error&&(this.loading=!0,this.$ajax.post("/auth/login",e).then(async e=>{if("undefined"!=typeof e.data){const{Error:t,ClientRedirect:s,RedirectUrl:i,RedirectPage:a,Questions:r,EssRedirect:n}=e.data;if(null!=t)this.error=e.data.Error,this.loading=!1;else{let t,o;if("MFA_V2"===a){localStorage.removeItem("MOUSSON_C");const e={name:a,query:i?{redirectUrl:i}:void 0};this.$router.push(e)}else{if(!n&&(["SetupPassword","Emails"].includes(a)<0||null==a)){const{authenticated:e,mfaRequired:s,otpChannels:a}=await this.$checkMFACookie(i);o=s&&!e,t=a}if(s&&i)o?this.$router.push({name:"MFA",params:{redirectUrl:i,otpChannels:t}}):(n||await this.$ajax.post("/legacy/success",null,{withCredentials:!0}),window.location.href=i);else if(a){let s={questions:void 0,otpChannels:t,mfaNotSet:o};"SetupQuestions"==a&&r.length&&(s.questions=e.data.Questions);const n={name:a,params:s,query:i?{redirectUrl:i}:void 0};this.$router.push(n)}}}}}).catch(()=>{this.loading=!1}))},closeIncident(){this.displayIncident=!1,this.displayMaintenance=!1,I("incidentBox","true",144e5)},loadIncidentBox(){this.$ajax.get("https://jwfkgpbj4kbg.statuspage.io/api/v2/summary.json").then(e=>e.data.incidents[0]?(this.displayIncident=!0,this.displayMaintenance=!1,this.incidentsHeading=e.data.incidents[0].name,this.incidentsTimeStart=N()(e.data.incidents[0].created_at).format("DD MMM YYYY HH:mm"),this.incidentsshortLink=e.data.incidents[0].shortlink,void(this.incidentInpact=e.data.incidents[0].impact)):e.data.scheduled_maintenances&&e.data.scheduled_maintenances[0]?(this.displayMaintenance=!0,this.displayIncident=!1,this.maintenanceHeading=e.data.scheduled_maintenances[0].name,this.maintenanceTimeDate=N()(e.data.scheduled_maintenances[0].scheduled_for).format("DD MMM YYYY"),this.maintenanceTimeStart=N()(e.data.scheduled_maintenances[0].scheduled_for).format("HH:mm"),void(this.maintenanceTimeEnd=N()(e.data.scheduled_maintenances[0].scheduled_until).format("HH:mm"))):void 0)}},mounted(){this.title=this.$router.history.current.meta.title,"true"!==q("incidentBox")&&this.loadIncidentBox()}},M=$,L=(s("dd9b"),Object(l["a"])(M,h,p,!1,null,null,null)),F=L.exports,D=function(){var e=this,t=e._self._c;return t("setup",{attrs:{title:"Set Up Your Email",error:e.error}},[t("form",{staticClass:"card-body",attrs:{method:"post"},on:{submit:function(t){return t.preventDefault(),e.handleFormSubmit.apply(null,arguments)}}},[t("div",{staticClass:"default-form w-border",staticStyle:{"text-align":"left",margin:"auto"}},[e.mfaLoading?t("div",{staticStyle:{"text-align":"center",padding:"20px 0 32px"}},[t("appIcons",{attrs:{asset:"loader"}})],1):e._e(),t("div",{staticClass:"form-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.WorkEmail,expression:"WorkEmail"}],staticClass:"long",attrs:{type:"text",disabled:e.mfaLoading,placeholder:"Enter Work Email (Optional)"},domProps:{value:e.WorkEmail},on:{input:function(t){t.target.composing||(e.WorkEmail=t.target.value)}}})]),t("div",{staticClass:"form-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.HomeEmail,expression:"HomeEmail"}],staticClass:"long",attrs:{type:"text",disabled:e.mfaLoading,placeholder:"Enter Personal Email "+(e.personalEmailRequired?"(Required)":"(Optional)")},domProps:{value:e.HomeEmail},on:{input:function(t){t.target.composing||(e.HomeEmail=t.target.value)}}})]),t("div",{staticClass:"form-row",staticStyle:{"text-align":"center"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"spinner small light"}),t("input",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"button large blue",attrs:{type:"submit",disabled:e.mfaLoading,value:"Continue"}})])])])])},j=[],V=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"login-underlay",attrs:{id:"login-underlay"}},[t("Header"),t("Footer")],1),t("div",{staticClass:"absolut-full content errorpage"},[t("div",{staticClass:"section setup-body"},[t("div",{staticClass:"section-body"},[t("div",{staticClass:"setup-content"},[t("h1",{directives:[{name:"show",rawName:"v-show",value:!e.hidePageTitle,expression:"!hidePageTitle"}]},[e._v(" "+e._s(e.title)+" ")]),e.success?t("div",{},[t("p",{staticStyle:{color:"#7abd2d"}},[e._v(e._s(e.success))])]):e._e(),e.error?t("div",{},[t("p",{staticStyle:{color:"red"},domProps:{innerHTML:e._s(e.error)}})]):e._e(),t("div",{},[e._t("default")],2)])])])])])},z=[],H={name:"Setup",components:{Header:_,Footer:T},props:["title","error","hidePageTitle","success","onMounted"],mounted(){this.onMounted&&this.onMounted()}},B=H,Q=Object(l["a"])(B,V,z,!1,null,null,null),W=Q.exports,Y=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("span",{staticClass:"app-icon"},["check-circle"==e.asset?t("svg",{attrs:{viewBox:"64 64 896 896",focusable:"false","data-icon":"check-circle",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"}},[t("path",{attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}}),t("path",{attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}})]):e._e(),"close-circle"==e.asset?t("svg",{attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false","data-icon":"close-circle",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"}},[t("path",{attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}})]):e._e(),"eye"==e.asset?t("svg",{attrs:{viewBox:"64 64 896 896",focusable:"false","data-icon":"eye",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"}},[t("path",{attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}})]):e._e(),"eye-invisible"==e.asset?t("svg",{attrs:{viewBox:"64 64 896 896",focusable:"false","data-icon":"eye-invisible",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"}},[t("path",{attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}}),t("path",{attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}})]):e._e(),"loader"==e.asset?t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",height:"5em",width:"5em","data-icon":"loader",viewBox:"0 0 200 200"}},[t("radialGradient",{attrs:{id:"a3",cx:".66",fx:".66",cy:".3125",fy:".3125",gradientTransform:"scale(1.5)"}},[t("stop",{attrs:{offset:"0","stop-color":"#1268B3"}}),t("stop",{attrs:{offset:".3","stop-color":"#1268B3","stop-opacity":".9"}}),t("stop",{attrs:{offset:".6","stop-color":"#1268B3","stop-opacity":".6"}}),t("stop",{attrs:{offset:".8","stop-color":"#1268B3","stop-opacity":".3"}}),t("stop",{attrs:{offset:"1","stop-color":"#1268B3","stop-opacity":"0"}})],1),t("circle",{attrs:{"transform-origin":"center",fill:"none",stroke:"url(#a3)","stroke-width":"15","stroke-linecap":"round","stroke-dasharray":"200 1000","stroke-dashoffset":"0",cx:"100",cy:"100",r:"70"}},[t("animateTransform",{attrs:{type:"rotate",attributeName:"transform",calcMode:"spline",dur:"2",values:"360;0",keyTimes:"0;1",keySplines:"0 0 1 1",repeatCount:"indefinite"}})],1),t("circle",{attrs:{"transform-origin":"center",fill:"none",opacity:".2",stroke:"#1268B3","stroke-width":"15","stroke-linecap":"round",cx:"100",cy:"100",r:"70"}})],1):e._e()])},G=[];let K=i["a"].extend({name:"AppIcons",props:["asset"]});var X=K,Z=X,J=(s("9bc2"),Object(l["a"])(Z,Y,G,!1,null,"9565230a",null)),ee=J.exports,te={name:"Emails",components:{Setup:W,AppIcons:ee},data(){return{error:"",loading:!1,redirectUrl:"",WorkEmail:"",HomeEmail:"",personalEmailRequired:!1,requiresMfa:void 0,mfaLoading:!1,useEmailsOnly:!1}},methods:{async checkCompanyMfa(){this.mfaLoading=!0;const e=await this.$ajax.get(this.$apiUrl+"/api/Setup/company-check",{withCredentials:!0}),{requiresMfa:t,contactDetailsAvailable:s,useEmailsOnly:i}=e.data;this.requiresMfa=t,this.useEmailsOnly=i,this.personalEmailRequired=t&&(!s||i),this.mfaLoading=!1},handleFormSubmit(){let e={redirectUrl:this.redirectUrl,HomeEmail:this.HomeEmail,WorkEmail:this.WorkEmail,requiresMfa:this.requiresMfa,IsSetupRequired:this.useEmailsOnly};this.error="",this.personalEmailRequired&&!e.HomeEmail?this.error="Personal email is required.":e.WorkEmail&&!this.$validateEmail(e.WorkEmail)?this.error="Work email is not valid.":e.HomeEmail&&!this.$validateEmail(e.HomeEmail)&&(this.error="Personal email is not valid."),""==this.error&&(this.loading=!0,this.$ajax.post("/Setup/Emails",e).then(async e=>{if("undefined"!=typeof e.data){const{Error:t,ClientRedirect:s,RedirectUrl:i,RedirectPage:a,EssRedirect:r}=e.data;if(null!=t)this.error=e.data.Error;else if(s&&i.length){let e,t;if(!r){const{authenticated:s,mfaRequired:a,otpChannels:r}=await this.$checkMFACookie(i);t=a&&!s,e=r}t?this.$router.push({name:"MFA",params:{redirectUrl:i,otpChannels:e}}):(r||await this.$ajax.post("/legacy/success",null,{withCredentials:!0}),window.location.href=i)}else if(null!=a){const e=null!=i?{redirectUrl:i}:{};this.$router.push({name:a,query:e})}}}).catch(e=>{401==e.status&&this.$router.push({name:"Login",query:{redirectUrl:this.redirectUrl||void 0}})}).then(()=>{this.loading=!1}))}},mounted(){"undefined"!=typeof this.$route.query&&"undefined"!=typeof this.$route.query.redirectUrl&&(this.redirectUrl=this.$route.query.redirectUrl),this.checkCompanyMfa()}},se=te,ie=(s("5be3"),Object(l["a"])(se,D,j,!1,null,"49af5e92",null)),ae=ie.exports,re=function(){var e=this,t=e._self._c;return t("setup",{attrs:{title:"Reset Your Password",error:e.error,hidePageTitle:e.hidePageTitle}},[t("form",{staticClass:"card-body",attrs:{method:"post"},on:{submit:function(t){return t.preventDefault(),e.handleFormSubmit.apply(null,arguments)}}},[t("div",{staticClass:"default-form w-border",staticStyle:{"text-align":"center",margin:"auto"}},[t("div",{staticClass:"form-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.userName,expression:"userName"},{name:"show",rawName:"v-show",value:!e.hideInput,expression:"!hideInput"}],staticClass:"long",attrs:{type:"text",autocomplete:"off",placeholder:"Username or email"},domProps:{value:e.userName},on:{input:[function(t){t.target.composing||(e.userName=t.target.value)},e.checkEmail]}})]),e.showEmailUsers?t("div",{staticClass:"form-row label"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.emailUser,expression:"emailUser"}],staticStyle:{width:"500px","box-sizing":"content-box"},attrs:{id:"emailuser",name:"emailuser"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.emailUser=t.target.multiple?s:s[0]}}},[t("option",{attrs:{value:"null",disabled:"",selected:""}},[e._v("Username and company")]),e._l(e.availableEmailUsers,(function(s){return t("option",{key:s.EmployeeNumber,domProps:{value:s.UserName}},[e._v(" "+e._s(s.UserName)+", "+e._s(s.CompanyName)+" ("+e._s(s.CompanyNumber)+") ")])}))],2)]):e._e(),t("div",{staticClass:"mt-4",staticStyle:{"text-align":"center"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"spinner small light"}),t("input",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"button large blue",attrs:{type:"submit",value:"Continue"}})])])])])},ne=[],oe={name:"Recover",data(){return{error:"",loading:!1,userName:"",redirectUrl:"",availableEmailUsers:null,instructionsMessage:"",hideInput:!1,emailUser:null,hidePageTitle:!1}},components:{Setup:W},computed:{showEmailUsers(){return this.availableEmailUsers&&this.availableEmailUsers.length>1}},methods:{handleFormSubmit(){let e={redirectUrl:this.redirectUrl,userName:this.userName,emailUser:this.emailUser,targetPath:this.$route.path};this.error="",""==e.userName&&(this.error="Username cannot be blank."),""==this.error&&(this.loading=!0,this.$ajax.post("/Password/Recover",e).then(e=>{if(e.data)if(e.data.Error)this.error=e.data.Error,window.setTimeout(()=>{this.$router.push({name:"Login",query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})},5e3);else{const t=!!e.data.email||!e.data.mobileNumber&&null,{hasCompleteAnswers:s,IsAllowedForNewAuth:i,RedirectPage:a}=e.data;if(i)localStorage.removeItem("MOUSSON_C"),this.$router.push({name:a,query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0});else if(s||null!==t){const s={sentToEmail:t,email:e.data.email,mobileNumber:e.data.mobileNumber,token:e.data.token};this.$router.push({name:null==t?"VerifyAnswer":"OTP",params:s})}else this.$router.push({name:"Login",params:{errorMsg:"Your email, phone number and security questions are not set up. Please contact your admin to reset your password."},query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})}}).catch(e=>{401==e.status&&this.$router.push({name:"Login",query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})}).finally(()=>{this.loading=!1}))},validateEmail(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(String(e).toLowerCase())},checkEmail(){let e=this.userName;e&&this.validateEmail(e)&&(this.loading=!0,this.$ajax.get("/auth/CheckEmail",{params:{email:e}}).then(e=>{const{AllowedForNewAuth:t,Users:s,EmailAddress:i}=e.data;this.userName==i&&(this.availableEmailUsers=t?null:s),this.error=""}).catch().then(()=>{this.loading=!1}))},verifyToken(e,t){this.hideInput=!0,this.loading=!0,this.hidePageTitle=!0;let s={token:e,userId:t,redirectUrl:this.redirectUrl};this.$ajax.post("/Password/VerifyToken",s).then(e=>{"undefined"!=typeof e.data&&(null!=e.data.Error?this.error=e.data.Error:null!=e.data.RedirectPage&&(this.instructionsMessage=e.data.InstructionsMessage,this.$router.push({name:e.data.RedirectPage,query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})))}).catch(()=>{}).then(()=>{this.loading=!1})}},mounted(){this.$route.query,this.redirectUrl=this.$route.query.redirectUrl||"","undefined"!=typeof this.$route.query.token&&"undefined"!=typeof this.$route.query.userId&&this.verifyToken(this.$route.query.token,this.$route.query.userId)}},le=oe,de=Object(l["a"])(le,re,ne,!1,null,null,null),ce=de.exports,ue=function(){var e=this,t=e._self._c;return t("setup",{attrs:{title:"Setup Password",error:e.error}},[t("div",{staticClass:"card-body"},[t("passwordPage",{attrs:{loading:e.loading,isMFAV2:e.isMFAV2,handleSubmit:e.handleFormSubmit,onValidationRequestError:e.handlePwdRequestError},model:{value:e.output,callback:function(t){e.output=t},expression:"output"}})],1)])},he=[],pe=(s("b7ef"),{name:"SetupPassword",props:["mfaNotSet","otpChannels","isMFAV2"],data(){return{error:"",loading:!1,redirectUrl:"",output:{password:"",confirmPassword:""}}},components:{Setup:W},methods:{handleFormSubmit(){let e={redirectUrl:this.redirectUrl,password:btoa(this.output.password),confirmPassword:btoa(this.output.confirmPassword)};this.error="",""==e.password&&""==e.confirmPassword?this.error="Password fields cannot be blank.":""==e.confirmPassword?this.error="Confirm Password field cannot be blank.":""==e.password&&(this.error="Password field cannot be blank."),""==this.error&&this.output.passed&&(this.loading=!0,this.$ajax.post("/Setup/Password",e).then(async e=>{if("undefined"!=typeof e.data){const{Error:t,ClientRedirect:s,RedirectUrl:i,RedirectPage:a,EssRedirect:r}=e.data;if(null!=t)this.error=t;else{let e=this.otpChannels||void 0;if(!r&&void 0==this.mfaNotSet){const{authenticated:t,mfaRequired:s,otpChannels:a}=await this.$checkMFACookie(i);this.mfaNotSet=s&&!t,e=a}if(s&&i.length)this.mfaNotSet?this.$router.push({name:"MFA",params:{redirectUrl:i,otpChannels:e}}):(r||await this.$ajax.post("/legacy/success",null,{withCredentials:!0}),window.location.href=i);else if(null!=a){const t={redirectUrl:i||void 0};let s={mfaNotSet:this.mfaNotSet||void 0,otpChannels:e};this.$router.push({name:a,params:s,query:t})}}}}).catch(e=>{401==e.status&&this.$router.push({name:"Login",query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})}).then(()=>{this.loading=!1}))},handlePwdRequestError(e){401==e.status?this.error="The browser session has expired. Redirecting you to the Reset Pasword page...":this.error="Something went wrong. Please try again after 5 minutes."}},mounted(){"undefined"!=typeof this.$route.query&&"undefined"!=typeof this.$route.query.redirectUrl&&(this.redirectUrl=this.$route.query.redirectUrl)}}),me=pe,ve=Object(l["a"])(me,ue,he,!1,null,null,null),fe=ve.exports,ge=function(){var e=this,t=e._self._c;return t("setup",{attrs:{title:"Setup Security Questions",error:e.error}},[t("form",{staticClass:"card-body",attrs:{method:"post",id:"form-questions-setup"},on:{submit:function(t){return t.preventDefault(),e.handleFormSubmit.apply(null,arguments)}}},[t("div",{staticClass:"default-form w-border",staticStyle:{"text-align":"left",margin:"auto"}},[e._l(e.answers,(function(s){return t("div",{key:s,staticStyle:{display:"inline-block"}},[t("div",{staticClass:"title-row section-title"},[e._v("Question "+e._s(s.count))]),t("div",{staticClass:"form-row"},[t("select",{directives:[{name:"model",rawName:"v-model",value:s.questionId,expression:"answer.questionId"}],staticClass:"long",on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(s,"questionId",t.target.multiple?i:i[0])}}},e._l(e.questionList,(function(s){return t("option",{key:s,domProps:{value:s.Value}},[e._v(" "+e._s(s.Text)+" ")])})),0)]),t("div",{staticClass:"form-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.value,expression:"answer.value"}],staticClass:"long",attrs:{type:"text"},domProps:{value:s.value},on:{input:function(t){t.target.composing||e.$set(s,"value",t.target.value)}}})])])})),t("div",{staticClass:"form-row",staticStyle:{"text-align":"center"}},[t("div",{staticClass:"mt-4"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"spinner small light"}),t("input",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"button large blue",attrs:{type:"submit",value:"Continue"}})])])],2)])])},we=[],ye={name:"SetupQuestions",props:["questions","mfaNotSet","otpChannels","isMFAV2"],components:{Setup:W},data(){return{error:"",loading:!1,questionList:this.questions,redirectUrl:"",data:{},answers:{answer1:{count:"1",questionId:1,value:""},answer2:{count:"2",questionId:1,value:""},answer3:{count:"3",questionId:1,value:""}}}},methods:{handleFormSubmit(){let e=Object.assign({},this.answers);e.redirectUrl=this.redirectUrl,this.error="";let t=[];for(var s in this.answers)if(this.answers.hasOwnProperty(s)){if(""==this.answers[s].value){this.error="All answers must be filled out.";break}if(t.includes(this.answers[s].questionId)){this.error="You need to select and answer three different questions.";break}t.push(this.answers[s].questionId)}""==this.error&&(this.loading=!0,this.$ajax.post("/Setup/Questions",e).then(async e=>{const{Error:t,ClientRedirect:s,RedirectUrl:i,RedirectPage:a,EssRedirect:r}=e.data;if("undefined"!=typeof e.data)if(null!=t)this.error=t;else{let e=this.otpChannels;if(!r&&void 0==this.mfaNotSet&&s){const{authenticated:t,mfaRequired:s,otpChannels:a}=await this.$checkMFACookie(i);this.mfaNotSet=s&&!t,e=a}if(s&&i)this.mfaNotSet?this.$router.push({name:"MFA",params:{redirectUrl:i,otpChannels:e||void 0}}):(r||await this.$ajax.post("/legacy/success",null,{withCredentials:!0}),window.location.href=i);else if(a){const t={redirectUrl:i||void 0};let s={mfaNotSet:this.mfaNotSet||void 0,otpChannels:e,isMFAV2:this.isMFAV2};this.$router.push({name:a,params:s,query:t})}}}).catch(e=>{401==e.status&&this.$router.push({name:"Login",query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})}).then(()=>{this.loading=!1}))},populatePage(){this.loading=!0,this.$ajax.get("/Setup/Questions").then(e=>{"undefined"!=typeof e.data&&(null!=e.data.Error?this.error=e.data.Error:null!=e.data.Questions&&(this.questionList=e.data.Questions))}).catch(()=>{}).then(()=>{this.loading=!1})}},mounted(){null==this.questionList&&this.populatePage(),"undefined"!=typeof this.$route.query&&"undefined"!=typeof this.$route.query.redirectUrl&&(this.redirectUrl=this.$route.query.redirectUrl)}},be=ye,Ce=Object(l["a"])(be,ge,we,!1,null,null,null),Ae=Ce.exports,Pe=function(){var e=this,t=e._self._c;return t("setup",{attrs:{title:"Answer Security Questions",error:e.error}},[t("form",{staticClass:"card-body",attrs:{method:"post",id:"form-questions-setup"},on:{submit:function(t){return t.preventDefault(),e.handleFormSubmit.apply(null,arguments)}}},[t("div",{staticClass:"default-form w-border",staticStyle:{margin:"0 auto","text-align":"left"}},[t("div",{staticClass:"title-row section-title",staticStyle:{"text-align":"center"}},[e._v(" "+e._s(e.userInfo)+" ")]),e._l(e.questionList,(function(s,i){return t("div",{key:s.id,staticClass:"form-row security-question"},[t("span",[e._v(" "+e._s(s.Text)+" ")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.questionList[i].Id,expression:"questionList[index].Id"}],attrs:{type:"hidden"},domProps:{value:e.questionList[i].Id},on:{input:function(t){t.target.composing||e.$set(e.questionList[i],"Id",t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.questionList[i].Text,expression:"questionList[index].Text"}],attrs:{type:"hidden"},domProps:{value:e.questionList[i].Text},on:{input:function(t){t.target.composing||e.$set(e.questionList[i],"Text",t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.questionList[i].AnswerId,expression:"questionList[index].AnswerId"}],attrs:{type:"hidden"},domProps:{value:e.questionList[i].AnswerId},on:{input:function(t){t.target.composing||e.$set(e.questionList[i],"AnswerId",t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.questionList[i].AnswerText,expression:"questionList[index].AnswerText"}],staticClass:"long",attrs:{type:"text"},domProps:{value:e.questionList[i].AnswerText},on:{input:function(t){t.target.composing||e.$set(e.questionList[i],"AnswerText",t.target.value)}}})])})),t("div",{staticClass:"form-row",staticStyle:{"text-align":"center"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"spinner small light"}),t("input",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"button large blue",attrs:{type:"submit",value:"Continue"}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:null!==e.sentToEmail,expression:"sentToEmail !== null"}],staticClass:"form-row",staticStyle:{"text-align":"center"}},[t("button",{staticClass:"button large green",on:{click:e.handleGoToOTP}},[e._v("Back to OTP")])])],2)])])},Se=[],_e=s("cee4"),xe={install(e,t){_e["a"].defaults.headers.common["X-Requested-With"]="XMLHttpRequest",t&&t.handleUnautorized&&(_e["a"].interceptors.request.use(e=>e),_e["a"].interceptors.response.use(e=>e,e=>{switch(e.response.status){case 302:const{RedirectUrl:t}=e.response.data;window.location.href=t||"/";break;case 401:setTimeout(()=>{window.location.href="/"},3e3);break}return Promise.reject(e.response)})),e.prototype.$ajax=_e["a"],e.ajax=_e["a"]}};const Ue={SUCCESS:"SUCCESS",FAILED:"FAILED",TOKEN_EXPIRED:"TOKEN_EXPIRED",EXPIRED:"EXPIRED",UNKNOWN_USER:"UNKNOWN_USER",BAD_REQUEST:"BAD_REQUEST",NOT_FOUND:"NOT_FOUND",SERVER_ERROR:"SERVER_ERROR"},Ee=(e,t)=>{switch(e){case Ue.FAILED:if("QUESTIONS"===t)return"You need to answer all three security questions correctly before your password can be reset.";if("PASSWORD"===t)return"Please complete all fields.";if("SEND_OTP"===t)return"Sending of OTP confirmation code has failed. Please try again later.";if("VERIFY_OTP"===t)return"You entered the wrong code. Please try again.";case Ue.TOKEN_EXPIRED:return"You are away for several minutes.";case Ue.EXPIRED:return"Confirmation code is already expired.";case Ue.UNKNOWN_USER:return"You need to enter a valid username or email address.";case Ue.BAD_REQUEST:return"Something went wrong. Please try again after 5 minutes.";case Ue.SERVER_ERROR:return"Something went wrong. Please try again after 5 minutes.";default:return""}};var ke={name:"VerifyAnswer",props:["redirectUrl","sentToEmail","email","mobileNumber","token","questions"],components:{Setup:W},data(){return{error:"",loading:!1,questionList:[],data:{},userInfo:""}},methods:{handleFormSubmit(){if(this.error="",this.questionList.forEach(e=>{""===e.AnswerText&&(this.error="All answers must be filled out.")}),""!=this.error)return;this.loading=!0;const e={Questions:this.questionList};this.$ajax.post("/Password/VerifyAnswers",e,{headers:{Authorization:this.token}}).then(e=>{const t=Ee(e.data.result,"QUESTIONS");t?(this.error=t,this.loading=!1):e.data.verified&&this.$router.push({name:"SetNew",params:{redirectUrl:this.redirectUrl},query:{token:e.data.token}})}).catch(e=>{"UNATHORIZED"!=e.result&&401!==e.status||this.redirectTo("The browser session has expired. Redirecting you to the Reset Pasword page..."),this.loading=!1})},handleGoToOTP(){const e={sentToEmail:this.sentToEmail,email:this.email,mobileNumber:this.mobileNumber,token:this.token};this.$router.push({name:"OTP",params:e})},populatePage(){this.loading=!0,this.$ajax.get("/Password/GetSecurityQuestions",{headers:{Authorization:this.token}}).then(e=>{"undefined"!=typeof e.data&&(e.data.error?this.error=e.data.errorMsg:e.data.Questions.length&&(this.questionList=e.data.Questions,this.userInfo=`Welcome, ${e.data.username}...`))}).catch(()=>{}).then(()=>{this.loading=!1})},redirectTo(e,t){const s=this.$router,i=t||"Recover";e&&(this.error=e),setTimeout(()=>{s.push({name:i,query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})},3e3)}},mounted(){if(this.token)this.populatePage();else{const{redirectUrl:e}=this.$route.query;this.$router.push({name:"Recover",query:e?{redirectUrl:e}:void 0})}}},Re=ke,Te=Object(l["a"])(Re,Pe,Se,!1,null,null,null),Oe=Te.exports,Ne=function(){var e=this,t=e._self._c;return t("setup",{attrs:{title:"Reset Password",error:e.error,success:e.success}},[t("div",{staticClass:"card-body"},[t("h3",[e._v(e._s(e.pageSubtitle))]),t("passwordPage",{attrs:{loading:e.loading,isMFAV2:e.isMFAV2,handleSubmit:e.handleFormSubmit,onValidationRequestError:e.handlePwdRequestError},model:{value:e.output,callback:function(t){e.output=t},expression:"output"}})],1)])},Ie=[],qe=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"default-form w-border",staticStyle:{"text-align":"left",margin:"auto"}},[t("div",{staticClass:"form-row password-ctrl-input pwd"},["checkbox"===(e.showPwd?"text":"password")?t("input",{directives:[{name:"model",rawName:"v-model",value:e.output.password,expression:"output.password"}],staticClass:"long",attrs:{maxlength:"50",placeholder:"Enter your new password",autocomplete:"off",type:"checkbox"},domProps:{checked:Array.isArray(e.output.password)?e._i(e.output.password,null)>-1:e.output.password},on:{keydown:e.handleEnterKey,focus:e.handlePwdFocus,blur:e.handlePwdBlur,change:function(t){var s=e.output.password,i=t.target,a=!!i.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);i.checked?n<0&&e.$set(e.output,"password",s.concat([r])):n>-1&&e.$set(e.output,"password",s.slice(0,n).concat(s.slice(n+1)))}else e.$set(e.output,"password",a)}}}):"radio"===(e.showPwd?"text":"password")?t("input",{directives:[{name:"model",rawName:"v-model",value:e.output.password,expression:"output.password"}],staticClass:"long",attrs:{maxlength:"50",placeholder:"Enter your new password",autocomplete:"off",type:"radio"},domProps:{checked:e._q(e.output.password,null)},on:{keydown:e.handleEnterKey,focus:e.handlePwdFocus,blur:e.handlePwdBlur,change:function(t){return e.$set(e.output,"password",null)}}}):t("input",{directives:[{name:"model",rawName:"v-model",value:e.output.password,expression:"output.password"}],staticClass:"long",attrs:{maxlength:"50",placeholder:"Enter your new password",autocomplete:"off",type:e.showPwd?"text":"password"},domProps:{value:e.output.password},on:{keydown:e.handleEnterKey,focus:e.handlePwdFocus,blur:e.handlePwdBlur,input:function(t){t.target.composing||e.$set(e.output,"password",t.target.value)}}}),t("span",{class:{"eye-toggle":!0,"valid-pwd":1==e.output.passed,"invalid-pwd":0==e.output.passed},on:{mousedown:function(t){e.showPwd=!0},mouseup:function(t){e.showPwd=!1},mouseleave:function(t){e.showPwd=!1}}},[e.showPwd?e._e():t("appIcons",{attrs:{asset:"eye-invisible"}}),e.showPwd?t("appIcons",{attrs:{asset:"eye"}}):e._e()],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showPwdGuide,expression:"showPwdGuide"}],staticClass:"password-ctrl-guide"},[t("div",[t("ul",{staticClass:"password-guide-list"},[t("li",{class:{"validation--passed":e.hasLength}},[t("span",{staticClass:"password-ctrl-icon validation-ico"},[e.hasLength?e._e():t("appIcons",{attrs:{asset:"close-circle"}}),e.hasLength?t("appIcons",{attrs:{asset:"check-circle"}}):e._e()],1),e._v(" Must contain at least 8 characters. ")]),t("li",{class:{"validation--passed":e.hasAlphaChars}},[t("span",{staticClass:"password-ctrl-icon validation-ico"},[e.hasAlphaChars?e._e():t("appIcons",{attrs:{asset:"close-circle"}}),e.hasAlphaChars?t("appIcons",{attrs:{asset:"check-circle"}}):e._e()],1),e._v(" Must contain at least one UPPERCASE and one lowercase character. ")]),t("li",{class:{"validation--passed":e.hasNumber&&e.hasSpecial}},[t("span",{staticClass:"password-ctrl-icon validation-ico"},[e.hasNumber&&e.hasSpecial?e._e():t("appIcons",{attrs:{asset:"close-circle"}}),e.hasNumber&&e.hasSpecial?t("appIcons",{attrs:{asset:"check-circle"}}):e._e()],1),e._v(" Must contain at least one number or special character (@#$%&*!). ")]),t("li",{class:{"validation--passed":e.noIdenticalChars}},[t("span",{staticClass:"password-ctrl-icon validation-ico"},[e.noIdenticalChars?e._e():t("appIcons",{attrs:{asset:"close-circle"}}),e.noIdenticalChars?t("appIcons",{attrs:{asset:"check-circle"}}):e._e()],1),e._v("Must not contain more than two identical characters in a row (aaa, 444). ")]),t("li",{class:{"validation--passed":e.noIncrementingNumbers}},[t("span",{staticClass:"password-ctrl-icon validation-ico"},[e.noIncrementingNumbers?e._e():t("appIcons",{attrs:{asset:"close-circle"}}),e.noIncrementingNumbers?t("appIcons",{attrs:{asset:"check-circle"}}):e._e()],1),e._v("Must not contain more than two incrementing numbers (12 is OK but 123 is not). ")]),t("li",{class:{"validation--passed":e.noReservedWords}},[t("span",{staticClass:"password-ctrl-icon validation-ico"},[e.noReservedWords?e._e():t("appIcons",{attrs:{asset:"close-circle"}}),e.noReservedWords?t("appIcons",{attrs:{asset:"check-circle"}}):e._e()],1),e._v("Must not contain your given names, username, email address, or the words ‘affinity’ or 'pass’. ")])])])]),t("ul",{directives:[{name:"show",rawName:"v-show",value:""!==e.outFocusMessage&&!e.showPwdGuide,expression:"outFocusMessage !== '' && !showPwdGuide"}],staticClass:"password-guide-list pwd-error"},[t("li",[t("span",{staticClass:"password-ctrl-icon validation-ico"}),e._v(e._s(e.outFocusMessage))])])]),t("div",{staticClass:"form-row password-ctrl-input repwd"},["checkbox"===(e.showRePwd?"text":"password")?t("input",{directives:[{name:"model",rawName:"v-model",value:e.output.confirmPassword,expression:"output.confirmPassword"}],staticClass:"long",attrs:{maxlength:"50",placeholder:"Re-enter your new password",autocomplete:"off",type:"checkbox"},domProps:{checked:Array.isArray(e.output.confirmPassword)?e._i(e.output.confirmPassword,null)>-1:e.output.confirmPassword},on:{keydown:e.handleEnterKey,change:function(t){var s=e.output.confirmPassword,i=t.target,a=!!i.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);i.checked?n<0&&e.$set(e.output,"confirmPassword",s.concat([r])):n>-1&&e.$set(e.output,"confirmPassword",s.slice(0,n).concat(s.slice(n+1)))}else e.$set(e.output,"confirmPassword",a)}}}):"radio"===(e.showRePwd?"text":"password")?t("input",{directives:[{name:"model",rawName:"v-model",value:e.output.confirmPassword,expression:"output.confirmPassword"}],staticClass:"long",attrs:{maxlength:"50",placeholder:"Re-enter your new password",autocomplete:"off",type:"radio"},domProps:{checked:e._q(e.output.confirmPassword,null)},on:{keydown:e.handleEnterKey,change:function(t){return e.$set(e.output,"confirmPassword",null)}}}):t("input",{directives:[{name:"model",rawName:"v-model",value:e.output.confirmPassword,expression:"output.confirmPassword"}],staticClass:"long",attrs:{maxlength:"50",placeholder:"Re-enter your new password",autocomplete:"off",type:e.showRePwd?"text":"password"},domProps:{value:e.output.confirmPassword},on:{keydown:e.handleEnterKey,input:function(t){t.target.composing||e.$set(e.output,"confirmPassword",t.target.value)}}}),t("span",{staticClass:"eye-toggle",class:{"eye-toggle":!0,"valid-pwd":1==e.hasConfirmed,"invalid-pwd":0==e.hasConfirmed},on:{mousedown:function(t){e.showRePwd=!0},mouseup:function(t){e.showRePwd=!1},mouseleave:function(t){e.showRePwd=!1}}},[e.showRePwd?e._e():t("appIcons",{attrs:{asset:"eye-invisible"}}),e.showRePwd?t("appIcons",{attrs:{asset:"eye"}}):e._e()],1)]),t("div",{staticClass:"form-row",staticStyle:{"text-align":"center"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"spinner small light"}),t("button",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"button large blue",attrs:{disabled:!e.hasConfirmed||!e.output.passed},on:{click:e.handleSubmit}},[e._v(" Continue ")])])])},$e=[];let Me=null,Le=null,Fe=i["a"].extend({name:"PasswordPage",props:["passwordVal","confirmPasswordVal","loading","isMFAV2","handleSubmit","onValidationRequestError"],components:{AppIcons:ee},data(){return{output:{password:"",confirmPassword:"",passed:void 0},hasLength:!1,hasNumber:!1,hasAlphaChars:!1,hasSpecial:!1,noIncrementingNumbers:!1,noIdenticalChars:!1,noReservedWords:!1,hasConfirmed:void 0,showPwdGuide:!1,showRpwdGuide:!1,showPwd:!1,showRePwd:!1,outFocusMessage:""}},watch:{"output.password":function(){if(this.outFocusMessage="",this.isMFAV2){const{password:e}=this.output;e?(Me&&(clearTimeout(Me),Me=null),Me=setTimeout(async()=>{this.hasLength=this.output.password.length>=8,this.hasNumber=/\d/.test(this.output.password),this.hasAlphaChars=/[a-z]/.test(this.output.password)&&/[A-Z]/.test(this.output.password),this.hasSpecial=/[!@#\$%\^\&*\)\(+=._-]/.test(this.output.password);const t=e.match(/.{1,1}/g);this.checkForIncrementingNumbers(t),this.checkForSameCharacters(t),await this.validatePassword(),this.output.passed=![this.hasAlphaChars,this.hasLength,this.hasNumber,this.hasSpecial,this.noIdenticalChars,this.noIncrementingNumbers,this.noReservedWords].includes(!1),this.output.passed?this.showPwdGuide=!1:this.showPwdGuide=!0},300)):(this.hasLength=!1,this.hasNumber=!1,this.hasAlphaChars=!1,this.hasSpecial=!1,this.noIdenticalChars=!1,this.noIncrementingNumbers=!1,this.noReservedWords=!1,this.output.passed=void 0,this.output.confirmPassword="",this.hasConfirmed=void 0)}else this.output.passed=!0;this.$emit("input",this.output)},"output.confirmPassword":function(){const{password:e,confirmPassword:t}=this.output;if(!e||!t)return t||(this.hasConfirmed=void 0),!1;Le&&(clearTimeout(Le),Le=null),Le=setTimeout(()=>{this.hasConfirmed=e===t,this.hasConfirmed?this.outFocusMessage="":this.outFocusMessage="Password fields do not match.",this.$emit("input",this.output)},250)}},methods:{handlePwdFocus(){this.output.passed||(this.showPwdGuide=!!this.isMFAV2)},handlePwdBlur(){this.isMFAV2&&(this.showPwdGuide=!1)},toggleEye(){this.showPwd=!this.showPwd},toggleEyeRePwd(){this.showRePwd=!this.showRePwd},checkForIncrementingNumbers(e){if(this.output.password&&e.length>=4){this.noIncrementingNumbers=!0;const t="0123456789";e.forEach((s,i)=>{const a=e.slice(i,i+4).join("");t.includes(a)&&i+2<e.length&&(this.noIncrementingNumbers=!1)})}},checkForSameCharacters(e){if(this.output.password&&e.length>=3){this.noIdenticalChars=!0;let t=0,s="";e.forEach(e=>{e===s?t++:(t=1,s=e),t>2&&(this.noIdenticalChars=!1)})}},async validatePassword(){const{password:e}=this.output;e&&e.length>=4&&await this.$ajax.post("/Password/validate",{password:btoa(e)}).then(e=>{const{result:t,ValidationErrors:s}=e.data,i=Object.keys(s);let a="";i.forEach(e=>{if(a=s[e].Message)return!1}),this.outFocusMessage="FAILED"===t?a:"",this.noReservedWords=s.NoInvalidWords.Success}).catch(e=>{this.onValidationRequestError(e)})},handleEnterKey(e){"Enter"===e.key&&this.handleSubmit()}}});i["a"].component("passwordPage",Fe);var De=Fe,je=De,Ve=(s("d5f9"),Object(l["a"])(je,qe,$e,!1,null,"1a863cf7",null)),ze=Ve.exports,He={name:"SetNew",props:["pageSubtitle","userId","redirectUrl","isMFAV2"],components:{PasswordPage:ze,Setup:W},data(){return{error:"",loading:!1,token:"",success:"",output:{password:"",confirmPassword:""}}},methods:{handleFormSubmit(){const{password:e,confirmPassword:t}=this.output;let s={Password:this.isMFAV2?btoa(e):e,ConfirmPassword:this.isMFAV2?btoa(t):t,UserId:this.userId};if(this.error="",""==e&&""==t?this.error="Password fields cannot be blank.":""==t?this.error="Confirm Password field cannot be blank.":""==e&&(this.error="Password field cannot be blank."),""!=this.error||!this.output.passed)return;this.loading=!0;const i=this,a=this.isMFAV2?"/Password/reset":"/Password/SetNew";this.$ajax.post(a,s,{headers:{Authorization:this.token}}).then(e=>{"undefined"!=typeof e.data&&("FAILED"===e.data.result?(this.error=e.data.message,this.loading=!1):(this.success="Password reset successful. Redirecting you to the login screen...",setTimeout(()=>{i.$router.push({name:"Login",query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})},5e3)))}).catch(e=>{"UNAUTHORIZED"===e.result||401===e.status?this.redirectTo("The browser session has expired. Redirecting you to the Reset Pasword page..."):(this.loading=!1,this.redirectTo("Password reset has timed out. Go back to the login page and request a new password.","Login"))})},verifyToken(){this.$ajax.get("/Token/Validate",{headers:{Authorization:this.token}}).catch(e=>{const{Valid:t}=e;t||this.redirectTo("The browser session has expired. Redirecting you to the Reset Pasword page...")})},handlePwdRequestError(e){401==e.status?this.redirectTo("The browser session has expired. Redirecting you to the Reset Pasword page..."):this.error="Something went wrong. Please try again later."},redirectTo(e,t){const s=this.$router,i=t||"Recover";e&&(this.error=e),setTimeout(()=>{s.push({name:i,query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})},3e3)}},mounted(){this.token=this.$route.query.token||"",this.token&&this.verifyToken()}},Be=He,Qe=Object(l["a"])(Be,Ne,Ie,!1,null,null,null),We=Qe.exports,Ye=function(){var e=this,t=e._self._c;return t("setup",{attrs:{title:"Reset Your Password",error:e.error,hidePageTitle:e.hidePageTitle}},[e.sendingOtp?t("div",{staticClass:"otp-sending-progress"},[t("div",[t("span",[e._v("Sending your code")])])]):e._e(),e.verifyingOtp?t("div",{staticClass:"otp-sending-progress"},[t("div",[e._v("Checking that code."),t("span",{staticStyle:{"white-space":"nowrap"}},[e._v("Please wait a moment...")])])]):e._e(),t("form",{staticClass:"card-body",attrs:{method:"post"},on:{submit:function(t){return t.preventDefault(),e.handleFormSubmit.apply(null,arguments)}}},[t("div",{staticClass:"default-form w-border",staticStyle:{"text-align":"center",margin:"auto"}},[t("p",{staticClass:"p-activation-note"},[t("strong",[e._v("To confirm your identity, ")]),e._v(" enter the code sent to"),t("br"),t("span",[e._v(e._s(e.otpToEmail?e.email:e.mobileNumber))])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"otp-control"},[t("v-otp-input",{ref:"otpInput",attrs:{"input-classes":"otp-input",separator:"","num-inputs":6,"should-auto-focus":!0,"is-input-num":!1},on:{"on-change":e.handleOtpChange,"on-complete":e.handleOtpComplete}})],1)]),t("div",{staticClass:"form-row"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.verifyingOtp,expression:"verifyingOtp"}],staticClass:"spinner small light"}),t("input",{directives:[{name:"show",rawName:"v-show",value:!e.verifyingOtp,expression:"!verifyingOtp"}],ref:"submitBtn",staticClass:"button large blue",attrs:{type:"submit",value:"VERIFY"}})]),t("div",{staticClass:"form-row",staticStyle:{"line-height":"2em"}},[t("a",{staticStyle:{cursor:"pointer"},on:{click:e.sendOtp}},[e._v("Resend the code")]),t("br"),e.email&&!e.otpToEmail?t("span",{},[t("a",{staticStyle:{cursor:"pointer"},on:{click:e.handleSwitchOtpReceiver}},[e._v("Send the code ("+e._s(e.email)+")")]),t("br")]):e._e(),e.mobileNumber&&e.otpToEmail?t("span",{},[t("a",{staticStyle:{cursor:"pointer"},on:{click:e.handleSwitchOtpReceiver}},[e._v("Send the code ("+e._s(e.mobileNumber)+")")]),t("br")]):e._e(),t("a",{staticStyle:{cursor:"pointer"},on:{click:e.handleGoToQuestions}},[e._v("Take me to my secret questions")])])])])])},Ge=[],Ke={name:"OTP",props:["sentToEmail","email","mobileNumber","redirectUrl","token"],data(){return{otpToEmail:this.$props.sentToEmail,sendingOtp:!1,verifyingOtp:!1,code:"",error:"",hidePageTitle:!1}},methods:{handleFormSubmit(){if(!this.code||this.code.length<6)return this.error="Insert the confirmation code that was sent to your\n  \t\t\t\t"+(this.otpToEmail?"email address ("+this.email+")":"contact number ("+this.mobileNumber+")"),!1;this.error="";const e=this.otpToEmail?"/Password/VerifyEmailOTP":"/Password/VerifySMSOTP";this.verifyingOtp=!0,this.$ajax.post(e,{verificationCode:this.code},{headers:{Authorization:this.token}}).then(e=>{this.verifyingOtp=!1;const t=Ee(e.data.result,"VERIFY_OTP");""===t?this.$router.push({name:"SetNew",params:{redirectUrl:this.redirectUrl},query:{token:e.data.token}}):(this.error=t,this.$refs.otpInput.clearInput())}).catch(e=>{this.verifyingOtp=!1,401==e.status&&this.redirectTo("That verification code has expired. Redirecting you to the Reset Pasword page...")})},handleOtpChange(e){this.code=e},handleOtpComplete(e){this.code=e,setTimeout(()=>{this.$refs.submitBtn.focus()},10)},sendOtp(){const e=this.otpToEmail?"/Password/SendOTPToEmail":"/Password/SendOTPToSMS";this.sendingOtp=!0,this.$ajax.get(e,{headers:{Authorization:this.token}}).then(e=>{const t=Ee(e.result,"SEND_OTP");t&&(this.error=t)}).catch(e=>{"UNAUTHORIZED"===e.result||401===e.status?this.redirectTo("The browser session has expired. Redirecting you to the Reset Pasword page..."):"SERVER_ERROR"===e.result&&(this.error=Ee(e.result))}).finally(()=>{this.sendingOtp=!1})},handleSwitchOtpReceiver(){this.otpToEmail=!this.otpToEmail,this.sendOtp()},handleGoToQuestions(){this.$router.push({name:"VerifyAnswer",params:{redirectUrl:this.redirectUrl,email:this.email,sentToEmail:this.sentToEmail,mobileNumber:this.mobileNumber,token:this.token}})},redirectTo(e,t){const s=this.$router,i=t||"Recover";e&&(this.error=e),setTimeout(()=>{s.push({name:i,query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})},3e3)}},components:{Setup:W},mounted(){if(this.token)this.sendOtp();else{const{redirectUrl:e}=this.$route.query;this.$router.push({name:"Recover",query:e?{redirectUrl:e}:void 0})}}},Xe=Ke,Ze=Object(l["a"])(Xe,Ye,Ge,!1,null,null,null),Je=Ze.exports,et=function(){var e=this,t=e._self._c;return t("setup",{attrs:{title:"Confirm Your Identity",error:e.error,hidePageTitle:e.hidePageTitle}},[e.sendingOtp?t("div",{staticClass:"otp-sending-progress"},[t("div",[t("span",[e._v("Sending your code")])])]):e._e(),e.verifyingOtp?t("div",{staticClass:"otp-sending-progress"},[t("div",[e._v(" Checking that code. "),t("span",{staticStyle:{"white-space":"nowrap"}},[e._v("Please wait a moment...")])])]):e._e(),e.verifyingStatus?t("div",[e._v(" Verifying token..."),t("span",{staticStyle:{"white-space":"nowrap"}},[e._v("Please wait")])]):e._e(),e.verifyingStatus?e._e():t("form",{staticClass:"card-body",attrs:{method:"post",novalidate:""},on:{submit:function(t){return t.preventDefault(),e.handleFormSubmit.apply(null,arguments)}}},[e.showOtpInput?t("div",{staticClass:"otp-input-group"},[t("p",[t("strong",[e._v("Enter your verification code here then click to verify:")])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"otp-control"},[t("v-otp-input",{ref:"otpInput",attrs:{"input-classes":"otp-input",separator:"","num-inputs":6,"should-auto-focus":!0,"is-input-num":!1},on:{"on-change":e.handleOtpChange,"on-complete":e.handleOtpComplete}})],1)]),t("div",{staticClass:"form-row"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.verifyingOtp,expression:"verifyingOtp"}],staticClass:"spinner small light"}),t("input",{directives:[{name:"show",rawName:"v-show",value:!e.verifyingOtp,expression:"!verifyingOtp"}],ref:"submitBtn",staticClass:"button large blue",attrs:{type:"submit",value:"VERIFY"}})])]):e._e(),t("div",{staticClass:"default-form w-border",staticStyle:{"text-align":"center",margin:"auto"}},[e.showOtpInput?e._e():t("p",[e._v("Where would you like us to send your verification code?"),t("br")]),e.showOtpInput?t("p",[e._v("Need a new verification code?"),t("br")]):e._e(),t("div",{staticClass:"otp-block-options"},e._l(e.otpChannels,(function(s){return t("div",{key:s.channel,staticClass:"otp-option"},[t("input",{attrs:{type:"radio",name:s.channel,id:s.channel},domProps:{value:s.channel,checked:s.channel==e.selectedChannel},on:{change:function(t){return e.handleContactChange(s.channel)}}}),t("label",{attrs:{for:s.channel}},[e._v("Send it to my "+e._s(""+e.getOptionLabel(s.channel))+" "),t("span",[e._v(e._s(`(${s.value})`))])])])})),0),t("div",{staticClass:"otp-block-button"},[t("button",{ref:"btnSendOTP",staticClass:"button small green",attrs:{type:"button",disabled:e.otpSending},on:{click:e.sendOtp}},[t("span",{directives:[{name:"show",rawName:"v-show",value:!e.otpSending,expression:"!otpSending"}]},[e._v(e._s(e.showOtpInput?"RESEND":"SEND"))]),t("span",{directives:[{name:"show",rawName:"v-show",value:e.otpSending,expression:"otpSending"}],staticClass:"spinner small light"})])])])])])},tt=[],st={name:"MFA",props:["redirectUrl","otpChannels"],data(){return{sendingOtp:!1,verifyingOtp:!1,verifyingStatus:!1,otpSending:!1,selectedChannel:"",showOtpInput:!1,retryCount:0,code:"",token:"",error:"",hidePageTitle:!1,page:void 0,failUrl:""}},methods:{getOptionLabel(e){switch(e){case"sms":return"mobile";case"work-email":return"work email";case"home-email":return"personal email"}},async checkOtpStatus(e,t,s,i){this.verifyingStatus=!0;const a=await this.$ajax.get(this.$apiUrl+"/api/Otp/status",{params:{token:e,page:i},withCredentials:!0}).catch(e=>{401==e.status&&this.redirectToLogin("Session has expired. Redirect you in Login page...")}).finally(()=>{this.verifyingStatus=!1});if(void 0!=a){const{otpChannels:i}=await this.$checkMFACookie(s);switch(this.otpChannels=i,this.redirectUrl=s,this.selectedChannel=t,this.showOtpInput=!0,this.token=e,a.data.status){case"expired":this.error="The OTP that was sent is already expired. Please get another OTP code.";break;case"invalid-token":this.error="OTP code is already expired. Please request a new one.";break}}},redirectToLogin(e){const t=this.$router,{redirectUrl:s}=this;this.error=e,setTimeout(()=>{t.push({name:"Login",query:s?{redirectUrl:s}:void 0})},3e3)},async sendOtp(){if(!this.selectedChannel)return this.error="No contact has been selected.",!1;this.error="";const e={channel:this.selectedChannel,token:this.token||void 0,page:this.page};this.otpSending=!0,this.retryCount=0,this.$ajax.post(this.$apiUrl+"/api/Otp",e,{withCredentials:!0}).then(e=>{const{isSuccess:t,token:s,status:i}=e.data;this.otpSending=!1,(t||"pending"===i)&&(this.showOtpInput=!0,this.token=s,this.$router.push({name:"MFA",params:{redirectUrl:this.redirectUrl,otpChannels:this.otpChannels},query:{token:s,channel:this.selectedChannel,redirectUrl:this.redirectUrl||void 0}}))}).catch(e=>{401==e.status&&this.redirectToLogin("The browser session has expired. Redirecting you to the login page...")})},handleContactChange(e){const{channel:t}=this.$route.query;e!=this.selectedChannel&&(this.selectedChannel=e,this.showOtpInput=!1),e==t&&(this.selectedChannel=e,this.showOtpInput=!0)},handleFormSubmit(){if(!this.code||this.code.length<6)return this.error="Please enter your verification code.",!1;this.error="",this.verifyingOtp=!0,this.$ajax.post(this.$apiUrl+"/api/Otp/verify",{code:this.code,token:this.token,page:this.page},{withCredentials:!0}).then(async e=>{const{isSuccess:t,status:s}=e.data;if(this.page){const e=t?this.page:this.failUrl;t?window.location.href=e:(this.verifyingOtp=!1,this.handleErrorResponse(s),["unknown","expired","invalid-token"].includes(s)&&setTimeout(()=>{window.location.href=this.failUrl},2e3))}else t?(this.verifyingOtp=!0,await this.$ajax.post("/legacy/success",null,{withCredentials:!0}),window.location.href=this.redirectUrl):(this.verifyingOtp=!1,this.handleErrorResponse(s),this.$refs.otpInput.clearInput())}).catch(e=>{401==e.status?this.redirectToLogin("That verification code has expired. Redirecting you to the login page..."):this.handleErrorResponse(e.status)})},handleErrorResponse(e){switch(e){case"unknown":this.error="Something went wrong, please enter it again later.";break;case"pending":this.retryCount+=1,this.error="That code is incorrect. You have 6 attempts at entering a valid code. Please try again.";break;case"expired":this.error=this.page?"That verification code has expired. Redirecting you to the previous page...":"OTP code is already expired. Please request a new one.";break;case"invalid-token":this.error=this.page?"That verification code has expired. Redirecting you to the previous page...":"OTP code is already expired. Please request a new one.";break;case"max-attempt":this.error="You only have 6 attempts at entering a valid code. Click RESEND to request a new code.";break}},handleOtpChange(e){this.code=e},handleOtpComplete(e){this.code=e,setTimeout(()=>{this.$refs.submitBtn.focus()},10)}},components:{Setup:W},async mounted(){const{redirectUrl:e,token:t,channel:s,page:i,mfaFailRedirectUrl:a}=this.$route.query;if(t)this.checkOtpStatus(t,s,e,i);else if(i){const{otpChannels:t,authenticated:s}=await this.$checkMFACookie(void 0,i);this.failUrl=a,this.otpChannels=t,this.redirectUrl=e,this.page=i,s&&(window.location.href=i)}else this.otpChannels||t||this.$router.push({name:"Login",query:e?{redirectUrl:e}:void 0});this.otpChannels.length&&(this.selectedChannel=1==this.otpChannels.length&&this.otpChannels[0].channel||"")}},it=st,at=(s("f46d"),Object(l["a"])(it,et,tt,!1,null,"d0e53e1a",null)),rt=at.exports,nt=function(){var e=this,t=e._self._c;return t("setup",{attrs:{title:"Select Your Identity",error:e.error,success:e.success}},[t("form",{staticClass:"card-body",attrs:{method:"post"},on:{submit:function(t){return t.preventDefault(),e.handleFormSubmit.apply(null,arguments)}}},[e.initializing?t("div",{staticStyle:{"text-align":"center",padding:"20px 0 32px"}},[t("appIcons",{attrs:{asset:"loader"}})],1):e._e(),e.initializing?e._e():t("div",{staticClass:"default-form w-border",staticStyle:{"text-align":"center",margin:"auto"}},[t("div",{staticClass:"form-row label"},[t("div",{staticClass:"form-label"},[e._v("Company")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.company,expression:"company"}],attrs:{id:"company",disabled:null===e.companies,name:"company"},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.company=t.target.multiple?s:s[0]},e.setRolePickList]}},[t("option",{attrs:{value:"null",disabled:"",selected:""}},[e._v("Select...")]),e._l(e.companies,(function(s){return t("option",{key:s.Id,domProps:{value:s.Id}},[e._v(" "+e._s(s.Name)+" ("+e._s(s.Id)+") ")])}))],2)]),null!==e.company?t("div",{staticClass:"form-row label"},[t("div",{staticClass:"form-label"},[e._v("Role")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.userRole,expression:"userRole"}],attrs:{id:"userRole",name:"userRole"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.userRole=t.target.multiple?s:s[0]}}},[t("option",{attrs:{value:"null",disabled:"",selected:""}},[e._v("Select...")]),e._l(e.roles,(function(s){return t("option",{key:s.Code,domProps:{value:s.Code}},[e._v(" "+e._s(s.Description)+" ")])}))],2)]):e._e(),t("div",{staticClass:"mt-4",staticStyle:{"text-align":"center"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"spinner small light"}),t("input",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"button large blue",attrs:{type:"submit",value:"Continue"}})])])])])},ot=[],lt={name:"Identity",data(){return{error:"",success:"",loading:!1,initializing:!0,companies:null,roles:[],roleList:[],company:null,userRole:null}},components:{Setup:W,AppIcons:ee},methods:{setRolePickList(){if(this.roleList.length>0){this.userRole=null;const e=this.roleList.filter(e=>e.AllowedCompanies.includes(this.company)||"*"===e.AllowedCompanies);this.roles=e||[]}},handleFormSubmit(){let e={Company:this.company,Role:this.userRole,RedirectUrl:this.$route.query.redirectUrl};this.error="",""==e.Company&&(this.error="Please select a company."),""==e.Role&&(this.error="Please select a Role."),""==this.error&&(this.loading=!0,this.reqAuthRedirect(e))},reqAuthRedirect(e){this.$ajax.post("/Roles/authenticated-redirect",e).then(e=>{const{RedirectUrl:t,Message:s}=e.data;this.success=s,window.setTimeout(()=>{window.location.href=t},1e3)}).catch(e=>{401==e.status&&this.$router.push({name:"Login",query:{redirectUrl:this.$route.query.redirectUrl||void 0}})}).finally(()=>{this.loading=!1})}},async mounted(){const{Companies:e,Roles:t}=await this.$ajax.get("/Roles/details").then(e=>e.data);if(this.companies=e,this.roleList=t,1===e.length&&1===t.length){let s={Company:e[0].Id,Role:t[0].Code,RedirectUrl:this.$route.query.redirectUrl};this.reqAuthRedirect(s)}else this.initializing=!1,this.companies=e,1===e.length&&(this.company=e[0].Id,this.setRolePickList(),1===this.roles.length&&(this.userRole=this.roles[0].Code))}},dt=lt,ct=(s("15d0"),Object(l["a"])(dt,nt,ot,!1,null,"1c987d93",null)),ut=ct.exports,ht=function(){var e=this,t=e._self._c;return t("setup",{attrs:{title:"Confirm Your Identity",error:e.error,success:e.success,hidePageTitle:e.hidePageTitle}},[e.sendingOtp?t("div",{staticClass:"otp-sending-progress"},[t("div",[t("span",[e._v("Sending your code")])])]):e._e(),e.verifyingOtp?t("div",{staticClass:"otp-sending-progress"},[t("div",[e._v(" Checking that code. "),t("span",{staticStyle:{"white-space":"nowrap"}},[e._v("Please wait a moment...")])])]):e._e(),e.verifyingStatus?t("div",[e._v(" Verifying token..."),t("span",{staticStyle:{"white-space":"nowrap"}},[e._v("Please wait")])]):e._e(),e.verifyingStatus?e._e():t("form",{staticClass:"card-body",attrs:{method:"post",novalidate:""},on:{submit:function(t){return t.preventDefault(),e.handleFormSubmit.apply(null,arguments)}}},[e.initializing?t("div",{staticStyle:{"text-align":"center",padding:"20px 0 32px"}},[t("appIcons",{attrs:{asset:"loader"}})],1):e._e(),e.initializing?e._e():t("div",[e.showOtpInput?t("div",{staticClass:"otp-input-group"},[t("p",[t("strong",[e._v("Enter your verification code here then click to verify:")])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"otp-control"},[t("v-otp-input",{ref:"otpInput",attrs:{"input-classes":"otp-input",separator:"","num-inputs":6,"should-auto-focus":!0,"is-input-num":!1},on:{"on-change":e.handleOtpChange,"on-complete":e.handleOtpComplete}})],1)]),t("div",{staticClass:"form-row"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.verifyingOtp,expression:"verifyingOtp"}],staticClass:"spinner small light"}),t("input",{directives:[{name:"show",rawName:"v-show",value:!e.verifyingOtp,expression:"!verifyingOtp"}],ref:"submitBtn",staticClass:"button large blue",attrs:{type:"submit",value:"VERIFY"}})])]):e._e(),t("div",{staticClass:"default-form w-border",staticStyle:{"text-align":"center",margin:"auto"}},[e.showOtpInput?e._e():t("p",[e._v("Where would you like us to send your verification code?"),t("br")]),e.showOtpInput?t("p",[e._v("Need a new verification code?"),t("br")]):e._e(),t("div",{staticClass:"otp-block-options"},e._l(e.otpChannels,(function(s){return t("div",{key:s.Channel,staticClass:"otp-option"},[t("input",{attrs:{type:"radio",name:s.Channel,id:s.Channel},domProps:{value:s.Channel,checked:s.Channel==e.selectedChannel},on:{change:function(t){return e.handleContactChange(s.Channel)}}}),t("label",{attrs:{for:s.Channel}},[e._v("Send it to my "+e._s(""+e.getOptionLabel(s.Channel))+" "),t("span",[e._v(e._s(`(${s.Contact})`))])])])})),0),t("div",{staticClass:"otp-block-button"},[t("button",{ref:"btnSendOTP",staticClass:"button small green",attrs:{type:"button",disabled:e.otpSendingDisabled},on:{click:e.sendOtp}},[t("span",{directives:[{name:"show",rawName:"v-show",value:!e.otpSending,expression:"!otpSending"}]},[e._v(e._s(e.showOtpInput?"RESEND"+(e.timerCount>0?` (${e.timerCount})`:""):"SEND"))]),t("span",{directives:[{name:"show",rawName:"v-show",value:e.otpSending,expression:"otpSending"}],staticClass:"spinner small light"})])])])])])])},pt=[],mt={name:"MFA_V2",data(){return{sendingOtp:!1,verifyingOtp:!1,verifyingStatus:!1,otpSending:!1,selectedChannel:"",showOtpInput:!1,code:"",token:"",error:"",success:"",hidePageTitle:!1,page:void 0,redirectUrl:"",otpChannels:[],resendTimer:null,timerCount:0,initializing:!0}},computed:{otpSendingDisabled(){const e=localStorage.getItem("MOUSSON_C");return(!e||e===this.selectedChannel)&&(this.otpSending||this.timerCount>0)}},methods:{getOptionLabel(e){switch(e){case"sms":return"mobile";case"email":return"email"}},redirectToLogin(e){const t=this.$router;this.error=e,setTimeout(()=>{t.push({name:"Login",query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})},3e3)},async sendOtp(){if(!this.selectedChannel)return this.error="No contact has been selected.",!1;this.error="";this.selectedChannel;this.otpRequest(this.selectedChannel)},otpRequest(e){this.otpSending=!0,this.$ajax.post("/Mfa/request",{Channel:e},{withCredentials:!0}).then(t=>{const{Success:s,Message:i,Resend:{IntervalSeconds:a}}=t.data;this.otpSending=!1,s&&(localStorage.setItem("MOUSSON_C",e),this.runResendTimer(a),this.showOtpInput=!0,this.success=i,window.setTimeout(()=>{this.success=""},5e3))}).catch(e=>{this.handleErrorResponse(e.status,e.data.Message)})},handleContactChange(e){const{channel:t}=this.$route.query;e!=this.selectedChannel&&(this.selectedChannel=e,this.showOtpInput=!1),e==t&&(this.selectedChannel=e,this.showOtpInput=!0)},handleFormSubmit(){if(!this.code||this.code.length<6)return this.error="Please enter your verification code.",!1;this.error="",this.verifyingOtp=!0,this.$ajax.post("/Mfa/verify",{Otp:this.code,Channel:this.selectedChannel},{withCredentials:!0}).then(async e=>{const{Success:t,RedirectPage:s,Message:i}=e.data;t?(this.success=i,setTimeout(()=>{this.$router.push({name:s,params:{isMFAV2:!0},query:this.redirectUrl?{redirectUrl:this.redirectUrl}:void 0})},3e3)):(this.error=i,this.verifyingOtp=!1,this.$refs.otpInput.clearInput())}).catch(e=>{this.handleErrorResponse(e.status,e.data.Message)})},handleErrorResponse(e,t){switch(e){case 401:this.redirectToLogin("That verification code has expired. Redirecting you to the login page...");break;case 429:this.redirectToLogin("You entered an invalid code too many times and your account is now locked. Ask your payroll team for help.");break;default:this.error=t;break}},handleOtpChange(e){this.code=e},handleOtpComplete(e){this.code=e,setTimeout(()=>{this.$refs.submitBtn.focus()},10)},runResendTimer(e){this.timerCount=e>0?e:0,e>0?(this.resendTimer&&(clearInterval(this.resendTimer),this.resendTimer=null),this.resendTimer=setInterval(()=>{this.timerCount--,this.timerCount<=0&&(clearInterval(this.resendTimer),this.resendTimer=null)},1e3)):(clearInterval(this.resendTimer),this.resendTimer=null)}},components:{Setup:W,AppIcons:ee},async mounted(){const e=localStorage.getItem("MOUSSON_C");if(e){this.showOtpInput=!0,this.selectedChannel=e;const{Resend:{RemainingIntervalSeconds:t}}=await this.$ajax.get("/Mfa/status?channel="+e).then(e=>e.data);this.timerCount=t,this.runResendTimer(this.timerCount)}const{Contacts:t}=await this.$ajax.get("/MFA/contact").then(e=>e.data);this.otpChannels=t,this.redirectUrl=this.$route.query.redirectUrl,this.initializing=!1}},vt=mt,ft=(s("70df"),Object(l["a"])(vt,ht,pt,!1,null,"abc11802",null)),gt=ft.exports;i["a"].use(u["a"]);const wt=[{path:"/",name:"Login",component:F,props:!0,meta:{title:"Login"}},{path:"/Emails",name:"Emails",component:ae,meta:{title:"Emails"}},{path:"/Recover",name:"Recover",component:ce,meta:{title:"Forgot Password"}},{path:"/SetupPassword",name:"SetupPassword",component:fe,meta:{title:"Reset Password"}},{path:"/SetupQuestions",name:"SetupQuestions",component:Ae,props:!0,meta:{title:"Answer Security Password"}},{path:"/VerifyAnswer",name:"VerifyAnswer",component:Oe,props:!0,meta:{title:"Answer Security Password"}},{path:"/SetNew",name:"SetNew",component:We,props:!0,meta:{title:"Reset Password"}},{path:"/Otp",name:"OTP",component:Je,props:!0,meta:{title:"One Time Password"}},{path:"/mfa",name:"MFA",component:rt,props:!0,meta:{title:"Multi-Factor Authentication"}},{path:"/identity",name:"Identity",component:ut,props:!0,meta:{title:"User Identity"}},{path:"/mfa-v2",name:"MFA_V2",component:gt,props:!0,meta:{title:"User Identity"}}],yt=new u["a"]({mode:"history",base:"/",routes:wt});var bt=yt,Ct=s("e37d"),At=s("cc46"),Pt=s.n(At);s("a1a3");i["a"].component("v-otp-input",Pt.a),i["a"].use(xe,{handleUnautorized:!0}),i["a"].use(Ct["a"]),i["a"].prototype.$validateEmail=function(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(String(e).toLowerCase())},i["a"].prototype.$validUrl=function(e){if("function"==typeof URL){let t;try{t=new URL(e)}catch(s){return!1}return"http:"===t.protocol||"https:"===t.protocol}var t=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return!!t.test(e)},i["a"].prototype.$checkMFACookie=async function(e="",t){const s=await i["a"].prototype.$ajax.post(i["a"].prototype.$apiUrl+"/api/Auth",null,{withCredentials:!0,params:{redirectUrl:e,page:t}});return 200==s.status?s.data:s},bt.afterEach((e,t)=>{i["a"].nextTick(()=>{document.title=e.meta.title||"Login"})}),caches,i["a"].prototype.$apiUrl="https://mfa.testaffinitylogon.com",i["a"].config.productionTip=!1,new i["a"]({router:bt,render:e=>e(c)}).$mount("#app")},"5be3":function(e,t,s){"use strict";s("7f9f")},"6d16":function(e,t,s){},"70df":function(e,t,s){"use strict";s("3789")},"7eed":function(e,t,s){},"7f9f":function(e,t,s){},"9bc2":function(e,t,s){"use strict";s("7eed")},a1a3:function(e,t,s){},d4d0:function(e,t,s){},d576:function(e,t,s){},d5f9:function(e,t,s){"use strict";s("6d16")},dd9b:function(e,t,s){"use strict";s("e3b1")},e3b1:function(e,t,s){},f46d:function(e,t,s){"use strict";s("d576")}});
//# sourceMappingURL=app.js.map
