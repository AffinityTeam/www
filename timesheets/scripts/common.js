var doc,File,scriptProcessed;if("Affinity"in window||(window.Affinity={}),"Components"in Affinity||(Affinity.Components={}),Affinity.started=(new Date).getTime(),Affinity.views={},Affinity.Components.Commons={},Affinity.Components.Commons.Version="6.0.34.2",Affinity.Components.Commons.Sequence=30,Affinity.Components.Commons.Name="UI Framework Commons",Affinity.Components.Commons.File="commons.6.0.0.js",Affinity.Components.Commons.Jira="",Affinity.Components.Commons.Notes="Add Affinity.IsElement method",Affinity.Components.MooTools={},Affinity.Components.MooTools.Version="1.6.0",Affinity.Components.MooTools.Sequence=10,Affinity.Components.MooTools.Name="MooTools Core",Affinity.Components.MooTools.File="MooTools-Core-1.6.0.js",Affinity.Components.MooTools.Jira="",Affinity.Components.MooTools.Notes="",Affinity.Components.MoreTools={},Affinity.Components.MoreTools.Version="1.6.0",Affinity.Components.MoreTools.Sequence=20,Affinity.Components.MoreTools.Name="MooTools More",Affinity.Components.MoreTools.File="MooTools-More-1.6.0.js",Affinity.Components.MoreTools.Jira="",Affinity.Components.MoreTools.Notes="",typeof console=="undefined"&&(console={log:function(){}}),typeof MooTools=="undefined")throw new ReferenceError("This site requires MooTools 1.6.0 and MooTools.More 1.6.0");doc=document.documentElement,doc.setAttribute("data-useragent",navigator.userAgent),"events"in Affinity||(Affinity.events={}),Affinity.mobile=!1,Affinity.events={over:"mouseover",out:"mouseout",overAll:"mouseenter",outAll:"mouseleave",start:"mousedown",move:"mousemove",end:"mouseup",click:"click"},Affinity.colors={green:"#7abd2d",blue:"#44b5ec",lightblue:"#e3eef3",orange:"#ff6600",yellow:"#ffbd00",red:"#ff0000",grey:"#888888"},Affinity.icons={AddToList:"&#xe096;",Adobe:"&#xe91c;",Air:"&#xe047;",Alarm:"&#xe855;",AlarmAdd:"&#xe856;",AppAddRow:"&#xe91b;",AppFilter:"&#xe919;",AppGridAdd:"&#xe91a;",AppHelp:"&#xe918;",AppReport:"&#xe917;",AppShare:"&#xe916;",Archive:"&#xe0a2;",ArrowDown:"&#xe0c0;",ArrowDownCircle:"&#xe0c8;",ArrowDownSmall:"&#xe0c4;",ArrowLeft:"&#xe0bf;",ArrowLeftCircle:"&#xe0c7;",ArrowLeftSmall:"&#xe0c3;",ArrowLineBigDown:"&#xe0d8;",ArrowLineBigLeft:"&#xe0d7;",ArrowLineBigRight:"&#xe0da;",ArrowLineBigUp:"&#xe0d9;",ArrowLineDown:"&#xe0d0;",ArrowLineLeft:"&#xe0cf;",ArrowLineRight:"&#xe0d2;",ArrowLineSmallDown:"&#xe0d4;",ArrowLineSmallLeft:"&#xe0d3;",ArrowLineSmallRight:"&#xe0d6;",ArrowLineSmallUp:"&#xe0d5;",ArrowLineUp:"&#xe0d1;",ArrowLongDown:"&#xe0dc;",ArrowLongLeft:"&#xe0db;",ArrowLongRight:"&#xe0de;",ArrowLongUp:"&#xe0dd;",ArrowRight:"&#xe0c2;",ArrowRightCircle:"&#xe0ca;",ArrowRightSmall:"&#xe0c6;",ArrowUp:"&#xe0c1;",ArrowUpCircle:"&#xe0c9;",ArrowUpSmall:"&#xe0c5;",ArrowheadDown:"&#xe0cc;",ArrowheadLeft:"&#xe0cb;",ArrowheadRight:"&#xe0ce;",ArrowheadUp:"&#xe0cd;",ArrowheadUpDown:"&#xe0df;",Back:"&#xe093;",Bag:"&#xe03b;",Barcode:"&#xe0fc;",Battery:"&#xe04d;",Bell:"&#xe029;",Blocked:"&#xe084;",Book:"&#xe039;",Book2:"&#xe0ac;",Bookmark:"&#xe0aa;",Bookmarks:"&#xe0ab;",Box:"&#xe06a;",Braces:"&#xe104;",Break:"&#xe90f;",BreakAdd:"&#xe910;",BreakRemove:"&#xe940;",BreakUp:"&#xe941;",BreakDown:"&#xe942;",Briefcase:"&#xe046;",Brightness:"&#xe060;",BrogressThird:"&#xe05c;",Browser:"&#xe058;",Brush:"&#xe053;",Bucket:"&#xe04e;",BulletList:"&#xe095;",CalView:"&#xe911;",Calendar:"&#xe041;",Camera:"&#xe030;",Cancel:"&#xe083;",Car:"&#xe909;",Cart:"&#xe069;",Cc:"&#xe0e3;",CcBy:"&#xe0e4;",CcNc:"&#xe0e5;",CcNcEu:"&#xe0e6;",CcNcJp:"&#xe0e7;",CcNd:"&#xe0e9;",CcPd:"&#xe0ea;",CcSa:"&#xe0e8;",CcShare:"&#xe0ec;",CcShare3:"&#xe0ed;",CcZero:"&#xe0eb;",Ccw:"&#xe08c;",Cd:"&#xe045;",Chat:"&#xe021;",Cleverforms:"&#xe939;",CleverformsAdmin:"&#xe93a;",CleverformsDesigner:"&#xe93c;",CleverformsFlow:"&#xe93b;",Clipboard:"&#xe068;",Clock:"&#xe03f;",Cloud:"&#xe0a8;",Code:"&#xe061;",CodeA:"&#xe0ee;",CodeD:"&#xe0f0;",CodeH:"&#xe0ef;",CodeM:"&#xe10e;",CodeP:"&#xe10f;",CodeR:"&#xe0f1;",CodeS:"&#xe0f2;",Cog:"&#xe02c;",Comment:"&#xe022;",CommsHangouts:"&#xe933;",CommsMsteams:"&#xe931;",CommsSkype:"&#xe930;",CommsSlack:"&#xe932;",Compare:"&#xe103;",Compass:"&#xe016;",Cone:"&#xe055;",CreditCard:"&#xe065;",Cross:"&#xe07a;",CrossRound:"&#xe080;",CrossSquare:"&#xe07d;",Csharp:"&#xe0ff;",Cup:"&#xe051;",Cw:"&#xe08b;",Cycle:"&#xe08a;",Database:"&#xe066;",DetailView:"&#xe913;",Directions:"&#xe005;",Docs:"&#xe09c;",DollarRound:"&#xe0fe;",Dot:"&#xe0e2;",Dots:"&#xe0e1;",DotsVert:"&#xe000;",Download:"&#xe0a5;",Drive:"&#xe050;",Droplet:"&#xe044;",Droplets:"&#xe06f;",Earth:"&#xe056;",Education:"&#xe038;",Eightball:"&#xe901;",Ellipsis:"&#xe0e0;",EmptyInbox:"&#xe00b;",Export:"&#xe013;",Extension:"&#xe87b;",Eye:"&#xe03e;",Feather:"&#xe009;",FieldEdit:"&#xe001;",File:"&#xe91d;",FileEdit:"&#xe91e;",FileExcel:"&#xe922;",FileExcelOld:"&#xe908;",FilePdf:"&#xe920;",FilePdfOld:"&#xe902;",FilePowerpoint:"&#xe923;",FileUser:"&#xe93f;",FileView:"&#xe91f;",FileWord:"&#xe921;",FileWordOld:"&#xe907;",First:"&#xe0b3;",Flag:"&#xe02b;",Flashlight:"&#xe027;",FlowBranch:"&#xe0bb;",FlowCascade:"&#xe0ba;",FlowLine:"&#xe0bd;",FlowParallel:"&#xe0be;",FlowTree:"&#xe0bc;",Folder:"&#xe0a1;",Forward:"&#xe00e;",Gauge:"&#xe049;",Ghost:"&#xe0fa;",Gift:"&#xe105;",Google:"&#xe926;",GoogleDrive:"&#xe928;",GoogleMaps:"&#xe927;",GoogleTranslate:"&#xe929;",GraphBars:"&#xe073;",GraphLinefill:"&#xe074;",GraphPie:"&#xe072;",GraphStatistics:"&#xe071;",Grid:"&#xe070;",HeartEmpty:"&#xe01c;",HeartFull:"&#xe01b;",HelpRound:"&#xe088;",History:"&#xe092;",Hourglass:"&#xe048;",House:"&#xe024;",Incident:"&#xe548;",Infinity:"&#xe063;",Info:"&#xe085;",InfoRound:"&#xe086;",Install:"&#xe0a7;",Key:"&#xe04c;",Keyboard:"&#xe057;",Kiwi:"&#xe102;",Lab:"&#xe903;",Landscape:"&#xe09d;",Language:"&#xe04a;",Last:"&#xe0b4;",Layout:"&#xe097;",Leaf:"&#xe034;",LifeRing:"&#xe03d;",LightBulb:"&#xe064;",Lightning:"&#xe042;",Link:"&#xe02a;",List:"&#xe098;",Location:"&#xe014;",LocationArrow:"&#xe017;",Lock:"&#xe075;",LockApproved:"&#xe90c;",LockDeclined:"&#xe90d;",LockOpen:"&#xe90a;",LockPaid:"&#xe90e;",LockSubmitted:"&#xe90b;",Login:"&#xe078;",Logout:"&#xe077;",Loop:"&#xe091;",Magnet:"&#xe04f;",Mail:"&#xe006;",MailGmail:"&#xe934;",MailHotmail:"&#xe935;",MailOutlook:"&#xe936;",Map:"&#xe015;",Maps:"&#xe925;",Megaphone:"&#xe031;",Microphone:"&#xe040;",Minus:"&#xe081;",MinusRound:"&#xe07e;",MinusSquare:"&#xe07b;",Mobile:"&#xe003;",Moneybag:"&#xe0fd;",Moon:"&#xe032;",MoreLeft:"&#xe10a;",MoreRight:"&#xe10d;",Mouse:"&#xe004;",Music:"&#xe036;",MusicSemi:"&#xe035;",MusicSquare:"&#xe0a0;",Mute:"&#xe0b9;",Network:"&#xe04b;",New:"&#xe037;",Newspaper:"&#xe03a;",Next:"&#xe0b1;",Page:"&#xe099;",PageEmpty:"&#xe93e;",PageFull:"&#xe93d;",Palette:"&#xe033;",Paperclip:"&#xe00a;",Paperplane:"&#xe007;",Pause:"&#xe0ae;",Pencil:"&#xe008;",PeriodView:"&#xe912;",Phone:"&#xe002;",Pictures:"&#xe09e;",Pin:"&#xe904;",Plane:"&#xe03c;",Play:"&#xe0ad;",Plugin:"&#xe905;",Plus:"&#xe082;",PlusRound:"&#xe07f;",PlusSquare:"&#xe07c;",Poop:"&#xe101;",Popup:"&#xe025;",Previous:"&#xe0b2;",Printer:"&#xe028;",ProgressEmpty:"&#xe05d;",ProgressFull:"&#xe05a;",ProgressHalf:"&#xe05b;",Prompt:"&#xe109;",PromptAlert:"&#xe10c;",PromptInfo:"&#xe10b;",Publish:"&#xe059;",Qrcode:"&#xe0fb;",Question:"&#xe087;",Quote:"&#xe023;",Record:"&#xe0af;",Repeat:"&#xe090;",Reply:"&#xe00c;",ReplyAll:"&#xe00d;",ResizeEnlarge:"&#xe0b5;",ResizeShrink:"&#xe0b6;",Return:"&#xe08f;",ReturnBack:"&#xe08e;",Rocket:"&#xe052;",Rss:"&#xe06c;",Save:"&#xe0a6;",Scaledown:"&#xe107;",Scaleup:"&#xe108;",Schedule:"&#xe900;",Screen:"&#xe062;",Search:"&#xe026;",Sharable:"&#xe01a;",Share:"&#xe019;",Shield:"&#xe906;",Shuffle:"&#xe08d;",SocialFacebook:"&#xe92a;",SocialInstagram:"&#xe92c;",SocialLinkedin:"&#xe92e;",SocialTwitter:"&#xe92b;",SocialYammer:"&#xe92f;",SocialYoutube:"&#xe92d;",Sound:"&#xe0b8;",StarEmpty:"&#xe01e;",StarFull:"&#xe01d;",Stop:"&#xe0b0;",Suitcase:"&#xe054;",Sun:"&#xe05f;",SunSmall:"&#xe05e;",Switch:"&#xe094;",Sync:"&#xe100;",Tag:"&#xe02f;",Target:"&#xe018;",TeamView:"&#xe914;",Thermometer:"&#xe06e;",ThumbsDown:"&#xe020;",ThumbsUp:"&#xe01f;",Thunder:"&#xe043;",Tick:"&#xe079;",Ticket:"&#xe06b;",Tools:"&#xe02d;",Traffic:"&#xe565;",Translate:"&#xe924;",Trash:"&#xe0a3;",Trophy:"&#xe02e;",Upload:"&#xe0a4;",Upload2:"&#xe0a9;",User:"&#xe0f3;",UserAdd:"&#xe0f5;",UserAddOld:"&#xe011;",UserBlock:"&#xe0f7;",UserBoss:"&#xe0f8;",UserCheck:"&#xe18a;",UserCheckOutline:"&#xe18b;",UserDel:"&#xe0f6;",UserOld:"&#xe00f;",Users:"&#xe0f4;",UsersOld:"&#xe010;",Vcard:"&#xe012;",Video:"&#xe09f;",ViewRefresh:"&#xe915;",Voicemail:"&#xe067;",Volume:"&#xe0b7;",Warning:"&#xe089;",Wikipedia:"&#xe938;",Wireless:"&#xe06d;",Wordpress:"&#xe937;",Wrench:"&#xe0f9;",Zzz:"&#xe106;"},Affinity.icons.getIcon=function(n,t){return n&&n in Affinity.icons?Affinity.icons[n]:n&&(n=n.replace("icon","").trim().camelCase(),n in Affinity.icons)?Affinity.icons[n]:t&&t in Affinity.icons?Affinity.icons[t]:""},Affinity.appname="none",Affinity.apiversion=2,Affinity.urlroot="",Affinity.authroot="",Affinity.zelosroot="",Affinity.lookupapi="",Affinity.debug=!(parseInt(Affinity.Components.Commons.Version.split(".")[2])%2==0),Affinity.uisession=String.uniqueID(),Affinity.uiready=!1,Affinity.commonsReady=!0,Affinity.login=null,Affinity.loaders={},Affinity.loaders.dark="data:image/gif;base64,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",Affinity.loaders.light="data:image/gif;base64,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",Affinity.loaders.blue="data:image/gif;base64,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",Affinity.loaders.large={},Affinity.loaders.large.light="data:image/gif;base64,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",Affinity.loaders.large.dark="data:image/gif;base64,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",Affinity.agent=window.navigator.userAgent,Affinity.oldess=!1,Affinity.oldessLaunched=!1,Affinity.oldessFrame=!1,Affinity.oldessWindow=!1,Affinity.ismac=!1,Affinity.isie=!1,Affinity.isEdge=!1,Affinity.ieversion=!1,Affinity.iedocmode=!1,Affinity.ismobile=!1,Affinity.mobile=!1,Affinity.istablet=!1,Affinity.tablet=!1,Affinity.isloggedin=!1,Affinity.isTeampayoffice=!1,Affinity.isTeampayofficeBranch=!1,Affinity.scrollBarSize=0,Affinity.supportsPassiveEvents=!1,Affinity.supportsDatalist=!1,Affinity.loginsThisSession=0,Affinity.UI={},Affinity.UI.debug={},Affinity.UI.lookups={},Affinity.UI.lookupLoaders=[],Affinity.UI.displaylookups={},Affinity.UI.displaylookupLoaders=[],Affinity.UI.dependancies={},Affinity.UI.dependancyLoaders=[],Affinity.UI.autocomplete={},Affinity.UI.lastAutoKill={},Affinity.UI.delayAutoKill=function(n,t){document.getElement("."+t)&&(document.getElement("."+t).removeEvents(),document.getElement("."+t).destroy()),window.Affinity.UI.lastAutoKill[n]=null,delete window.Affinity.UI.lastAutoKill[n]},Affinity.DarkMode=!1,Affinity.UI.scrolling=!1,Affinity.UI.autoscroll=function(n){var t=window;if(Affinity.oldessFrame)try{t=window.parent.window}catch(f){}try{var i=t.document.documentElement,r=t.document.body,u=i&&i.scrollTop||r&&r.scrollTop||0;n>0&&t.scrollTo(0,u+10),n<0&&t.scrollTo(0,u-10)}catch(f){}},Affinity.EstablishAutosrollOnDragEvents=function(){document.addEventListener(Affinity.events.move,function(n){var t;if(Affinity.UI.drageventFired){var r=n.client.y,i=window.innerHeight||window.document.documentElement.clientHeight,u=50,f=i-50;if(Affinity.oldessFrame)try{t=window.parent,i=t.innerHeight||t.document.documentElement.clientHeight;var e=t.document.documentElement,o=t.document.body,h=e&&e.scrollTop||o&&o.scrollTop||0,c=document.documentMode&&document.documentMode<9?Affinity.oldessFrame.querySelectorAll(".ContentBody")[0].offsetTop:Affinity.oldessFrame.getElementsByClassName("ContentBody")[0].offsetTop;var s=h-c,u=50+s,f=s+i-50}catch(n){}r>f?Affinity.UI.scrolling||(document.getElement(".dragger")&&document.getElement(".dragger").setStyle("display","none"),Affinity.UI.scrolling=!0,Affinity.UI.scroller=Affinity.UI.autoscroll.periodical(25,window,[1])):r<u?Affinity.UI.scrolling||(document.getElement(".dragger")&&document.getElement(".dragger").setStyle("display","none"),Affinity.UI.scrolling=!0,Affinity.UI.scroller=Affinity.UI.autoscroll.periodical(25,window,[-1])):Affinity.UI.scrolling&&(document.getElement(".dragger")&&document.getElement(".dragger").setStyle("display","block"),Affinity.UI.scrolling=!1,clearInterval(Affinity.UI.scroller))}},Affinity.supportsPassiveEvents?{passive:!0}:!1),document.addEventListener(Affinity.events.end,function(){Affinity.UI.drageventFired=!1,Affinity.UI.scrolling&&(document.getElement(".dragger")&&document.getElement(".dragger").setStyle("display","block"),Affinity.UI.scrolling=!1,clearInterval(Affinity.UI.scroller))}),Affinity.EstablishAutosrollOnDragEvents=null,delete Affinity.EstablishAutosrollOnDragEvents},Affinity.Konami=new Class({Implements:[Options],options:{onSuccess:function(){}},input:"",pattern:"38384040373937396665",initialize:function(n){this.setOptions(n),document.addEvent("keydown",function(n){this.input+=n.code,this.input.length>this.pattern.length&&(this.input=this.input.substr(this.input.length-this.pattern.length)),this.input===this.pattern&&this.options.onSuccess()}.bind(this))}}),Affinity.RickRoll=new Class({Binds:["inject","destroy"],options:{},input:"",ytBox:!1,pattern:"8273677582797676",initialize:function(){document.addEvent("keydown",function(n){this.input+=n.code,this.input.length>this.pattern.length&&(this.input=this.input.substr(this.input.length-this.pattern.length)),this.input===this.pattern&&this.inject()}.bind(this))},inject:function(){this.destroy(),this.ytBox=new Element("div").setStyles({position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(255,255,255,0.8)","text-align":"center","z-index":99999999999}).inject(document.body,"bottom").set("html",'<iframe width="420" height="315" style="position:fixed;top:50%;left:50%;margin:-157px 0 0 -210px;" src="https://www.youtube-nocookie.com/embed/dQw4w9WgXcQ?rel=0&amp;autoplay=1&amp;showinfo=0" frameborder="0" allowfullscreen><\/iframe>').addEvent("click",this.destroy)},destroy:function(){this.ytBox&&(this.ytBox.removeEvents(),this.ytBox.destroy())}}),new Affinity.RickRoll,Affinity.CookieMonster=new new Class({Read:function(n){var t,i;if(Affinity.isie){if(t=document.cookie.indexOf(n+"="),t!==-1)return t+=n.length+1,i=document.cookie.indexOf(";",t),i===-1&&(i=document.cookie.length),unescape(document.cookie.substring(t,i))}else return Cookie.read(n)},Write:function(n,t,i){var r=new URI(window.location.href).parsed.host,u=new Date;if(typeOf(i)!=="null"&&!isNaN(i)&&parseFloat(i)>0){var e=new Date(u.getTime()+i*6e4),o=u.toUTCString(),f=e.toUTCString();if(log("&#169; Cookie Write Expires - name: "+n+", value: "+t),log("  expires: "+f+", now: "+o+", expires value: "+i+", in days: "+parseFloat(i)/1440+", domain: "+r),Affinity.isie)try{return document.cookie=n+"="+escape(t)+"; expires="+f+"; domain:"+r+"; SameSite=None; Secure",t}catch(s){return!1}else try{return Cookie.write(n,t,{duration:parseFloat(i)/1440}),t}catch(s){return!1}}else if(log("&#169; Cookie Write - name: "+n+", value: "+t),Affinity.isie)try{return document.cookie=n+"="+escape(t)+"; SameSite=None; Secure",t}catch(s){return!1}else try{return Cookie.write(n,t),t}catch(s){return!1}},Delete:function(n){if(log("&#169; Cookie Delete - name: "+n),Affinity.isie){document.cookie=n+"=; expires=Thu, 01-Jan-70 00:00:01 GMT; SameSite=None; Secure";try{return Cookie.dispose(n),!0}catch(t){return!1}}else try{return Cookie.dispose(n),!0}catch(t){return!1}}}),Affinity.logger=new new Class({Binds:["build","enable","disable","enableLog","disableLog","log","clear","open","close"],enabled:!1,__prelog:[],initialize:function(){window.log=this.log,window.logClear=this.clear,window.logEnable=this.enableLog,window.logDisable=this.disableLog},build:function(){if(!Affinity.uiready){window.removeEvent("UiReady",this.build),window.addEvent("UiReady",this.build);return}window.removeEvent("UiReady",this.build),document.id("_log")&&document.id("_log").destroy(),document.id("_logbutton")&&document.id("_logbutton").destroy(),this.enabled=!0,this.logBox=new Element("div",{id:"_log"}).inject(document.body,"bottom"),this.logsBox=new Element("div",{html:"","class":"logs"}).inject(this.logBox,"top"),this.closeButton=new Element("div",{html:"close","class":"close"}).inject(this.logBox,"top"),this.clearButton=new Element("div",{html:"clear","class":"clear"}).inject(this.logBox,"top"),this.hiddenButton=new Element("div",{id:"_logbutton"}).inject(this.logBox,"after"),this.hiddenButton.setStyles({position:"absolute",top:5,left:5,width:30,height:30,"z-index":9999999998}),this.logBox.setStyles({position:"absolute",top:40,left:5,width:"80%",height:"80%",border:"1px solid black","background-color":"#fff",color:"000","z-index":9999999999,"-webkit-transform":"translateX(0)",transform:"translateX(0)",display:"none"}),this.logsBox.setStyles({width:"100%",height:"100%",padding:10,overflow:"scroll","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"}),this.clearButton.setStyles({position:"absolute",top:10,right:80,padding:5,"background-color":"#fff",cursor:"pointer"}),this.closeButton.setStyles({position:"absolute",top:10,right:30,padding:5,"background-color":"#fff",cursor:"pointer"}),this.closeButton.addEvent(Affinity.events.click,this.close),this.clearButton.addEvent(Affinity.events.click,this.clear),this.hiddenButton.addEvent(Affinity.events.click,this.open),this.log("// log started "+new Date),this.__prelog.length>0&&Array.each(this.__prelog,function(n){this.log(n[0],n[1])}.bind(this)),this.enabled=!1,window.fireEvent("LogReady")},enable:function(){this.destroy(),this.build(),this.open()},disable:function(){this.destroy()},enableLog:function(){return this.enabled=!0,this.log("// log enabled "+new Date),'Log Enabled. Enter "disableLog()" to stop.'},disableLog:function(){return this.log("// log disabled "+new Date),this.enabled=!1,'Log disabled. Enter "enableLog()" to start.'},log:function(n,t){if(this.enabled){if(typeOf(n)==="string"&&(n==="show"||n==="open")){this.open();return}var i=typeOf(n)==="object"||typeOf(n)==="array"?JSON.stringify(n,null,2):typeOf(n)==="element"?"element type: "+n.get("tag")+"\r\n"+JSON.stringify(n.getProperties("id","class","style","src","title","alt"),null,2):n;typeOf(t)==="object"?new Element("<pre>",{html:i}).inject(this.logsBox,"top").setStyles(t):typeOf(t)==="string"?new Element("<pre>",{html:i}).inject(this.logsBox,"top").set("style",t):new Element("<pre>",{html:i}).inject(this.logsBox,"top")}else this.__prelog.push([n,t])},clear:function(){this.enabled&&(this.logsBox.empty(),this.log("// log cleared "+new Date))},open:function(){this.enabled&&(this.logBox.getStyle("display")==="none"?this.logBox.setStyle("display","block"):this.logBox.setStyle("display","none"))},close:function(){this.enabled&&(this.logBox.getStyle("display")==="block"?this.logBox.setStyle("display","none"):this.logBox.setStyle("display","block"))},destroy:function(){window.removeEvent("UiReady",this.build),this.enabled=!1,this.closeButton&&this.closeButton.remveEvents(),this.clearButton&&this.clearButton.remveEvents(),this.hiddenButton&&this.hiddenButton.remveEvents(),this.logBox&&this.logBox.destroy()}}),Affinity.SmartClose=new Class({Binds:["isActive","checkActive","isOver","setClose","overAll","outAll","windowClick"],over:!1,isOverCheckTimer:!1,initialize:function(n){if(Affinity.mobile)return"is mobile";this.class="smart-close-"+String.uniqueID(),this.element=n,this.element.addClass(this.class),this.element.isOver=this.isOver,this.element.addEvent(Affinity.events.overAll,this.overAll),this.element.addEvent(Affinity.events.outAll,this.outAll),this.element.addEvent("focus",this.setClose)},isActive:function(){if(document.activeElement){if(document.activeElement===this.element||document.activeElement.getParent("."+this.class)===this.element)return!0}else return!1;return!0},checkActive:function(){this.isActive()||(this.over=!1,this.windowClick())},isOver:function(){return this.isActive()||(this.over=!1),this.over},setClose:function(){window.removeEvent(Affinity.events.click,this.windowClick),window.addEvent(Affinity.events.click,this.windowClick)},overAll:function(){clearTimeout(this.isOverCheckTimer),this.setClose(),this.over=!0,this.isOverCheckTimer=this.checkActive.delay(1e3,this)},outAll:function(){clearTimeout(this.isOverCheckTimer),this.over=!1},windowClick:function(){this.over||(this.element.fireEvent("SmartClose"),window.removeEvent(Affinity.events.click,this.windowClick))}}),Affinity.UI.mobileZooming=!1,Affinity.mobile&&window.addEvents({touchmove:function(n){n.touches.length===2&&(Affinity.UI.mobileZooming=!0)},touchend:function(){if(Affinity.UI.mobileZooming){var n=document.createEvent("HTMLEvents");n.initEvent("resize",!0,!1),window.dispatchEvent(n)}Affinity.UI.mobileZooming=!1}}),Affinity.GetCacheSafePath=function(n){if(!Affinity.isie||typeOf(n)!=="string")return n;return n+(n.contains("?")?"&ran=":"?ran=")+String.uniqueID()+"-"+Date.parse(new Date).format("%s")},Affinity.ProcessUrl=function(n){var t,u="/_Api/Zelos",i,o,r,e,f;return i=n.replace("%3F","?"),i=Affinity.isTeampayoffice&&new RegExp("timesheets"+u,"i").test(i)?i.replace(new RegExp("timesheets"+u,"i"),u):i,i=Affinity.isTeampayofficeBranch&&new RegExp("tb"+u,"i").test(i)?i.replace(new RegExp("tb"+u,"i"),u):i,i=i.replace(u+"?",""),o=i.indexOf("&")>-1&&i.indexOf("?")===-1?i.replace("&","?"):i,r=new URI(o),e={},typeOf(r.parsed.query)!=="null"&&(f=r.parsed.query.parseQueryString(),Object.each(f,function(n,t){typeOf(n)==="array"&&(f[t]=n[n.length-1])}),e=Object.toQueryString(f)),r.parsed.query="",t=r.toString(),t=typeOf(r.parsed.scheme)!=="null"?t.replace(r.parsed.scheme+"://",""):t,t=typeOf(r.parsed.host)!=="null"?t.replace(r.parsed.host,""):t,t=typeOf(r.parsed.port)!=="null"?t.replace(":"+r.parsed.port,""):t,t=t.indexOf(u)===-1?u+"?"+t:t,t=(t.charAt(0)==="/"?t.substring(1):t)+"?"+decodeURIComponent(Object.toQueryString(e)),t=Affinity.isTeampayoffice&&!Affinity.isTeampayofficeBranch&&t.indexOf("timesheets")===-1?"/timesheets/"+t:t,t=Affinity.isTeampayofficeBranch&&t.indexOf("tb")===-1?"/tb/"+t:t,t=t.replace(new RegExp("//","g"),"/"),t=t.replace("??","?"),t.replace("?/","?")},Affinity.ProcessUrlObj=function(n,t){var i,r,u="/_Api/Zelos";return t=typeOf(t)!=="null"?t:{},r=t.parseQueryString(),Object.each(r,function(n,t){typeOf(n)==="array"&&(r[t]=n[n.length-1])}),t=Object.toQueryString(r),n.parsed.query="",n.parsed.directory=Affinity.isTeampayoffice&&new RegExp("timesheets/","i").test(n.parsed.directory)?n.parsed.directory.replace(new RegExp("timesheets/","i"),""):n.parsed.directory,n.parsed.directory=Affinity.isTeampayofficeBranch&&new RegExp("tb/","i").test(n.parsed.directory)?n.parsed.directory.replace(new RegExp("tb/","i"),""):n.parsed.directory,n.parsed.directory=n.parsed.directory.replace(new RegExp("//","g"),"/"),i=n.toString(),i=typeOf(n.parsed.scheme)!=="null"?i.replace(n.parsed.scheme+"://",""):i,i=typeOf(n.parsed.host)!=="null"?i.replace(n.parsed.host,""):i,i=typeOf(n.parsed.port)!=="null"?i.replace(":"+n.parsed.port,""):i,i=i.indexOf(u)===-1?u+"?"+i:i,i=(i.charAt(0)==="/"?i.substring(1):i)+"?"+decodeURIComponent(Object.toQueryString(t)),i=Affinity.isTeampayoffice&&!Affinity.isTeampayofficeBranch&&i.indexOf("timesheets")===-1?"/timesheets/"+i:i,i=Affinity.isTeampayofficeBranch&&i.indexOf("tb")===-1?"/tb/"+i:i,i=i.replace(new RegExp("//","g"),"/"),i=i.replace("??","?"),i.replace("?/","?")},Affinity.IsElement=function(n){try{return n instanceof HTMLElement}catch(t){return typeof n=="object"&&n.nodeType===1&&typeof n.style=="object"&&typeof n.ownerDocument=="object"}},Locale.define("en-NZ","Date",{dateOrder:["date","month","year","/"],shortDate:"%D/%M/%Y",shortTime:"%I:%M%p",AM:"am",PM:"pm"}).inherit("en-US","Date"),Locale.define("en-AU").inherit("en-NZ","Date"),Locale.use("en-NZ"),Date.implement({toZelos:function(){return Date.parse(this.format("%d/%m/%Y %H:%M:%S")).format("%Y-%m-%dT%H:%M:%S")},toTime:function(){try{return this.format("%k:%M:%S")}catch(n){return"Invalid Date"}},toTime24:function(){this.toTime()},toTime12:function(){try{return this.format("%l:%M:%S %p").toLowerCase()}catch(n){return"Invalid Date"}},toSimple:function(){try{return this.format("%d-%m-%Y")}catch(n){return"Invalid Date"}},toSimpleDateTime:function(){try{return this.format("%d-%m-%Y %k:%M:%S")}catch(n){return"Invalid Date"}},toServer:function(){try{return this.format("%d.%m.%Y %k:%M:%S %z")}catch(n){return"Invalid Date"}},toFriendly:function(){try{return this.format("%A %B %e%o %Y").replace(/  /gi," ")}catch(n){return"Invalid Date"}},toFriendlyShort:function(){try{return this.format("%a %b %e%o %Y").replace(/  /gi," ")}catch(n){return"Invalid Date"}},toWords:function(){try{return this.timeDiffInWords()}catch(n){return"Invalid Date"}},toWordsShort:function(){try{return this.timeDiffInWords().replace(/year/g,"yr").replace(/month/g,"mnth").replace(/hour/g,"hr").replace(/minute/g,"min").replace(/second/g,"sec").replace(/about/g,"")}catch(n){return"Invalid Date"}},matches:function(n,t,i){if(typeOf(n)!=="null"){var r=Date.parse(this),u=Date.parse(n);if(r&&u&&typeOf(r)=="date"&&typeOf(u)==="date"&&r.isValid()&&u.isValid()&&(typeOf(t)==="boolean"&&t&&(r=r.setSeconds(0),u=u.setSeconds(0)),typeOf(i)==="boolean"&&i&&(r=r.setMilliseconds(0),u=u.setMilliseconds(0)),r=r.getTime(),u=u.getTime(),r===u))return!0}return!1},elapsed:function(){return((new Date).getTime()-this.getTime())/1e3},sameDay:function(n){if(typeOf(n)!=="null"){var t=Date.parse(this),i=Date.parse(n);if(t&&i&&typeOf(t)=="date"&&typeOf(i)==="date"&&t.isValid()&&i.isValid()&&(t=t.clearTime().getTime(),i=i.clearTime().getTime(),t===i))return!0}return!1},lessThan:function(n){if(typeOf(n)!=="null"){var t=Date.parse(this),i=Date.parse(n);if(t&&i&&typeOf(t)=="date"&&typeOf(i)==="date"&&t.isValid()&&i.isValid()&&(t=t.clearTime().getTime(),i=i.clearTime().getTime(),t<i))return!0}return!1},lessThanOrEqualTo:function(n){return typeOf(n)!=="null"&&(this.sameDay(n)||this.lessThan(n))?!0:!1},greaterThan:function(n){if(typeOf(n)!=="null"){var t=Date.parse(this),i=Date.parse(n);if(t&&i&&typeOf(t)=="date"&&typeOf(i)==="date"&&t.isValid()&&i.isValid()&&(t=t.clearTime().getTime(),i=i.clearTime().getTime(),t>i))return!0}return!1},greaterThanOrEqualTo:function(n){return typeOf(n)!=="null"&&(this.sameDay(n)||this.greaterThan(n))?!0:!1}}),Date.defineFormat("zelos",function(n){return n.toZelos()}),Date.CurentYear=(new Date).get("year"),Date.FormatStrings=[["christmas","12.25."+(Date.CurentYear+1)],["xmas","12.25."+(Date.CurentYear+1)],["newyear","1.1."+(Date.CurentYear+1)],["new year","1.1."+(Date.CurentYear+1)]],Date.TimeTravel=[["second",/(\+|\-)\s*[0-9]+( )*(seconds|second|sec|s)/],["minute",/(\+|\-)\s*[0-9]+( )*(minutes|minute|min|m)/],["hour",/(\+|\-)\s*[0-9]+( )*(hours|hour|h)/],["day",/(\+|\-)\s*[0-9]+( )*(days|day|d)/],["week",/(\+|\-)\s*[0-9]+( )*(weeks|week|w)/],["month",/(\+|\-)\s*[0-9]+( )*(months|month)/],["year",/(\+|\-)\s*[0-9]+( )*(years|year|y)/]],String.implement({toDate:function(){Locale.use("en-GB");var n,i,r,t;if(s=this.toLowerCase().trim(),s==="now")return new Date;for(s.contains("now ")&&(s=s.replace(/(now |today )/,(new Date).format("%k:%H:%S "))),/^\d+$/.test(s)&&s.length>=6&&(s=s.length>8?parseInt(s,10)*1e3+"":s.substr(0,2)+"."+s.substr(2,2)+"."+s.substr(4)),n=0;n<Date.FormatStrings.length;n++)if(s.contains(Date.FormatStrings[n][0])){s=s.replace(Date.FormatStrings[n][0],Date.FormatStrings[n][1]);break}for(n=0;n<Date.TimeTravel.length;n++)s.test(Date.TimeTravel[n][1])&&(i=s.match(Date.TimeTravel[n][1])[0],r=i.match(/[0-9]+/)[0],i.indexOf("+")&&(t=Date.parse(s.replace(i,"").trim()).decrement(Date.TimeTravel[n][0],parseFloat(r))),i.indexOf("-")&&(t=Date.parse(s.replace(i,"").trim()).increment(Date.TimeTravel[n][0],parseFloat(r))));t=t==null?Date.parse(s):t;try{return t.format("%s")==0?"Invalid Date":t}catch(u){return"Invalid Date"}}}),String.implement({ToCamelCase:function(){return this.toLowerCase().replace(/(_|-)([a-z])/g,function(n){return n[1].toUpperCase()})}}),String.implement({isNullOrEmpty:function(){return typeof this=="string"&&(this===null||this.trim().toLowerCase()==="null"||this.trim()==="")?!0:!1}}),Affinity.hasOwnProperty("isWindow")||(Affinity.isWindow=function(n){return n!=null&&n===n.window},Affinity.isWindowReturn=function(n){return Affinity.isWindow(n)?n:!1}),Affinity.hasOwnProperty("isObject")||(Affinity.isObject=function(n){return n===null||typeof n!="object"||n.nodeType||Affinity.isWindow(n)?!1:n.constructor&&!hasOwnProperty.call(n.constructor.prototype,"isPrototypeOf")?!1:!0},Affinity.isObjectReturn=function(n){return Affinity.isObject(n)?n:!1}),Affinity.hasOwnProperty("FormatString")||(Affinity.FormatString=function(n,t){if(typeof n=="object"&&(n=Object.keys(n).map(function(t){return n[t]}).join("")),t.length===1&&Affinity.isObject(t[0])){var r=t[0],i;for(i in r)r.hasOwnProperty(i)&&(n=n.replace(new RegExp("{"+i+"}","g"),r[i]));return n}return n.replace(/{(\d+)}/g,function(n,i){return typeof t[i]!="undefined"?t[i]:n})}),String.prototype.format||(String.prototype.format=function(){var n=[].slice.call(arguments);return Affinity.FormatString(this,n)}),Array.implement({FindIn:function(n,t){for(var i=this.length-1;i<-1;i--)if(this[i][n]===t)return this[i];return null}}),Object.valueFromKeyString=function(n,t){var r,i,f,u;try{for(t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,""),r=t.split("."),i=0,f=r.length;i<f;++i)if(u=r[i],u in n)n=n[u];else return!1;return n}catch(e){return null}},Array.implement({mapFromKey:function(n){if(this.length>0&&n in this[0])return this.reduce(function(t,i){return t[i[n]]=i,t},{})}}),Affinity.DeepMergeObjects=function(n){function r(n){var t=n&&typeof n=="object";return t&&Object.prototype.toString.call(n)!=="[object RegExp]"&&Object.prototype.toString.call(n)!=="[object Date]"}function f(n){return Array.isArray(n)?[]:{}}function i(n,i){var u=i&&i.clone===!0;return u&&r(n)?t(f(n),n,i):n}function u(n,u,f){var e=n.slice();return u.forEach(function(u,o){typeof e[o]=="undefined"?e[o]=i(u,f):r(u)?e[o]=t(n[o],u,f):n.indexOf(u)===-1&&e.push(i(u,f))}),e}function e(n,u,f){var e={};return r(n)&&Object.keys(n).forEach(function(t){e[t]=i(n[t],f)}),Object.keys(u).forEach(function(o){e[o]=r(u[o])&&n[o]?t(n[o],u[o],f):i(u[o],f)}),e}function t(n,t,r){var f=Array.isArray(t),o=r||{arrayMerge:u},s=o.arrayMerge||u;return f?Array.isArray(n)?s(n,t,r):i(t,r):e(n,t,r)}return t.all=function(n,i){if(!Array.isArray(n)||n.length<2)throw new Error("first argument should be an array with at least two elements");return n.reduce(function(n,r){return t(n,r,i)})},t.all(n)},JSON.Unauthorized=function(n,t){var r=!1,i=typeOf(n);return(i==="object"||i==="array")&&(n=JSON.encode(n),i="string"),i==="string"&&n.indexOf('[{"Key":')!==0&&(n.test("unauthorized","gi")||n.test("unauthorised","gi")||n.test("/(401/)","gi")||n.test("/(403/)","gi"))&&(log("&#x270B; json response is unauthorized"+(typeOf(t)!==null?" ("+unescape(t)+")":"")+" &#x270B;"),log(JSON.stringify(n,null,2)),log("&#x270B; END json response is unauthorized log &#x270B;"),window.prompts&&Affinity.prompts.hide(),r=!0),n=null,r},Element.implement({hasWidget:function(n){return this.retrieve(n)?!0:!1},getWidget:function(n){return n&&this.retrieve(n)?this.retrieve(n):this.retrieve("widget")?this.retrieve("widget"):!1},destroyWidget:function(n){var t=this.getWidget(n);return t&&"destroy"in t&&t.destroy(),t=null,null},exists:function(){try{if(document.contains(this))return this}catch(n){}return!1}}),DOMEvent.implement({getTarget:function(n){return this.target.hasClass(n)?this.target:this.target.get("id")===n?this.target:this.target.getParent("."+n)?this.target.getParent("."+n):this.target.getParent("#"+n)?this.target.getParent("#"+n):this.target}}),Element.implement({hasEvent:function(n,t){var i=this.retrieve("events");switch(i&&i[n]&&(t==undefined||i[n].keys.contains(t))){case null:case!1:case undefined:case 0:return!1;default:return!0}}}),Affinity.FormElement=new Class({Implements:[Options,Events],WidgetName:"FormElement",Binds:["clearEvents","setEvents","sanatiseValue","cloneValue","setValue","getValue","getDisplayValue","checkChanged","lookup","lookupComplete","destroy"],options:{},element:!1,dynamicContents:!1,dynamicFirstLoad:!0,defaultValue:"",valueEmpty:!1,changed:!1,initialize:function(n,t){this.setOptions(t),this.element=n,n.retrieve("defaultValue")||(this.element=n,this.setEvents(),this.defaultValue=this.sanatiseValue(n.value),this.element.store("defaultValue",this.defaultValue)),this.element.store("widget",this),this.element.store("elementWidget",this),this.element.addClass("widget"),this.element.value=this.sanatiseValue(this.element.value),this.lastValue=this.element.value},reset:function(){this.changed=!0,this.defaultValue=this.sanatiseValue(this.element.value),this.lastValue=this.element.value,this.element.store("defaultValue",this.defaultValue),this.element.fireEvent("changed",{target:this.element,defaultValue:this.defaultValue,value:this.element.value,type:"changed",originalEvent:null}),this.element.addClass("changed").removeClass("restored")},clearEvents:function(){this.element.removeEvent("input",this.checkChanged),this.element.removeEvent("lookup",this.lookup),this.element.removeEvent("lookupComplete",this.lookupComplete),this.element.removeEvent("change",this.checkChanged),this.element.removeEvent("blur",this.checkChanged)},setEvents:function(){this.clearEvents(),this.element.get("list")?this.element.addEvent("input",this.checkChanged):(this.element.addEvent("lookup",this.lookup),this.element.addEvent("lookupComplete",this.lookupComplete),this.element.addEvent("change",this.checkChanged),this.element.addEvent("blur",this.checkChanged))},sanatiseValue:function(n){try{return n===null||n===undefined||n.trim()===""?"":n}catch(t){return n}},cloneValue:function(n){return(n+"").trim()},getValue:function(){return this.element.value},setValue:function(n){this.element.value=this.sanatiseValue(n),this.defaultValue=this.element.value,this.lastValue=this.element.value,this.element.store("defaultValue",this.defaultValue),this.element.removeClass("changed").removeClass("restored"),this.changed=!1},getDisplayValue:function(){return this.element.value},checkChanged:function(n){var t;return t=typeOf(n)!=="null"&&typeOf(n.target)!=="null"?n.target.value:this.sanatiseValue(this.element.value),this.cloneValue(t)!==this.cloneValue(this.defaultValue)?(this.changed=!0,this.lastValue===this.element.value&&(this.element.fireEvent("changed",{target:this.element,defaultValue:this.defaultValue,value:this.element.value,type:"changed",originalEvent:n}),this.element.addClass("changed").removeClass("restored")),this.lastValue=this.element.value):(this.changed=!1,this.element.fireEvent("restored",{target:this.element,defaultValue:this.defaultValue,value:this.element.value,type:"restored",originalEvent:n}),this.lastValue=this.element.value,this.element.addClass("restored").removeClass("changed")),this.changed},lookup:function(){this.dynamicContents=!0},lookupComplete:function(n){this.dynamicFirstLoad&&(this.defaultValue=n.defaultValue,this.element.store("defaultValue",this.defaultValue),this.dynamicFirstLoad=!1),this.checkChanged({target:this.element})},destroy:function(){this.clearEvents(),this.element.eliminate("defaultValue"),this.element.eliminate("elementWidget")}}),Element.implement({makeFormElement:function(){return this.get("tag").test("select|input|textarea|datalist","gi")&&new Affinity.FormElement(this),this}}),Affinity.ElementValueTracker=new Class({Implements:[Options,Events],WidgetName:"ValueTracker",Binds:["__removeEvents","__addEvents","__elementChanged","__elementBlured","__doChangeCheck","__doChangeCheckThrottled","__lookupComplete","addElement","removeElement","setValue","hasChanged","hasRestored","getValue","getDefault","getLast","changeStatus"],options:{},elements:[],values:[],valuesDefault:[],valuesLast:[],id:!1,initialize:function(n){this.id=String.uniqueID(),n&&!n.hasClass("has-change-tracker")&&this.addElement(n)},__removeEvents:function(n){n.removeEvent("change",this.__elementChanged),n.removeEvent("blur",this.__elementBlured)},__addEvents:function(n){n.addEvent("change",this.__elementChanged),n.addEvent("blur",this.__elementBlured)},__cloneValue:function(n){var i=typeOf(n)==="number"?!0:!1,t=(n+"").trim();return i?parseFloat(t):t},__sanatiseValue:function(n){try{return n===null||n===undefined||n.trim()===""?"":n}catch(t){return n}},__isSame:function(n,t){var i=n+"",r=t+"";return i.isNullOrEmpty()&&r.isNullOrEmpty()?!1:i.trim().toLowerCase()===r.trim().toLowerCase()},__doChangeCheck:function(n){clearTimeout(this.__doChangeCheckThrottle),this.__doChangeCheckThrottle=this.__doChangeCheckThrottled.delay(100,this,[n])},__doChangeCheckThrottle:!1,__doChangeCheckThrottled:function(n){if(n&&["object","event","domevent"].contains(typeOf(n))&&"target"in n&&this.elements.indexOf(n.target)>-1){var t,i;Array.each(this.elements,function(n,r){t=i=!1,this.values[r]=this.__sanatiseValue(n.value),this.__isSame(this.values[r],this.valuesDefault[r])?i=!0:t=!0,n.removeClass("cant-select-default"),t&&(n.removeClass("value-restored").addClass("value-changed"),n.fireEvent("ElementChanged",{value:this.values[r],last:this.valuesLast[r],"default":this.valuesDefault[r]}),this.fireEvent("ElementChanged",{value:this.values[r],last:this.valuesLast[r],"default":this.valuesDefault[r]}),window.fireEvent("AnElementChanged",{target:this.elements[r],value:this.values[r],last:this.valuesLast[r],"default":this.valuesDefault[r]}),this.values[r]!==this.valuesDefault[r]&&(n.get("class").test(new RegExp("dependencies","gi"))||n.get("class").test(new RegExp("lookup","gi")))&&n.addClass("cant-select-default")),i&&(n.removeClass("value-changed").addClass("value-restored"),n.fireEvent("ElementRestored",{value:this.values[r],last:this.valuesLast[r],"default":this.valuesDefault[r]}),this.fireEvent("ElementRestored",{value:this.values[r],last:this.valuesLast[r],"default":this.valuesDefault[r]}),window.fireEvent("AnElementRestored",{target:this.elements[r],value:this.values[r],last:this.valuesLast[r],"default":this.valuesDefault[r]})),this.valuesLast[r]=this.values[r]}.bind(this))}},__elementChanged:function(n){this.__doChangeCheck(n)},__elementBlured:function(n){this.__doChangeCheck(n)},__lookupComplete:function(n){this.__doChangeCheck.delay(500,this,[n])},addElement:function(n){if(!n.retrieve("changetracker")){var t="value"in n?n.value:"",i=n.get("data-default-value")?n.get("data-default-value"):t;this.elements.indexOf(n)===-1?(this.elements.push(n),this.values.push(t),this.valuesDefault.push(i),this.valuesLast.push(t),this.__removeEvents(n),this.__addEvents(n),n.addEvent("lookupComplete",this.__lookupComplete),n.addClass("has-change-tracker"),n.store("changetracker",this)):this.setValue(n,t)}},removeElement:function(n){if(this.elements.indexOf(n)!==-1){var t=this.elements.indexOf(n);this.elements.splice(t,1),this.values.splice(t,1),this.valuesLast.splice(t,1),this.valuesDefault.splice(t,1),this.__removeEvents(n),n.removeClass("value-restored").removeClass("value-changed").removeClass("has-change-tracker"),n.eliminate("changetracker")}},setValue:function(n,t){if(this.elements.indexOf(n)!==-1){var i=this.elements.indexOf(n);n.value=t,n.removeClass("value-restored").removeClass("value-changed"),this.values[i]=t,this.valuesDefault[i]=t,this.valuesLast[i]=t,this.__removeEvents(n),this.__addEvents(n)}else this.addElement(n)},hasChanged:function(){var n=!1;return Array.each(this.elements,function(t,i){t.hasClass("value-changed")&&(n=!0),this.__isSame(this.values[i],this.valuesDefault[i])||(n=!0)}.bind(this)),n},hasRestored:function(){var n=!1;return Array.each(this.elements,function(t){t.hasClass("value-restored")&&(n=!0)}.bind(this)),n},getValue:function(n){var i=n||this.elements[0],t=this.elements.indexOf(i);if(t!==-1)return this.values[t];throw new Error("Target element not tracked");},getDefault:function(n){var i=n||this.elements[0],t=this.elements.indexOf(i);if(t!==-1)return this.valuesDefault[t];throw new Error("Target element not tracked");},getLast:function(n){var i=n||this.elements[0],t=this.elements.indexOf(i);if(t!==-1)return this.valuesLast[t];throw new Error("Target element not tracked");},changeStatus:function(){return{changed:this.hasChanged(),restored:this.hasRestored(),values:this.values,last:this.valuesLast,defaults:this.valuesDefault}},destroy:function(){Array.each(this.elements,function(n){this.__removeEvents(n),n.removeClass("value-restored").removeClass("value-changed").removeClass("has-change-tracker"),n.eliminate("changetracker")}.bind(this))}}),Element.implement({addChangeTracker:function(){return this.get("tag").test("select|input|textarea|datalist","gi")&&new Affinity.ElementValueTracker(this),this},hasChanged:function(){if(this.retrieve("changetracker"))return this.retrieve("changetracker").hasChanged()},getTrackedValue:function(){if(this.retrieve("changetracker"))return this.retrieve("changetracker").getValue(this)},getTrackedDefault:function(){if(this.retrieve("changetracker"))return this.retrieve("changetracker").getDefault(this)},getTrackedLast:function(){if(this.retrieve("changetracker"))return this.retrieve("changetracker").getLast(this)},fireTrackedChange:function(){if(this.retrieve("changetracker"))return this.retrieve("changetracker").__elementChanged({target:this}),this.retrieve("changetracker").getValue(this)}}),Element.implement({exists:function(){try{if(document.body.contains(this)||this.ownerDocument&&this.ownerDocument.body.contains(this))return this}catch(n){return!1}return!1}}),Element.Events.added={onAdd:function(){this.exists()?this.fireEvent("exists",this):(this.store("_exists_method",function(){this.exists()&&(clearInterval(this.retrieve("_exists_timer")),this.eliminate("_exists_timer"),this.eliminate("_exists_method"),this.fireEvent("exists",this))}),this.store("_exists_timer",this.retrieve("_exists_method").periodical(100,this)))},onRemove:function(){clearInterval(this.retrieve("_exists_timer")),this.eliminate("_exists_timer"),this.eliminate("_exists_method")}},Element.Events.removed={onAdd:function(){this.exists()?(this.store("_not_exists_method",function(){this.exists()||(clearInterval(this.retrieve("_not_exists_timer")),this.eliminate("_not_exists_timer"),this.eliminate("_not_exists_method"),this.fireEvent("notexists",!0))}),this.store("_not_exists_timer",this.retrieve("_not_exists_method").periodical(1e3,this))):this.fireEvent("notexists",!0)},onRemove:function(){clearInterval(this.retrieve("_not_exists_timer")),this.eliminate("_not_exists_method"),this.eliminate("_not_exists_method")}},String.prototype.soundex=function(){var f=this,t,n="",r,e,o,u;for(f=f.toUpperCase(),n=f,n=n.replace(/[^A-Z]/gi," "),n=n.replace(/^\s*/g,""),n=n.replace(/\s*$/g,""),n=n.replace(/^GH/g,"G"),n=n.replace(/DG/g,"G"),n=n.replace(/GH/g,"H"),n=n.replace(/GN/g,"N"),n=n.replace(/KN/g,"N"),n=n.replace(/PH/g,"F"),n=n.replace(/MP([STZ])/g,"M$1"),n=n.replace(/^PS/g,"S"),n=n.replace(/^PF/g,"F"),n=n.replace(/MB/g,"M"),n=n.replace(/TCH/g,"CH"),u=n.substr(0,1),(u==="H"||u==="W")&&(n="-"+n.substr(1)),n=n.replace(/[AEIOUYHW]/g,"0"),n=n.replace(/[BPFV]/g,"1"),n=n.replace(/[CSGJKQXZ]/g,"2"),n=n.replace(/[DT]/g,"3"),n=n.replace(/[L]/g,"4"),n=n.replace(/[MN]/g,"5"),n=n.replace(/[R]/g,"6"),o=n.length,e="",t="",i=0;i<o;i++)r=n.charAt(i),r===e?t+=" ":(t+=r,e=r);return n=t,n=n.substr(1),n=n.replace(/\s/g,""),n=n.replace(/0/g,""),n+="0000000000",n=u+n,n.substr(0,5)},String.prototype.distance=function(n){var u=this.toLowerCase(),f=n.toLowerCase(),r,t,i;if(u.length===0)return f.length;if(f.length===0)return u.length;for(r=[],t=0;t<=f.length;t++)r[t]=[t];for(i=0;i<=u.length;i++)r[0][i]=i;for(t=1;t<=f.length;t++)for(i=1;i<=u.length;i++)r[t][i]=f.charAt(t-1)===u.charAt(i-1)?r[t-1][i-1]:Math.min(r[t-1][i-1]+1,Math.min(r[t][i-1]+1,r[t-1][i]+1));return r[f.length][u.length]},typeOf(File)==="null"&&(File={}),typeOf(Request)==="null"&&(File={}),File.Upload=new Class({Implements:[Options,Events],options:{onComplete:function(){}},initialize:function(n){var t=this;this.setOptions(n),this.uploadReq=new Request.File({onComplete:function(){t.fireEvent("complete",arguments),this.reset()}}),this.options.data&&this.data(this.options.data),this.options.images&&this.addMultiple(this.options.images)},data:function(n){var t=this;this.options.url.indexOf("?")<0&&(this.options.url+="?"),Object.each(n,function(n,i){t.options.url.charAt(t.options.url.length-1)!=="?"&&(t.options.url+="&"),t.options.url+=encodeURIComponent(i)+"="+encodeURIComponent(n)})},addMultiple:function(n){var t=this;n.each(function(n){t.add(n)})},add:function(n){var t=n;typeOf(n)!=="null"&&(n=document.id(n),name=n.get("name"),file=n.files[0],this.uploadReq.append("fileData",file))},addPostData:function(n){this.uploadReq.addPostData(n)},send:function(n){n&&this.add(n),this.uploadReq.send({url:this.options.url})}}),Request.File=new Class({Extends:Request,options:{emulation:!1,urlEncoded:!1},initialize:function(n){this.xhr=new Browser.Request,this.formData=new FormData,this.setOptions(n),this.headers=this.options.headers},append:function(n,t){return this.formData.append(n,t),this.formData},addPostData:function(n){var t=this;Object.each(n,function(n,i){t.formData.append(i,n)})},reset:function(){this.formData=new FormData},send:function(n){var i=n.url||this.options.url,t;return this.options.isSuccess=this.options.isSuccess||this.isSuccess,this.running=!0,t=this.xhr,t.open("POST",i,!0),t.onreadystatechange=this.onStateChange.bind(this),Object.each(this.headers,function(n,i){try{t.setRequestHeader(i,n)}catch(r){this.fireEvent("exception",[i,n])}},this),this.fireEvent("request"),t.send(this.formData),this.options.async||this.onStateChange(),this.options.timeout&&(this.timer=this.timeout.delay(this.options.timeout,this)),this}}),Affinity.Shake=new Class({Implements:Options,options:{distance:4,duration:50,transition:Fx.Transitions.Sine.easeInOut,loops:2},initialize:function(n,t){this.setOptions(t),this.element=n,this.tween=new Fx.Tween(this.element,{link:"chain",duration:this.options.duration,transition:this.options.transition,property:"margin-left"})},shake:function(){var n=this.options.distance;for(this.loops=0;this.loops<this.options.loops;this.loops++)this.tween.start("left",n).start("left",-n),this.tween.start("left",n).start("left",0);n=null},stop:function(){this.loops=this.options.loops,this.tween.cancel(),this.element.setStyle("margin-left",0)}}),Affinity.user=null,AuthRequest=new Class({initialize:function(n){this._req=new Request(n)},send:function(){this._authorize(function(){this._req.send()}.bind(this))},get:function(){this._authorize(function(){this._req.get()}.bind(this))},post:function(){this._authorize(function(){this._req.post()}.bind(this))},_authorize:function(n){var t=this;Affinity.user?Affinity.user.AccessToken?(t._setAuthHeader(),n()):new Request.JSON({url:"/Auth/RefreshAccessToken",onSuccess:function(i){if(i.error)return location.reload();Affinity.user.AccessToken=i.AccessToken,t._setAccessTimeout(i.ExpiryTimeout*1e3),t._setAuthHeader(),n()},onFailure:function(){console.log("Failed to refresh access token.")}}).post():new Request.JSON({url:"/Auth/GetInfo",onSuccess:function(i){if(Affinity.user=i,i.ExpiryTimeout<0)return Affinity.user.AccessToken="",t._authorize(n);t._setAccessTimeout(i.ExpiryTimeout*1e3),t._setAuthHeader(),n()}}).post()},_setAuthHeader:function(){this._req.options.headers.Authorization="Bearer "+Affinity.user.AccessToken},_setAccessTimeout:function(n){clearTimeout(this._accessTimeout),this._accessTimeout=setTimeout(function(){Affinity.user.AccessToken=""},n)}}),AuthRequest.JSON=new Class({Extends:AuthRequest,initialize:function(n){this._req=new Request.JSON(n)}}),Request.AuthJSON=AuthRequest.JSON,Affinity.languages={english:{helpIcon:Affinity.icons.HelpRound,helpTabTooltip:"Help"}},Affinity.Lang=new new Class({Load:function(n){new Request.JSON({url:n||"./lang.json?ran="+(new Date).getTime(),onComplete:this._process,onError:this._loadFailed,onFailure:this._loadFailed}).get()},CheckPath:function(n){for(var i=Affinity.languages.english,r=n.replace("l:","").replace("join:","").split("."),t=0;t<r.length;t++)i.hasOwnProperty(r[t])&&(i=i[r[t]]);return i?!0:!1},ReturnPath:function(n){for(var t=Affinity.languages.english,r=n.replace("l:","").replace("join:","").split("."),i=0;i<r.length;i++)t.hasOwnProperty(r[i])&&(t=t[r[i]]);return t?t:null},_returnIcon:function(n,t){for(var i=window,u=t.replace("i:","").split("."),r=0;r<u.length;r++)i.hasOwnProperty(u[r])&&(i=i[u[r]]);return i&&typeof i=="string"?n.replace("{{"+t+"}}",i):n},_returnLabel:function(n,t){for(var i=Affinity.languages.english,f=t.contains("join:"),u=t.replace("l:","").replace("join:","").split("."),r=0;r<u.length;r++)i.hasOwnProperty(u[r])&&(i=i[u[r]]);if(i||i===""){if(f&&Array.isArray(i))return n.replace("{{"+t+"}}",i.join(" "));if(!f&&(typeof i=="string"||typeof i=="number"))return n.replace("{{"+t+"}}",i)}return n},_retuenMethodRef:function(n,t){for(var i=window,u=t.replace("m:","").split("."),r=0;r<u.length;r++)i.hasOwnProperty(u[r])&&(i=i[u[r]]);return i&&typeof i=="function"?i:function(){}},_processString:function(n){var u,i,r,t,f;if(n.contains("{{")&&n.contains("}}")&&(u=/[^{{\}}]+(?=}})/g,i=n.match(u),i!==null))for(r=0;r<i.length;r++){t=i[r],f=t.substr(0,2);switch(f){case"i:":n=this._returnIcon(n,t);break;case"l:":n=this._returnLabel(n,t);break;case"m:":n=this._retuenMethodRef(n,t)}}return n},_check:function(n){if(typeof n=="object")for(key in n)typeof n[key]=="object"?this._check(n[key]):typeof n[key]=="string"&&(n[key]=this._processString(n[key]));return n},_process:function(n){n.hasOwnProperty("languages")&&n.languages.hasOwnProperty("english")&&typeof n.languages.english=="object"&&(Affinity.languages.english=Affinity.DeepMergeObjects([Affinity.languages.english,n.languages.english]),Affinity.languages.english=this._check(Affinity.languages.english)),window.fireEvent("langComplete")},_loadFailed:function(){window.fireEvent("langComplete")},initialize:function(){},Binds:["Load","CheckPath","ReturnPath","_returnIcon","_returnLabel","_retuenMethodRef","_processString","_check","_process","_loadFailed"]}),Affinity.FavResultSort=function(n,t,i){var e=function(n,t){return n.sort(function(n,i){var r=(n[t]+"").toUpperCase(),u=(i[t]+"").toUpperCase();return r<u?-1:r>u?1:0}),n},r,u,f;if(t=t||"Name",i=i||!1,i){if(n.length>0&&n[0].hasOwnProperty(t)&&n[0].hasOwnProperty(i))return r={},f=[],n.forEach(function(n){u=(n[i]+"").trim().replace(/\s/g,""),r.hasOwnProperty(u)||(r[u]=[]),r[u].push(n)}),Object.keys(r).sort().forEach(function(n){e(r[n],t).forEach(function(n){f.push(n)})}),f}else if(n.length>0&&n[0].hasOwnProperty(t))return e(n,t);return n},Affinity.FavNameValidation=function(n){var t={isValid:!0,error:!1},r;if(Affinity.Lang.CheckPath("features.favourites.validation")&&Affinity.Lang.CheckPath("application.timesheets.features.favourites")){var u=Affinity.languages.english.features.favourites.validation,i=Affinity.languages.english.application.timesheets.features.favourites,f=u.illegalchars,s=u.max,h=u.min,e=i.illegalMessage,c=i.badMessage,l=i.tooLongMessage,o=i.tooShortMessage;if(n.length===0||n===null||n===undefined)return t.isValid=!1,t.error=o,t;if(f&&e)for(r=f.length-1;r>-1;r--)if(n.indexOf(f[r])!==-1)return t.isValid=!1,t.error=e,t;if(new RegExp(/^\d+$/).test(n.trim())||!isNaN(parseInt(n.trim().charAt(0))))return t.isValid=!1,t.error=c,t;if(n.trim().length>s)return t.isValid=!1,t.error=l,t;if(n.trim().length<h)return t.isValid=!1,t.error=o,t}return t},Affinity.CheckFavError=function(n,t){var r=n.hasOwnProperty("error"),u=r?typeof n.error=="string":!1,f=u?n.error!=="":!1,i=f?n.error:typeof n=="string"?n:t;return(isNotUnique=i.toUpperCase().contains("UNIQUE KEY")?!0:!1,isNotUnique=i.toLowerCase().contains("already exists")?!0:isNotUnique,isNotUnique)?Affinity.languages.english.application.timesheets.features.favourites.alreadyExistsError:n.error.contains("Not found")?n.error.replace("Not found","Could not find:<br />"):t},Affinity.ShowMasterLoader=function(n){time=typeof n=="number"?n:!1,time?setTimeout(function(){document.querySelector("body").classList.add("newload-lock")},time):document.querySelector("body").classList.add("newload-lock")},Affinity.HideMasterLoader=function(n){time=typeof n=="number"?n:!1,time?setTimeout(function(){document.querySelector("body").classList.remove("newload-lock")},time):document.querySelector("body").classList.remove("newload-lock")},Affinity.FeatureChecks={ScrollBarWidth:function(){var t,n,r,i;return t=document.createElement("p"),t.style.width="100%",t.style.height="200px",n=document.createElement("div"),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.overflow="hidden",n.appendChild(t),document.body.appendChild(n),r=t.offsetWidth,n.style.overflow="scroll",i=t.offsetWidth,r==i&&(i=n.clientWidth),document.body.removeChild(n),Affinity.scrollBarSize=r-i,Affinity.scrollBarSize},DatalistTest:function(){var n=document.createElement("datalist");n&&"options"in n&&(Affinity.supportsDatalist=!0),n=null},PassiveEvents:function(){var n=!1;try{document.addEventListener("test",null,{get passive(){n=!0}})}catch(t){}Affinity.supportsPassiveEvents=n},TypeDetection:function(){var n=document.body.classList;Affinity.ismac=n.contains("mac")?!0:!1,Affinity.isie=n.contains("ie")?!0:!1,Affinity.isEdge=n.contains("ieedge"),Affinity.isie&&(Affinity.ieversion=Browser.version),Affinity.isie&&(Affinity.iedocmode=document.documentMode?document.documentMode:!1),Affinity.ismobile=n.contains("mobile")?!0:!1,Affinity.mobile&&(Affinity.ismobile=!0),Affinity.isTeampayoffice=window.location.href.toLowerCase().indexOf("teampayoffice")!==-1?!0:!1,Affinity.isTeampayofficeBranch=Affinity.isTeampayoffice?window.location.href.toLowerCase().indexOf("/tb")!==-1?!0:!1:!1,Affinity.isie&&Affinity.iedocmode===8&&document.getElementsByTagName("body")[0].classList.add("ie8"),Affinity.isie&&Affinity.iedocmode===9&&document.getElementsByTagName("body")[0].classList.add("ie9"),Affinity.isie&&Affinity.iedocmode===10&&document.getElementsByTagName("body")[0].classList.add("ie10"),Affinity.isie&&!Affinity.isEdge&&Affinity.iedocmode<11&&document.getElementsByTagName("body")[0].classList.add("not-supported")},DashboardWrapper:function(){for(var r=["Dashboard","dashboard","IsDashboard","isDashboard","isdashboard","HasDashboard","hasDashboard","hasdashboard"],t=!1,i=0,n;i<r.length;i++)n=r[i],Affinity.hasOwnProperty(n)&&(typeOf(Affinity[n])==="boolean"?Affinity[n]!==!1&&(t=!0):typeOf(Affinity[n])!=="null"&&typeOf(Affinity[n])==="string"&&Affinity[n].trim()!==""&&(t=Affinity[n].trim().toLowerCase()==="true"));return"hasDashboardWrapper"in Affinity||(Affinity.hasDashboard=t,Affinity.hasDashboardWrapper=function(){return Affinity.hasDashboard}),t},CheckWebWorkers:function(){Affinity.hasOwnProperty("CheckForWorkers")||(Affinity.CheckForWorkers=!0),Affinity.CheckForWorkers&&(Affinity.CheckForWorkers=Affinity.isie&&Affinity.ieversion<=11?!1:Affinity.CheckForWorkers),Affinity.CheckForWorkers&&(Affinity.supportsWebWorkers=typeof Worker!="undefined"?!0:!1),delete Affinity.CheckForWorkers},CheckElementClosest:function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(n){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(n))return t;t=t.parentElement||t.parentNode}while(t!==null&&t.nodeType===1);return null})},CheckForArrayForEach:function(){Array.prototype.forEach||(Array.prototype.forEach=function(n){var r,t,i,u,f;if(this==null)throw new TypeError("this is null or not defined");if(i=Object(this),u=i.length>>>0,typeof n!="function")throw new TypeError(n+" is not a function");for(arguments.length>1&&(r=arguments[1]),t=0;t<u;)t in i&&(f=i[t],n.call(r,f,t,i)),t++}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach)}},Affinity.TimesheetsReady=function(){return},Affinity.SessionLoginExists=function(){return Affinity.hasOwnProperty("login")&&Affinity.login!==null?!0:!1},Affinity.SessionLoginReady=function(){return Affinity.SessionLoginExists()&&Affinity.login.hasOwnProperty("ready")&&typeof Affinity.login.ready=="boolean"&&Affinity.login.ready===!0?!0:!1},Affinity.PageReady=function(){"onreadystatechange"in document?document.onreadystatechange=null:document.removeEventListener("DOMContentLoaded",Affinity.PageReady,!1),window.removeEventListener("PageReady",Affinity.PageReady,!1),Object.keys(Affinity.FeatureChecks).map(function(n){Affinity.FeatureChecks[n]()}),Affinity.apiversion>1?(Affinity.zelosroot=Affinity.zelosroot,Affinity.lookupapi=Affinity.zelosroot+"?api=Lookup/Get"):Affinity.lookupapi=Affinity.zelosroot+"?api=Lookup/Get",Affinity.EstablishAutosrollOnDragEvents(),Affinity.refreshControll={},Affinity.refreshControll.initialLoad=!0,Affinity.refreshControll.lastRefresh=(new Date).getTime(),window.addEvent("keydown",function(n){if(n.key==="f5"||n.key==="F5"||n.control&&(n.key==="r"||n.key==="R")){var t=(new Date).getTime(),i=Affinity.refreshControll.initialLoad?7e3:5e3;t-Affinity.refreshControll.lastRefresh<i&&(n.stop(),uialert({message:"Refreshing this often can slow things down.<br />If you believe the page is not responding,<br />please contact Affinity Help desk.",showButtons:!0})),Affinity.refreshControll.lastRefresh=(new Date).getTime(),Affinity.refreshControll.initialLoad=!1}}),function(){var n,t=function(){if(clearTimeout(n),document.body){if(Affinity.DarkMode=!1,Affinity.CookieMonster.Read("dark-mode")){var i=Affinity.CookieMonster.Read("dark-mode");typeof i=="string"&&(i=i.toLowerCase().trim()==="true"?!0:!1),Affinity.DarkMode=i}Affinity.DarkMode?document.body.classList.add("dark"):document.body.classList.remove("dark");return}n=setTimeout(t,10)};t(),window.addEventListener("keydown",function(n){n.ctrlKey&&n.altKey&&(n.key==="d"||n.key==="D")&&(Affinity.DarkMode=!Affinity.DarkMode,Affinity.CookieMonster.Write("dark-mode",Affinity.DarkMode),Affinity.DarkMode?document.body.classList.add("dark"):document.body.classList.remove("dark"))})}(),Affinity&&Affinity.isie&&Affinity.ieversion<9&&document.addEvent("keydown",function(n){(n.key===8||n.key==="backspace")&&(n.target.get("tag").test("select","gi")||n.target.disabled||n.target.readOnly)&&n.preventDefault()}),window.addEvent("userComplete",function(n){document.getElements(".displayname").set("html",n.commonName?n.commonName:n.displayName?n.displayName:"")});try{parent&&"parentFrameResize"in parent&&(window.addEvent("ResizeFrame",function(){var i,n,t;document.getElement(".content")&&(i=document.getElement(".content"),n=i.getScrollSize(),parent&&"parentFrameResize"in parent&&window.parent.window!==window&&(t=window.parent.window.innerWidth?window.parent.window.innerWidth-70:window.parent.window.document.body.offsetWidth-70,n.x=t&&t>0?t:1e3,parent.parentFrameResize({x:n.x,y:n.y+100})))}),window.fireEvent("ResizeFrame"),function(){window.fireEvent("ResizeFrame")}.delay(500))}catch(n){}Affinity.oldess&&Affinity.oldessFrame&&Affinity.agent.contains("Chrome")&&Affinity.agent.contains("Windows NT 6.2")&&window.addEvent("click",function(){document.getElement("body").className.contains("redraw")?(document.getElement("body").setStyle("width","100%"),document.getElement("body").classList.remove("redraw")):(document.getElement("body").setStyle("width","99.9%"),document.getElement("body").classList.add("redraw"))}),Affinity.essmessage="",function(){Affinity.oldess=!1;var t=new URI(window.location.href),n=typeOf(t.parsed.query)==="null"?{}:t.parsed.query.parseQueryString();("sessionKey"in n||"isEss"in n)&&(Affinity.oldess=!0,"iframe"in n&&(Affinity.oldessLaunched=!1,Affinity.oldessFrame=!0,Affinity.oldessWindow=window.parent),"external"in n&&(Affinity.oldessLaunched=!0,Affinity.oldessFrame=!1,Affinity.oldessWindow=window.opener),!Affinity.oldess||"external"in n||"iframe"in n||window.addEvent("UiReady",function(){Affinity.appname==="cleverforms"?(Affinity.oldessLaunched=!1,Affinity.oldessFrame=!0,Affinity.oldessWindow=window.parent):(Affinity.oldessLaunched=!0,Affinity.oldessFrame=!1,Affinity.oldessWindow=window.opener)}))}(),Affinity.IeWarning=function(){if(typeof window.masterMessage!="undefined"&&Affinity.isie&&Affinity.ieversion<Affinity.minIEVersion){var t=Affinity.minIEVersion<12?"IE"+Affinity.minIEVersion:"Edge",n="";n+='<strong class="color red large">Warning!<\/strong><br /><br />',n+="We do not support Internet Explorer "+(Affinity.minIEVersion-1)+" and less.<br />",n+="Some functionality may not work.<br /><br />",n+='We recommend <a href="https://www.google.com/chrome/browser/desktop/" target="_blank" class="color green">Chrome<\/a> or updating to at least '+t+".<br /><br />",n+="Continue at your own risk.",masterMessage({message:n,okText:"Accept and Continue"})}window.removeEvent("UiReady",Affinity.IeWarning),Affinity.IeWarning=null,delete Affinity.IeWarning},window.addEvent("UiReady",Affinity.IeWarning),Affinity.debug&&console.info("<< affinity ready >>"),setTimeout(function(){Affinity.Tests=null,delete Affinity.Tests,Affinity.debug&&console.info("\taffinity detections cleaned up"),Affinity.PageReady=null,delete Affinity.PageReady,Affinity.debug&&console.info("\taffinity cleaned up")},1e3),Affinity.hasLangFile?(window.addEvent("langComplete",function(){Affinity.debug&&console.info("\tlang loaded and processed"),Affinity.commonsReady=!0,window.fireEvent("AffinityReady")}),Affinity.Lang.Load(Affinity.langFilePath+"?last="+Affinity.langFileAge)):(Affinity.commonsReady=!0,window.fireEvent("AffinityReady"))},Affinity.MobileDetect,constructor(),Affinity.Browser={userAgent:navigator.userAgent,platform:"Unknown",renderer:"Unknown",name:"Unknown",version:"?",major:-1,minor:-1,device:!1,isie:!1,isedge:!1,isfirefox:!1,issafari:!1,ischrome:!1,ismobile:!1,isandroid:!1,ismac:!1,isipad:!1,istablet:!1,widemode:!1},checkBody(),document.querySelector("body")?Affinity.MobileDetect.getBrowser():setTimeout(Affinity.MobileDetect.checkBody,10),getBrowser();{let t=function(){let t=new UAParser,n=t.getResult();Affinity.Browser.platform=n.os.name+(n.os.version!==undefined?" "+n.os.version:""),Affinity.Browser.renderer=n.engine.name,Affinity.Browser.name=n.browser.name,Affinity.Browser.version=n.browser.version,Affinity.Browser.major=parseInt(n.browser.major),Affinity.Browser.minor=n.browser.version.replace(n.browser.major,""),Affinity.Browser.minor=Affinity.Browser.minor.indexOf(".")===0?Affinity.Browser.minor.substr(1):Affinity.Browser.minor,Affinity.Browser.minor=Affinity.Browser.minor.indexOf("0.")===0?Affinity.Browser.minor.substr(2):Affinity.Browser.minor,Affinity.Browser.minor=parseFloat(Affinity.Browser.minor),Affinity.Browser.name.toLowerCase().contains("ie")&&(Affinity.Browser.isie=!0),Affinity.Browser.name.toLowerCase().contains("edge")&&(Affinity.Browser.isedge=!0),Affinity.Browser.name.toLowerCase().contains("chrome")&&(Affinity.Browser.ischrome=!0),Affinity.Browser.name.toLowerCase().contains("safari")&&(Affinity.Browser.issafari=!0),Affinity.Browser.name.toLowerCase().contains("firefox")&&(Affinity.Browser.isfirefox=!0),Affinity.Browser.platform.toLowerCase().contains("android")&&(Affinity.Browser.isandroid=!0),Affinity.Browser.platform.toLowerCase().contains("mac")&&(Affinity.Browser.ismac=!0),Affinity.Browser.platform.toLowerCase().contains("ios")&&(Affinity.Browser.ismac=!0),n.device.model!==undefined&&n.device.model.toLowerCase().contains("ipad")&&(Affinity.Browser.isipad=!0),Affinity.Browser.isipad&&!Affinity.Browser.ismac&&(Affinity.Browser.ismac=!0),Affinity.MobileDetect.getWurfl()},i=function(n){console.warn("UAParser failed to load"),console.warn(n),Affinity.MobileDetect.getWurfl()},n=document.createElement("script");n.type="text/javascript",n.nonce="a9e3b03a6fd6ba6582578c3ad5393ee54b2b6acb==",n.readyState?n.onreadystatechange=function(){n.readyState==="loaded"||n.readyState==="complete"?(n.onreadystatechange=null,t()):console.log(n.readyState)}:(n.onload=t,n.onerror=i),n.setAttribute("src","https://cdnjs.cloudflare.com/ajax/libs/UAParser.js/0.7.20/ua-parser.min.js"),document.head.appendChild(n)}getWurfl();{let n=document.createElement("script"),t=document.querySelector("body");n.type="text/javascript",n.src=document.location.protocol+"//wurfl.io/wurfl.js",n.nonce="a9e3b03a6fd6ba6582578c3ad5393ee54b2b6acb==",scriptProcessed=function(){var t,n;Affinity.Browser.widemode=window.innerWidth>=1024,Affinity.Browser.ismobile||("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&(Affinity.Browser.ismobile=!0),t=!1,navigator.platform==="MacIntel"&&(Affinity.Browser.ismac=!0),!Affinity.Browser.ismobile&&(Affinity.Browser.platform.toLowerCase().contains("ios")||Affinity.Browser.platform.toLowerCase().contains("android"))&&(Affinity.Browser.ismobile=!0),Affinity.Browser.ismobile&&Affinity.Browser.widemode&&(Affinity.Browser.istablet=!0),Affinity.Browser.istablet&&Affinity.Browser.ismac&&(Affinity.Browser.isipad=!0),Affinity.Browser.istablet&&Affinity.Browser.widemode&&!Affinity.Browser.isipad&&(Affinity.Browser.ismobile=!1),n=document.body,n.classList.remove("mobile","tablet","desktop","edge","ie","firefox","mac","wide-mode"),(!Affinity.Browser.ismobile||Affinity.Browser.istablet&&Affinity.Browser.widemode&&!Affinity.Browser.isipad)&&n.classList.add("desktop"),n.classList.contains("desktop")||(Affinity.Browser.ismobile&&n.classList.add("mobile"),Affinity.Browser.istablet&&n.classList.add("tablet"),Affinity.Browser.istablet&&Affinity.Browser.widemode&&n.classList.add("wide-mode")),Affinity.Browser.ismac&&n.classList.add("mac"),Affinity.Browser.isipad&&n.classList.add("ipad"),Affinity.Browser.isie&&!isNaN(parseInt(Affinity.Browser.major))&&n.classList.add("ie"+parseInt(Affinity.Browser.major)),Affinity.Browser.isedge&&n.classList.add("edge"),Affinity.Browser.isfirefox&&n.classList.add("firefox"),Affinity.mobile=Affinity.ismobile=Affinity.IsMobile=Affinity.isMobile=Affinity.Browser.ismobile,Affinity.mobile&&Affinity.hasOwnProperty("EnableMobile")&&Affinity.EnableMobile(),window.dispatchEvent(new Event("MobileChecked")),Affinity.PageReady()},n.onload=function(){Affinity.MobileChecked=!0,Affinity.Browser.ismobile=WURFL.is_mobile,Affinity.Browser.device=WURFL.form_factor.toLowerCase(),scriptProcessed()},n.onerror=function(){console.error("WURFL failed to load"),Affinity.MobileChecked=!0,Affinity.Browser.ismobile=!1,Affinity.Browser.device="unknown",scriptProcessed()},t.appendChild(n)}"onreadystatechange"in document,document.onreadystatechange=function(){document.readyState=="interactive"&&Affinity.MobileDetect.checkBody()},document.addEventListener("DOMContentLoaded",Affinity.PageReady,!1)