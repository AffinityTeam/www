"Affinity"in window||(window.Affinity={}),Affinity.MobileEnabled=!1,Affinity.EnableMobile=function(){if(!Affinity.MobileEnabled){Affinity.MobileEnabled=!0,MooTools&&"version"in MooTools&&parseFloat(MooTools.version)>=1.5&&parseFloat(MooTools.version)<1.6&&Class.refactor(Drag,{attach:function(){return this.handles.addEvent("touchstart",this.bound.start),this.previous.apply(this,arguments)},detach:function(){return this.handles.removeEvent("touchstart",this.bound.start),this.previous.apply(this,arguments)},start:function(n){n.type&&n.type=="touchstart"&&(n.preventDefault(),n.stop());var t={touchmove:this.bound.check,touchend:this.bound.cancel};this.document.addEvents(t),this.previous.apply(this,arguments)},check:function(n){n.type&&n.type=="touchmove"&&(n.preventDefault(),n.stop()),this.options.preventDefault&&n.preventDefault();var t=Math.round(Math.sqrt(Math.pow(n.page.x-this.mouse.start.x,2)+Math.pow(n.page.y-this.mouse.start.y,2)));t>this.options.snap&&(this.cancel(),this.document.addEvents({touchmove:this.bound.drag,touchend:this.bound.stop}),this.fireEvent("start",[this.element,n]).fireEvent("snap",this.element))},cancel:function(){this.document.removeEvents({touchmove:this.bound.check,touchend:this.bound.cancel})},stop:function(n){var t={touchmove:this.bound.drag,touchend:this.bound.stop};t[this.selection]=this.bound.eventStop,this.document.removeEvents(t),this.mouse.start=null,n&&this.fireEvent("complete",[this.element,n])}}),MooTools&&"version"in MooTools&&parseFloat(MooTools.version)>=1.5&&parseFloat(MooTools.version)<1.6&&Class.refactor(Sortables,{addItems:function(){return Array.flatten(arguments).each(function(n){this.elements.push(n);var t=n.retrieve("sortables:start",function(t){this.start.call(this,t,n)}.bind(this));(this.options.handle?n.getElement(this.options.handle)||n:n).addEvent("touchstart",t)},this),this},removeItems:function(){return $$(Array.flatten(arguments).map(function(n){this.elements.erase(n);var t=n.retrieve("sortables:start");return(this.options.handle?n.getElement(this.options.handle)||n:n).removeEvent("touchstart",t),n},this))},getClone:function(n,t){if(!this.options.clone)return new Element(t.tagName).inject(document.body);if(typeOf(this.options.clone)=="function")return this.options.clone.call(this,n,t,this.list);var i=t.clone(!0).setStyles({margin:0,position:"absolute",visibility:"hidden",width:t.getStyle("width")}).addEvent("touchstart",function(n){t.fireEvent("touchstart",n)});return i.get("html").test("radio")&&i.getElements("input[type=radio]").each(function(n,i){n.set("name","clone_"+i),n.get("checked")&&t.getElements("input[type=radio]")[i].set("checked",!0)}),i.inject(this.list).setPosition(this.getDroppableCoordinates(this.element))}});
/*! Hammer.JS - v2.0.8 - 2016-04-23
   * http://hammerjs.github.io/
   *
   * Copyright (c) 2016 Jorik Tangelder;
   * Licensed under the MIT license */
!function(n,t,i,r){"use strict";function hi(n,t,i){return setTimeout(ci(n,i),t)}function rt(n,t,i){return Array.isArray(n)?(v(n,i[t],i),!0):!1}function v(n,t,i){var u;if(n)if(n.forEach)n.forEach(t,i);else if(n.length!==r)for(u=0;u<n.length;)t.call(i,n[u],u,n),u++;else for(u in n)n.hasOwnProperty(u)&&t.call(i,n[u],u,n)}function fr(t,i,r){var u="DEPRECATED METHOD: "+i+"\n"+r+" AT \n";return function(){var i=new Error("get-stack-trace"),f=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=n.console&&(n.console.warn||n.console.log);return r&&r.call(n.console,u,f),t.apply(this,arguments)}}function o(n,t,i){var r,u=t.prototype;r=n.prototype=Object.create(u),r.constructor=n,r._super=u,i&&w(r,i)}function ci(n,t){return function(){return n.apply(t,arguments)}}function li(n,t){return typeof n==cf?n.apply(t?t[0]||r:r,t):n}function er(n,t){return n===r?t:n}function pt(n,t,i){v(bt(t),function(t){n.addEventListener(t,i,!1)})}function wt(n,t,i){v(bt(t),function(t){n.removeEventListener(t,i,!1)})}function or(n,t){for(;n;){if(n==t)return!0;n=n.parentNode}return!1}function d(n,t){return n.indexOf(t)>-1}function bt(n){return n.trim().split(/\s+/g)}function ut(n,t,i){if(n.indexOf&&!i)return n.indexOf(t);for(var r=0;r<n.length;){if(i&&n[r][i]==t||!i&&n[r]===t)return r;r++}return-1}function kt(n){return Array.prototype.slice.call(n,0)}function sr(n,t,i){for(var f,u=[],e=[],r=0;r<n.length;)f=t?n[r][t]:n[r],ut(e,f)<0&&u.push(n[r]),e[r]=f,r++;return i&&(u=t?u.sort(function(n,i){return n[t]>i[t]}):u.sort()),u}function dt(n,t){for(var i,u,e=t[0].toUpperCase()+t.slice(1),f=0;f<dr.length;){if(i=dr[f],u=i?i+e:t,u in n)return u;f++}return r}function yu(){return af++}function hr(t){var i=t.ownerDocument||t;return i.defaultView||i.parentWindow||n}function s(n,t){var i=this;this.manager=n,this.callback=t,this.element=n.element,this.target=n.options.inputTarget,this.domHandler=function(t){li(n.options.enable,[n])&&i.handler(t)},this.init()}function pu(n){var i,t=n.options.inputClass;return new(i=t?t:vf?vi:yf?ti:nu?yi:ni)(n,wu)}function wu(n,t,i){var r=i.pointers.length,o=i.changedPointers.length,s=t&f&&r-o==0,h=t&(u|e)&&r-o==0;i.isFirst=!!s,i.isFinal=!!h,s&&(n.session={}),i.eventType=t,bu(n,i),n.emit("hammer.input",i),n.recognize(i),n.session.prevInput=i}function bu(n,t){var i=n.session,f=t.pointers,o=f.length,r,e;i.firstInput||(i.firstInput=cr(t)),o>1&&!i.firstMultiple?i.firstMultiple=cr(t):1===o&&(i.firstMultiple=!1);var s=i.firstInput,u=i.firstMultiple,h=u?u.center:s.center,c=t.center=lr(f);t.timeStamp=nr(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=ai(h,c),t.distance=gt(h,c),ku(i,t),t.offsetDirection=vr(t.deltaX,t.deltaY),r=ar(t.deltaTime,t.deltaX,t.deltaY),t.overallVelocityX=r.x,t.overallVelocityY=r.y,t.overallVelocity=g(r.x)>g(r.y)?r.x:r.y,t.scale=u?nf(u.pointers,f):1,t.rotation=u?gu(u.pointers,f):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,du(i,t),e=n.element,or(t.srcEvent.target,e)&&(e=t.srcEvent.target),t.target=e}function ku(n,t){var i=t.center,r=n.offsetDelta||{},e=n.prevDelta||{},o=n.prevInput||{};t.eventType!==f&&o.eventType!==u||(e=n.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=n.offsetDelta={x:i.x,y:i.y}),t.deltaX=e.x+(i.x-r.x),t.deltaY=e.y+(i.y-r.y)}function du(n,t){var f,o,s,h,i=n.lastInterval||t,c=t.timeStamp-i.timeStamp;if(t.eventType!=e&&(c>pf||i.velocity===r)){var l=t.deltaX-i.deltaX,a=t.deltaY-i.deltaY,u=ar(c,l,a);o=u.x,s=u.y,f=g(u.x)>g(u.y)?u.x:u.y,h=vr(l,a),n.lastInterval=t}else f=i.velocity,o=i.velocityX,s=i.velocityY,h=i.direction;t.velocity=f,t.velocityX=o,t.velocityY=s,t.direction=h}function cr(n){for(var i=[],t=0;t<n.pointers.length;)i[t]={clientX:ft(n.pointers[t].clientX),clientY:ft(n.pointers[t].clientY)},t++;return{timeStamp:nr(),pointers:i,center:lr(i),deltaX:n.deltaX,deltaY:n.deltaY}}function lr(n){var t=n.length;if(1===t)return{x:ft(n[0].clientX),y:ft(n[0].clientY)};for(var r=0,u=0,i=0;t>i;)r+=n[i].clientX,u+=n[i].clientY,i++;return{x:ft(r/t),y:ft(u/t)}}function ar(n,t,i){return{x:t/n||0,y:i/n||0}}function vr(n,t){return n===t?fi:g(n)>=g(t)?0>n?st:ht:0>t?ct:lt}function gt(n,t,i){i||(i=iu);var r=t[i[0]]-n[i[0]],u=t[i[1]]-n[i[1]];return Math.sqrt(r*r+u*u)}function ai(n,t,i){i||(i=iu);var r=t[i[0]]-n[i[0]],u=t[i[1]]-n[i[1]];return 180*Math.atan2(u,r)/Math.PI}function gu(n,t){return ai(t[1],t[0],ei)+ai(n[1],n[0],ei)}function nf(n,t){return gt(t[0],t[1],ei)/gt(n[0],n[1],ei)}function ni(){this.evEl=bf,this.evWin=kf,this.pressed=!1,s.apply(this,arguments)}function vi(){this.evEl=ru,this.evWin=uu,s.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function yr(){this.evTarget=te,this.evWin=ie,this.started=!1,s.apply(this,arguments)}function tf(n,t){var i=kt(n.touches),r=kt(n.changedTouches);return t&(u|e)&&(i=sr(i.concat(r),"identifier",!0)),[i,r]}function ti(){this.evTarget=eu,this.targetIds={},s.apply(this,arguments)}function rf(n,t){var r=kt(n.touches),o=this.targetIds;if(t&(f|nt)&&1===r.length)return o[r[0].identifier]=!0,[r,r];var i,s,h=kt(n.changedTouches),c=[],l=this.target;if(s=r.filter(function(n){return or(n.target,l)}),t===f)for(i=0;i<s.length;)o[s[i].identifier]=!0,i++;for(i=0;i<h.length;)o[h[i].identifier]&&c.push(h[i]),t&(u|e)&&delete o[h[i].identifier],i++;if(c.length)return[sr(s.concat(c),"identifier",!0),c]}function yi(){s.apply(this,arguments);var n=ci(this.handler,this);this.touch=new ti(this.manager,n),this.mouse=new ni(this.manager,n),this.primaryTouch=null,this.lastTouches=[]}function uf(n,t){n&f?(this.primaryTouch=t.changedPointers[0].identifier,pr.call(this,t)):n&(u|e)&&pr.call(this,t)}function pr(n){var t=n.changedPointers[0],i,r,u;t.identifier===this.primaryTouch&&(i={x:t.clientX,y:t.clientY},this.lastTouches.push(i),r=this.lastTouches,u=function(){var n=r.indexOf(i);n>-1&&r.splice(n,1)},setTimeout(u,ou))}function ff(n){for(var r=n.srcEvent.clientX,u=n.srcEvent.clientY,t=0;t<this.lastTouches.length;t++){var i=this.lastTouches[t],f=Math.abs(r-i.x),e=Math.abs(u-i.y);if(ir>=f&&ir>=e)return!0}return!1}function pi(n,t){this.manager=n,this.set(t)}function ef(n){if(d(n,it))return it;var t=d(n,at),i=d(n,vt);return t&&i?it:t||i?t?at:vt:d(n,rr)?rr:lu}function of(){if(!hu)return!1;var t={},i=n.CSS&&n.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){t[r]=i?n.CSS.supports("touch-action",r):!0}),t}function y(n){this.options=w({},this.defaults,n||{}),this.id=yu(),this.manager=null,this.options.enable=er(this.options.enable,!0),this.state=si,this.simultaneous={},this.requireFail=[]}function wr(n){return n&yt?"cancel":n&k?"end":n&et?"move":n&h?"start":""}function br(n){return n==lt?"down":n==ct?"up":n==st?"left":n==ht?"right":""}function ii(n,t){var i=t.manager;return i?i.get(n):n}function c(){y.apply(this,arguments)}function ri(){c.apply(this,arguments),this.pX=null,this.pY=null}function wi(){c.apply(this,arguments)}function bi(){y.apply(this,arguments),this._timer=null,this._input=null}function ki(){c.apply(this,arguments)}function di(){c.apply(this,arguments)}function ui(){y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function p(n,t){return t=t||{},t.recognizers=er(t.recognizers,p.defaults.preset),new gi(n,t)}function gi(n,t){this.options=w({},p.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||n,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=n,this.input=pu(this),this.touchAction=new pi(this,this.options.touchAction),kr(this,!0),v(this.options.recognizers,function(n){var t=this.add(new n[0](n[1]));n[2]&&t.recognizeWith(n[2]),n[3]&&t.requireFailure(n[3])},this)}function kr(n,t){var r=n.element,i;r.style&&(v(n.options.cssProps,function(u,f){i=dt(r.style,f),t?(n.oldCssProps[i]=r.style[i],r.style[i]=u):r.style[i]=n.oldCssProps[i]||""}),t||(n.oldCssProps={}))}function sf(n,i){var r=t.createEvent("Event");r.initEvent(n,!0,!0),r.gesture=i,i.target.dispatchEvent(r)}var w,dr=["","webkit","Moz","MS","ms","o"],hf=t.createElement("div"),cf="function",ft=Math.round,g=Math.abs,nr=Date.now,fu,eu,ou,ir,au,ur,vu;w="function"!=typeof Object.assign?function(n){var f,i,t,u;if(n===r||null===n)throw new TypeError("Cannot convert undefined or null to object");for(f=Object(n),i=1;i<arguments.length;i++)if(t=arguments[i],t!==r&&null!==t)for(u in t)t.hasOwnProperty(u)&&(f[u]=t[u]);return f}:Object.assign;var gr=fr(function(n,t,i){for(var f=Object.keys(t),u=0;u<f.length;)(!i||i&&n[f[u]]===r)&&(n[f[u]]=t[f[u]]),u++;return n},"extend","Use `assign`."),lf=fr(function(n,t){return gr(n,t,!0)},"merge","Use `assign`."),af=1,nu="ontouchstart"in n,vf=dt(n,"PointerEvent")!==r,yf=nu&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),ot="touch",tr="mouse",pf=25,f=1,nt=2,u=4,e=8,fi=1,st=2,ht=4,ct=8,lt=16,l=st|ht,tt=ct|lt,tu=l|tt,iu=["x","y"],ei=["clientX","clientY"];s.prototype={handler:function(){},init:function(){this.evEl&&pt(this.element,this.evEl,this.domHandler),this.evTarget&&pt(this.target,this.evTarget,this.domHandler),this.evWin&&pt(hr(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&wt(this.element,this.evEl,this.domHandler),this.evTarget&&wt(this.target,this.evTarget,this.domHandler),this.evWin&&wt(hr(this.element),this.evWin,this.domHandler)}};var wf={mousedown:f,mousemove:nt,mouseup:u},bf="mousedown",kf="mousemove mouseup";o(ni,s,{handler:function(n){var t=wf[n.type];t&f&&0===n.button&&(this.pressed=!0),t&nt&&1!==n.which&&(t=u),this.pressed&&(t&u&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[n],changedPointers:[n],pointerType:tr,srcEvent:n}))}});var df={pointerdown:f,pointermove:nt,pointerup:u,pointercancel:e,pointerout:e},gf={2:ot,3:"pen",4:tr,5:"kinect"},ru="pointerdown",uu="pointermove pointerup pointercancel";n.MSPointerEvent&&!n.PointerEvent&&(ru="MSPointerDown",uu="MSPointerMove MSPointerUp MSPointerCancel"),o(vi,s,{handler:function(n){var t=this.store,o=!1,h=n.type.toLowerCase().replace("ms",""),r=df[h],s=gf[n.pointerType]||n.pointerType,c=s==ot,i=ut(t,n.pointerId,"pointerId");r&f&&(0===n.button||c)?0>i&&(t.push(n),i=t.length-1):r&(u|e)&&(o=!0),0>i||(t[i]=n,this.callback(this.manager,r,{pointers:t,changedPointers:[n],pointerType:s,srcEvent:n}),o&&t.splice(i,1))}});var ne={touchstart:f,touchmove:nt,touchend:u,touchcancel:e},te="touchstart",ie="touchstart touchmove touchend touchcancel";o(yr,s,{handler:function(n){var i=ne[n.type],t;(i===f&&(this.started=!0),this.started)&&(t=tf.call(this,n,i),i&(u|e)&&t[0].length-t[1].length==0&&(this.started=!1),this.callback(this.manager,i,{pointers:t[0],changedPointers:t[1],pointerType:ot,srcEvent:n}))}}),fu={touchstart:f,touchmove:nt,touchend:u,touchcancel:e},eu="touchstart touchmove touchend touchcancel",o(ti,s,{handler:function(n){var i=fu[n.type],t=rf.call(this,n,i);t&&this.callback(this.manager,i,{pointers:t[0],changedPointers:t[1],pointerType:ot,srcEvent:n})}}),ou=2500,ir=25,o(yi,s,{handler:function(n,t,i){var u=i.pointerType==ot,r=i.pointerType==tr;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(u)uf.call(this,t,i);else if(r&&ff.call(this,i))return;this.callback(n,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var su=dt(hf.style,"touchAction"),hu=su!==r,cu="compute",lu="auto",rr="manipulation",it="none",at="pan-x",vt="pan-y",oi=of();pi.prototype={set:function(n){n==cu&&(n=this.compute()),hu&&this.manager.element.style&&oi[n]&&(this.manager.element.style[su]=n),this.actions=n.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var n=[];return v(this.manager.recognizers,function(t){li(t.options.enable,[t])&&(n=n.concat(t.getTouchAction()))}),ef(n.join(" "))},preventDefaults:function(n){var i=n.srcEvent,r=n.offsetDirection;if(this.manager.session.prevented)return void i.preventDefault();var t=this.actions,u=d(t,it)&&!oi[it],f=d(t,vt)&&!oi[vt],e=d(t,at)&&!oi[at];if(u){var o=1===n.pointers.length,s=n.distance<2,h=n.deltaTime<250;if(o&&s&&h)return}if(!e||!f)return u||f&&r&l||e&&r&tt?this.preventSrc(i):void 0},preventSrc:function(n){this.manager.session.prevented=!0,n.preventDefault()}};var si=1,h=2,et=4,k=8,b=k,yt=16,a=32;y.prototype={defaults:{},set:function(n){return w(this.options,n),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(n){if(rt(n,"recognizeWith",this))return this;var t=this.simultaneous;return n=ii(n,this),t[n.id]||(t[n.id]=n,n.recognizeWith(this)),this},dropRecognizeWith:function(n){return rt(n,"dropRecognizeWith",this)?this:(n=ii(n,this),delete this.simultaneous[n.id],this)},requireFailure:function(n){if(rt(n,"requireFailure",this))return this;var t=this.requireFail;return n=ii(n,this),-1===ut(t,n)&&(t.push(n),n.requireFailure(this)),this},dropRequireFailure:function(n){if(rt(n,"dropRequireFailure",this))return this;n=ii(n,this);var t=ut(this.requireFail,n);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(n){return!!this.simultaneous[n.id]},emit:function(n){function t(t){i.manager.emit(t,n)}var i=this,r=this.state;k>r&&t(i.options.event+wr(r)),t(i.options.event),n.additionalEvent&&t(n.additionalEvent),r>=k&&t(i.options.event+wr(r))},tryEmit:function(n){return this.canEmit()?this.emit(n):void(this.state=a)},canEmit:function(){for(var n=0;n<this.requireFail.length;){if(!(this.requireFail[n].state&(a|si)))return!1;n++}return!0},recognize:function(n){var t=w({},n);return li(this.options.enable,[this,t])?(this.state&(b|yt|a)&&(this.state=si),this.state=this.process(t),void(this.state&(h|et|k|yt)&&this.tryEmit(t))):(this.reset(),void(this.state=a))},process:function(){},getTouchAction:function(){},reset:function(){}},o(c,y,{defaults:{pointers:1},attrTest:function(n){var t=this.options.pointers;return 0===t||n.pointers.length===t},process:function(n){var t=this.state,i=n.eventType,r=t&(h|et),f=this.attrTest(n);return r&&(i&e||!f)?t|yt:r||f?i&u?t|k:t&h?t|et:h:a}}),o(ri,c,{defaults:{event:"pan",threshold:10,pointers:1,direction:tu},getTouchAction:function(){var t=this.options.direction,n=[];return t&l&&n.push(vt),t&tt&&n.push(at),n},directionTest:function(n){var i=this.options,r=!0,u=n.distance,t=n.direction,f=n.deltaX,e=n.deltaY;return t&i.direction||(i.direction&l?(t=0===f?fi:0>f?st:ht,r=f!=this.pX,u=Math.abs(n.deltaX)):(t=0===e?fi:0>e?ct:lt,r=e!=this.pY,u=Math.abs(n.deltaY))),n.direction=t,r&&u>i.threshold&&t&i.direction},attrTest:function(n){return c.prototype.attrTest.call(this,n)&&(this.state&h||!(this.state&h)&&this.directionTest(n))},emit:function(n){this.pX=n.deltaX,this.pY=n.deltaY;var t=br(n.direction);t&&(n.additionalEvent=this.options.event+t),this._super.emit.call(this,n)}}),o(wi,c,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[it]},attrTest:function(n){return this._super.attrTest.call(this,n)&&(Math.abs(n.scale-1)>this.options.threshold||this.state&h)},emit:function(n){if(1!==n.scale){var t=n.scale<1?"in":"out";n.additionalEvent=this.options.event+t}this._super.emit.call(this,n)}}),o(bi,y,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[lu]},process:function(n){var t=this.options,i=n.pointers.length===t.pointers,r=n.distance<t.threshold,o=n.deltaTime>t.time;if(this._input=n,!r||!i||n.eventType&(u|e)&&!o)this.reset();else if(n.eventType&f)this.reset(),this._timer=hi(function(){this.state=b,this.tryEmit()},t.time,this);else if(n.eventType&u)return b;return a},reset:function(){clearTimeout(this._timer)},emit:function(n){this.state===b&&(n&&n.eventType&u?this.manager.emit(this.options.event+"up",n):(this._input.timeStamp=nr(),this.manager.emit(this.options.event,this._input)))}}),o(ki,c,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[it]},attrTest:function(n){return this._super.attrTest.call(this,n)&&(Math.abs(n.rotation)>this.options.threshold||this.state&h)}}),o(di,c,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:l|tt,pointers:1},getTouchAction:function(){return ri.prototype.getTouchAction.call(this)},attrTest:function(n){var t,i=this.options.direction;return i&(l|tt)?t=n.overallVelocity:i&l?t=n.overallVelocityX:i&tt&&(t=n.overallVelocityY),this._super.attrTest.call(this,n)&&i&n.offsetDirection&&n.distance>this.options.threshold&&n.maxPointers==this.options.pointers&&g(t)>this.options.velocity&&n.eventType&u},emit:function(n){var t=br(n.offsetDirection);t&&this.manager.emit(this.options.event+t,n),this.manager.emit(this.options.event,n)}}),o(ui,y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[rr]},process:function(n){var t=this.options,o=n.pointers.length===t.pointers,s=n.distance<t.threshold,c=n.deltaTime<t.time,i,r,e;if(this.reset(),n.eventType&f&&0===this.count)return this.failTimeout();if(s&&c&&o){if(n.eventType!=u)return this.failTimeout();if(i=this.pTime?n.timeStamp-this.pTime<t.interval:!0,r=!this.pCenter||gt(this.pCenter,n.center)<t.posThreshold,this.pTime=n.timeStamp,this.pCenter=n.center,r&&i?this.count+=1:this.count=1,this._input=n,e=this.count%t.taps,0===e)return this.hasRequireFailures()?(this._timer=hi(function(){this.state=b,this.tryEmit()},t.interval,this),h):b}return a},failTimeout:function(){return this._timer=hi(function(){this.state=a},this.options.interval,this),a},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==b&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),p.VERSION="2.0.8",p.defaults={domEvents:!1,touchAction:cu,enable:!0,inputTarget:null,inputClass:null,preset:[[ki,{enable:!1}],[wi,{enable:!1},["rotate"]],[di,{direction:l}],[ri,{direction:l},["swipe"]],[ui],[ui,{event:"doubletap",taps:2},["tap"]],[bi]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},au=1,ur=2,gi.prototype={set:function(n){return w(this.options,n),n.touchAction&&this.touchAction.update(),n.inputTarget&&(this.input.destroy(),this.input.target=n.inputTarget,this.input.init()),this},stop:function(n){this.session.stopped=n?ur:au},recognize:function(n){var r=this.session,i,f,t,u;if(!r.stopped)for(this.touchAction.preventDefaults(n),f=this.recognizers,t=r.curRecognizer,(!t||t&&t.state&b)&&(t=r.curRecognizer=null),u=0;u<f.length;)i=f[u],r.stopped===ur||t&&i!=t&&!i.canRecognizeWith(t)?i.reset():i.recognize(n),!t&&i.state&(h|et|k)&&(t=r.curRecognizer=i),u++},get:function(n){if(n instanceof y)return n;for(var i=this.recognizers,t=0;t<i.length;t++)if(i[t].options.event==n)return i[t];return null},add:function(n){if(rt(n,"add",this))return this;var t=this.get(n.options.event);return t&&this.remove(t),this.recognizers.push(n),n.manager=this,this.touchAction.update(),n},remove:function(n){if(rt(n,"remove",this))return this;if(n=this.get(n)){var t=this.recognizers,i=ut(t,n);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(n,t){if(n!==r&&t!==r){var i=this.handlers;return v(bt(n),function(n){i[n]=i[n]||[],i[n].push(t)}),this}},off:function(n,t){if(n!==r){var i=this.handlers;return v(bt(n),function(n){t?i[n]&&i[n].splice(ut(i[n],t),1):delete i[n]}),this}},emit:function(n,t){var i,r;if(this.options.domEvents&&sf(n,t),i=this.handlers[n]&&this.handlers[n].slice(),i&&i.length)for(t.type=n,t.preventDefault=function(){t.srcEvent.preventDefault()},r=0;r<i.length;)i[r](t),r++},destroy:function(){this.element&&kr(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},w(p,{INPUT_START:f,INPUT_MOVE:nt,INPUT_END:u,INPUT_CANCEL:e,STATE_POSSIBLE:si,STATE_BEGAN:h,STATE_CHANGED:et,STATE_ENDED:k,STATE_RECOGNIZED:b,STATE_CANCELLED:yt,STATE_FAILED:a,DIRECTION_NONE:fi,DIRECTION_LEFT:st,DIRECTION_RIGHT:ht,DIRECTION_UP:ct,DIRECTION_DOWN:lt,DIRECTION_HORIZONTAL:l,DIRECTION_VERTICAL:tt,DIRECTION_ALL:tu,Manager:gi,Input:s,TouchAction:pi,TouchInput:ti,MouseInput:ni,PointerEventInput:vi,TouchMouseInput:yi,SingleTouchInput:yr,Recognizer:y,AttrRecognizer:c,Tap:ui,Pan:ri,Swipe:di,Pinch:wi,Rotate:ki,Press:bi,on:pt,off:wt,each:v,merge:lf,extend:gr,assign:w,inherit:o,bindFn:ci,prefixed:dt}),vu="undefined"!=typeof n?n:"undefined"!=typeof self?self:{},vu.Hammer=p,"function"==typeof define&&define.amd?define(function(){return p}):"undefined"!=typeof module&&module.exports?module.exports=p:n[i]=p}(window,document,"Hammer"),Affinity.stopHammerEvent=function(n){var t=typeOf(n)!=="null"?n:!1,i=t&&typeOf(t.srcEvent)!=="null"?t.srcEvent:!1;if(t){try{n.stopPropagation()}catch(r){}try{n.hasOwnProperty("event")&&n.event.hasOwnProperty("cancelable")&&n.event.cancelable&&n.preventDefault()}catch(r){}}if(i){try{i.stopPropagation()}catch(r){}try{i.preventDefault()}catch(r){}}},Affinity.mobileHistory={},Affinity.mobileHistory.set=function(){if(window.history.state===null){var t=[],n=window.location.href;n.indexOf("#")>-1&&(t=n.substring(n.indexOf("#")+1).split(","),n=n.substring(0,n.indexOf("#"))),t.push("m"),t=t.unique(),n+="#"+t.join(","),window.history.pushState("forward",null,n)}},window.history&&window.history.pushState&&(window.addEvent("popstate",function(n){try{n.stop()}catch(n){}try{n.preventDefault()}catch(n){}try{n.stopPropagation()}catch(n){}Affinity.mobileHistory.set(),window.fireEvent("mobileback")}),Affinity.mobileHistory.set()),Affinity.mobile=!0,Affinity.events={over:"touchstart",out:"touchstart",overAll:"touchstart",outAll:"touchend",start:"touchstart",move:"touchmove",end:"touchend",click:"touchstart"},window.fireEvent("MobileReady")}}.bind(window);var UIAutoCompleteMobileWidget=new Class({Version:"1.0.2.0",File:"ui.autocomplete.mobile.js",Name:"Autocomplete Mobile",Jira:"",Notes:"Add gteValue",WidgetName:"AutocompleteMobile",debug:!1,Implements:[Options,Events],Binds:["stopEvent","checkExists","cleanDisplay","getValue","setValue","getDisplayValue","openSearcher","processOptions","escapeRegExp","search","doSearch","defaultSelected","itemClicked","position","hide","blockHide","show","obscure","reveal","reset","revert","destroy","sortSelectElementOptionsByInnerText","sortSelectElementOptionsByInnerTextLastName","sortSelectElementOptionsByValue"],options:{stopInitialChange:!1,selectElement:null},list:[],selectElement:null,listElement:null,displayElement:null,changed:!1,defaultChangeValue:null,uuid:"",killid:"",type:"autocomplete",showEmptyAsBlank:!1,initialize:function(n){this.setOptions(n),this.icons={},this.icons.search=Affinity.icons.Search,this.selectElement=this.options.selectElement,this.selectElement.parentNode.classList.contains("select")&&this.selectElement.parentNode.classList.remove("select"),this.bestguess=null,this.selectElement.set("tabindex",5e3),this.selectElement.innerHTML.test(/\<option value=".*"\>\<all\>\<\/all\>\<\/option\>/gi)&&(this.selectElement.innerHTML=this.selectElement.innerHTML.replace(/\<option value="(.*)"\>\<all\>\<\/all\>\<\/option\>/gi,'<option value="$1">All<\/option>')),this.hiddenWrapper=new Element("div",{"class":"subhidden"}).inject(this.selectElement,"after"),this.selectElement.inject(this.hiddenWrapper),this.uuid=this.selectElement.get("id")==null?String.uniqueID():this.selectElement.get("id"),this.killid="ac-destroy-"+String.uniqueID(),window.autocompletes.widgets[this.uuid]||(window.autocompletes.widgets[this.uuid]=this),this.selectElement.set("id",this.uuid),this.selectElement.store("widget",this),this.build.delay(100,this)},build:function(){var i=!0,r=!0,u=!0,n=this.uuid+"",f,e,t;if(Affinity.UI.lastAutoKill[n]&&(document.getElement("."+Affinity.UI.lastAutoKill[n].killid)&&(clearTimeout(Affinity.UI.lastAutoKill[n].destroy),this.displayElement=document.getElement("."+Affinity.UI.lastAutoKill[n].killid).removeClass(Affinity.UI.lastAutoKill[n].killid).set("id",n+"-Display").inject(this.hiddenWrapper,"before"),this.displayElement.destroyWidget("elementWidget"),this.displayElement.removeEvents(),i=!1),Affinity.UI.lastAutoKill[n]=null,delete Affinity.UI.lastAutoKill[n]),i&&(this.displayElement=new Element("input",{type:"text","class":"ui-autocomplete-display",id:n+"-Display"}).inject(this.hiddenWrapper,"before")),this.displayElement.addClass(this.killid),n=this.uuid+"_icon",Affinity.UI.lastAutoKill[n]&&(document.getElement("."+Affinity.UI.lastAutoKill[n].killid)&&(clearTimeout(Affinity.UI.lastAutoKill[n].destroy),this.iconElement=document.getElement("."+Affinity.UI.lastAutoKill[n].killid).removeClass(Affinity.UI.lastAutoKill[n].killid).set("id",n+"-Display-Icon").inject(this.hiddenWrapper,"before"),this.iconElement.removeEvents(),r=!1),Affinity.UI.lastAutoKill[n]=null,delete Affinity.UI.lastAutoKill[n]),r&&(this.iconElement=new Element("span",{"class":"ui-autocomplete-display-icon searchmode",id:n+"-Display-Icon",html:Affinity.icons.Search}),this.iconElement.inject(this.displayElement,"after"),this.iconElement.addEventListener("click",this.openSearcher)),this.iconElement.addClass(this.killid+"_icon"),this.iconElement.removeClass("loading"),n=this.uuid+"_searcher",Affinity.UI.lastAutoKill[n]&&(document.getElement("."+Affinity.UI.lastAutoKill[n].killid)&&(clearTimeout(Affinity.UI.lastAutoKill[n].destroy),this.iconElement=document.getElement("."+Affinity.UI.lastAutoKill[n].killid).removeClass(Affinity.UI.lastAutoKill[n].killid).set("id",n+"-Display-Icon").inject(this.hiddenWrapper,"before"),this.iconElement.removeEvents(),u=!1),Affinity.UI.lastAutoKill[n]=null,delete Affinity.UI.lastAutoKill[n]),u){this.tapCloser=new Element("div",{"class":"ui-autocomplete-mobile-searcher-closer "+this.killid+" hidden"}).inject(document.body,"bottom"),this.tapCloser.addEvent("touchmove",function(n){n.stop()}),this.searchElement=new Element("div",{"class":"ui-autocomplete-mobile-searcher "+this.killid+" hidden",id:n}).inject(document.body,"bottom"),f=new Element("div",{"class":"ui-autocomplete-mobile-searcher-input-box"}).inject(this.searchElement),this.searchInput=new Element("input",{type:"text"}).inject(f),this.listBox=new Element("div",{"class":"ui-autocomplete-mobile-searcher-list-box hidden"}).inject(this.searchElement),this.listLoader=new Element("div",{"class":"ui-autocomplete-mobile-searcher-loader hidden",html:'Loading list <img src="'+Affinity.loaders.light+'" />'}).inject(this.searchElement),this.list=new Element("ul").inject(this.listBox),this.searchElement.set("reveal",{duration:250}),this.searchElement.toggle(),this.searchElement.addClass("hidden"),e=new Hammer(this.tapCloser,{domEvents:!0});e.on("tap",this.hide);this.searchInput.addEvent("keyup",this.search)}"getSelected"in this.selectElement?(t=this.selectElement.getSelected(),t.length>0&&(this.displayElement.value=this.cleanDisplay(t[0].get("html")))):this.displayElement.value=this.selectElement.getElement("option")?this.selectElement.getElement("option").value:this.selectElement.value||"",window.addEvent("mobileback",this.hide)},stopEvent:function(n){n.stop()},checkExists:function(){},cleanDisplay:function(n){return n.trim().replace(/&amp;/gi,"&")},getValue:function(){return this.selectElement.value},setValue:function(n){this.displayElement.value=n,this.searchInput.value=n,this.selectElement.value=n,this.processOptions()},getDisplayValue:function(){return this.cleanDisplay(this.displayElement.value)},status:"closed",defaultSelected:function(){},itemClicked:function(n){var t=n.target.get("tag")=="li"?n.target:n.target.getParent("li"),i;this.list.getElements("li.selected").removeClass("selected"),t.addClass("selected"),i=t.retrieve("value"),this.searchInput.value=this.cleanDisplay(t.get("html").stripTags()),this.displayElement.value=this.cleanDisplay(this.searchInput.value),this.selectElement.selectedIndex=t.retrieve("index"),this.selectElement.value=this.cleanDisplay(t.retrieve("value")),this.hide(),this.defaultChangeValue!==i?(this.defaultChangeValue=i,this.changed=!0):this.changed=!1,this.selectElement.get("onChange")||this.selectElement.get("onchange")?this.selectElement.onChange():this.selectElement.fireEvent("change",{target:this.selectElement}),window.fireEvent("elementChanged",{element:this.selectElement,callee:"autocomplete mobile itemClicked"}),this.fireEvent("elementChanged",this.selectElement.value)},processOptions:function(){var t,r,e,s,o;if(this.list.empty(),r=this.searchInput.value.clean().trim(),this.listLoader.set("html",'Loading list <img src="'+Affinity.loaders.light+'" />').removeClass("hidden"),this.selectElement.retrieve("data-store")&&this.selectElement.retrieve("data-key")){var n,i=!1,u=this.selectElement.retrieve("data-store"),f=this.selectElement.retrieve("data-key"),h=Affinity.UI[u][f].api;Affinity.UI[u][f].data.length===0?new Request.JSONP({callbackKey:"jsoncallback",url:h,method:"get",timeout:3e4,onComplete:function(e){JSON.Unauthorized(e,Affinity.UI[u][f].id+", lookup mobile loader")||("error"in e?this.listLoader.set("html","Failed loading list. Please refresh and try again."):typeOf(e)==="array"&&e.length>0&&(Affinity.UI[u][f].data=e,Affinity.UI[u][f].loaded=!0,this.defaultChangeValue=e[0].Key,Array.each(Affinity.UI[u][f].data,function(u,f){t=this.cleanDisplay(u.Value),this.showEmptyAsBlank&&(t=u.Value.trim()===""?"(blank)":t),n=new Element("li",{html:value}).store("value",u.Key).inject(this.list),u.Value.toLowerCase().indexOf(r.toLowerCase())>-1&&n.inject(this.list,"top"),u.Value===r&&(i=n,n.addClass("selected"),this.defaultChangeValue=u.Key),n.store("index",f),n.store("value",u.Key)}.bind(this)),i&&i.inject(this.list,"top"),this.listLoader.addClass("hidden"),this.listBox.removeClass("hidden"),this.buildFuzzySaechData()))}.bind(this),onError:function(){this.listLoader.set("html","Failed loading list. Please refresh and try again.")}.bind(this),onFailure:function(){this.listLoader.set("html","Failed loading list. Please refresh and try again.")}.bind(this),onTimeout:function(){this.listLoader.set("html","List loader timed out. Please refresh and try again.")}.bind(this)}).send():(this.defaultChangeValue=Affinity.UI[u][f].data[0].Key,Array.each(Affinity.UI[u][f].data,function(u,f){t=this.cleanDisplay(u.Value),this.showEmptyAsBlank&&(t=u.Value.trim()===""?"(blank)":t),n=new Element("li",{html:t}).store("value",u.Key).inject(this.list),u.Value.toLowerCase().indexOf(r.toLowerCase())>-1&&n.inject(this.list,"top"),u.Value===r&&(i=n,n.addClass("selected"),this.defaultChangeValue=u.Key),n.store("index",f),n.store("value",u.Key)}.bind(this)),i&&i.inject(this.list,"top"),this.listLoader.addClass("hidden"),this.listBox.removeClass("hidden"),this.buildFuzzySaechData())}else{this.defaultChangeValue=this.cleanDisplay(this.selectElement.value),s=this.selectElement.getAttribute("sortby"),o=null;switch(s){case"innerText-lastname":o=this.sortSelectElementOptionsByInnerTextLastName();break;case"innerText":o=this.sortSelectElementOptionsByInnerText();break;default:o=this.sortSelectElementOptionsByValue()}Array.each(o,function(u,f){e={Value:this.cleanDisplay(u.get("html")),Key:u.get("value")?u.get("value"):u.get("html").stripTags()},t=this.cleanDisplay(e.Value),this.showEmptyAsBlank&&(t=e.Value.trim()===""?"(blank)":t),n=new Element("li",{html:t}).store("value",e.Key).inject(this.list),e.Value.toLowerCase().indexOf(r.toLowerCase())>-1&&r.trim()!==""&&n.inject(this.list,"top"),e.Value===r&&(i=n,n.addClass("selected"),this.defaultChangeValue=e.Key),n.store("index",f),n.store("value",e.Key)}.bind(this)),i&&i.inject(this.list,"top"),this.listLoader.addClass("hidden"),this.listBox.removeClass("hidden"),this.buildFuzzySaechData()}},sortSelectElementOptionsByValue:function(){var n=this.selectElement.getElements("option"),t=!1,i;return n.length>0&&(i=n.length,n[0].value<n[i-1].value&&(t=!0)),t||(n=this.selectElement.getElements("option").sort(function(n,t){var i=n.value,r=t.value;return i<r?-1:i>r?1:0})),n},sortSelectElementOptionsByInnerText:function(){var n=this.selectElement.getElements("option"),t=!1;if(n.length>0){var i=n.length,r=n[0].innerText,u=n[i-1].innerText;r<u&&(t=!0)}return t||(n=this.selectElement.getElements("option").sort(function(n,t){var i=n.innerText,r=t.innerText;return i<r?-1:i>r?1:0})),n},sortSelectElementOptionsByInnerTextLastName:function(){var t=this.selectElement.getElements("option"),r=!1,n;if(t.length>0){var e=t.length,u="",f="",i=t[0].innerText.split(" ");for(n=1;n<i.length;n++)u+=i[n].trim()+" ";for(i=t[e-1].innerText.split(" "),n=1;n<i.length;n++)f+=i[n].trim()+" ";u<f&&(r=!0)}return r||(t=this.selectElement.getElements("option").sort(function(n,t){var u="",f,r,e,i;if(n!==undefined&&n.value!==null)for(f=n.innerText.split(" "),i=1;i<f.length;i++)u+=f[i].trim()+" ";if(r="",t!==undefined&&t.value!==null)for(e=t.innerText.split(" "),i=1;i<e.length;i++)r+=e[i].trim()+" ";return u<r?-1:u>r?1:0})),t},items:[],fuzzySearchItems:[],buildFuzzySaechData:function(){var n;this.items=[],this.fuzzySearchItems=[],Array.each(this.list.getElements("li"),function(t){n=this.cleanDisplay(t.get("html").replace(/\,/g," - ")),value=t.retrieve("value");var i=new Hammer(t,{domEvents:!0});i.on("tap",this.itemClicked);this.items.push(t),this.fuzzySearchItems.push({element:t,searchstr:n,value:value})}.bind(this)),this.fuzzySearchItemsTotal=this.fuzzySearchItems.length,this.fireEvent("complete",this)},openSearcher:function(){this.searchInput.value=this.displayElement.value;var n=this.displayElement.value.trim();n==""?uialert({message:"You must enter a search term",showButtons:!0}):n.length===1?uialert({message:"You must enter more than 1 character",showButtons:!0}):(this.show(),this.processOptions())},escapeRegExp:function(n){return n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},searchDelay:!1,search:function(n){if(typeOf(n)!=="null"&&"key"in n&&n.key==="enter"){this.itemClicked({target:this.list.getElement("li")});return}this.searchDelay&&clearTimeout(this.searchDelay);var t=this.fuzzySearchItems.length>1e3?500:this.fuzzySearchItems.length>500?250:100;this.searchDelay=this.doSearch.delay(t,this)},searchRunning:!1,doSearch:function(){var l=this.list,n=this.searchInput.value.clean().trim(),f=this.fuzzySearchItems,h="searchstr",a,t,r,o,u,nt,s,v,b,y,e,p,c,k,d,g,i,w;if(!this.searchRunning){if(n===""){Array.each(f,function(n){i=this.cleanDisplay(n.element.get("html").stripTags()),n.element.set("html",i),n.element.inject(l)}.bind(this));return}return this.searchRunning=!0,a=[],t=[],isNaN(n)?Array.each(f,function(f,l){o=0,nt=[],n=n.toLowerCase(),s=f[h].toLowerCase().trim(),v=n===s,b=s.indexOf(n)>-1?!0:!1,p=n.split(" "),y=p.length,v?(e=y,u=99999,o=99999,i="<strong>"+this.cleanDisplay(f.element.get("html").stripTags())+"<\/strong>",f.element.set("html",i)):!v&&b?(e=s.split(n).length-1||0,u=e,o=u+100,i=this.cleanDisplay(f.element.get("html").stripTags()).replace(new RegExp("("+this.escapeRegExp(n)+")","gi"),"<strong>$1<\/strong>"),f.element.set("html",i)):(c=s.split(" "),e=0,Array.each(p,function(n){Array.each(c,function(t){n!=" "&&n!=""&&(k=n.soundex(),d=t.soundex(),g=k.distance(d),g==0&&(e+=1))})}),o=e,u=Number.round(e/y,2)||0,o>=0&&(i=this.cleanDisplay(f.element.get("html").stripTags()),f.element.set("html",i))),r={originalIndex:l,score:o,wordScore:u},t.push(r)}.bind(this)):Array.each(f,function(r,f){r[h].contains(n)&&(u=r[h].split(n).length-1||0,c=r[h].split(" "),i=this.cleanDisplay(r.element.get("html").stripTags()).replace(new RegExp("("+this.escapeRegExp(n)+")","gi"),"<strong>$1<\/strong>"),r.element.set("html",i),t.push({originalIndex:f,score:u,wordScore:u/c}))}.bind(this)),t.sort(function(n,t){return parseFloat(n.score)===parseFloat(t.score)?parseFloat(n.wordScore)<parseFloat(t.wordScore)?1:-1:parseFloat(n.score)<parseFloat(t.score)?1:-1}),w=!1,Array.each(t,function(n){r=f[n.originalIndex],r.score=n.score,r.wordScore=n.wordScore,a.push(r),n.score>0?(r.element.inject(l,"top"),w=!0):r.element.inject(l,"bottom")}),!w&&t.length>0&&t[0].originalIndex&&f[t[0].originalIndex]&&f[t[0].originalIndex].element&&(this.bestguess=f[t[0].originalIndex].element),this.searchRunning=!1,a}},position:function(){},hideTimer:!1,hide:function(){this.tapCloser.addClass("hidden"),this.searchElement.dissolve(),clearTimeout(this.hideTimer),this.hideTimer=this.blockHide.delay(250,this)},blockHide:function(){this.searchElement.addClass("hidden")},show:function(){var t,i,n;clearTimeout(this.hideTimer),t=320,this.tapCloser.removeClass("hidden"),i=window.getSize().y,n=i-t,this.list.setStyle("max-height",n-41),this.searchElement.setStyle("max-height",n),this.searchElement.removeClass("hidden"),function(){this.searchElement.reveal(),function(){this.searchInput.focus(),function(){this.searchInput.setSelectionRange(0,this.searchInput.value.length)}.delay(50,this)}.delay(50,this)}.delay(50,this)},obscure:function(){clearTimeout(this.hideTimer),this.tapCloser.addClass("hidden"),this.searchElement.dissolve(),this.searchElement.addClass("hidden")},reset:function(){this.revert()},revert:function(n){if(this.tapCloser!==undefined&&this.tapCloser!==null){for(clearTimeout(this.hideTimer),Hammer(this.tapCloser).off("tap",this.hide),this.tapCloser.removeEvents(),this.tapCloser.destroy(),this.list.removeEvents();this.list.lastChild;)this.list.lastChild.removeEvents(),Hammer(this.list.lastChild).off("tap",this.itemClicked),this.list.removeChild(this.list.lastChild);this.list.destroy(),this.searchElement.destroy(),Hammer(this.iconElement).off("tap",this.openSearcher),this.iconElement.destroy(),Affinity.UI.lastAutoKill[this.uuid]={},Affinity.UI.lastAutoKill[this.uuid].id=this.uuid+"",Affinity.UI.lastAutoKill[this.uuid].killid=this.killid+"",Affinity.UI.lastAutoKill[this.uuid].destroy=Affinity.UI.delayAutoKill.delay(2e3,window,[this.uuid+"",this.killid+""]),this.iconElement.addClass("loading"),Affinity.UI.lastAutoKill[this.uuid+"_icon"]={},Affinity.UI.lastAutoKill[this.uuid+"_icon"].id=this.uuid+"_icon",Affinity.UI.lastAutoKill[this.uuid+"_icon"].killid=this.killid+"_icon",Affinity.UI.lastAutoKill[this.uuid+"_icon"].destroy=Affinity.UI.delayAutoKill.delay(2e3,window,[this.uuid+"_icon",this.killid+"_icon"]),this.displayElement.removeEvents(),this.displayElement.getWidget("elementWidget")&&this.displayElement.getWidget("elementWidget").destroy(),this.displayElement.eliminate("value"),this.selectElement.inject(this.hiddenWrapper,"before"),this.selectElement.eliminate("widget"),n&&this.selectElement.destroy(),this.hiddenWrapper.destroy(),window.autocompletes.widgets[this.uuid]&&(window.autocompletes.widgets[this.uuid]=null,delete window.autocompletes.widgets[this.uuid]),window.removeEvent("mobileback",this.hide),Object.each(this,function(n,t){this[t]=null,delete this[t]}.bind(this))}},destroy:function(){this.revert(!0)}})